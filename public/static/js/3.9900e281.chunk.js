(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[3],{435:function(e,r,n){"use strict";n.d(r,"a",(function(){return i}));var t=n(167),a=function(e,r){var n={};for(var a in e){var i=Object(t.d)(r,a);Object(t.e)(n,a,Object.assign(e[a],{ref:i&&i.ref}))}return n},i=function(e,r,n){return void 0===r&&(r={abortEarly:!1}),void 0===n&&(n={}),function(i,c,s){try{return Promise.resolve(function(t,a){try{var s=(r.context,Promise.resolve(e["sync"===n.mode?"validateSync":"validate"](i,Object.assign({},r,{context:c}))).then((function(e){return{values:e,errors:{}}})))}catch(t){return a(t)}return s&&s.then?s.then(void 0,a):s}(0,(function(e){return{values:{},errors:a((r=e,n="all"===s.criteriaMode,r.inner.reduce((function(e,r){if(e[r.path]||(e[r.path]={message:r.message,type:r.type}),n){var a=e[r.path].types,i=a&&a[r.type];e[r.path]=Object(t.c)(r.path,n,e,r.type,i?[].concat(i,r.message):r.message)}return e}),{})),s.fields)};var r,n})))}catch(o){return Promise.reject(o)}}}},436:function(e,r,n){"use strict";n.d(r,"a",(function(){return t}));var t={};n.r(t),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return a})),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return i})),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return c})),n.d(t,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return s})),n.d(t,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return o})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return l})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return d})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return u})),n.d(t,"VER_USUARIOS",(function(){return j})),n.d(t,"VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return b})),n.d(t,"REGISTRAR_USUARIOS",(function(){return O})),n.d(t,"REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return m})),n.d(t,"EDITAR_USUARIOS",(function(){return h})),n.d(t,"EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return x})),n.d(t,"BLOQUEAR_USUARIOS",(function(){return f})),n.d(t,"BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return p})),n.d(t,"DESBLOQUEAR_USUARIOS",(function(){return v})),n.d(t,"DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return E})),n.d(t,"CAMBIAR_CONTRASE\xd1A",(function(){return R})),n.d(t,"CAMBIAR_CONTRASE\xd1A_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return g})),n.d(t,"VER_ROLES",(function(){return A})),n.d(t,"REGISTRAR_ROLES",(function(){return I})),n.d(t,"EDITAR_ROLES",(function(){return _})),n.d(t,"ELIMINAR_ROLES",(function(){return S})),n.d(t,"VER_LISTA_DE_MORA",(function(){return N})),n.d(t,"VER_LISTA_DE_MORA_REGIONAL",(function(){return C})),n.d(t,"AGREGAR_EMPLEADOR_EN_MORA",(function(){return w})),n.d(t,"AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return U})),n.d(t,"QUITAR_EMPLEADOR_EN_MORA",(function(){return L})),n.d(t,"QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return y})),n.d(t,"VER_MEDICOS",(function(){return P})),n.d(t,"VER_MEDICOS_REGIONAL",(function(){return M})),n.d(t,"REGISTRAR_MEDICOS",(function(){return D})),n.d(t,"REGISTRAR_MEDICOS_REGIONAL",(function(){return T})),n.d(t,"EDITAR_MEDICOS",(function(){return G})),n.d(t,"EDITAR_MEDICOS_REGIONAL",(function(){return z})),n.d(t,"BAJA_MEDICOS",(function(){return V})),n.d(t,"BAJA_MEDICOS_REGIONAL",(function(){return k})),n.d(t,"VER_PROVEEDORES",(function(){return F})),n.d(t,"VER_PROVEEDORES_REGIONAL",(function(){return B})),n.d(t,"REGISTRAR_PROVEEDORES",(function(){return Q})),n.d(t,"REGISTRAR_PROVEEDORES_REGIONAL",(function(){return q})),n.d(t,"EDITAR_PROVEEDORES",(function(){return K})),n.d(t,"EDITAR_PROVEEDORES_REGIONAL",(function(){return H})),n.d(t,"REGISTRAR_CONTRATO_PROVEEDOR",(function(){return X})),n.d(t,"REGISTRAR_CONTRATO_PROVEEDOR_REGIONAL",(function(){return W})),n.d(t,"BAJA_PROVEEDORES",(function(){return J})),n.d(t,"BAJA_PROVEEDORES_REGIONAL",(function(){return $})),n.d(t,"VER_ESPECIALIDADES",(function(){return Z})),n.d(t,"REGISTRAR_ESPECIALIDADES",(function(){return Y})),n.d(t,"EDITAR_ESPECIALIDADES",(function(){return ee})),n.d(t,"ELIMINAR_ESPECIALIDADES",(function(){return re})),n.d(t,"IMPORTAR_ESPECIALIDADES",(function(){return ne})),n.d(t,"VER_PRESTACIONES",(function(){return te})),n.d(t,"REGISTRAR_PRESTACIONES",(function(){return ae})),n.d(t,"EDITAR_PRESTACIONES",(function(){return ie})),n.d(t,"ELIMINAR_PRESTACIONES",(function(){return ce})),n.d(t,"IMPORTAR_PRESTACIONES",(function(){return se}));var a="Ver solicitudes de atencion externa",i="Ver solicitudes de atencion externa (misma regional)",c="Ver solicitudes de atencion externa (registrado por)",s="Registrar solicitudes de atencion externa",o="Registrar solicitudes de atencion externa (misma regional)",l="Emitir solicitudes de atencion externa",d="Emitir solicitudes de atencion externa (misma regional)",u="Emitir solicitudes de atencion externa (registrado por)",j="Ver usuarios",b="Ver usuarios (misma regional)",O="Registrar usuarios",m="Registrar usuarios (misma regional)",h="Editar usuarios",x="Editar usuarios (misma regional)",f="Bloquear usuarios",p="Bloquear usuarios (misma regional)",v="Desbloquear usuarios",E="Desbloquear usuarios (misma regional)",R="Cambiar contrase\xf1a",g="Cambiar contrase\xf1a (misma regional)",A="Ver roles",I="Registrar roles",_="Editar roles",S="Eliminar roles",N="Ver lista de mora",C="Ver lista de mora (regional)",w="Agregar empleador en mora",U="Agregar empleador en mora (misma regional)",L="Quitar empleador en mora",y="Quitar empleador en mora (misma regional)",P="Ver m\xe9dicos",M="Ver m\xe9dicos (regional)",D="Registrar m\xe9dicos",T="Registrar m\xe9dicos (regional)",G="Editar m\xe9dicos",z="Editar m\xe9dicos (regional)",V="Baja m\xe9dicos",k="Baja m\xe9dicos (regional)",F="Ver proveedores",B="Ver proveedores (regional)",Q="Registrar proveedores",q="Registrar proveedores (regional)",K="Editar proveedores",H="Editar proveedores (regional)",X="Registrar contratos de preveedores",W="Registrar contratos de preveedores (regional)",J="Baja proveedores",$="Baja proveedores (regional)",Z="Ver especialidades",Y="Registrar especialidades",ee="Editar especialidades",re="Eliminar especialidades",ne="Importar especialidades",te="Ver prestaciones",ae="Registrar prestaciones",ie="Editar prestaciones",ce="Eliminar prestaciones",se="Importar prestaciones"},437:function(e,r,n){"use strict";var t=n(15),a=(n(1),n(440)),i=n(37),c=n(23),s=n(169),o=(n(438),n(4));r.a=function(e){var r=e.sidebar,n=e.children,l=Object(i.c)((function(e){return e.main.showSidebar})),d=Object(c.j)();d.path,d.url;return Object(o.jsxs)("div",{className:"position-relative d-flex flex-grow-1 bg-light"+(l?"":" toggled"),id:"wrapper",children:[Object(o.jsx)(s.a,Object(t.a)({className:"bg-white shadow-sm"},r)),Object(o.jsx)(a.a,{className:"d-flex flex-column flex-grow-1",children:Object(o.jsx)("div",{className:"d-flex flex-column bg-white rounded-lg shadow-sm m-2 p-3 flex-grow-1",children:n})})]})}},438:function(e,r,n){},440:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(7),c=n.n(i),s=n(1),o=n.n(s),l=n(9),d=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.fluid,s=e.as,d=void 0===s?"div":s,u=e.className,j=Object(a.a)(e,["bsPrefix","fluid","as","className"]),b=Object(l.a)(n,"container"),O="string"===typeof i?"-"+i:"-fluid";return o.a.createElement(d,Object(t.a)({ref:r},j,{className:c()(u,i?""+b+O:b)}))}));d.displayName="Container",d.defaultProps={fluid:!1},r.a=d},441:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(7),c=n.n(i),s=n(1),o=n.n(s),l=n(9),d=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,s=e.striped,d=e.bordered,u=e.borderless,j=e.hover,b=e.size,O=e.variant,m=e.responsive,h=Object(a.a)(e,["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"]),x=Object(l.a)(n,"table"),f=c()(i,x,O&&x+"-"+O,b&&x+"-"+b,s&&x+"-striped",d&&x+"-bordered",u&&x+"-borderless",j&&x+"-hover"),p=o.a.createElement("table",Object(t.a)({},h,{className:f,ref:r}));if(m){var v=x+"-responsive";return"string"===typeof m&&(v=v+"-"+m),o.a.createElement("div",{className:v},p)}return p}));r.a=d},444:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(7),c=n.n(i),s=n(1),o=n.n(s),l=n(48),d=n(9),u=n(33),j=o.a.createContext(null);j.displayName="AccordionContext";var b=j;var O=o.a.forwardRef((function(e,r){var n=e.as,i=void 0===n?"button":n,c=e.children,l=e.eventKey,d=e.onClick,j=Object(a.a)(e,["as","children","eventKey","onClick"]),O=function(e,r){var n=Object(s.useContext)(b),t=Object(s.useContext)(u.a);return function(a){t&&t(e===n?null:e,a),r&&r(a)}}(l,d);return"button"===i&&(j.type="button"),o.a.createElement(i,Object(t.a)({ref:r,onClick:O},j),c)})),m=n(174),h=o.a.forwardRef((function(e,r){var n=e.children,i=e.eventKey,c=Object(a.a)(e,["children","eventKey"]),l=Object(s.useContext)(b);return o.a.createElement(u.a.Provider,{value:null},o.a.createElement(m.a,Object(t.a)({ref:r,in:l===i},c),o.a.createElement("div",null,o.a.Children.only(n))))}));h.displayName="AccordionCollapse";var x=h,f=o.a.forwardRef((function(e,r){var n=Object(l.a)(e,{activeKey:"onSelect"}),i=n.as,s=void 0===i?"div":i,j=n.activeKey,O=n.bsPrefix,m=n.children,h=n.className,x=n.onSelect,f=Object(a.a)(n,["as","activeKey","bsPrefix","children","className","onSelect"]),p=c()(h,Object(d.a)(O,"accordion"));return o.a.createElement(b.Provider,{value:j||null},o.a.createElement(u.a.Provider,{value:x||null},o.a.createElement(s,Object(t.a)({ref:r},f,{className:p}),m)))}));f.displayName="Accordion",f.Toggle=O,f.Collapse=x;r.a=f},445:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(7),c=n.n(i),s=n(1),o=n.n(s),l=n(9),d=n(27),u=n(110),j=n(176),b=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,s=e.variant,d=e.as,u=void 0===d?"img":d,j=Object(a.a)(e,["bsPrefix","className","variant","as"]),b=Object(l.a)(n,"card-img");return o.a.createElement(u,Object(t.a)({ref:r,className:c()(s?b+"-"+s:b,i)},j))}));b.displayName="CardImg",b.defaultProps={variant:null};var O=b,m=Object(u.a)("h5"),h=Object(u.a)("h6"),x=Object(d.a)("card-body"),f=Object(d.a)("card-title",{Component:m}),p=Object(d.a)("card-subtitle",{Component:h}),v=Object(d.a)("card-link",{Component:"a"}),E=Object(d.a)("card-text",{Component:"p"}),R=Object(d.a)("card-header"),g=Object(d.a)("card-footer"),A=Object(d.a)("card-img-overlay"),I=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,d=e.bg,u=e.text,b=e.border,O=e.body,m=e.children,h=e.as,f=void 0===h?"div":h,p=Object(a.a)(e,["bsPrefix","className","bg","text","border","body","children","as"]),v=Object(l.a)(n,"card"),E=Object(s.useMemo)((function(){return{cardHeaderBsPrefix:v+"-header"}}),[v]);return o.a.createElement(j.a.Provider,{value:E},o.a.createElement(f,Object(t.a)({ref:r},p,{className:c()(i,v,d&&"bg-"+d,u&&"text-"+u,b&&"border-"+b)}),O?o.a.createElement(x,null,m):m))}));I.displayName="Card",I.defaultProps={body:!1},I.Img=O,I.Title=f,I.Subtitle=p,I.Body=x,I.Link=v,I.Text=E,I.Header=R,I.Footer=g,I.ImgOverlay=A;r.a=I},449:function(e,r,n){"use strict";n.r(r),n.d(r,"IamApp",(function(){return Ae}));var t=n(1),a=n.n(t),i=n(23),c=n(30),s=n(437),o=n(107),l=n(108),d=n(15),u=n(26),j=n(426),b=n(444),O=n(445),m=n(232),h=n(161),x=n(416),f=n(167),p=n(428),v=n(432),E=n(168),R=n(47),g=n(36),A=function(e,r){return R.apiClient.get("/usuarios",{params:Object(g.c)({page:r,filter:e})})},I=function(e){return R.apiClient.get("/usuarios/".concat(e))},_=function(e){return R.apiClient.post("/usuarios",Object(g.c)(e))},S=function(e,r){return R.apiClient.put("/usuarios/".concat(e),Object(g.c)(r))},N=function(e,r){return R.apiClient.put("/usuarios/".concat(e,"/cambiar-contrasena"),Object(g.c)(r))},C=function(e){return R.apiClient.put("/usuarios/".concat(e,"/bloquear"))},w=function(e){return R.apiClient.put("/usuarios/".concat(e,"/desbloquear"))},U=function(e,r){return R.apiClient.get("/roles",{params:{filter:e,page:r}})},L=function(e){return R.apiClient.get("/roles/".concat(e))},y=function(e){return R.apiClient.post("roles",e)},P=function(e,r){return R.apiClient.put("roles/".concat(e),r)},M=function(e){return R.apiClient.delete("roles/".concat(e))},D=n(22),T=n(417),G=n(2),z=n(5),V=n(7),k=n.n(V),F=(n(39),n(48)),B=n(9),Q=n(224),q=n(222),K=n(33),H={variant:void 0,active:!1,disabled:!1},X=a.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.active,c=e.disabled,s=e.className,o=e.variant,l=e.action,d=e.as,u=e.eventKey,j=e.onClick,b=Object(z.a)(e,["bsPrefix","active","disabled","className","variant","action","as","eventKey","onClick"]);n=Object(B.a)(n,"list-group-item");var O=Object(t.useCallback)((function(e){if(c)return e.preventDefault(),void e.stopPropagation();j&&j(e)}),[c,j]);return c&&void 0===b.tabIndex&&(b.tabIndex=-1,b["aria-disabled"]=!0),a.a.createElement(q.a,Object(G.a)({ref:r},b,{eventKey:Object(K.b)(u,b.href),as:d||(l?b.href?"a":"button":"div"),onClick:O,className:k()(s,n,i&&"active",c&&"disabled",o&&n+"-"+o,l&&n+"-action")}))}));X.defaultProps=H,X.displayName="ListGroupItem";var W=X,J={variant:void 0,horizontal:void 0},$=a.a.forwardRef((function(e,r){var n,t=Object(F.a)(e,{activeKey:"onSelect"}),i=t.className,c=t.bsPrefix,s=t.variant,o=t.horizontal,l=t.as,d=void 0===l?"div":l,u=Object(z.a)(t,["className","bsPrefix","variant","horizontal","as"]),j=Object(B.a)(c,"list-group");return n=o?!0===o?"horizontal":"horizontal-"+o:null,a.a.createElement(Q.a,Object(G.a)({ref:r},u,{as:d,className:k()(i,j,s&&j+"-"+s,n&&j+"-"+n)}))}));$.defaultProps=J,$.displayName="ListGroup",$.Item=W;var Z=$,Y=n(4),ee=1,re=a.a.memo((function(e){var r,n=e.isInvalid,t=e.selected,a=void 0===t?[]:t,i=e.onChange,c=Object(p.a)("roles.buscar",(function(){return U()}),{enabled:!0,refetchOnReconnect:!1,refetchOnMount:!1,refetchOnWindowFocus:!1});console.log("Render count",ee++);var s=(null===(r=c.data)||void 0===r?void 0:r.data)||[];return Object(Y.jsx)("div",{className:n?"is-invalid":"",children:c.isFetching?Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(x.a,{animation:"border",size:"sm"}),Object(Y.jsx)("span",{children:"Cargando"})]}):c.isError?Object(Y.jsxs)(T.a,{variant:"danger",children:["Ocurrio un error al obtener la lista de roles. Haga clic ",Object(Y.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),c.refetch()},children:"aqui"})," para volver a intentar"]}):Object(Y.jsx)(Z,{as:"ul",className:"overflow-auto flex-grow-1",style:{maxHeight:"12rem"},children:s.map((function(e,r){return Object(Y.jsx)(Z.Item,{as:"li",className:"py-2 px-3 text-capitalize"+(n?" border-danger":""),action:!0,children:Object(Y.jsx)(j.a.Check,{type:"checkbox",isInvalid:n,label:e.name,checked:a.some((function(r){return r.id==e.id})),onChange:function(r){var n=r.target.checked;i&&i(n?[].concat(Object(D.a)(a),[e]):a.filter((function(r){return r.id!=e.id})))}})},e.id)}))})})})),ne=n(435),te=n(83),ae=n(436),ie=function(){var e,r,n,a,c,s,o,R,g,A,N,C,w,U,L,y,P,M,D,T,G,z,V,k,F,B,Q,q=Object(l.a)(),K=Object(i.i)().id,H=Object(t.useMemo)((function(){return te.g().shape({informacionPersonal:te.g().shape({ci:te.f().label("carnet de identidad"),ciComplemento:te.d((function(e){return e?te.j().label("'complemento'").trim().length(2):te.j().nullable().optional()})),apellidoPaterno:te.j().label("apellido paterno").trim().when("apellidoMaterno",{is:function(e){return!e},then:te.j().required("Debe proporcionar al menos un apellido")}),apellidoMaterno:te.j().label("apellido materno").trim().when("apellidoPaterno",{is:function(e){return!e},then:te.j().required("Debe proporcionar al menos un apellido")}),nombres:te.j().label("nombres").trim().required().label("'Nombres'")},[["apellidoMaterno","apellidoPaterno"]]),informacionUsuario:te.g().shape(K?{roles:te.b().label("roles").min(1,"Debe seleccionar al menos un rol")}:{username:te.j().label("usuario").required().matches(/[a-zA-Z0-9]{4,}/).min(4).max(16),password:te.j().label("contrase\xf1a").min(8).max(32).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/,"La contrase\xf1a debe contener al menos un caracter en minuscula, uno en mayuscula, un n\xfamero y uno de los siguientes caracter especial: !@#$%^&*").required(),passwordRepeat:te.j().label("confirmar contrase\xf1a").test("password-match","Las contrase\xf1as no coinciden",(function(e){return e===this.parent.password})),regional:te.b().length(1),roles:te.b().label("roles").min(1,"Debe seleccionar al menos un rol")})})}),[]),X=Object(f.h)({resolver:Object(ne.a)(H),mode:"onBlur",defaultValues:{informacionUsuario:{roles:[],regional:[]}}}),W=X.control,J=X.formState,$=X.handleSubmit,Z=X.register,ee=X.setValue,ie=X.trigger,ce=X.watch,se=Object(i.g)(),oe=["usuarios.cargar",K],le=Object(p.a)(oe,(function(){return I(parseInt(K))}),{enabled:!!K&&!(null===(e=se.location.state)||void 0===e?void 0:e.user)}),de=Object(v.a)((function(e){var r=e.informacionPersonal,n=e.informacionUsuario;return K?S(parseInt(K),{regionalId:n.regional[0].id,roles:n.roles.map((function(e){return e.name})),ci:parseInt(r.ci),ciComplemento:r.ciComplemento,apellidoPaterno:r.apellidoPaterno,apellidoMaterno:r.apellidoMaterno,nombres:r.nombres}):_({username:n.username,password:n.password,regionalId:n.regional[0].id,roles:n.roles.map((function(e){return e.name})),ci:parseInt(r.ci),ciComplemento:r.ciComplemento,apellidoPaterno:r.apellidoPaterno,apellidoMaterno:r.apellidoMaterno,nombres:r.nombres})}),{onSuccess:function(e){var r=e.data;se.replace("/iam/usuarios/".concat(r.id),{user:r})}}),ue=Object(t.useState)([]),je=Object(u.a)(ue,2),be=je[0],Oe=je[1],me=Object(t.useCallback)((function(e){return!!q.can(ae.a.REGISTRAR_USUARIOS)||e.id==q.regionalId}),[q]),he=(null===(r=le.data)||void 0===r?void 0:r.data)||(null===(n=se.location.state)||void 0===n?void 0:n.user),xe=J.errors;return Object(t.useEffect)((function(){he&&be.length&&(ee("informacionPersonal",{ci:String(he.ciRaiz),ciComplemento:he.ciComplemento,apellidoPaterno:he.apellidoPaterno,apellidoMaterno:he.apellidoMaterno,nombres:he.nombres}),ee("informacionUsuario",{username:he.username,roles:he.roles,regional:[be.find((function(e){return e.id==he.id}))]}))}),[he]),Object(Y.jsx)(Y.Fragment,{children:Object(Y.jsxs)(j.a,{onSubmit:$((function(e){de.mutate(e)})),children:[Object(Y.jsx)("h1",{style:{fontSize:"2rem"},children:"Usuarios"}),Object(Y.jsxs)(b.a,{className:"mb-2",defaultActiveKey:"0",children:[Object(Y.jsxs)(O.a,{children:[Object(Y.jsx)(b.a.Toggle,{as:O.a.Header,className:["text-light",xe.informacionPersonal?"bg-danger":"bg-primary"].join(" "),eventKey:"0",children:"Informaci\xf3n personal"}),Object(Y.jsx)(b.a.Collapse,{eventKey:"0",children:Object(Y.jsxs)(O.a.Body,{children:[Object(Y.jsxs)(j.a.Row,{children:[Object(Y.jsxs)(j.a.Group,{as:m.a,xs:8,md:4,children:[Object(Y.jsx)(j.a.Label,{title:"Numero raiz del carnet de identidad",children:"Carnet de identidad"}),Object(Y.jsx)(j.a.Control,Object(d.a)({type:"number",isInvalid:!!(null===(a=J.errors.informacionPersonal)||void 0===a?void 0:a.ci)},Z("informacionPersonal.ci"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(c=xe.informacionPersonal)||void 0===c||null===(s=c.ci)||void 0===s?void 0:s.message})]}),Object(Y.jsxs)(j.a.Group,{as:m.a,xs:4,md:2,children:[Object(Y.jsx)(j.a.Label,{title:"Complemento del carnet de identiad",children:"Complemento"}),Object(Y.jsx)(j.a.Control,Object(d.a)({isInvalid:!!(null===(o=xe.informacionPersonal)||void 0===o?void 0:o.ciComplemento)},Z("informacionPersonal.ciComplemento"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(R=xe.informacionPersonal)||void 0===R||null===(g=R.ciComplemento)||void 0===g?void 0:g.message})]})]}),Object(Y.jsxs)(j.a.Row,{children:[Object(Y.jsxs)(j.a.Group,{as:m.a,lg:4,children:[Object(Y.jsx)(j.a.Label,{children:"Apellido Paterno"}),Object(Y.jsx)(j.a.Control,Object(d.a)(Object(d.a)({isInvalid:!!(null===(A=xe.informacionPersonal)||void 0===A?void 0:A.apellidoPaterno)},Z("informacionPersonal.apellidoPaterno")),{},{onChange:function(e){Z("informacionPersonal.apellidoPaterno").onChange(e),J.isSubmitted&&ie("informacionPersonal.apellidoMaterno")}})),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(N=xe.informacionPersonal)||void 0===N||null===(C=N.apellidoPaterno)||void 0===C?void 0:C.message})]}),Object(Y.jsxs)(j.a.Group,{as:m.a,lg:4,children:[Object(Y.jsx)(j.a.Label,{children:"Apellido Materno"}),Object(Y.jsx)(j.a.Control,Object(d.a)(Object(d.a)({isInvalid:!!(null===(w=xe.informacionPersonal)||void 0===w?void 0:w.apellidoMaterno)},Z("informacionPersonal.apellidoMaterno")),{},{onChange:function(e){Z("informacionPersonal.apellidoPaterno").onChange(e),J.isSubmitted&&ie("informacionPersonal.apellidoMaterno")}})),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(U=xe.informacionPersonal)||void 0===U||null===(L=U.apellidoMaterno)||void 0===L?void 0:L.message})]}),Object(Y.jsxs)(j.a.Group,{as:m.a,lg:4,children:[Object(Y.jsx)(j.a.Label,{children:"Nombres"}),Object(Y.jsx)(j.a.Control,Object(d.a)({isInvalid:!!(null===(y=J.errors.informacionPersonal)||void 0===y?void 0:y.nombres)},Z("informacionPersonal.nombres"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(P=J.errors.informacionPersonal)||void 0===P||null===(M=P.nombres)||void 0===M?void 0:M.message})]})]})]})})]}),Object(Y.jsxs)(O.a,{children:[Object(Y.jsx)(b.a.Toggle,{as:O.a.Header,className:["text-light",xe.informacionUsuario?"bg-danger":"bg-primary"].join(" "),eventKey:"1",children:"Informacion de usuario"}),Object(Y.jsx)(b.a.Collapse,{eventKey:"1",children:Object(Y.jsxs)(O.a.Body,{children:[Object(Y.jsxs)(j.a.Row,{children:[Object(Y.jsxs)(j.a.Group,{controlId:"username",as:m.a,md:4,children:[Object(Y.jsx)(j.a.Label,{children:"Usuario"}),Object(Y.jsx)(j.a.Control,Object(d.a)({disabled:!!K,isInvalid:!!(null===(D=J.errors.informacionUsuario)||void 0===D?void 0:D.username)},Z("informacionUsuario.username"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(T=J.errors.informacionUsuario)||void 0===T||null===(G=T.username)||void 0===G?void 0:G.message})]}),K?null:Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsxs)(j.a.Group,{as:m.a,md:4,children:[Object(Y.jsx)(j.a.Label,{children:"Contrase\xf1a"}),Object(Y.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!(null===(z=J.errors.informacionUsuario)||void 0===z?void 0:z.password)},Z("informacionUsuario.password"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(V=J.errors.informacionUsuario)||void 0===V||null===(k=V.password)||void 0===k?void 0:k.message})]}),Object(Y.jsxs)(j.a.Group,{as:m.a,md:4,children:[Object(Y.jsx)(j.a.Label,{children:"Confirmar contrase\xf1a"}),Object(Y.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!(null===(F=J.errors.informacionUsuario)||void 0===F?void 0:F.passwordRepeat)},Z("informacionUsuario.passwordRepeat",{required:{value:!0,message:"Este campo es requerido"},validate:{matchPassword:function(e){return e===ce("informacionUsuario.password")||"Las contrase\xf1as no coinciden"}}}))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(B=J.errors.informacionUsuario)||void 0===B||null===(Q=B.passwordRepeat)||void 0===Q?void 0:Q.message})]})]})]}),Object(Y.jsxs)(j.a.Group,{children:[Object(Y.jsx)(j.a.Label,{children:"Regional"}),Object(Y.jsx)(f.a,{name:"informacionUsuario.regional",control:W,render:function(e){var r,n=e.field,t=e.fieldState;return Object(Y.jsx)(E.i,{id:"usuario/regionales-typeahead",onLoad:Oe,isInvalid:!!t.error,feedback:null===(r=t.error)||void 0===r?void 0:r.message,filterBy:me,selected:n.value,onBlur:n.onBlur,onChange:n.onChange})}})]}),Object(Y.jsx)(j.a.Row,{children:Object(Y.jsxs)(j.a.Group,{as:m.a,children:[Object(Y.jsx)(j.a.Label,{children:"Roles"}),Object(Y.jsx)(f.a,{name:"informacionUsuario.roles",control:W,render:function(e){var r,n=e.field,t=e.fieldState;return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(re,{isInvalid:!!t.error,onChange:n.onChange,selected:n.value}),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(r=t.error)||void 0===r?void 0:r.message})]})}})]})})]})})]})]}),Object(Y.jsx)(j.a.Row,{children:Object(Y.jsx)(m.a,{children:Object(Y.jsxs)(h.a,{type:"submit",children:[de.isLoading?Object(Y.jsx)(x.a,{animation:"border",className:"mr-2",size:"sm"}):null,Object(Y.jsx)("span",{className:"align-middle",children:"Guardar"})]})})})]})})},ce=function(){var e,r,n=Object(i.i)().id,a=Object(i.g)(),c=Object(t.useMemo)((function(){return te.g().shape({newPassword:te.j().label("nueva contrase\xf1a").min(8).max(32).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/,"La contrase\xf1a debe contener al menos un caracter en minuscula, uno en mayuscula, un n\xfamero y uno de los siguientes caracter especial: !@#$%^&*").required(),newPasswordRepeat:te.j().label("repita la nueva contrase\xf1a").oneOf([te.h("newPassword")],"Las contrase\xf1as no coinciden")})}),[]),s=Object(f.h)({mode:"onBlur",resolver:Object(ne.a)(c),defaultValues:{newPassword:"",newPasswordRepeat:""}}),o=s.formState,l=s.handleSubmit,u=s.register,b=Object(v.a)((function(e){return N(parseInt(n),{newPassword:e.newPassword})}),{onSuccess:function(e){e.data;a.replace("/iam/usuarios")}}),O=o.errors;return console.log(O),Object(Y.jsxs)(j.a,{onSubmit:l((function(e){console.log(e),b.mutate(e)})),children:[Object(Y.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Cambiar contrase\xf1a"}),Object(Y.jsxs)(j.a.Group,{children:[Object(Y.jsx)(j.a.Label,{children:"Nueva contrase\xf1a"}),Object(Y.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!O.newPassword},u("newPassword"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(e=O.newPassword)||void 0===e?void 0:e.message})]}),Object(Y.jsxs)(j.a.Group,{children:[Object(Y.jsx)(j.a.Label,{children:"Repita la nueva contrase\xf1a"}),Object(Y.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!O.newPasswordRepeat},u("newPasswordRepeat"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(r=O.newPasswordRepeat)||void 0===r?void 0:r.message})]}),Object(Y.jsxs)(h.a,{type:"submit",children:[b.isLoading?Object(Y.jsx)(x.a,{animation:"border",size:"sm"}):null,"Guardar"]})]})},se=n(424),oe=n(441),le=n(60),de=n(73),ue=n(130),je=n(74),be={index:function(e){return e.canAny([ae.a.VER_USUARIOS,ae.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO,ae.a.REGISTRAR_USUARIOS,ae.a.REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},register:function(e){return e.canAny([ae.a.REGISTRAR_USUARIOS,ae.a.REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},edit:function(e){return e.canAny([ae.a.EDITAR_USUARIOS,ae.a.EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},view:function(e){return e.canAny([ae.a.VER_USUARIOS,ae.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},changePassword:function(e){return e.canAny([ae.a.CAMBIAR_CONTRASE\u00d1A,ae.a.CAMBIAR_CONTRASE\u00d1A_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},disable:function(e){return e.canAny([ae.a.BLOQUEAR_USUARIOS,ae.a.BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},enable:function(e){return e.canAny([ae.a.DESBLOQUEAR_USUARIOS,ae.a.DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])}},Oe=function(e){var r=e.user,n=Object(je.b)("queryLoader"),a=Object(ue.b)(),i=Object(v.a)((function(){return r.estado?C(r.id):w(r.id)}),{onSuccess:function(){n.close(),a.setQueryData("usuarios.buscar",(function(e){return Object(d.a)(Object(d.a)({},e),{},{data:Object(d.a)(Object(d.a)({},e.data),{},{records:e.data.records.map((function(e){return e==r?Object(d.a)(Object(d.a)({},e),{},{estado:!r.estado}):Object(d.a)({},e)}))})})}))}});return Object(t.useEffect)((function(){"loading"==i.status?n.open({state:"loading"}):"error"==i.status&&n.open({state:"error",error:i.error})}),[i.status]),Object(Y.jsxs)(de.a,{children:[Object(Y.jsx)(de.a.Toggle,{as:E.j,variant:"link",id:"dropdown-users-".concat(r.id)}),Object(Y.jsxs)(de.a.Menu,{children:[Object(Y.jsx)(o.b,{authorize:be.view,children:Object(Y.jsx)(de.a.Item,{as:le.b,to:{pathname:"/iam/usuarios/".concat(r.id),state:{user:r}},children:"Ver"})}),Object(Y.jsx)(o.b,{authorize:be.edit,children:Object(Y.jsx)(de.a.Item,{as:le.b,to:{pathname:"/iam/usuarios/".concat(r.id,"/editar"),state:{user:r}},children:"Editar"})}),Object(Y.jsx)(o.b,{authorize:be.changePassword,children:Object(Y.jsx)(de.a.Item,{as:le.b,to:{pathname:"/iam/usuarios/".concat(r.id,"/cambiar-contrasena"),state:{user:r}},children:"Cambiar contrase\xf1a"})}),Object(Y.jsx)(o.b,{authorize:function(e){return r.estado?be.disable(e):be.enable(e)},children:Object(Y.jsx)(de.a.Item,{className:"text-danger",onClick:function(){i.mutate()},children:r.estado?"Bloquear":"Desbloquear"})})]})]})},me=function(){var e,r,n,a=Object(l.a)(),i=Object(t.useState)({current:1,size:10}),s=Object(u.a)(i,2),b=s[0],O=s[1],f=Object(t.useState)({}),v=Object(u.a)(f,2),R=v[0],g=(v[1],Object(t.useState)(!1)),I=Object(u.a)(g,2),_=(I[0],I[1],Object(p.a)("usuarios.buscar",(function(){return a.can(ae.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO,!1)&&(R.regionalId=a.regionalId),A(R,b)}),{enabled:be.view(a),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1})),S=(null===(e=_.data)||void 0===e||null===(r=e.data)||void 0===r||null===(n=r.meta)||void 0===n?void 0:n.total)||0,N=Object(t.useRef)(!1);Object(t.useEffect)((function(){N.current?be.view(a)&&_.refetch():N.current=!0}),[b,R,a]);return Object(Y.jsxs)("div",{className:"px-1",children:[Object(Y.jsx)("h2",{style:{fontSize:"1.75rem"},children:"Usuarios"}),Object(Y.jsx)("div",{className:"d-flex my-2",children:Object(Y.jsxs)(j.a.Row,{className:"ml-auto flex-nowrap",children:[Object(Y.jsx)(o.b,{authorize:be.view,children:Object(Y.jsx)(m.a,{xs:"auto",children:Object(Y.jsx)(h.a,{onClick:function(){_.refetch()},children:Object(Y.jsx)(c.k,{})})})}),Object(Y.jsx)(o.b,{authorize:be.register,children:Object(Y.jsx)(m.a,{xs:"auto",children:Object(Y.jsxs)(h.a,{as:le.b,to:"/iam/usuarios/registrar",className:"d-flex align-items-center",children:[Object(Y.jsx)(c.p,{className:"mr-2"}),"Nuevo"]})})})]})}),Object(Y.jsxs)(o.b,{authorize:be.view,children:[Object(Y.jsxs)(se.a,{children:[Object(Y.jsx)(m.a,{className:"mb-2"}),Object(Y.jsx)(m.a,{className:"mb-2",xs:"auto",children:Object(Y.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(Y.jsx)("span",{children:"Mostrar"}),Object(Y.jsxs)(j.a.Control,{className:"mx-2",as:"select",value:b.size,onChange:function(e){var r=e.target.value;O((function(e){return{current:1,size:parseInt(r)}}))},children:[Object(Y.jsx)("option",{value:10,children:"10"}),Object(Y.jsx)("option",{value:20,children:"20"}),Object(Y.jsx)("option",{value:30,children:"30"}),Object(Y.jsx)("option",{value:50,children:"50"}),Object(Y.jsx)("option",{value:100,children:"100"})]}),Object(Y.jsx)("span",{children:"filas"})]})})]}),Object(Y.jsxs)(oe.a,{responsive:!0,children:[Object(Y.jsx)("thead",{children:Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{style:{width:1},children:"#"}),Object(Y.jsx)("th",{children:"Propietario"}),Object(Y.jsx)("th",{children:"Usuario"}),Object(Y.jsx)("th",{children:"Estado"}),Object(Y.jsx)("th",{style:{width:1}})]})}),Object(Y.jsx)("tbody",{children:function(){if(_.isFetching)return Object(Y.jsx)("tr",{children:Object(Y.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(Y.jsx)(x.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(_.isError){var e,r,n=_.error;return Object(Y.jsx)("tr",{children:Object(Y.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||n.message})})}if(_.data){var t=_.data.data.records;return 0==t.length?Object(Y.jsx)("tr",{children:Object(Y.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):t.map((function(e,r){return Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("td",{children:r+1}),Object(Y.jsxs)("td",{children:[e.ci," - ",e.nombreCompleto]}),Object(Y.jsx)("td",{children:e.username}),Object(Y.jsx)("td",{children:e.estado?"Activo":"Bloqueado"}),Object(Y.jsx)("td",{children:Object(Y.jsx)(Oe,{user:e})})]},e.id)}))}}()})]}),Object(Y.jsxs)(se.a,{children:[Object(Y.jsx)(m.a,{children:Object(Y.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(S," resultados")})}),Object(Y.jsx)(m.a,{children:Object(Y.jsx)(E.f,{current:b.current,total:Math.ceil((S-b.size)/b.size)+1,onChange:function(e){return O((function(r){return Object(d.a)(Object(d.a)({},r),{},{current:e})}))}})})]})]})]})},he=function(){var e,r=Object(i.h)().state,n=Object(i.i)().id,t=Object(p.a)(["cargarUsuario",n],(function(){return I(parseInt(n))}),{enabled:!(null===r||void 0===r?void 0:r.user),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),a=(null===r||void 0===r?void 0:r.user)||(null===(e=t.data)||void 0===e?void 0:e.data);return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)("h2",{style:{fontSize:"1.75rem"},children:null===a||void 0===a?void 0:a.username}),Object(Y.jsx)(oe.a,{children:Object(Y.jsxs)("tbody",{children:[Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Carnet de identidad"}),Object(Y.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.ci]})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Nombre completo"}),Object(Y.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.nombreCompleto]})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{className:"text-nowrap",scope:"row",style:{width:"1px"},children:"Nombre de usuario"}),Object(Y.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.username]})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Estado"}),Object(Y.jsxs)("td",{children:[": ",(null===a||void 0===a?void 0:a.estado)?"Activo":!1===(null===a||void 0===a?void 0:a.estado)?"Bloqueado":""]})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Creado el"}),Object(Y.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.createdAt]})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Actualizado el"}),Object(Y.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.updatedAt]})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Roles"}),Object(Y.jsxs)("td",{className:"text-capitalize",children:[": ",null===a||void 0===a?void 0:a.roleNames]})]})]})}),a?Object(Y.jsxs)(j.a.Row,{children:[Object(Y.jsx)(m.a,{xs:"auto",children:Object(Y.jsx)(h.a,{as:le.b,to:{pathname:"/iam/usuarios/".concat(a.id,"/editar"),state:{user:a}},children:"Editar"})}),Object(Y.jsx)(m.a,{xs:"auto",children:Object(Y.jsx)(h.a,{variant:"danger",children:"Bloquear"})})]}):null]})},xe=n(408),fe=function(){return R.apiClient.get("/permisos")},pe=function(e){var r,n=e.isInvalid,t=e.selected,a=void 0===t?[]:t,i=e.onChange,c=Object(p.a)("permisos.buscar",(function(){return fe()}),{refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1}),s=(null===(r=c.data)||void 0===r?void 0:r.data)||[];return Object(Y.jsx)("div",{className:n?"is-invalid":"",children:c.isFetching?Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(x.a,{animation:"border",size:"sm"}),Object(Y.jsx)("span",{children:"Cargando"})]}):c.isError?Object(Y.jsxs)(T.a,{variant:"danger",children:["Ocurrio un error al obtener la lista de permisos. Haga clic ",Object(Y.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),c.refetch()},children:"aqui"})," para volver a intentar"]}):Object(Y.jsx)(Z,{as:"ul",className:"overflow-auto flex-grow-1",style:{maxHeight:"12rem"},children:s.map((function(e,r){return Object(Y.jsx)(Z.Item,{as:"li",className:"py-2 px-3 text-capitalize"+(n?" border-danger":""),action:!0,children:Object(Y.jsx)(j.a.Check,{type:"checkbox",isInvalid:n,label:e,checked:a.some((function(r){return r==e})),onChange:function(r){var n=r.target.checked;i&&i(n?[].concat(Object(D.a)(a),[e]):a.filter((function(r){return r!=e})))}})},e)}))})})},ve=function(){var e,r,n,a,c,s=Object(t.useMemo)((function(){return te.g().shape({name:te.j().label("nombre").trim().required().max(50),description:te.j().label("descripcion").trim().nullable().optional().max(250),permissions:te.b().label("permisos").min(1)})}),[]),o=Object(f.h)({mode:"onBlur",resolver:Object(ne.a)(s),defaultValues:{name:"",description:"",permissions:[]}}),l=o.handleSubmit,u=o.register,b=o.control,O=o.formState,R=o.reset,g=o.setError,A=Object(i.i)().id,I=Object(i.g)(),_=Object(t.useRef)(null),S=Object(p.a)(["fetchRole",A],(function(){return L(parseInt(A))}),{enabled:!!A&&!(null===(e=I.location.state)||void 0===e?void 0:e.rol),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),N=Object(v.a)((function(e){return A?P(parseInt(A),{name:e.name,description:e.description,permissions:e.permissions}):y({name:e.name,description:e.description,permissions:e.permissions})}),{onSuccess:function(e){var r=e.data;I.replace("/iam/roles/".concat(r.id),{rol:r,ignoreAuthorization:!0})},onError:function(e){var r,n;422!==(null===(r=e.response)||void 0===r?void 0:r.status)&&(null===(n=_.current)||void 0===n||n.show(!0))}}),C=(null===(r=S.data)||void 0===r?void 0:r.data)||(null===(n=I.location.state)||void 0===n?void 0:n.rol),w=O.errors;Object(t.useEffect)((function(){C&&R({name:C.name,description:C.description,permissions:C.permissionNames})}),[C]),Object(t.useEffect)((function(){var e;S.isFetching&&(null===(e=_.current)||void 0===e||e.show(!0))}),[S.isFetching]),Object(t.useEffect)((function(){if(N.error){var e,r=N.error;if(422==(null===(e=r.response)||void 0===e?void 0:e.status)){var n=r.response.data.errors;n.name&&g("name",{message:n.name}),n.description&&g("description",{message:n.description}),n.permissions&&g("permissions",{message:n.permissions})}}}),[N.error]),console.log("Guardar State",w);return Object(Y.jsx)(Y.Fragment,{children:Object(Y.jsxs)(j.a,{noValidate:!0,validated:O.isValid,onSubmit:l((function(e){N.mutate(e)})),children:[Object(Y.jsx)("h1",{style:{fontSize:"2rem"},children:"Roles"}),Object(Y.jsxs)(E.b,{ref:_,children:[Object(Y.jsx)(xe.a.Header,{children:S.isFetching?"Cargando":S.isError||N.isError?"Error":null}),Object(Y.jsx)(xe.a.Body,{children:function(){return S.isFetching?Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(x.a,{animation:"border",size:"sm"}),Object(Y.jsx)("span",{className:"ml-2",children:"Espere un momento"})]}):S.isError||N.isError?Object(Y.jsx)(T.a,{variant:"danger",children:404==(null===(e=S.error)||void 0===e||null===(r=e.response)||void 0===r?void 0:r.status)?"El rol no existe":"Ocurrio un error mientras se cargaban los datos del rol"}):null;var e,r}()})]}),Object(Y.jsxs)(j.a.Group,{children:[Object(Y.jsx)(j.a.Label,{children:"Nombre"}),Object(Y.jsx)(j.a.Control,Object(d.a)({isInvalid:!!O.errors.name},u("name"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(a=w.name)||void 0===a?void 0:a.message})]}),Object(Y.jsxs)(j.a.Group,{children:[Object(Y.jsx)(j.a.Label,{children:"Descripcion"}),Object(Y.jsx)(j.a.Control,Object(d.a)({as:"textarea",isInvalid:!!w.description},u("description"))),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(c=w.description)||void 0===c?void 0:c.message})]}),Object(Y.jsxs)(j.a.Group,{children:[Object(Y.jsx)(j.a.Label,{children:"Permisos"}),Object(Y.jsx)(f.a,{name:"permissions",control:b,render:function(e){var r,n=e.field,t=e.fieldState;return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(pe,{isInvalid:!!t.error,onChange:n.onChange,selected:n.value}),Object(Y.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(r=t.error)||void 0===r?void 0:r.message})]})}})]}),Object(Y.jsx)(j.a.Row,{children:Object(Y.jsx)(m.a,{children:Object(Y.jsxs)(h.a,{type:"submit",children:[N.isLoading?Object(Y.jsx)(x.a,{animation:"border",className:"mr-2",size:"sm"}):null,Object(Y.jsx)("span",{className:"align-middle",children:"Registrar"})]})})})]})})},Ee={index:function(e){return e.canAny([ae.a.VER_ROLES,ae.a.REGISTRAR_ROLES])},register:function(e){return e.canAny([ae.a.REGISTRAR_ROLES])},edit:function(e){return e.canAny([ae.a.EDITAR_ROLES])},view:function(e){return e.canAny([ae.a.VER_ROLES])},delete:function(e){return e.canAny([ae.a.ELIMINAR_ROLES])}},Re=function(){var e=Object(l.a)(),r=Object(t.useState)(0),n=Object(u.a)(r,2),a=n[0],i=n[1],s=Object(t.useState)({current:1,size:10}),b=Object(u.a)(s,2),O=b[0],f=b[1],R=Object(t.useState)({}),g=Object(u.a)(R,2),A=g[0],I=(g[1],Object(t.useState)(!1)),_=Object(u.a)(I,2),S=(_[0],_[1],Object(t.useRef)(null)),N=Object(p.a)(["roles.buscar",O,A],(function(){return U(A,O)}),{enabled:Ee.view(e),refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1,onSuccess:function(e){var r=e.data.meta;i(r.total)}}),C=Object(v.a)((function(e){return M(e)}),{onSuccess:function(){var e;N.refetch(),null===(e=S.current)||void 0===e||e.show(!1)}});return Object(Y.jsxs)("div",{className:"px-1",children:[Object(Y.jsx)("h2",{style:{fontSize:"1.75rem"},children:"Roles"}),Object(Y.jsxs)(E.b,{ref:S,children:[Object(Y.jsx)(xe.a.Header,{children:C.isLoading?"Eliminando":C.isError?"Error":null}),Object(Y.jsx)(xe.a.Body,{children:C.isLoading?Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(x.a,{animation:"border",size:"sm"}),Object(Y.jsx)("span",{className:"ml-2",children:"Espere un momento"})]}):C.isError?Object(Y.jsx)(T.a,{variant:"danger",children:"Ocurrio un error mientras se eliminaba el rol"}):null})]}),Object(Y.jsx)("div",{className:"d-flex my-2",children:Object(Y.jsxs)(se.a,{className:"ml-auto flex-nowrap",children:[Object(Y.jsxs)(o.b,{authorize:Ee.view,children:[Object(Y.jsx)(m.a,{className:"pr-0",xs:"auto",children:Object(Y.jsx)(h.a,{onClick:function(){N.refetch()},children:Object(Y.jsx)(c.k,{})})}),Object(Y.jsx)(m.a,{className:"pr-0",xs:"auto",children:Object(Y.jsx)(h.a,{onClick:function(){},children:Object(Y.jsx)(c.f,{})})})]}),Object(Y.jsx)(o.b,{authorize:Ee.register,children:Object(Y.jsx)(m.a,{xs:"auto",children:Object(Y.jsxs)(h.a,{as:le.b,to:"/iam/roles/registrar",className:"d-flex align-items-center",children:[Object(Y.jsx)(c.i,{className:"mr-2"}),"Nuevo"]})})})]})}),Object(Y.jsxs)(o.b,{authorize:Ee.view,children:[Object(Y.jsxs)(se.a,{children:[Object(Y.jsx)(m.a,{className:"mb-2"}),Object(Y.jsx)(m.a,{className:"mb-2",xs:"auto",children:Object(Y.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(Y.jsx)("span",{children:"Mostrar"}),Object(Y.jsxs)(j.a.Control,{className:"mx-2",as:"select",value:O.size,onChange:function(e){var r=e.target.value;f((function(e){return{current:1,size:parseInt(r)}}))},children:[Object(Y.jsx)("option",{value:10,children:"10"}),Object(Y.jsx)("option",{value:20,children:"20"}),Object(Y.jsx)("option",{value:30,children:"30"}),Object(Y.jsx)("option",{value:50,children:"50"}),Object(Y.jsx)("option",{value:100,children:"100"})]}),Object(Y.jsx)("span",{children:"filas"})]})})]}),Object(Y.jsxs)(oe.a,{responsive:!0,children:[Object(Y.jsx)("thead",{children:Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{style:{width:1},children:"#"}),Object(Y.jsx)("th",{children:"Nombre"}),Object(Y.jsx)("th",{children:"Descripcion"}),Object(Y.jsx)("th",{style:{width:1}})]})}),Object(Y.jsx)("tbody",{children:function(){if(N.isFetching)return Object(Y.jsx)("tr",{children:Object(Y.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(Y.jsx)(x.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(N.isError){var e,r,n=N.error;return Object(Y.jsx)("tr",{children:Object(Y.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||n.message})})}if(N.data){var t=N.data.data.records;return 0==t.length?Object(Y.jsx)("tr",{children:Object(Y.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):t.map((function(e,r){return Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("td",{children:r+1}),Object(Y.jsx)("td",{className:"text-capitalize",children:e.name}),Object(Y.jsx)("td",{children:e.description}),Object(Y.jsx)("td",{children:Object(Y.jsxs)(de.a,{children:[Object(Y.jsx)(de.a.Toggle,{as:E.j,variant:"link",id:"dropdown-users-".concat(e.id)}),Object(Y.jsxs)(de.a.Menu,{children:[Object(Y.jsx)(o.b,{authorize:Ee.view,children:Object(Y.jsx)(de.a.Item,{as:le.b,to:{pathname:"/iam/roles/".concat(e.id),state:{rol:e}},children:"Ver"})}),Object(Y.jsx)(o.b,{authorize:Ee.edit,children:Object(Y.jsx)(de.a.Item,{as:le.b,to:{pathname:"/iam/roles/".concat(e.id,"/editar"),state:{rol:e}},children:"Editar"})}),Object(Y.jsx)(o.b,{authorize:Ee.delete,children:Object(Y.jsx)(de.a.Item,{className:"text-danger",onClick:function(){var r;window.confirm("Esta accion es irreversible, \xbfEsta seguro de continuar?")&&(C.mutate(e.id),null===(r=S.current)||void 0===r||r.show(!0))},children:"Eliminar"})})]})]})})]},e.id)}))}}()})]}),Object(Y.jsxs)("div",{className:"row",children:[Object(Y.jsx)(m.a,{children:Object(Y.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(a," resultados")})}),Object(Y.jsx)(m.a,{children:Object(Y.jsx)(E.f,{current:O.current,total:Math.ceil((a-O.size)/O.size)+1,onChange:function(e){return f((function(r){return Object(d.a)(Object(d.a)({},r),{},{current:e})}))}})})]})]})]})},ge=function(){var e,r=Object(i.h)(),n=(r.pathname,r.state),a=Object(i.i)().id,c=Object(t.useRef)(null),s=Object(p.a)(["cargar",a],(function(){return L(parseInt(a))}),{enabled:!(null===n||void 0===n?void 0:n.rol),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,onSuccess:function(){var e;null===(e=c.current)||void 0===e||e.show(!1)}}),o=Object(v.a)((function(){return M(parseInt(a))}),{onSuccess:function(){var e;null===(e=c.current)||void 0===e||e.show(!1)}}),l=(null===(e=s.data)||void 0===e?void 0:e.data)||(null===n||void 0===n?void 0:n.rol);Object(t.useEffect)((function(){var e;s.isFetching&&(null===(e=c.current)||void 0===e||e.show(!0))}),[s.isFetching]);return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)("h2",{style:{fontSize:"1.75rem"},children:null===l||void 0===l?void 0:l.name}),Object(Y.jsxs)(E.b,{ref:c,children:[Object(Y.jsx)(xe.a.Header,{children:o.isLoading?"Eliminando":s.isFetching?"Cargando":o.isError||s.isError?"Error":null}),Object(Y.jsx)(xe.a.Body,{children:function(){return o.isLoading||s.isFetching?Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)(x.a,{animation:"border",size:"sm"}),Object(Y.jsx)("span",{className:"ml-2",children:"Espere un momento"})]}):o.isError?Object(Y.jsx)(T.a,{variant:"danger",children:"Ocurrio un error mientras se eliminaba el rol"}):s.isError?Object(Y.jsx)(T.a,{variant:"danger",children:404==(null===(e=s.error.response)||void 0===e?void 0:e.status)?"El rol no existe":"Ocurrio un error mientras se cargaban los datos del rol"}):null;var e}()})]}),Object(Y.jsx)(oe.a,{children:Object(Y.jsxs)("tbody",{children:[Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",style:{width:"1px"},children:"Nombre"}),Object(Y.jsx)("td",{className:"text-capitalize",children:null===l||void 0===l?void 0:l.name})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{className:"text-nowrap",scope:"row",children:"Descripci\xf3n"}),Object(Y.jsx)("td",{className:(null===l||void 0===l?void 0:l.description)?"":"bg-light",children:(null===l||void 0===l?void 0:l.description)||"Sin descripci\xf3n"})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Fecha de creaci\xf3n"}),Object(Y.jsx)("td",{children:null===l||void 0===l?void 0:l.createdAt})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Fecha de actualizaci\xf3n"}),Object(Y.jsx)("td",{children:null===l||void 0===l?void 0:l.updatedAt})]}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{scope:"row",children:"Permisos"}),Object(Y.jsx)("td",{className:"d-flex ".concat((null===l||void 0===l?void 0:l.permissionNames.length)?"":"bg-light"),children:(null===l||void 0===l?void 0:l.permissionNames.length)?Object(Y.jsx)("ul",{className:"d-inline-block",children:null===l||void 0===l?void 0:l.permissionNames.map((function(e,r){return Object(Y.jsx)("li",{className:"text-capitalize",children:e},r)}))}):"No se agregaron permisos"})]})]})}),l?Object(Y.jsxs)(j.a.Row,{children:[Object(Y.jsx)(m.a,{xs:"auto",children:Object(Y.jsx)(h.a,{as:le.b,to:{pathname:"/iam/roles/".concat(l.id,"/editar"),state:{rol:l}},children:"Editar"})}),Object(Y.jsx)(m.a,{xs:"auto",children:Object(Y.jsxs)(h.a,{variant:"danger",onClick:function(){var e;null===(e=c.current)||void 0===e||e.show(!0),o.mutate()},children:[o.isLoading?Object(Y.jsx)(x.a,{className:"mr-2",animation:"border",size:"sm"}):null,"Eliminar"]})})]}):null]})},Ae=function(){var e=Object(i.j)().url,r=Object(l.a)(),n=Object(t.useMemo)((function(){var n=[];return be.index(r)&&n.push({id:"users",icon:Object(Y.jsx)(c.q,{}),path:"".concat(e,"/usuarios"),title:"Usuarios"}),Ee.index(r)&&n.push({id:"roles",icon:Object(Y.jsx)(c.l,{}),path:"".concat(e,"/roles"),title:"Roles"}),n}),[r]);return Object(Y.jsx)(s.a,{sidebar:{items:n},children:Object(Y.jsxs)(i.d,{children:[Object(Y.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios"),authorize:be.index,children:Object(Y.jsx)(me,{})}),Object(Y.jsx)(o.c,{exact:!0,path:["".concat(e,"/usuarios/registrar"),"".concat(e,"/usuarios/:id/editar")],authorize:function(r,n){return n=="".concat(e,"/usuarios/registrar")?be.register(r):be.edit(r)},children:Object(Y.jsx)(ie,{})}),Object(Y.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios/:id/cambiar-contrasena"),authorize:be.changePassword,children:Object(Y.jsx)(ce,{})}),Object(Y.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios/:id"),authorize:be.view,children:Object(Y.jsx)(he,{})}),Object(Y.jsx)(o.c,{exact:!0,path:"".concat(e,"/roles"),authorize:Ee.index,children:Object(Y.jsx)(Re,{})}),Object(Y.jsx)(o.c,{exact:!0,path:["".concat(e,"/roles/registrar"),"".concat(e,"/roles/:id/editar")],authorize:function(r,n){return n=="".concat(e,"/roles/registrar")?Ee.register(r):Ee.edit(r)},children:Object(Y.jsx)(ve,{})}),Object(Y.jsx)(o.c,{exact:!0,path:"".concat(e,"/roles/:id"),authorize:Ee.view,children:Object(Y.jsx)(ge,{})})]})})};r.default=Ae}}]);
//# sourceMappingURL=3.9900e281.chunk.js.map