(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[4],{626:function(e,r,n){"use strict";n.d(r,"a",(function(){return t}));var t={};n.r(t),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return a})),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return i})),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return c})),n.d(t,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return s})),n.d(t,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return o})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return l})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return d})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return u})),n.d(t,"VER_USUARIOS",(function(){return j})),n.d(t,"VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return b})),n.d(t,"REGISTRAR_USUARIOS",(function(){return O})),n.d(t,"REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return m})),n.d(t,"EDITAR_USUARIOS",(function(){return h})),n.d(t,"EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return x})),n.d(t,"BLOQUEAR_USUARIOS",(function(){return p})),n.d(t,"BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return f})),n.d(t,"DESBLOQUEAR_USUARIOS",(function(){return v})),n.d(t,"DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return E})),n.d(t,"CAMBIAR_CONTRASE\xd1A",(function(){return R})),n.d(t,"CAMBIAR_CONTRASE\xd1A_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return g})),n.d(t,"VER_ROLES",(function(){return A})),n.d(t,"REGISTRAR_ROLES",(function(){return _})),n.d(t,"EDITAR_ROLES",(function(){return I})),n.d(t,"ELIMINAR_ROLES",(function(){return S})),n.d(t,"VER_LISTA_DE_MORA",(function(){return N})),n.d(t,"VER_LISTA_DE_MORA_REGIONAL",(function(){return C})),n.d(t,"AGREGAR_EMPLEADOR_EN_MORA",(function(){return U})),n.d(t,"AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return L})),n.d(t,"QUITAR_EMPLEADOR_EN_MORA",(function(){return w})),n.d(t,"QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return D})),n.d(t,"VER_MEDICOS",(function(){return y})),n.d(t,"VER_MEDICOS_REGIONAL",(function(){return T})),n.d(t,"REGISTRAR_MEDICOS",(function(){return M})),n.d(t,"REGISTRAR_MEDICOS_REGIONAL",(function(){return P})),n.d(t,"EDITAR_MEDICOS",(function(){return G})),n.d(t,"EDITAR_MEDICOS_REGIONAL",(function(){return V})),n.d(t,"BAJA_MEDICOS",(function(){return z})),n.d(t,"BAJA_MEDICOS_REGIONAL",(function(){return F})),n.d(t,"VER_PROVEEDORES",(function(){return k})),n.d(t,"VER_PROVEEDORES_REGIONAL",(function(){return B})),n.d(t,"REGISTRAR_PROVEEDORES",(function(){return Q})),n.d(t,"REGISTRAR_PROVEEDORES_REGIONAL",(function(){return q})),n.d(t,"EDITAR_PROVEEDORES",(function(){return K})),n.d(t,"EDITAR_PROVEEDORES_REGIONAL",(function(){return H})),n.d(t,"BAJA_PROVEEDOR",(function(){return X})),n.d(t,"BAJA_PROVEEDOR_REGIONAL",(function(){return W})),n.d(t,"VER_CONTRATOS_PROVEEDOR",(function(){return J})),n.d(t,"VER_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return $})),n.d(t,"REGISTRAR_CONTRATOS_PROVEEDOR",(function(){return Z})),n.d(t,"REGISTRAR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return Y})),n.d(t,"CONSUMIR_CONTRATOS_PROVEEDOR",(function(){return ee})),n.d(t,"CONSUMIR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return re})),n.d(t,"EXTENDER_CONTRATOS_PROVEEDOR",(function(){return ne})),n.d(t,"EXTENDER_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return te})),n.d(t,"ANULAR_CONTRATOS_PROVEEDOR",(function(){return ae})),n.d(t,"ANULAR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return ie})),n.d(t,"VER_ESPECIALIDADES",(function(){return ce})),n.d(t,"REGISTRAR_ESPECIALIDADES",(function(){return se})),n.d(t,"EDITAR_ESPECIALIDADES",(function(){return oe})),n.d(t,"ELIMINAR_ESPECIALIDADES",(function(){return le})),n.d(t,"IMPORTAR_ESPECIALIDADES",(function(){return de})),n.d(t,"VER_PRESTACIONES",(function(){return ue})),n.d(t,"REGISTRAR_PRESTACIONES",(function(){return je})),n.d(t,"EDITAR_PRESTACIONES",(function(){return be})),n.d(t,"ELIMINAR_PRESTACIONES",(function(){return Oe})),n.d(t,"IMPORTAR_PRESTACIONES",(function(){return me}));var a="Ver solicitudes de atencion externa",i="Ver solicitudes de atencion externa (misma regional)",c="Ver solicitudes de atencion externa (registrado por)",s="Registrar solicitudes de atencion externa",o="Registrar solicitudes de atencion externa (misma regional)",l="Emitir solicitudes de atencion externa",d="Emitir solicitudes de atencion externa (misma regional)",u="Emitir solicitudes de atencion externa (registrado por)",j="Ver usuarios",b="Ver usuarios (misma regional)",O="Registrar usuarios",m="Registrar usuarios (misma regional)",h="Editar usuarios",x="Editar usuarios (misma regional)",p="Bloquear usuarios",f="Bloquear usuarios (misma regional)",v="Desbloquear usuarios",E="Desbloquear usuarios (misma regional)",R="Cambiar contrase\xf1a",g="Cambiar contrase\xf1a (misma regional)",A="Ver roles",_="Registrar roles",I="Editar roles",S="Eliminar roles",N="Ver lista de mora",C="Ver lista de mora (regional)",U="Agregar empleador en mora",L="Agregar empleador en mora (misma regional)",w="Quitar empleador en mora",D="Quitar empleador en mora (misma regional)",y="Ver m\xe9dicos",T="Ver m\xe9dicos (regional)",M="Registrar m\xe9dicos",P="Registrar m\xe9dicos (regional)",G="Editar m\xe9dicos",V="Editar m\xe9dicos (regional)",z="Baja m\xe9dicos",F="Baja m\xe9dicos (regional)",k="Ver proveedores",B="Ver proveedores (regional)",Q="Registrar proveedores",q="Registrar proveedores (regional)",K="Editar proveedores",H="Editar proveedores (regional)",X="Baja proveedores",W="Baja proveedores (regional)",J="Ver contratos de proveedores",$="Ver contratos de proveedores",Z="Registrar contratos de proveedores",Y="Registrar contratos de proveedores (regional)",ee="Consumir contratos de proveedores",re="Consumir contratos de proveedores (regional)",ne="Extender contratos de proveedores",te="Extender contratos de proveedores (regional)",ae="Anular contratos de proveedores",ie="Anular contratos de proveedores (regional)",ce="Ver especialidades",se="Registrar especialidades",oe="Editar especialidades",le="Eliminar especialidades",de="Importar especialidades",ue="Ver prestaciones",je="Registrar prestaciones",be="Editar prestaciones",Oe="Eliminar prestaciones",me="Importar prestaciones"},627:function(e,r,n){"use strict";var t=n(16),a=(n(1),n(633)),i=n(45),c=n(237),s=(n(628),n(3));r.a=function(e){var r=e.sidebar,n=e.children,o=Object(i.c)((function(e){return e.main.showSidebar}));return Object(s.jsxs)("div",{className:"position-relative d-flex flex-grow-1 bg-light"+(o?"":" toggled"),id:"wrapper",children:[Object(s.jsx)(c.a,Object(t.a)({className:"bg-white shadow-sm"},r)),Object(s.jsx)(a.a,{className:"d-flex flex-column flex-grow-1",children:Object(s.jsx)("div",{className:"d-flex flex-column bg-white rounded-lg shadow-sm m-2 p-3 flex-grow-1",children:n})})]})}},628:function(e,r,n){},633:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(6),c=n.n(i),s=n(1),o=n.n(s),l=n(8),d=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.fluid,s=e.as,d=void 0===s?"div":s,u=e.className,j=Object(a.a)(e,["bsPrefix","fluid","as","className"]),b=Object(l.a)(n,"container"),O="string"===typeof i?"-"+i:"-fluid";return o.a.createElement(d,Object(t.a)({ref:r},j,{className:c()(u,i?""+b+O:b)}))}));d.displayName="Container",d.defaultProps={fluid:!1},r.a=d},634:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(6),c=n.n(i),s=n(1),o=n.n(s),l=n(8),d=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,s=e.striped,d=e.bordered,u=e.borderless,j=e.hover,b=e.size,O=e.variant,m=e.responsive,h=Object(a.a)(e,["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"]),x=Object(l.a)(n,"table"),p=c()(i,x,O&&x+"-"+O,b&&x+"-"+b,s&&x+"-striped",d&&x+"-bordered",u&&x+"-borderless",j&&x+"-hover"),f=o.a.createElement("table",Object(t.a)({},h,{className:p,ref:r}));if(m){var v=x+"-responsive";return"string"===typeof m&&(v=v+"-"+m),o.a.createElement("div",{className:v},f)}return f}));r.a=d},638:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(6),c=n.n(i),s=n(1),o=n.n(s),l=n(48),d=n(8),u=n(35),j=o.a.createContext(null);j.displayName="AccordionContext";var b=j;var O=o.a.forwardRef((function(e,r){var n=e.as,i=void 0===n?"button":n,c=e.children,l=e.eventKey,d=e.onClick,j=Object(a.a)(e,["as","children","eventKey","onClick"]),O=function(e,r){var n=Object(s.useContext)(b),t=Object(s.useContext)(u.a);return function(a){t&&t(e===n?null:e,a),r&&r(a)}}(l,d);return"button"===i&&(j.type="button"),o.a.createElement(i,Object(t.a)({ref:r,onClick:O},j),c)})),m=n(244),h=o.a.forwardRef((function(e,r){var n=e.children,i=e.eventKey,c=Object(a.a)(e,["children","eventKey"]),l=Object(s.useContext)(b);return o.a.createElement(u.a.Provider,{value:null},o.a.createElement(m.a,Object(t.a)({ref:r,in:l===i},c),o.a.createElement("div",null,o.a.Children.only(n))))}));h.displayName="AccordionCollapse";var x=h,p=o.a.forwardRef((function(e,r){var n=Object(l.a)(e,{activeKey:"onSelect"}),i=n.as,s=void 0===i?"div":i,j=n.activeKey,O=n.bsPrefix,m=n.children,h=n.className,x=n.onSelect,p=Object(a.a)(n,["as","activeKey","bsPrefix","children","className","onSelect"]),f=c()(h,Object(d.a)(O,"accordion"));return o.a.createElement(b.Provider,{value:j||null},o.a.createElement(u.a.Provider,{value:x||null},o.a.createElement(s,Object(t.a)({ref:r},p,{className:f}),m)))}));p.displayName="Accordion",p.Toggle=O,p.Collapse=x;r.a=p},639:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(6),c=n.n(i),s=n(1),o=n.n(s),l=n(8),d=n(30),u=n(156),j=n(245),b=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,s=e.variant,d=e.as,u=void 0===d?"img":d,j=Object(a.a)(e,["bsPrefix","className","variant","as"]),b=Object(l.a)(n,"card-img");return o.a.createElement(u,Object(t.a)({ref:r,className:c()(s?b+"-"+s:b,i)},j))}));b.displayName="CardImg",b.defaultProps={variant:null};var O=b,m=Object(u.a)("h5"),h=Object(u.a)("h6"),x=Object(d.a)("card-body"),p=Object(d.a)("card-title",{Component:m}),f=Object(d.a)("card-subtitle",{Component:h}),v=Object(d.a)("card-link",{Component:"a"}),E=Object(d.a)("card-text",{Component:"p"}),R=Object(d.a)("card-header"),g=Object(d.a)("card-footer"),A=Object(d.a)("card-img-overlay"),_=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,d=e.bg,u=e.text,b=e.border,O=e.body,m=e.children,h=e.as,p=void 0===h?"div":h,f=Object(a.a)(e,["bsPrefix","className","bg","text","border","body","children","as"]),v=Object(l.a)(n,"card"),E=Object(s.useMemo)((function(){return{cardHeaderBsPrefix:v+"-header"}}),[v]);return o.a.createElement(j.a.Provider,{value:E},o.a.createElement(p,Object(t.a)({ref:r},f,{className:c()(i,v,d&&"bg-"+d,u&&"text-"+u,b&&"border-"+b)}),O?o.a.createElement(x,null,m):m))}));_.displayName="Card",_.defaultProps={body:!1},_.Img=O,_.Title=p,_.Subtitle=f,_.Body=x,_.Link=v,_.Text=E,_.Header=R,_.Footer=g,_.ImgOverlay=A;r.a=_},643:function(e,r,n){"use strict";n.r(r),n.d(r,"IamApp",(function(){return ue}));var t=n(1),a=n.n(t),i=n(23),c=n(34),s=n(627),o=n(140),l=n(141),d=n(16),u=n(28),j=n(618),b=n(638),O=n(639),m=n(334),h=n(229),x=n(607),p=n(94),f=n(179),v=n(622),E=n(624),R=n(235),g=n(60),A=n(42),_=function(e,r){return g.apiClient.get("/usuarios",{params:Object(A.c)({page:r,filter:e})})},I=function(e){return g.apiClient.get("/usuarios/".concat(e))},S=function(e){return g.apiClient.post("/usuarios",Object(A.c)(e))},N=function(e,r){return g.apiClient.put("/usuarios/".concat(e),Object(A.c)(r))},C=function(e,r){return g.apiClient.put("/usuarios/".concat(e,"/cambiar-contrasena"),Object(A.c)(r))},U=function(e){return g.apiClient.put("/usuarios/".concat(e,"/bloquear"))},L=function(e){return g.apiClient.put("/usuarios/".concat(e,"/desbloquear"))},w=function(e,r){return g.apiClient.get("/roles",{params:{filter:e,page:r}})},D=function(e){return g.apiClient.get("/roles/".concat(e))},y=function(e){return g.apiClient.post("roles",e)},T=function(e,r){return g.apiClient.put("roles/".concat(e),r)},M=function(e){return g.apiClient.delete("roles/".concat(e))},P=n(24),G=n(608),V=n(343),z=n(3),F=1,k=a.a.memo((function(e){var r,n=e.isInvalid,t=e.selected,a=void 0===t?[]:t,i=e.onChange,c=Object(v.a)("roles.buscar",(function(){return w()}),{refetchOnReconnect:!1,refetchOnWindowFocus:!1});console.log("Render count",F++);var s=(null===(r=c.data)||void 0===r?void 0:r.data)||[];return Object(z.jsx)("div",{className:n?"is-invalid":"",children:c.isFetching?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(x.a,{animation:"border",size:"sm"}),Object(z.jsx)("span",{children:"Cargando"})]}):c.isError?Object(z.jsxs)(G.a,{variant:"danger",children:["Ocurrio un error al obtener la lista de roles. Haga clic ",Object(z.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),c.refetch()},children:"aqui"})," para volver a intentar"]}):Object(z.jsx)(V.a,{as:"ul",className:"overflow-auto flex-grow-1",style:{maxHeight:"12rem"},children:s.map((function(e,r){return Object(z.jsx)(V.a.Item,{as:"li",className:"py-2 px-3 text-capitalize"+(n?" border-danger":""),action:!0,children:Object(z.jsx)(j.a.Check,{type:"checkbox",isInvalid:n,label:e.name,checked:a.some((function(r){return r.id==e.id})),onChange:function(r){var n=r.target.checked;i&&i(n?[].concat(Object(P.a)(a),[e]):a.filter((function(r){return r.id!=e.id})))}})},e.id)}))})})})),B=n(236),Q=n(69),q=n(626),K=function(){var e,r,n,a,c,s,o,g,A,_,C,U,L,w,D,y,T,M,P,G,V,F,K,H,X,W,J,$=Object(l.a)(),Z=Object(i.i)().id,Y=Object(t.useMemo)((function(){return Q.g().shape({informacionPersonal:Q.g().shape({ci:Q.f().label("carnet de identidad"),ciComplemento:Q.d((function(e){return e?Q.j().label("'complemento'").trim().length(2):Q.j().nullable().optional()})),apellidoPaterno:Q.j().label("apellido paterno").trim().when("apellidoMaterno",{is:function(e){return!e},then:Q.j().required("Debe proporcionar al menos un apellido")}),apellidoMaterno:Q.j().label("apellido materno").trim().when("apellidoPaterno",{is:function(e){return!e},then:Q.j().required("Debe proporcionar al menos un apellido")}),nombres:Q.j().label("nombres").trim().required().label("'Nombres'")},[["apellidoMaterno","apellidoPaterno"]]),informacionUsuario:Q.g().shape(Z?{roles:Q.b().label("roles").min(1,"Debe seleccionar al menos un rol")}:{username:Q.j().label("usuario").required().matches(/[a-zA-Z0-9]{4,}/).min(4).max(16),password:Q.j().label("contrase\xf1a").min(8).max(256).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\/()=?\*])(?=.{8,})/,"La contrase\xf1a debe contener al menos un caracter en minuscula, uno en mayuscula, un n\xfamero y uno de los siguientes caracter especial: !@#$%^&*").required(),passwordRepeat:Q.j().label("confirmar contrase\xf1a").test("password-match","Las contrase\xf1as no coinciden",(function(e){return e===this.parent.password})),regional:Q.b().length(1),roles:Q.b().label("roles").min(1,"Debe seleccionar al menos un rol")})})}),[]),ee=Object(p.h)({resolver:Object(B.a)(Y),mode:"onBlur",defaultValues:{informacionUsuario:{roles:[],regional:[]}}}),re=ee.control,ne=ee.formState,te=ee.handleSubmit,ae=ee.register,ie=ee.setValue,ce=ee.trigger,se=ee.watch,oe=Object(i.g)(),le=Object(f.b)(),de=["usuarios.cargar",Z],ue=Object(v.a)(de,(function(){return I(parseInt(Z))}),{enabled:!!Z&&!(null===(e=oe.location.state)||void 0===e?void 0:e.user)}),je=Object(E.a)((function(e){var r=e.informacionPersonal,n=e.informacionUsuario;return Z?N(parseInt(Z),{regionalId:n.regional[0].id,roles:n.roles.map((function(e){return e.name})),ci:parseInt(r.ci),ciComplemento:r.ciComplemento,apellidoPaterno:r.apellidoPaterno,apellidoMaterno:r.apellidoMaterno,nombres:r.nombres}):S({username:n.username,password:n.password,regionalId:n.regional[0].id,roles:n.roles.map((function(e){return e.name})),ci:parseInt(r.ci),ciComplemento:r.ciComplemento,apellidoPaterno:r.apellidoPaterno,apellidoMaterno:r.apellidoMaterno,nombres:r.nombres})}),{onSuccess:function(e){var r=e.data;le.invalidateQueries("usuarios.buscar"),oe.replace("/iam/usuarios/".concat(r.id),{user:r})}}),be=Object(t.useState)([]),Oe=Object(u.a)(be,2),me=Oe[0],he=Oe[1],xe=Object(t.useCallback)((function(e){return!!$.can(q.a.REGISTRAR_USUARIOS)||e.id==$.regionalId}),[$]),pe=(null===(r=ue.data)||void 0===r?void 0:r.data)||(null===(n=oe.location.state)||void 0===n?void 0:n.user),fe=ne.errors;return Object(t.useEffect)((function(){pe&&me.length&&(ie("informacionPersonal",{ci:String(pe.ciRaiz),ciComplemento:pe.ciComplemento,apellidoPaterno:pe.apellidoPaterno,apellidoMaterno:pe.apellidoMaterno,nombres:pe.nombres}),ie("informacionUsuario",{username:pe.username,roles:pe.roles,regional:[me.find((function(e){return e.id==pe.id}))]}))}),[pe]),Object(z.jsx)(z.Fragment,{children:Object(z.jsxs)(j.a,{onSubmit:te((function(e){je.mutate(e)})),children:[Object(z.jsx)("h1",{style:{fontSize:"2rem"},children:"Usuarios"}),Object(z.jsxs)(b.a,{className:"mb-2",defaultActiveKey:"0",children:[Object(z.jsxs)(O.a,{children:[Object(z.jsx)(b.a.Toggle,{as:O.a.Header,className:["text-light",fe.informacionPersonal?"bg-danger":"bg-primary"].join(" "),eventKey:"0",children:"Informaci\xf3n personal"}),Object(z.jsx)(b.a.Collapse,{eventKey:"0",children:Object(z.jsxs)(O.a.Body,{children:[Object(z.jsxs)(j.a.Row,{children:[Object(z.jsxs)(j.a.Group,{as:m.a,xs:8,md:4,children:[Object(z.jsx)(j.a.Label,{title:"Numero raiz del carnet de identidad",children:"Carnet de identidad"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"number",isInvalid:!!(null===(a=ne.errors.informacionPersonal)||void 0===a?void 0:a.ci)},ae("informacionPersonal.ci"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(c=fe.informacionPersonal)||void 0===c||null===(s=c.ci)||void 0===s?void 0:s.message})]}),Object(z.jsxs)(j.a.Group,{as:m.a,xs:4,md:2,children:[Object(z.jsx)(j.a.Label,{title:"Complemento del carnet de identiad",children:"Complemento"}),Object(z.jsx)(j.a.Control,Object(d.a)({isInvalid:!!(null===(o=fe.informacionPersonal)||void 0===o?void 0:o.ciComplemento)},ae("informacionPersonal.ciComplemento"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(g=fe.informacionPersonal)||void 0===g||null===(A=g.ciComplemento)||void 0===A?void 0:A.message})]})]}),Object(z.jsxs)(j.a.Row,{children:[Object(z.jsxs)(j.a.Group,{as:m.a,lg:4,children:[Object(z.jsx)(j.a.Label,{children:"Apellido Paterno"}),Object(z.jsx)(j.a.Control,Object(d.a)(Object(d.a)({isInvalid:!!(null===(_=fe.informacionPersonal)||void 0===_?void 0:_.apellidoPaterno)},ae("informacionPersonal.apellidoPaterno")),{},{onChange:function(e){ae("informacionPersonal.apellidoPaterno").onChange(e),ne.isSubmitted&&ce("informacionPersonal.apellidoMaterno")}})),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(C=fe.informacionPersonal)||void 0===C||null===(U=C.apellidoPaterno)||void 0===U?void 0:U.message})]}),Object(z.jsxs)(j.a.Group,{as:m.a,lg:4,children:[Object(z.jsx)(j.a.Label,{children:"Apellido Materno"}),Object(z.jsx)(j.a.Control,Object(d.a)(Object(d.a)({isInvalid:!!(null===(L=fe.informacionPersonal)||void 0===L?void 0:L.apellidoMaterno)},ae("informacionPersonal.apellidoMaterno")),{},{onChange:function(e){ae("informacionPersonal.apellidoPaterno").onChange(e),ne.isSubmitted&&ce("informacionPersonal.apellidoMaterno")}})),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(w=fe.informacionPersonal)||void 0===w||null===(D=w.apellidoMaterno)||void 0===D?void 0:D.message})]}),Object(z.jsxs)(j.a.Group,{as:m.a,lg:4,children:[Object(z.jsx)(j.a.Label,{children:"Nombres"}),Object(z.jsx)(j.a.Control,Object(d.a)({isInvalid:!!(null===(y=ne.errors.informacionPersonal)||void 0===y?void 0:y.nombres)},ae("informacionPersonal.nombres"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(T=ne.errors.informacionPersonal)||void 0===T||null===(M=T.nombres)||void 0===M?void 0:M.message})]})]})]})})]}),Object(z.jsxs)(O.a,{children:[Object(z.jsx)(b.a.Toggle,{as:O.a.Header,className:["text-light",fe.informacionUsuario?"bg-danger":"bg-primary"].join(" "),eventKey:"1",children:"Informacion de usuario"}),Object(z.jsx)(b.a.Collapse,{eventKey:"1",children:Object(z.jsxs)(O.a.Body,{children:[Object(z.jsxs)(j.a.Row,{children:[Object(z.jsxs)(j.a.Group,{controlId:"username",as:m.a,md:4,children:[Object(z.jsx)(j.a.Label,{children:"Usuario"}),Object(z.jsx)(j.a.Control,Object(d.a)({disabled:!!Z,isInvalid:!!(null===(P=ne.errors.informacionUsuario)||void 0===P?void 0:P.username)},ae("informacionUsuario.username"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(G=ne.errors.informacionUsuario)||void 0===G||null===(V=G.username)||void 0===V?void 0:V.message})]}),Z?null:Object(z.jsxs)(z.Fragment,{children:[Object(z.jsxs)(j.a.Group,{as:m.a,md:4,children:[Object(z.jsx)(j.a.Label,{children:"Contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!(null===(F=ne.errors.informacionUsuario)||void 0===F?void 0:F.password)},ae("informacionUsuario.password"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(K=ne.errors.informacionUsuario)||void 0===K||null===(H=K.password)||void 0===H?void 0:H.message})]}),Object(z.jsxs)(j.a.Group,{as:m.a,md:4,children:[Object(z.jsx)(j.a.Label,{children:"Confirmar contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!(null===(X=ne.errors.informacionUsuario)||void 0===X?void 0:X.passwordRepeat)},ae("informacionUsuario.passwordRepeat",{required:{value:!0,message:"Este campo es requerido"},validate:{matchPassword:function(e){return e===se("informacionUsuario.password")||"Las contrase\xf1as no coinciden"}}}))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(W=ne.errors.informacionUsuario)||void 0===W||null===(J=W.passwordRepeat)||void 0===J?void 0:J.message})]})]})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Regional"}),Object(z.jsx)(p.a,{name:"informacionUsuario.regional",control:re,render:function(e){var r,n=e.field,t=e.fieldState;return Object(z.jsx)(R.i,{id:"usuario/regionales-typeahead",onLoad:he,isInvalid:!!t.error,feedback:null===(r=t.error)||void 0===r?void 0:r.message,filterBy:xe,selected:n.value,onBlur:n.onBlur,onChange:n.onChange})}})]}),Object(z.jsx)(j.a.Row,{children:Object(z.jsxs)(j.a.Group,{as:m.a,children:[Object(z.jsx)(j.a.Label,{children:"Roles"}),Object(z.jsx)(p.a,{name:"informacionUsuario.roles",control:re,render:function(e){var r,n=e.field,t=e.fieldState;return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(k,{isInvalid:!!t.error,onChange:n.onChange,selected:n.value}),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(r=t.error)||void 0===r?void 0:r.message})]})}})]})})]})})]})]}),Object(z.jsx)(j.a.Row,{children:Object(z.jsx)(m.a,{children:Object(z.jsxs)(h.a,{type:"submit",children:[je.isLoading?Object(z.jsx)(x.a,{animation:"border",className:"mr-2",size:"sm"}):null,Object(z.jsx)("span",{className:"align-middle",children:"Guardar"})]})})})]})})},H=function(){var e,r,n=Object(i.i)().id,a=Object(i.g)(),c=Object(t.useMemo)((function(){return Q.g().shape({password:Q.j().label("nueva contrase\xf1a").min(8).max(32).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/,"La contrase\xf1a debe contener al menos un caracter en minuscula, uno en mayuscula, un n\xfamero y uno de los siguientes caracter especial: !@#$%^&*").required(),passwordRepeat:Q.j().label("repita la nueva contrase\xf1a").oneOf([Q.h("newPassword")],"Las contrase\xf1as no coinciden")})}),[]),s=Object(p.h)({mode:"onBlur",resolver:Object(B.a)(c),defaultValues:{password:"",passwordRepeat:""}}),o=s.formState,l=s.handleSubmit,u=s.register,b=Object(E.a)((function(e){return C(parseInt(n),{password:e.password})}),{onSuccess:function(e){e.data;a.replace("/iam/usuarios")}}),O=o.errors;return console.log(O),Object(z.jsxs)(j.a,{onSubmit:l((function(e){console.log(e),b.mutate(e)})),children:[Object(z.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Cambiar contrase\xf1a"}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Nueva contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!O.password},u("password"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(e=O.password)||void 0===e?void 0:e.message})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Repita la nueva contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!O.passwordRepeat},u("passwordRepeat"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(r=O.passwordRepeat)||void 0===r?void 0:r.message})]}),Object(z.jsxs)(h.a,{type:"submit",children:[b.isLoading?Object(z.jsx)(x.a,{animation:"border",size:"sm"}):null,"Guardar"]})]})},X=n(616),W=n(634),J=n(77),$=n(93),Z=n(95),Y={index:function(e){return e.canAny([q.a.VER_USUARIOS,q.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO,q.a.REGISTRAR_USUARIOS,q.a.REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},register:function(e){return e.canAny([q.a.REGISTRAR_USUARIOS,q.a.REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},edit:function(e){return e.canAny([q.a.EDITAR_USUARIOS,q.a.EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},view:function(e){return e.canAny([q.a.VER_USUARIOS,q.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},changePassword:function(e){return e.canAny([q.a.CAMBIAR_CONTRASE\u00d1A,q.a.CAMBIAR_CONTRASE\u00d1A_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},disable:function(e){return e.canAny([q.a.BLOQUEAR_USUARIOS,q.a.BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},enable:function(e){return e.canAny([q.a.DESBLOQUEAR_USUARIOS,q.a.DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])}},ee=function(e){var r=e.user,n=Object(Z.b)("queryLoader"),a=Object(f.b)(),i=Object(E.a)((function(){return r.estado?U(r.id):L(r.id)}),{onSuccess:function(){n.close(),a.setQueryData("usuarios.buscar",(function(e){return Object(d.a)(Object(d.a)({},e),{},{data:Object(d.a)(Object(d.a)({},e.data),{},{records:e.data.records.map((function(e){return e==r?Object(d.a)(Object(d.a)({},e),{},{estado:!r.estado}):Object(d.a)({},e)}))})})}))}});return Object(t.useEffect)((function(){"loading"==i.status?n.open({state:"loading"}):"error"==i.status&&n.open({state:"error",error:i.error})}),[i.status]),Object(z.jsxs)($.a,{children:[Object(z.jsx)($.a.Toggle,{as:R.j,variant:"link",id:"dropdown-users-".concat(r.id)}),Object(z.jsxs)($.a.Menu,{children:[Object(z.jsx)(o.b,{authorize:Y.view,children:Object(z.jsx)($.a.Item,{as:J.b,to:{pathname:"/iam/usuarios/".concat(r.id),state:{user:r}},children:"Ver"})}),Object(z.jsx)(o.b,{authorize:Y.edit,children:Object(z.jsx)($.a.Item,{as:J.b,to:{pathname:"/iam/usuarios/".concat(r.id,"/editar"),state:{user:r}},children:"Editar"})}),Object(z.jsx)(o.b,{authorize:Y.changePassword,children:Object(z.jsx)($.a.Item,{as:J.b,to:{pathname:"/iam/usuarios/".concat(r.id,"/cambiar-contrasena"),state:{user:r}},children:"Cambiar contrase\xf1a"})}),Object(z.jsx)(o.b,{authorize:function(e){return r.estado?Y.disable(e):Y.enable(e)},children:Object(z.jsx)($.a.Item,{className:"text-danger",onClick:function(){i.mutate()},children:r.estado?"Bloquear":"Desbloquear"})})]})]})},re=function(){var e,r,n,a=Object(l.a)(),i=Object(t.useState)({current:1,size:10}),s=Object(u.a)(i,2),b=s[0],O=s[1],p=Object(t.useState)({}),f=Object(u.a)(p,2),E=f[0],g=(f[1],Object(t.useState)(!1)),A=Object(u.a)(g,2),I=(A[0],A[1],Object(v.a)("usuarios.buscar",(function(){return a.can(q.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO,!1)&&(E.regionalId=a.regionalId),_(E,b)}),{enabled:Y.view(a),refetchOnWindowFocus:!1,refetchOnReconnect:!1})),S=(null===(e=I.data)||void 0===e||null===(r=e.data)||void 0===r||null===(n=r.meta)||void 0===n?void 0:n.total)||0,N=Object(t.useRef)(!1);Object(t.useEffect)((function(){N.current?Y.view(a)&&I.refetch():N.current=!0}),[b,E,a]);return Object(z.jsxs)("div",{className:"px-1",children:[Object(z.jsx)("h2",{style:{fontSize:"1.75rem"},children:"Usuarios"}),Object(z.jsx)("div",{className:"d-flex my-2",children:Object(z.jsxs)(j.a.Row,{className:"ml-auto flex-nowrap",children:[Object(z.jsx)(o.b,{authorize:Y.view,children:Object(z.jsx)(m.a,{xs:"auto",children:Object(z.jsx)(h.a,{onClick:function(){I.refetch()},children:Object(z.jsx)(c.j,{})})})}),Object(z.jsx)(o.b,{authorize:Y.register,children:Object(z.jsx)(m.a,{xs:"auto",children:Object(z.jsxs)(h.a,{as:J.b,to:"/iam/usuarios/registrar",className:"d-flex align-items-center",children:[Object(z.jsx)(c.o,{className:"mr-2"}),"Nuevo"]})})})]})}),Object(z.jsxs)(o.b,{authorize:Y.view,children:[Object(z.jsxs)(X.a,{children:[Object(z.jsx)(m.a,{className:"mb-2"}),Object(z.jsx)(m.a,{className:"mb-2",xs:"auto",children:Object(z.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(z.jsx)("span",{children:"Mostrar"}),Object(z.jsxs)(j.a.Control,{className:"mx-2",as:"select",value:b.size,onChange:function(e){var r=e.target.value;O((function(e){return{current:1,size:parseInt(r)}}))},children:[Object(z.jsx)("option",{value:10,children:"10"}),Object(z.jsx)("option",{value:20,children:"20"}),Object(z.jsx)("option",{value:30,children:"30"}),Object(z.jsx)("option",{value:50,children:"50"}),Object(z.jsx)("option",{value:100,children:"100"})]}),Object(z.jsx)("span",{children:"filas"})]})})]}),Object(z.jsxs)(W.a,{responsive:!0,children:[Object(z.jsx)("thead",{children:Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{style:{width:1},children:"#"}),Object(z.jsx)("th",{children:"Propietario"}),Object(z.jsx)("th",{children:"Usuario"}),Object(z.jsx)("th",{children:"Estado"}),Object(z.jsx)("th",{style:{width:1}})]})}),Object(z.jsx)("tbody",{children:function(){if(I.isFetching)return Object(z.jsx)("tr",{children:Object(z.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(z.jsx)(x.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(I.isError){var e,r,n=I.error;return Object(z.jsx)("tr",{children:Object(z.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||n.message})})}if(I.data){var t=I.data.data.records;return 0==t.length?Object(z.jsx)("tr",{children:Object(z.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):t.map((function(e,r){return Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{children:r+1}),Object(z.jsxs)("td",{children:[e.ci," - ",e.nombreCompleto]}),Object(z.jsx)("td",{children:e.username}),Object(z.jsx)("td",{children:e.estado?"Activo":"Bloqueado"}),Object(z.jsx)("td",{children:Object(z.jsx)(ee,{user:e})})]},e.id)}))}}()})]}),Object(z.jsxs)(X.a,{children:[Object(z.jsx)(m.a,{children:Object(z.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(S," resultados")})}),Object(z.jsx)(m.a,{children:Object(z.jsx)(R.f,{current:b.current,total:Math.ceil((S-b.size)/b.size)+1,onChange:function(e){return O((function(r){return Object(d.a)(Object(d.a)({},r),{},{current:e})}))}})})]})]})]})},ne=function(){var e,r=Object(i.h)().state,n=Object(i.i)().id,t=Object(v.a)(["cargarUsuario",n],(function(){return I(parseInt(n))}),{enabled:!(null===r||void 0===r?void 0:r.user),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),a=(null===r||void 0===r?void 0:r.user)||(null===(e=t.data)||void 0===e?void 0:e.data);return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)("h2",{style:{fontSize:"1.75rem"},children:null===a||void 0===a?void 0:a.username}),Object(z.jsx)(W.a,{children:Object(z.jsxs)("tbody",{children:[Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Carnet de identidad"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.ci]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Nombre completo"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.nombreCompleto]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{className:"text-nowrap",scope:"row",style:{width:"1px"},children:"Nombre de usuario"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.username]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Estado"}),Object(z.jsxs)("td",{children:[": ",(null===a||void 0===a?void 0:a.estado)?"Activo":!1===(null===a||void 0===a?void 0:a.estado)?"Bloqueado":""]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Creado el"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.createdAt]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Actualizado el"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.updatedAt]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Roles"}),Object(z.jsxs)("td",{className:"text-capitalize",children:[": ",null===a||void 0===a?void 0:a.roleNames]})]})]})}),a?Object(z.jsxs)(j.a.Row,{children:[Object(z.jsx)(m.a,{xs:"auto",children:Object(z.jsx)(h.a,{as:J.b,to:{pathname:"/iam/usuarios/".concat(a.id,"/editar"),state:{user:a}},children:"Editar"})}),Object(z.jsx)(m.a,{xs:"auto",children:Object(z.jsx)(h.a,{variant:"danger",children:"Bloquear"})})]}):null]})},te=n(598),ae=function(){return g.apiClient.get("/permisos")},ie=function(e){var r,n=e.isInvalid,t=e.selected,a=void 0===t?[]:t,i=e.onChange,c=Object(v.a)("permisos.buscar",(function(){return ae()}),{refetchOnWindowFocus:!1,refetchOnReconnect:!1}),s=(null===(r=c.data)||void 0===r?void 0:r.data)||[];return Object(z.jsx)("div",{className:n?"is-invalid":"",children:c.isFetching?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(x.a,{animation:"border",size:"sm"}),Object(z.jsx)("span",{children:"Cargando"})]}):c.isError?Object(z.jsxs)(G.a,{variant:"danger",children:["Ocurrio un error al obtener la lista de permisos. Haga clic ",Object(z.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),c.refetch()},children:"aqui"})," para volver a intentar"]}):Object(z.jsx)(V.a,{as:"ul",className:"overflow-auto flex-grow-1",style:{maxHeight:"12rem"},children:s.map((function(e,r){return Object(z.jsx)(V.a.Item,{as:"li",className:"py-2 px-3 text-capitalize"+(n?" border-danger":""),action:!0,children:Object(z.jsx)(j.a.Check,{type:"checkbox",isInvalid:n,label:e,checked:a.some((function(r){return r==e})),onChange:function(r){var n=r.target.checked;i&&i(n?[].concat(Object(P.a)(a),[e]):a.filter((function(r){return r!=e})))}})},e)}))})})},ce=function(){var e,r,n,a,c,s=Object(t.useMemo)((function(){return Q.g().shape({name:Q.j().label("nombre").trim().required().max(50),description:Q.j().label("descripcion").trim().nullable().optional().max(250),permissions:Q.b().label("permisos").min(1)})}),[]),o=Object(p.h)({mode:"onBlur",resolver:Object(B.a)(s),defaultValues:{name:"",description:"",permissions:[]}}),l=o.handleSubmit,u=o.register,b=o.control,O=o.formState,g=o.reset,A=o.setError,_=Object(i.i)().id,I=Object(i.g)(),S=Object(t.useRef)(null),N=Object(f.b)(),C=Object(v.a)(["fetchRole",_],(function(){return D(parseInt(_))}),{enabled:!!_&&!(null===(e=I.location.state)||void 0===e?void 0:e.rol),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),U=Object(E.a)((function(e){return _?T(parseInt(_),{name:e.name,description:e.description,permissions:e.permissions}):y({name:e.name,description:e.description,permissions:e.permissions})}),{onSuccess:function(e){var r=e.data;N.invalidateQueries("roles.buscar"),I.replace("/iam/roles/".concat(r.id),{rol:r,ignoreAuthorization:!0})},onError:function(e){var r,n;422!==(null===(r=e.response)||void 0===r?void 0:r.status)&&(null===(n=S.current)||void 0===n||n.show(!0))}}),L=(null===(r=C.data)||void 0===r?void 0:r.data)||(null===(n=I.location.state)||void 0===n?void 0:n.rol),w=O.errors;Object(t.useEffect)((function(){L&&g({name:L.name,description:L.description,permissions:L.permissionNames})}),[L]),Object(t.useEffect)((function(){var e;C.isFetching&&(null===(e=S.current)||void 0===e||e.show(!0))}),[C.isFetching]),Object(t.useEffect)((function(){if(U.error){var e,r=U.error;if(422==(null===(e=r.response)||void 0===e?void 0:e.status)){var n=r.response.data.errors;n.name&&A("name",{message:n.name}),n.description&&A("description",{message:n.description}),n.permissions&&A("permissions",{message:n.permissions})}}}),[U.error]),console.log("Guardar State",w);return Object(z.jsx)(z.Fragment,{children:Object(z.jsxs)(j.a,{noValidate:!0,validated:O.isValid,onSubmit:l((function(e){U.mutate(e)})),children:[Object(z.jsx)("h1",{style:{fontSize:"2rem"},children:"Roles"}),Object(z.jsxs)(R.b,{ref:S,children:[Object(z.jsx)(te.a.Header,{children:C.isFetching?"Cargando":C.isError||U.isError?"Error":null}),Object(z.jsx)(te.a.Body,{children:function(){return C.isFetching?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(x.a,{animation:"border",size:"sm"}),Object(z.jsx)("span",{className:"ml-2",children:"Espere un momento"})]}):C.isError||U.isError?Object(z.jsx)(G.a,{variant:"danger",children:404==(null===(e=C.error)||void 0===e||null===(r=e.response)||void 0===r?void 0:r.status)?"El rol no existe":"Ocurrio un error mientras se cargaban los datos del rol"}):null;var e,r}()})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Nombre"}),Object(z.jsx)(j.a.Control,Object(d.a)({isInvalid:!!O.errors.name},u("name"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(a=w.name)||void 0===a?void 0:a.message})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Descripcion"}),Object(z.jsx)(j.a.Control,Object(d.a)({as:"textarea",isInvalid:!!w.description},u("description"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(c=w.description)||void 0===c?void 0:c.message})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Permisos"}),Object(z.jsx)(p.a,{name:"permissions",control:b,render:function(e){var r,n=e.field,t=e.fieldState;return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(ie,{isInvalid:!!t.error,onChange:n.onChange,selected:n.value}),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(r=t.error)||void 0===r?void 0:r.message})]})}})]}),Object(z.jsx)(j.a.Row,{children:Object(z.jsx)(m.a,{children:Object(z.jsxs)(h.a,{type:"submit",children:[U.isLoading?Object(z.jsx)(x.a,{animation:"border",className:"mr-2",size:"sm"}):null,Object(z.jsx)("span",{className:"align-middle",children:"Registrar"})]})})})]})})},se={index:function(e){return e.canAny([q.a.VER_ROLES,q.a.REGISTRAR_ROLES])},register:function(e){return e.canAny([q.a.REGISTRAR_ROLES])},edit:function(e){return e.canAny([q.a.EDITAR_ROLES])},view:function(e){return e.canAny([q.a.VER_ROLES])},delete:function(e){return e.canAny([q.a.ELIMINAR_ROLES])}},oe=function(){var e=Object(l.a)(),r=Object(t.useState)(0),n=Object(u.a)(r,2),a=n[0],i=n[1],s=Object(t.useState)({current:1,size:10}),b=Object(u.a)(s,2),O=b[0],p=b[1],f=Object(t.useState)({}),g=Object(u.a)(f,2),A=g[0],_=(g[1],Object(t.useState)(!1)),I=Object(u.a)(_,2),S=(I[0],I[1],Object(t.useRef)(null)),N=Object(v.a)(["roles.buscar",O,A],(function(){return w(A,O)}),{enabled:se.view(e),refetchOnReconnect:!1,refetchOnWindowFocus:!1,onSuccess:function(e){var r=e.data.meta;i(r.total)}}),C=Object(E.a)((function(e){return M(e)}),{onSuccess:function(){var e;N.refetch(),null===(e=S.current)||void 0===e||e.show(!1)}});return Object(z.jsxs)("div",{className:"px-1",children:[Object(z.jsx)("h2",{style:{fontSize:"1.75rem"},children:"Roles"}),Object(z.jsxs)(R.b,{ref:S,children:[Object(z.jsx)(te.a.Header,{children:C.isLoading?"Eliminando":C.isError?"Error":null}),Object(z.jsx)(te.a.Body,{children:C.isLoading?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(x.a,{animation:"border",size:"sm"}),Object(z.jsx)("span",{className:"ml-2",children:"Espere un momento"})]}):C.isError?Object(z.jsx)(G.a,{variant:"danger",children:"Ocurrio un error mientras se eliminaba el rol"}):null})]}),Object(z.jsx)("div",{className:"d-flex my-2",children:Object(z.jsxs)(X.a,{className:"ml-auto flex-nowrap",children:[Object(z.jsxs)(o.b,{authorize:se.view,children:[Object(z.jsx)(m.a,{className:"pr-0",xs:"auto",children:Object(z.jsx)(h.a,{onClick:function(){N.refetch()},children:Object(z.jsx)(c.j,{})})}),Object(z.jsx)(m.a,{className:"pr-0",xs:"auto",children:Object(z.jsx)(h.a,{onClick:function(){},children:Object(z.jsx)(c.e,{})})})]}),Object(z.jsx)(o.b,{authorize:se.register,children:Object(z.jsx)(m.a,{xs:"auto",children:Object(z.jsxs)(h.a,{as:J.b,to:"/iam/roles/registrar",className:"d-flex align-items-center",children:[Object(z.jsx)(c.h,{className:"mr-2"}),"Nuevo"]})})})]})}),Object(z.jsxs)(o.b,{authorize:se.view,children:[Object(z.jsxs)(X.a,{children:[Object(z.jsx)(m.a,{className:"mb-2"}),Object(z.jsx)(m.a,{className:"mb-2",xs:"auto",children:Object(z.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(z.jsx)("span",{children:"Mostrar"}),Object(z.jsxs)(j.a.Control,{className:"mx-2",as:"select",value:O.size,onChange:function(e){var r=e.target.value;p((function(e){return{current:1,size:parseInt(r)}}))},children:[Object(z.jsx)("option",{value:10,children:"10"}),Object(z.jsx)("option",{value:20,children:"20"}),Object(z.jsx)("option",{value:30,children:"30"}),Object(z.jsx)("option",{value:50,children:"50"}),Object(z.jsx)("option",{value:100,children:"100"})]}),Object(z.jsx)("span",{children:"filas"})]})})]}),Object(z.jsxs)(W.a,{responsive:!0,children:[Object(z.jsx)("thead",{children:Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{style:{width:1},children:"#"}),Object(z.jsx)("th",{children:"Nombre"}),Object(z.jsx)("th",{children:"Descripcion"}),Object(z.jsx)("th",{style:{width:1}})]})}),Object(z.jsx)("tbody",{children:function(){if(N.isFetching)return Object(z.jsx)("tr",{children:Object(z.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(z.jsx)(x.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(N.isError){var e,r,n=N.error;return Object(z.jsx)("tr",{children:Object(z.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||n.message})})}if(N.data){var t=N.data.data.records;return 0==t.length?Object(z.jsx)("tr",{children:Object(z.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):t.map((function(e,r){return Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{children:r+1}),Object(z.jsx)("td",{className:"text-capitalize",children:e.name}),Object(z.jsx)("td",{children:e.description}),Object(z.jsx)("td",{children:Object(z.jsxs)($.a,{children:[Object(z.jsx)($.a.Toggle,{as:R.j,variant:"link",id:"dropdown-users-".concat(e.id)}),Object(z.jsxs)($.a.Menu,{children:[Object(z.jsx)(o.b,{authorize:se.view,children:Object(z.jsx)($.a.Item,{as:J.b,to:{pathname:"/iam/roles/".concat(e.id),state:{rol:e}},children:"Ver"})}),Object(z.jsx)(o.b,{authorize:se.edit,children:Object(z.jsx)($.a.Item,{as:J.b,to:{pathname:"/iam/roles/".concat(e.id,"/editar"),state:{rol:e}},children:"Editar"})}),Object(z.jsx)(o.b,{authorize:se.delete,children:Object(z.jsx)($.a.Item,{className:"text-danger",onClick:function(){var r;window.confirm("Esta accion es irreversible, \xbfEsta seguro de continuar?")&&(C.mutate(e.id),null===(r=S.current)||void 0===r||r.show(!0))},children:"Eliminar"})})]})]})})]},e.id)}))}}()})]}),Object(z.jsxs)("div",{className:"row",children:[Object(z.jsx)(m.a,{children:Object(z.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(a," resultados")})}),Object(z.jsx)(m.a,{children:Object(z.jsx)(R.f,{current:O.current,total:Math.ceil((a-O.size)/O.size)+1,onChange:function(e){return p((function(r){return Object(d.a)(Object(d.a)({},r),{},{current:e})}))}})})]})]})]})},le=function(){var e,r=Object(i.h)(),n=(r.pathname,r.state),a=Object(i.i)().id,c=Object(t.useRef)(null),s=Object(v.a)(["cargar",a],(function(){return D(parseInt(a))}),{enabled:!(null===n||void 0===n?void 0:n.rol),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,onSuccess:function(){var e;null===(e=c.current)||void 0===e||e.show(!1)}}),o=Object(E.a)((function(){return M(parseInt(a))}),{onSuccess:function(){var e;null===(e=c.current)||void 0===e||e.show(!1)}}),l=(null===(e=s.data)||void 0===e?void 0:e.data)||(null===n||void 0===n?void 0:n.rol);Object(t.useEffect)((function(){var e;s.isFetching&&(null===(e=c.current)||void 0===e||e.show(!0))}),[s.isFetching]);return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)("h2",{style:{fontSize:"1.75rem"},children:null===l||void 0===l?void 0:l.name}),Object(z.jsxs)(R.b,{ref:c,children:[Object(z.jsx)(te.a.Header,{children:o.isLoading?"Eliminando":s.isFetching?"Cargando":o.isError||s.isError?"Error":null}),Object(z.jsx)(te.a.Body,{children:function(){return o.isLoading||s.isFetching?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(x.a,{animation:"border",size:"sm"}),Object(z.jsx)("span",{className:"ml-2",children:"Espere un momento"})]}):o.isError?Object(z.jsx)(G.a,{variant:"danger",children:"Ocurrio un error mientras se eliminaba el rol"}):s.isError?Object(z.jsx)(G.a,{variant:"danger",children:404==(null===(e=s.error.response)||void 0===e?void 0:e.status)?"El rol no existe":"Ocurrio un error mientras se cargaban los datos del rol"}):null;var e}()})]}),Object(z.jsx)(W.a,{children:Object(z.jsxs)("tbody",{children:[Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",style:{width:"1px"},children:"Nombre"}),Object(z.jsx)("td",{className:"text-capitalize",children:null===l||void 0===l?void 0:l.name})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{className:"text-nowrap",scope:"row",children:"Descripci\xf3n"}),Object(z.jsx)("td",{className:(null===l||void 0===l?void 0:l.description)?"":"bg-light",children:(null===l||void 0===l?void 0:l.description)||"Sin descripci\xf3n"})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Fecha de creaci\xf3n"}),Object(z.jsx)("td",{children:null===l||void 0===l?void 0:l.createdAt})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Fecha de actualizaci\xf3n"}),Object(z.jsx)("td",{children:null===l||void 0===l?void 0:l.updatedAt})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Permisos"}),Object(z.jsx)("td",{className:"d-flex ".concat((null===l||void 0===l?void 0:l.permissionNames.length)?"":"bg-light"),children:(null===l||void 0===l?void 0:l.permissionNames.length)?Object(z.jsx)("ul",{className:"d-inline-block",children:null===l||void 0===l?void 0:l.permissionNames.map((function(e,r){return Object(z.jsx)("li",{className:"text-capitalize",children:e},r)}))}):"No se agregaron permisos"})]})]})}),l?Object(z.jsxs)(j.a.Row,{children:[Object(z.jsx)(m.a,{xs:"auto",children:Object(z.jsx)(h.a,{as:J.b,to:{pathname:"/iam/roles/".concat(l.id,"/editar"),state:{rol:l}},children:"Editar"})}),Object(z.jsx)(m.a,{xs:"auto",children:Object(z.jsxs)(h.a,{variant:"danger",onClick:function(){var e;null===(e=c.current)||void 0===e||e.show(!0),o.mutate()},children:[o.isLoading?Object(z.jsx)(x.a,{className:"mr-2",animation:"border",size:"sm"}):null,"Eliminar"]})})]}):null]})},de=n(615),ue=function(){var e=Object(i.j)().url,r=Object(l.a)(),n=Object(t.useMemo)((function(){var n=[];return Y.index(r)&&n.push({id:"users",icon:Object(z.jsx)(c.p,{}),path:"".concat(e,"/usuarios"),title:"Usuarios"}),se.index(r)&&n.push({id:"roles",icon:Object(z.jsx)(c.k,{}),path:"".concat(e,"/roles"),title:"Roles"}),n}),[r]);return Object(z.jsx)(s.a,{sidebar:{header:Object(z.jsx)("div",{className:"d-flex justify-content-center",children:Object(z.jsx)(de.a,{src:"/logo-lg.png"})}),items:n},children:Object(z.jsxs)(i.d,{children:[Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios"),authorize:Y.index,children:Object(z.jsx)(re,{})}),Object(z.jsx)(o.c,{exact:!0,path:["".concat(e,"/usuarios/registrar"),"".concat(e,"/usuarios/:id/editar")],authorize:function(r,n){return n=="".concat(e,"/usuarios/registrar")?Y.register(r):Y.edit(r)},children:Object(z.jsx)(K,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios/:id/cambiar-contrasena"),authorize:Y.changePassword,children:Object(z.jsx)(H,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios/:id"),authorize:Y.view,children:Object(z.jsx)(ne,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/roles"),authorize:se.index,children:Object(z.jsx)(oe,{})}),Object(z.jsx)(o.c,{exact:!0,path:["".concat(e,"/roles/registrar"),"".concat(e,"/roles/:id/editar")],authorize:function(r,n){return n=="".concat(e,"/roles/registrar")?se.register(r):se.edit(r)},children:Object(z.jsx)(ce,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/roles/:id"),authorize:se.view,children:Object(z.jsx)(le,{})})]})})};r.default=ue}}]);
//# sourceMappingURL=4.05a79480.chunk.js.map