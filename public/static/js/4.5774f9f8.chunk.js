(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[4],{626:function(e,r,n){"use strict";var t=n(140);n.d(r,"b",(function(){return t.b})),n.d(r,"c",(function(){return t.c}));var a=n(141);n.d(r,"d",(function(){return a.a}));var i=n(627);n.d(r,"a",(function(){return i.a}))},627:function(e,r,n){"use strict";n.d(r,"a",(function(){return t}));var t={};n.r(t),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return a})),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return i})),n.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return c})),n.d(t,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return s})),n.d(t,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return o})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return l})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return d})),n.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return u})),n.d(t,"VER_USUARIOS",(function(){return j})),n.d(t,"VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return b})),n.d(t,"REGISTRAR_USUARIOS",(function(){return O})),n.d(t,"REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return m})),n.d(t,"EDITAR_USUARIOS",(function(){return h})),n.d(t,"EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return x})),n.d(t,"BLOQUEAR_USUARIOS",(function(){return p})),n.d(t,"BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return f})),n.d(t,"DESBLOQUEAR_USUARIOS",(function(){return v})),n.d(t,"DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return E})),n.d(t,"CAMBIAR_CONTRASE\xd1A",(function(){return R})),n.d(t,"CAMBIAR_CONTRASE\xd1A_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return g})),n.d(t,"VER_ROLES",(function(){return A})),n.d(t,"REGISTRAR_ROLES",(function(){return _})),n.d(t,"EDITAR_ROLES",(function(){return I})),n.d(t,"ELIMINAR_ROLES",(function(){return S})),n.d(t,"VER_LISTA_DE_MORA",(function(){return N})),n.d(t,"VER_LISTA_DE_MORA_REGIONAL",(function(){return C})),n.d(t,"AGREGAR_EMPLEADOR_EN_MORA",(function(){return L})),n.d(t,"AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return U})),n.d(t,"QUITAR_EMPLEADOR_EN_MORA",(function(){return w})),n.d(t,"QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return y})),n.d(t,"VER_MEDICOS",(function(){return D})),n.d(t,"VER_MEDICOS_REGIONAL",(function(){return P})),n.d(t,"REGISTRAR_MEDICOS",(function(){return T})),n.d(t,"REGISTRAR_MEDICOS_REGIONAL",(function(){return M})),n.d(t,"EDITAR_MEDICOS",(function(){return G})),n.d(t,"EDITAR_MEDICOS_REGIONAL",(function(){return V})),n.d(t,"BAJA_MEDICOS",(function(){return z})),n.d(t,"BAJA_MEDICOS_REGIONAL",(function(){return F})),n.d(t,"VER_PROVEEDORES",(function(){return k})),n.d(t,"VER_PROVEEDORES_REGIONAL",(function(){return B})),n.d(t,"REGISTRAR_PROVEEDORES",(function(){return Q})),n.d(t,"REGISTRAR_PROVEEDORES_REGIONAL",(function(){return q})),n.d(t,"EDITAR_PROVEEDORES",(function(){return K})),n.d(t,"EDITAR_PROVEEDORES_REGIONAL",(function(){return X})),n.d(t,"BAJA_PROVEEDOR",(function(){return H})),n.d(t,"BAJA_PROVEEDOR_REGIONAL",(function(){return W})),n.d(t,"VER_CONTRATOS_PROVEEDOR",(function(){return J})),n.d(t,"VER_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return $})),n.d(t,"REGISTRAR_CONTRATOS_PROVEEDOR",(function(){return Z})),n.d(t,"REGISTRAR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return Y})),n.d(t,"CONSUMIR_CONTRATOS_PROVEEDOR",(function(){return ee})),n.d(t,"CONSUMIR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return re})),n.d(t,"EXTENDER_CONTRATOS_PROVEEDOR",(function(){return ne})),n.d(t,"EXTENDER_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return te})),n.d(t,"ANULAR_CONTRATOS_PROVEEDOR",(function(){return ae})),n.d(t,"ANULAR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return ie})),n.d(t,"VER_ESPECIALIDADES",(function(){return ce})),n.d(t,"REGISTRAR_ESPECIALIDADES",(function(){return se})),n.d(t,"EDITAR_ESPECIALIDADES",(function(){return oe})),n.d(t,"ELIMINAR_ESPECIALIDADES",(function(){return le})),n.d(t,"IMPORTAR_ESPECIALIDADES",(function(){return de})),n.d(t,"VER_PRESTACIONES",(function(){return ue})),n.d(t,"REGISTRAR_PRESTACIONES",(function(){return je})),n.d(t,"EDITAR_PRESTACIONES",(function(){return be})),n.d(t,"ELIMINAR_PRESTACIONES",(function(){return Oe})),n.d(t,"IMPORTAR_PRESTACIONES",(function(){return me}));var a="Ver solicitudes de atencion externa",i="Ver solicitudes de atencion externa (misma regional)",c="Ver solicitudes de atencion externa (registrado por)",s="Registrar solicitudes de atencion externa",o="Registrar solicitudes de atencion externa (misma regional)",l="Emitir solicitudes de atencion externa",d="Emitir solicitudes de atencion externa (misma regional)",u="Emitir solicitudes de atencion externa (registrado por)",j="Ver usuarios",b="Ver usuarios (misma regional)",O="Registrar usuarios",m="Registrar usuarios (misma regional)",h="Editar usuarios",x="Editar usuarios (misma regional)",p="Bloquear usuarios",f="Bloquear usuarios (misma regional)",v="Desbloquear usuarios",E="Desbloquear usuarios (misma regional)",R="Cambiar contrase\xf1a",g="Cambiar contrase\xf1a (misma regional)",A="Ver roles",_="Registrar roles",I="Editar roles",S="Eliminar roles",N="Ver lista de mora",C="Ver lista de mora (regional)",L="Agregar empleador en mora",U="Agregar empleador en mora (misma regional)",w="Quitar empleador en mora",y="Quitar empleador en mora (misma regional)",D="Ver m\xe9dicos",P="Ver m\xe9dicos (regional)",T="Registrar m\xe9dicos",M="Registrar m\xe9dicos (regional)",G="Editar m\xe9dicos",V="Editar m\xe9dicos (regional)",z="Baja m\xe9dicos",F="Baja m\xe9dicos (regional)",k="Ver proveedores",B="Ver proveedores (regional)",Q="Registrar proveedores",q="Registrar proveedores (regional)",K="Editar proveedores",X="Editar proveedores (regional)",H="Baja proveedores",W="Baja proveedores (regional)",J="Ver contratos de proveedores",$="Ver contratos de proveedores (regional)",Z="Registrar contratos de proveedores",Y="Registrar contratos de proveedores (regional)",ee="Consumir contratos de proveedores",re="Consumir contratos de proveedores (regional)",ne="Extender contratos de proveedores",te="Extender contratos de proveedores (regional)",ae="Anular contratos de proveedores",ie="Anular contratos de proveedores (regional)",ce="Ver especialidades",se="Registrar especialidades",oe="Editar especialidades",le="Eliminar especialidades",de="Importar especialidades",ue="Ver prestaciones",je="Registrar prestaciones",be="Editar prestaciones",Oe="Eliminar prestaciones",me="Importar prestaciones"},628:function(e,r,n){"use strict";var t=n(16),a=(n(1),n(633)),i=n(45),c=n(237),s=(n(629),n(3));r.a=function(e){var r=e.sidebar,n=e.children,o=Object(i.c)((function(e){return e.main.showSidebar}));return Object(s.jsxs)("div",{className:"position-relative d-flex flex-grow-1 bg-light"+(o?"":" toggled"),id:"wrapper",children:[Object(s.jsx)(c.a,Object(t.a)({className:"bg-white shadow-sm"},r)),Object(s.jsx)(a.a,{className:"d-flex flex-column flex-grow-1",children:Object(s.jsx)("div",{className:"d-flex flex-column bg-white rounded-lg shadow-sm m-2 p-3 flex-grow-1",children:n})})]})}},629:function(e,r,n){},633:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(6),c=n.n(i),s=n(1),o=n.n(s),l=n(8),d=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.fluid,s=e.as,d=void 0===s?"div":s,u=e.className,j=Object(a.a)(e,["bsPrefix","fluid","as","className"]),b=Object(l.a)(n,"container"),O="string"===typeof i?"-"+i:"-fluid";return o.a.createElement(d,Object(t.a)({ref:r},j,{className:c()(u,i?""+b+O:b)}))}));d.displayName="Container",d.defaultProps={fluid:!1},r.a=d},634:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(6),c=n.n(i),s=n(1),o=n.n(s),l=n(8),d=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,s=e.striped,d=e.bordered,u=e.borderless,j=e.hover,b=e.size,O=e.variant,m=e.responsive,h=Object(a.a)(e,["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"]),x=Object(l.a)(n,"table"),p=c()(i,x,O&&x+"-"+O,b&&x+"-"+b,s&&x+"-striped",d&&x+"-bordered",u&&x+"-borderless",j&&x+"-hover"),f=o.a.createElement("table",Object(t.a)({},h,{className:p,ref:r}));if(m){var v=x+"-responsive";return"string"===typeof m&&(v=v+"-"+m),o.a.createElement("div",{className:v},f)}return f}));r.a=d},639:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(6),c=n.n(i),s=n(1),o=n.n(s),l=n(48),d=n(8),u=n(36),j=o.a.createContext(null);j.displayName="AccordionContext";var b=j;var O=o.a.forwardRef((function(e,r){var n=e.as,i=void 0===n?"button":n,c=e.children,l=e.eventKey,d=e.onClick,j=Object(a.a)(e,["as","children","eventKey","onClick"]),O=function(e,r){var n=Object(s.useContext)(b),t=Object(s.useContext)(u.a);return function(a){t&&t(e===n?null:e,a),r&&r(a)}}(l,d);return"button"===i&&(j.type="button"),o.a.createElement(i,Object(t.a)({ref:r,onClick:O},j),c)})),m=n(244),h=o.a.forwardRef((function(e,r){var n=e.children,i=e.eventKey,c=Object(a.a)(e,["children","eventKey"]),l=Object(s.useContext)(b);return o.a.createElement(u.a.Provider,{value:null},o.a.createElement(m.a,Object(t.a)({ref:r,in:l===i},c),o.a.createElement("div",null,o.a.Children.only(n))))}));h.displayName="AccordionCollapse";var x=h,p=o.a.forwardRef((function(e,r){var n=Object(l.a)(e,{activeKey:"onSelect"}),i=n.as,s=void 0===i?"div":i,j=n.activeKey,O=n.bsPrefix,m=n.children,h=n.className,x=n.onSelect,p=Object(a.a)(n,["as","activeKey","bsPrefix","children","className","onSelect"]),f=c()(h,Object(d.a)(O,"accordion"));return o.a.createElement(b.Provider,{value:j||null},o.a.createElement(u.a.Provider,{value:x||null},o.a.createElement(s,Object(t.a)({ref:r},p,{className:f}),m)))}));p.displayName="Accordion",p.Toggle=O,p.Collapse=x;r.a=p},640:function(e,r,n){"use strict";var t=n(2),a=n(5),i=n(6),c=n.n(i),s=n(1),o=n.n(s),l=n(8),d=n(30),u=n(156),j=n(245),b=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,s=e.variant,d=e.as,u=void 0===d?"img":d,j=Object(a.a)(e,["bsPrefix","className","variant","as"]),b=Object(l.a)(n,"card-img");return o.a.createElement(u,Object(t.a)({ref:r,className:c()(s?b+"-"+s:b,i)},j))}));b.displayName="CardImg",b.defaultProps={variant:null};var O=b,m=Object(u.a)("h5"),h=Object(u.a)("h6"),x=Object(d.a)("card-body"),p=Object(d.a)("card-title",{Component:m}),f=Object(d.a)("card-subtitle",{Component:h}),v=Object(d.a)("card-link",{Component:"a"}),E=Object(d.a)("card-text",{Component:"p"}),R=Object(d.a)("card-header"),g=Object(d.a)("card-footer"),A=Object(d.a)("card-img-overlay"),_=o.a.forwardRef((function(e,r){var n=e.bsPrefix,i=e.className,d=e.bg,u=e.text,b=e.border,O=e.body,m=e.children,h=e.as,p=void 0===h?"div":h,f=Object(a.a)(e,["bsPrefix","className","bg","text","border","body","children","as"]),v=Object(l.a)(n,"card"),E=Object(s.useMemo)((function(){return{cardHeaderBsPrefix:v+"-header"}}),[v]);return o.a.createElement(j.a.Provider,{value:E},o.a.createElement(p,Object(t.a)({ref:r},f,{className:c()(i,v,d&&"bg-"+d,u&&"text-"+u,b&&"border-"+b)}),O?o.a.createElement(x,null,m):m))}));_.displayName="Card",_.defaultProps={body:!1},_.Img=O,_.Title=p,_.Subtitle=f,_.Body=x,_.Link=v,_.Text=E,_.Header=R,_.Footer=g,_.ImgOverlay=A;r.a=_},644:function(e,r,n){"use strict";n.r(r),n.d(r,"IamApp",(function(){return he}));var t=n(1),a=n.n(t),i=n(23),c=n(34),s=n(628),o=n(140),l=n(141),d=n(16),u=n(28),j=n(618),b=n(608),O=n(639),m=n(640),h=n(334),x=n(229),p=n(607),f=n(94),v=n(179),E=n(622),R=n(624),g=n(235),A=n(61),_=n(42),I=function(e,r){return A.apiClient.get("/usuarios",{params:Object(_.c)({page:r,filter:e})})},S=function(e){return A.apiClient.get("/usuarios/".concat(e))},N=function(e){return A.apiClient.post("/usuarios",Object(_.c)(e))},C=function(e,r){return A.apiClient.put("/usuarios/".concat(e),Object(_.c)(r))},L=function(e,r){return A.apiClient.put("/usuarios/".concat(e,"/cambiar-contrasena"),Object(_.c)(r))},U=function(e){return A.apiClient.put("/usuarios/".concat(e,"/bloquear"))},w=function(e){return A.apiClient.put("/usuarios/".concat(e,"/desbloquear"))},y=function(e,r){return A.apiClient.get("/roles",{params:{filter:e,page:r}})},D=function(e){return A.apiClient.get("/roles/".concat(e))},P=function(e){return A.apiClient.post("roles",e)},T=function(e,r){return A.apiClient.put("roles/".concat(e),r)},M=function(e){return A.apiClient.delete("roles/".concat(e))},G=n(24),V=n(343),z=n(3),F=1,k=a.a.memo((function(e){var r,n=e.isInvalid,t=e.selected,a=void 0===t?[]:t,i=e.onChange,c=Object(E.a)("roles.buscar",(function(){return y()}),{refetchOnReconnect:!1,refetchOnWindowFocus:!1});console.log("Render count",F++);var s=(null===(r=c.data)||void 0===r?void 0:r.data)||[];return Object(z.jsx)("div",{className:n?"is-invalid":"",children:c.isFetching?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(p.a,{animation:"border",size:"sm"}),Object(z.jsx)("span",{children:"Cargando"})]}):c.isError?Object(z.jsxs)(b.a,{variant:"danger",children:["Ocurrio un error al obtener la lista de roles. Haga clic ",Object(z.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),c.refetch()},children:"aqui"})," para volver a intentar"]}):Object(z.jsx)(V.a,{as:"ul",className:"overflow-auto flex-grow-1",style:{maxHeight:"12rem"},children:s.map((function(e,r){return Object(z.jsx)(V.a.Item,{as:"li",className:"py-2 px-3 text-capitalize"+(n?" border-danger":""),action:!0,children:Object(z.jsx)(j.a.Check,{type:"checkbox",isInvalid:n,label:e.name,checked:a.some((function(r){return r.id==e.id})),onChange:function(r){var n=r.target.checked;i&&i(n?[].concat(Object(G.a)(a),[e]):a.filter((function(r){return r.id!=e.id})))}})},e.id)}))})})})),B=n(236),Q=n(70),q=n(627),K=function(){var e,r,n,a,c,s,o,A,_,I,L,U,w,y,D,P,T,M,G,V,F,K,X,H,W,J,$,Z,Y,ee=Object(l.a)(),re=Object(i.i)().id,ne=Object(t.useMemo)((function(){return Q.g().shape({informacionPersonal:Q.g().shape({ci:Q.f().label("carnet de identidad"),ciComplemento:Q.d((function(e){return e?Q.j().label("'complemento'").trim().length(2):Q.j().nullable().optional()})),apellidoPaterno:Q.j().label("apellido paterno").trim().when("apellidoMaterno",{is:function(e){return!e},then:Q.j().required("Debe proporcionar al menos un apellido")}),apellidoMaterno:Q.j().label("apellido materno").trim().when("apellidoPaterno",{is:function(e){return!e},then:Q.j().required("Debe proporcionar al menos un apellido")}),nombres:Q.j().label("nombres").trim().required().label("'Nombres'")},[["apellidoMaterno","apellidoPaterno"]]),informacionUsuario:Q.g().shape(re?{roles:Q.b().label("roles").min(1,"Debe seleccionar al menos un rol")}:{username:Q.j().label("usuario").required().min(6).max(16).matches(/[a-zA-Z0-9]*/),password:Q.j().label("contrase\xf1a").min(8).max(256).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\/()=?\*])(?=.{8,})/,"La contrase\xf1a debe contener al menos un caracter en minuscula, uno en mayuscula, un n\xfamero y uno de los siguientes caracter especial: !@#$%^&*").required(),passwordRepeat:Q.j().label("confirmar contrase\xf1a").test("password-match","Las contrase\xf1as no coinciden",(function(e){return e===this.parent.password})),regional:Q.b().length(1),roles:Q.b().label("roles").min(1,"Debe seleccionar al menos un rol")})})}),[]),te=Object(f.h)({resolver:Object(B.a)(ne),mode:"onBlur",defaultValues:{informacionUsuario:{roles:[],regional:[]}}}),ae=te.control,ie=te.formState,ce=te.handleSubmit,se=te.register,oe=te.setValue,le=te.trigger,de=te.watch,ue=Object(i.g)(),je=Object(v.b)(),be=["usuarios.cargar",re],Oe=Object(E.a)(be,(function(){return S(parseInt(re))}),{enabled:!!re&&!(null===(e=ue.location.state)||void 0===e?void 0:e.user)}),me=Object(R.a)((function(e){var r=e.informacionPersonal,n=e.informacionUsuario;return re?C(parseInt(re),{regionalId:n.regional[0].id,roles:n.roles.map((function(e){return e.name})),ci:parseInt(r.ci),ciComplemento:r.ciComplemento,apellidoPaterno:r.apellidoPaterno,apellidoMaterno:r.apellidoMaterno,nombres:r.nombres}):N({username:n.username,password:n.password,regionalId:n.regional[0].id,roles:n.roles.map((function(e){return e.name})),ci:parseInt(r.ci),ciComplemento:r.ciComplemento,apellidoPaterno:r.apellidoPaterno,apellidoMaterno:r.apellidoMaterno,nombres:r.nombres})}),{onSuccess:function(e){var r=e.data;je.invalidateQueries("usuarios.buscar"),ue.replace("/iam/usuarios/".concat(r.id),{user:r})}}),he=Object(t.useState)([]),xe=Object(u.a)(he,2),pe=xe[0],fe=xe[1],ve=Object(t.useCallback)((function(e){return!!ee.can(q.a.REGISTRAR_USUARIOS)||e.id==ee.regionalId}),[ee]),Ee=(null===(r=Oe.data)||void 0===r?void 0:r.data)||(null===(n=ue.location.state)||void 0===n?void 0:n.user),Re=ie.errors;return Object(t.useEffect)((function(){Ee&&pe.length&&(oe("informacionPersonal",{ci:String(Ee.ciRaiz),ciComplemento:Ee.ciComplemento,apellidoPaterno:Ee.apellidoPaterno,apellidoMaterno:Ee.apellidoMaterno,nombres:Ee.nombres}),oe("informacionUsuario",{username:Ee.username,roles:Ee.roles,regional:[pe.find((function(e){return e.id==Ee.id}))]}))}),[Ee]),Object(z.jsx)(z.Fragment,{children:Object(z.jsxs)(j.a,{onSubmit:ce((function(e){me.mutate(e)})),children:[Object(z.jsx)("h1",{style:{fontSize:"2rem"},children:"Usuarios"}),"error"==me.status||"success"==me.status?Object(z.jsx)(b.a,{variant:me.isError?"danger":"success",children:me.isError?(null===(a=me.error.response)||void 0===a||null===(c=a.data)||void 0===c?void 0:c.message)||me.error.message:"Guardado"}):null,Object(z.jsxs)(O.a,{className:"mb-2",defaultActiveKey:"0",children:[Object(z.jsxs)(m.a,{children:[Object(z.jsx)(O.a.Toggle,{as:m.a.Header,className:["text-light",Re.informacionPersonal?"bg-danger":"bg-primary"].join(" "),eventKey:"0",children:"Informaci\xf3n personal"}),Object(z.jsx)(O.a.Collapse,{eventKey:"0",children:Object(z.jsxs)(m.a.Body,{children:[Object(z.jsxs)(j.a.Row,{children:[Object(z.jsxs)(j.a.Group,{as:h.a,xs:8,md:4,children:[Object(z.jsx)(j.a.Label,{title:"Numero raiz del carnet de identidad",children:"Carnet de identidad"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"number",isInvalid:!!(null===(s=ie.errors.informacionPersonal)||void 0===s?void 0:s.ci)},se("informacionPersonal.ci"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(o=Re.informacionPersonal)||void 0===o||null===(A=o.ci)||void 0===A?void 0:A.message})]}),Object(z.jsxs)(j.a.Group,{as:h.a,xs:4,md:2,children:[Object(z.jsx)(j.a.Label,{title:"Complemento del carnet de identiad",children:"Complemento"}),Object(z.jsx)(j.a.Control,Object(d.a)({isInvalid:!!(null===(_=Re.informacionPersonal)||void 0===_?void 0:_.ciComplemento)},se("informacionPersonal.ciComplemento"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(I=Re.informacionPersonal)||void 0===I||null===(L=I.ciComplemento)||void 0===L?void 0:L.message})]})]}),Object(z.jsxs)(j.a.Row,{children:[Object(z.jsxs)(j.a.Group,{as:h.a,lg:4,children:[Object(z.jsx)(j.a.Label,{children:"Apellido Paterno"}),Object(z.jsx)(j.a.Control,Object(d.a)(Object(d.a)({isInvalid:!!(null===(U=Re.informacionPersonal)||void 0===U?void 0:U.apellidoPaterno)},se("informacionPersonal.apellidoPaterno")),{},{onChange:function(e){se("informacionPersonal.apellidoPaterno").onChange(e),ie.isSubmitted&&le("informacionPersonal.apellidoMaterno")}})),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(w=Re.informacionPersonal)||void 0===w||null===(y=w.apellidoPaterno)||void 0===y?void 0:y.message})]}),Object(z.jsxs)(j.a.Group,{as:h.a,lg:4,children:[Object(z.jsx)(j.a.Label,{children:"Apellido Materno"}),Object(z.jsx)(j.a.Control,Object(d.a)(Object(d.a)({isInvalid:!!(null===(D=Re.informacionPersonal)||void 0===D?void 0:D.apellidoMaterno)},se("informacionPersonal.apellidoMaterno")),{},{onChange:function(e){se("informacionPersonal.apellidoPaterno").onChange(e),ie.isSubmitted&&le("informacionPersonal.apellidoMaterno")}})),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(P=Re.informacionPersonal)||void 0===P||null===(T=P.apellidoMaterno)||void 0===T?void 0:T.message})]}),Object(z.jsxs)(j.a.Group,{as:h.a,lg:4,children:[Object(z.jsx)(j.a.Label,{children:"Nombres"}),Object(z.jsx)(j.a.Control,Object(d.a)({isInvalid:!!(null===(M=ie.errors.informacionPersonal)||void 0===M?void 0:M.nombres)},se("informacionPersonal.nombres"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(G=ie.errors.informacionPersonal)||void 0===G||null===(V=G.nombres)||void 0===V?void 0:V.message})]})]})]})})]}),Object(z.jsxs)(m.a,{children:[Object(z.jsx)(O.a.Toggle,{as:m.a.Header,className:["text-light",Re.informacionUsuario?"bg-danger":"bg-primary"].join(" "),eventKey:"1",children:"Informacion de usuario"}),Object(z.jsx)(O.a.Collapse,{eventKey:"1",children:Object(z.jsxs)(m.a.Body,{children:[Object(z.jsxs)(j.a.Row,{children:[Object(z.jsxs)(j.a.Group,{controlId:"username",as:h.a,md:4,children:[Object(z.jsx)(j.a.Label,{children:"Usuario"}),Object(z.jsx)(j.a.Control,Object(d.a)({disabled:!!re,isInvalid:!!(null===(F=ie.errors.informacionUsuario)||void 0===F?void 0:F.username)},se("informacionUsuario.username"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(K=ie.errors.informacionUsuario)||void 0===K||null===(X=K.username)||void 0===X?void 0:X.message})]}),re?null:Object(z.jsxs)(z.Fragment,{children:[Object(z.jsxs)(j.a.Group,{as:h.a,md:4,children:[Object(z.jsx)(j.a.Label,{children:"Contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!(null===(H=ie.errors.informacionUsuario)||void 0===H?void 0:H.password)},se("informacionUsuario.password"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(W=ie.errors.informacionUsuario)||void 0===W||null===(J=W.password)||void 0===J?void 0:J.message})]}),Object(z.jsxs)(j.a.Group,{as:h.a,md:4,children:[Object(z.jsx)(j.a.Label,{children:"Confirmar contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!(null===($=ie.errors.informacionUsuario)||void 0===$?void 0:$.passwordRepeat)},se("informacionUsuario.passwordRepeat",{required:{value:!0,message:"Este campo es requerido"},validate:{matchPassword:function(e){return e===de("informacionUsuario.password")||"Las contrase\xf1as no coinciden"}}}))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(Z=ie.errors.informacionUsuario)||void 0===Z||null===(Y=Z.passwordRepeat)||void 0===Y?void 0:Y.message})]})]})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Regional"}),Object(z.jsx)(f.a,{name:"informacionUsuario.regional",control:ae,render:function(e){var r,n=e.field,t=e.fieldState;return Object(z.jsx)(g.i,{id:"usuario/regionales-typeahead",onLoad:fe,isInvalid:!!t.error,feedback:null===(r=t.error)||void 0===r?void 0:r.message,filterBy:ve,selected:n.value,onBlur:n.onBlur,onChange:n.onChange})}})]}),Object(z.jsx)(j.a.Row,{children:Object(z.jsxs)(j.a.Group,{as:h.a,children:[Object(z.jsx)(j.a.Label,{children:"Roles"}),Object(z.jsx)(f.a,{name:"informacionUsuario.roles",control:ae,render:function(e){var r,n=e.field,t=e.fieldState;return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(k,{isInvalid:!!t.error,onChange:n.onChange,selected:n.value}),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(r=t.error)||void 0===r?void 0:r.message})]})}})]})})]})})]})]}),Object(z.jsx)(j.a.Row,{children:Object(z.jsx)(h.a,{children:Object(z.jsxs)(x.a,{type:"submit",children:[me.isLoading?Object(z.jsx)(p.a,{animation:"border",className:"mr-2",size:"sm"}):null,Object(z.jsx)("span",{className:"align-middle",children:"Guardar"})]})})})]})})},X=n(626),H=function(){var e,r,n,a,c,s=Object(i.i)().id,o=(Object(i.g)(),Object(X.d)()),l=Object(t.useMemo)((function(){return Q.g().shape({oldPassword:s?Q.e().notRequired():Q.j().label("antig\xfca contrase\xf1a").trim().required(),password:Q.j().label("nueva contrase\xf1a").min(8).max(32).matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/,"La contrase\xf1a debe contener al menos un caracter en minuscula, uno en mayuscula, un n\xfamero y uno de los siguientes caracter especial: !@#$%^&*").required(),passwordRepeat:Q.j().label("repita la nueva contrase\xf1a").oneOf([Q.h("password")],"Las contrase\xf1as no coinciden")})}),[]),u=Object(f.h)({mode:"onBlur",resolver:Object(B.a)(l),defaultValues:{oldPassword:"",password:"",passwordRepeat:""}}),O=u.formState,m=u.handleSubmit,h=u.register,v=Object(R.a)((function(e){var r=parseInt(s);return L(isNaN(r)?o.id:r,{password:e.password,oldPassword:e.oldPassword})}),{onSuccess:function(e){e.data}}),E=O.errors;return Object(z.jsxs)(j.a,{onSubmit:m((function(e){v.mutate(e)})),children:[Object(z.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Cambiar contrase\xf1a"}),"error"==v.status||"success"==v.status?Object(z.jsx)(b.a,{variant:v.isError?"danger":"success",children:v.isError?(null===(e=v.error.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||v.error.message:"Guardado"}):null,s?null:Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Antig\xfca contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!E.oldPassword},h("oldPassword"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(n=E.oldPassword)||void 0===n?void 0:n.message})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Nueva contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!E.password},h("password"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(a=E.password)||void 0===a?void 0:a.message})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Repita la nueva contrase\xf1a"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"password",isInvalid:!!E.passwordRepeat},h("passwordRepeat"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(c=E.passwordRepeat)||void 0===c?void 0:c.message})]}),Object(z.jsxs)(x.a,{type:"submit",children:[v.isLoading?Object(z.jsx)(p.a,{animation:"border",size:"sm"}):null,"Guardar"]})]})},W=n(244),J=n(634),$=n(616),Z=n(60),Y={index:function(e){return e.canAny([q.a.VER_USUARIOS,q.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO,q.a.REGISTRAR_USUARIOS,q.a.REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},register:function(e){return e.canAny([q.a.REGISTRAR_USUARIOS,q.a.REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},edit:function(e){return e.canAny([q.a.EDITAR_USUARIOS,q.a.EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},view:function(e){return e.canAny([q.a.VER_USUARIOS,q.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},changePassword:function(e){return e.canAny([q.a.CAMBIAR_CONTRASE\u00d1A,q.a.CAMBIAR_CONTRASE\u00d1A_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},disable:function(e){return e.canAny([q.a.BLOQUEAR_USUARIOS,q.a.BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])},enable:function(e){return e.canAny([q.a.DESBLOQUEAR_USUARIOS,q.a.DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO])}},ee=function(e){var r=Object(f.h)(),n=(r.control,r.handleSubmit),t=r.register,a=r.reset;return Object(z.jsxs)(j.a,{onSubmit:n((function(r){var n={};r.numCi&&(n.ci=r.numCi),r.compCi&&(n.ciComplemento=r.compCi),r.nombre&&(n.nombreCompleto=r.nombre),r.username&&(n.username=r.username),e.onFilter(n)})),children:[Object(z.jsxs)(j.a.Row,{children:[Object(z.jsxs)(j.a.Group,{as:h.a,sm:4,lg:3,children:[Object(z.jsx)(j.a.Label,{children:"N\xba Carnet"}),Object(z.jsx)(j.a.Control,Object(d.a)({},t("numCi")))]}),Object(z.jsxs)(j.a.Group,{as:h.a,sm:2,lg:1,children:[Object(z.jsx)(j.a.Label,{children:"Comp. Carnet"}),Object(z.jsx)(j.a.Control,Object(d.a)({},t("compCi")))]}),Object(z.jsxs)(j.a.Group,{as:h.a,sm:6,lg:8,children:[Object(z.jsx)(j.a.Label,{children:"Nombre"}),Object(z.jsx)(j.a.Control,Object(d.a)({},t("nombre")))]})]}),Object(z.jsx)(j.a.Row,{children:Object(z.jsxs)(j.a.Group,{as:h.a,sm:"6",children:[Object(z.jsx)(j.a.Label,{children:"Nombre de usuario"}),Object(z.jsx)(j.a.Control,Object(d.a)({},t("username")))]})}),Object(z.jsxs)(j.a.Row,{children:[Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsx)(x.a,{type:"submit",children:"Aplicar"})}),Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsx)(x.a,{variant:"secondary",onClick:function(){return a()},children:"Limpiar"})})]})]})},re=n(93),ne=n(95),te=function(e){var r=e.user,n=Object(ne.b)("queryLoader"),a=Object(v.b)(),i=Object(R.a)((function(){return r.estado?U(r.id):w(r.id)}),{onSuccess:function(){n.close(),a.setQueryData("usuarios.buscar",(function(e){return Object(d.a)(Object(d.a)({},e),{},{data:Object(d.a)(Object(d.a)({},e.data),{},{records:e.data.records.map((function(e){return e==r?Object(d.a)(Object(d.a)({},e),{},{estado:!r.estado}):Object(d.a)({},e)}))})})}))}});return Object(t.useEffect)((function(){"loading"==i.status?n.open({state:"loading"}):"error"==i.status&&n.open({state:"error",error:i.error})}),[i.status]),Object(z.jsxs)(re.a,{style:{position:"initial"},children:[Object(z.jsx)(re.a.Toggle,{as:g.j,variant:"link",id:"dropdown-users-".concat(r.id)}),Object(z.jsxs)(re.a.Menu,{children:[Object(z.jsx)(o.b,{authorize:Y.view,children:Object(z.jsx)(re.a.Item,{as:Z.b,to:{pathname:"/iam/usuarios/".concat(r.id),state:{user:r}},children:"Ver"})}),Object(z.jsx)(o.b,{authorize:Y.edit,children:Object(z.jsx)(re.a.Item,{as:Z.b,to:{pathname:"/iam/usuarios/".concat(r.id,"/editar"),state:{user:r}},children:"Editar"})}),Object(z.jsx)(o.b,{authorize:Y.changePassword,children:Object(z.jsx)(re.a.Item,{as:Z.b,to:{pathname:"/iam/usuarios/".concat(r.id,"/cambiar-contrasena"),state:{user:r}},children:"Cambiar contrase\xf1a"})}),Object(z.jsx)(o.b,{authorize:function(e){return r.estado?Y.disable(e):Y.enable(e)},children:Object(z.jsx)(re.a.Item,{className:"text-danger",onClick:function(){i.mutate()},children:r.estado?"Bloquear":"Desbloquear"})})]})]})},ae=function(){var e,r,n,a=Object(l.a)(),i=Object(t.useState)({current:1,size:10}),s=Object(u.a)(i,2),b=s[0],O=s[1],m=Object(t.useMemo)((function(){var e={};return a.can(q.a.VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO,!1)&&(e.regionalId=a.regionalId),e}),[a]),f=Object(t.useState)(m),v=Object(u.a)(f,2),R=v[0],A=v[1],_=Object(t.useState)(!1),S=Object(u.a)(_,2),N=S[0],C=S[1],L=Object(E.a)("usuarios.buscar",(function(){return I(R,b)}),{enabled:Y.view(a),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),U=(null===(e=L.data)||void 0===e||null===(r=e.data)||void 0===r||null===(n=r.meta)||void 0===n?void 0:n.total)||0;return Object(z.jsxs)("div",{className:"px-1",children:[Object(z.jsx)("h2",{style:{fontSize:"1.75rem"},children:"Usuarios"}),Object(z.jsx)("div",{className:"d-flex my-2",children:Object(z.jsxs)(j.a.Row,{className:"ml-auto flex-nowrap",children:[Object(z.jsxs)(o.b,{authorize:Y.view,children:[Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsx)(x.a,{onClick:function(){L.refetch()},children:Object(z.jsx)(c.j,{})})}),Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsx)(x.a,{onClick:function(){C((function(e){return!e}))},children:Object(z.jsx)(c.e,{})})})]}),Object(z.jsx)(o.b,{authorize:Y.register,children:Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsxs)(x.a,{as:Z.b,to:"/iam/usuarios/registrar",className:"d-flex align-items-center",children:[Object(z.jsx)(c.o,{className:"mr-2"}),"Nuevo"]})})})]})}),Object(z.jsxs)(o.b,{authorize:Y.view,children:[Object(z.jsx)(W.a,{in:N,children:Object(z.jsx)("div",{children:Object(z.jsx)(ee,{onFilter:function(e){A(Object(d.a)(Object(d.a)({},e),m))}})})}),Object(z.jsx)("div",{className:"d-flex",children:Object(z.jsx)("div",{className:"ml-auto mb-2",children:Object(z.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(z.jsx)("span",{children:"Mostrar"}),Object(z.jsxs)(j.a.Control,{className:"mx-2",as:"select",value:b.size,onChange:function(e){var r=e.target.value;O((function(e){return Object(d.a)(Object(d.a)({},e),{},{size:parseInt(r)})}))},children:[Object(z.jsx)("option",{value:10,children:"10"}),Object(z.jsx)("option",{value:20,children:"20"}),Object(z.jsx)("option",{value:30,children:"30"}),Object(z.jsx)("option",{value:50,children:"50"}),Object(z.jsx)("option",{value:100,children:"100"})]}),Object(z.jsx)("span",{children:"filas"})]})})}),Object(z.jsxs)(J.a,{responsive:!0,children:[Object(z.jsx)("thead",{children:Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{style:{width:1},children:"#"}),Object(z.jsx)("th",{children:"Propietario"}),Object(z.jsx)("th",{children:"Usuario"}),Object(z.jsx)("th",{children:"Estado"}),Object(z.jsx)("th",{style:{width:1}})]})}),Object(z.jsx)("tbody",{children:function(){if(L.isFetching)return Object(z.jsx)("tr",{children:Object(z.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(z.jsx)(p.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(L.isError){var e,r,n=L.error;return Object(z.jsx)("tr",{children:Object(z.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||n.message})})}if(L.data){var t=L.data.data.records;return 0==t.length?Object(z.jsx)("tr",{children:Object(z.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):t.map((function(e,r){return Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{children:r+1}),Object(z.jsxs)("td",{children:[e.ci," - ",e.nombreCompleto]}),Object(z.jsx)("td",{children:e.username}),Object(z.jsx)("td",{children:e.estado?"Activo":"Bloqueado"}),Object(z.jsx)("td",{children:Object(z.jsx)(te,{user:e})})]},e.id)}))}}()})]}),Object(z.jsxs)($.a,{children:[Object(z.jsx)(h.a,{children:Object(z.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(U," resultados")})}),Object(z.jsx)(h.a,{children:Object(z.jsx)(g.f,{current:b.current,total:Math.ceil((U-b.size)/b.size)+1,onChange:function(e){return O((function(r){return Object(d.a)(Object(d.a)({},r),{},{current:e})}))}})})]})]})]})},ie=function(){var e,r=Object(i.h)().state,n=Object(i.i)().id,t=Object(E.a)(["cargarUsuario",n],(function(){return S(parseInt(n))}),{enabled:!(null===r||void 0===r?void 0:r.user),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),a=(null===r||void 0===r?void 0:r.user)||(null===(e=t.data)||void 0===e?void 0:e.data);return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)("h2",{style:{fontSize:"1.75rem"},children:null===a||void 0===a?void 0:a.username}),Object(z.jsx)(J.a,{children:Object(z.jsxs)("tbody",{children:[Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Carnet de identidad"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.ci]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Nombre completo"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.nombreCompleto]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{className:"text-nowrap",scope:"row",style:{width:"1px"},children:"Nombre de usuario"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.username]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Estado"}),Object(z.jsxs)("td",{children:[": ",(null===a||void 0===a?void 0:a.estado)?"Activo":!1===(null===a||void 0===a?void 0:a.estado)?"Bloqueado":""]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Creado el"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.createdAt]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Actualizado el"}),Object(z.jsxs)("td",{children:[": ",null===a||void 0===a?void 0:a.updatedAt]})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Roles"}),Object(z.jsxs)("td",{className:"text-capitalize",children:[": ",null===a||void 0===a?void 0:a.roleNames]})]})]})}),a?Object(z.jsxs)(j.a.Row,{children:[Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsx)(x.a,{as:Z.b,to:{pathname:"/iam/usuarios/".concat(a.id,"/editar"),state:{user:a}},children:"Editar"})}),Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsx)(x.a,{variant:"danger",children:"Bloquear"})})]}):null]})},ce=n(598),se=function(){return A.apiClient.get("/permisos")},oe=function(e){var r,n=e.isInvalid,t=e.selected,a=void 0===t?[]:t,i=e.onChange,c=Object(E.a)("permisos.buscar",(function(){return se()}),{refetchOnWindowFocus:!1,refetchOnReconnect:!1}),s=(null===(r=c.data)||void 0===r?void 0:r.data)||[];return Object(z.jsx)("div",{className:n?"is-invalid":"",children:c.isFetching?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(p.a,{animation:"border",size:"sm"}),Object(z.jsx)("span",{children:"Cargando"})]}):c.isError?Object(z.jsxs)(b.a,{variant:"danger",children:["Ocurrio un error al obtener la lista de permisos. Haga clic ",Object(z.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),c.refetch()},children:"aqui"})," para volver a intentar"]}):Object(z.jsx)(V.a,{as:"ul",className:"overflow-auto flex-grow-1",style:{maxHeight:"12rem"},children:s.map((function(e,r){return Object(z.jsx)(V.a.Item,{as:"li",className:"py-2 px-3 text-capitalize"+(n?" border-danger":""),action:!0,children:Object(z.jsx)(j.a.Check,{type:"checkbox",isInvalid:n,label:e,checked:a.some((function(r){return r==e})),onChange:function(r){var n=r.target.checked;i&&i(n?[].concat(Object(G.a)(a),[e]):a.filter((function(r){return r!=e})))}})},e)}))})})},le=function(){var e,r,n,a,c,s=Object(t.useMemo)((function(){return Q.g().shape({name:Q.j().label("nombre").trim().required().max(50),description:Q.j().label("descripcion").trim().nullable().optional().max(250),permissions:Q.b().label("permisos").min(1)})}),[]),o=Object(f.h)({mode:"onBlur",resolver:Object(B.a)(s),defaultValues:{name:"",description:"",permissions:[]}}),l=o.handleSubmit,u=o.register,O=o.control,m=o.formState,A=o.reset,_=o.setError,I=Object(i.i)().id,S=Object(i.g)(),N=Object(t.useRef)(null),C=Object(v.b)(),L=Object(E.a)(["fetchRole",I],(function(){return D(parseInt(I))}),{enabled:!!I&&!(null===(e=S.location.state)||void 0===e?void 0:e.rol),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),U=Object(R.a)((function(e){return I?T(parseInt(I),{name:e.name,description:e.description,permissions:e.permissions}):P({name:e.name,description:e.description,permissions:e.permissions})}),{onSuccess:function(e){var r=e.data;C.invalidateQueries("roles.buscar"),S.replace("/iam/roles/".concat(r.id),{rol:r,ignoreAuthorization:!0})},onError:function(e){var r,n;422!==(null===(r=e.response)||void 0===r?void 0:r.status)&&(null===(n=N.current)||void 0===n||n.show(!0))}}),w=(null===(r=L.data)||void 0===r?void 0:r.data)||(null===(n=S.location.state)||void 0===n?void 0:n.rol),y=m.errors;Object(t.useEffect)((function(){w&&A({name:w.name,description:w.description,permissions:w.permissionNames})}),[w]),Object(t.useEffect)((function(){var e;L.isFetching&&(null===(e=N.current)||void 0===e||e.show(!0))}),[L.isFetching]),Object(t.useEffect)((function(){if(U.error){var e,r=U.error;if(422==(null===(e=r.response)||void 0===e?void 0:e.status)){var n=r.response.data.errors;n.name&&_("name",{message:n.name}),n.description&&_("description",{message:n.description}),n.permissions&&_("permissions",{message:n.permissions})}}}),[U.error]),console.log("Guardar State",y);return Object(z.jsx)(z.Fragment,{children:Object(z.jsxs)(j.a,{noValidate:!0,validated:m.isValid,onSubmit:l((function(e){U.mutate(e)})),children:[Object(z.jsx)("h1",{style:{fontSize:"2rem"},children:"Roles"}),Object(z.jsxs)(g.b,{ref:N,children:[Object(z.jsx)(ce.a.Header,{children:L.isFetching?"Cargando":L.isError||U.isError?"Error":null}),Object(z.jsx)(ce.a.Body,{children:function(){return L.isFetching?Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(p.a,{animation:"border",size:"sm"}),Object(z.jsx)("span",{className:"ml-2",children:"Espere un momento"})]}):L.isError||U.isError?Object(z.jsx)(b.a,{variant:"danger",children:404==(null===(e=L.error)||void 0===e||null===(r=e.response)||void 0===r?void 0:r.status)?"El rol no existe":"Ocurrio un error mientras se cargaban los datos del rol"}):null;var e,r}()})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Nombre"}),Object(z.jsx)(j.a.Control,Object(d.a)({isInvalid:!!m.errors.name},u("name"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(a=y.name)||void 0===a?void 0:a.message})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Descripcion"}),Object(z.jsx)(j.a.Control,Object(d.a)({as:"textarea",isInvalid:!!y.description},u("description"))),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(c=y.description)||void 0===c?void 0:c.message})]}),Object(z.jsxs)(j.a.Group,{children:[Object(z.jsx)(j.a.Label,{children:"Permisos"}),Object(z.jsx)(f.a,{name:"permissions",control:O,render:function(e){var r,n=e.field,t=e.fieldState;return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(oe,{isInvalid:!!t.error,onChange:n.onChange,selected:n.value}),Object(z.jsx)(j.a.Control.Feedback,{type:"invalid",children:null===(r=t.error)||void 0===r?void 0:r.message})]})}})]}),Object(z.jsx)(j.a.Row,{children:Object(z.jsx)(h.a,{children:Object(z.jsxs)(x.a,{type:"submit",children:[U.isLoading?Object(z.jsx)(p.a,{animation:"border",className:"mr-2",size:"sm"}):null,Object(z.jsx)("span",{className:"align-middle",children:"Registrar"})]})})})]})})},de=function(e){var r=Object(f.h)(),n=r.register,t=r.handleSubmit;return Object(z.jsx)(j.a,{onSubmit:t((function(r){var n=r.texto;e.onSearch(n)})),children:Object(z.jsxs)(j.a.Row,{className:"flex-nowrap",children:[Object(z.jsxs)(h.a,{children:[Object(z.jsx)(j.a.Label,{htmlFor:"texto",srOnly:!0,children:"Texto"}),Object(z.jsx)(j.a.Control,Object(d.a)({type:"search",id:"texto",style:{minWidth:"10rem"}},n("texto")))]}),Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsx)(x.a,{className:"ml-2",type:"submit",children:Object(z.jsx)(c.i,{})})})]})})},ue={index:function(e){return e.canAny([q.a.VER_ROLES,q.a.REGISTRAR_ROLES])},register:function(e){return e.canAny([q.a.REGISTRAR_ROLES])},edit:function(e){return e.canAny([q.a.EDITAR_ROLES])},view:function(e){return e.canAny([q.a.VER_ROLES])},delete:function(e){return e.canAny([q.a.ELIMINAR_ROLES])}},je=function(e){var r=e.rol,n=e.queryKey,a=Object(ne.b)("queryLoader"),i=Object(v.b)(),c=Object(R.a)((function(e){return M(e)}),{onSuccess:function(){a.close(),i.invalidateQueries("roles.buscar",{inactive:!0}),i.setQueryData(n,(function(e){return Object(d.a)(Object(d.a)({},e),{},{data:Object(d.a)(Object(d.a)({},e.data),{},{records:e.data.records.filter((function(e){return e!==r}))})})}))}});return Object(t.useEffect)((function(){"loading"==c.status?a.open({state:"loading"}):"error"==c.status&&a.open({state:"error",error:c.error})}),[c.status]),Object(z.jsxs)(re.a,{style:{position:"initial"},children:[Object(z.jsx)(re.a.Toggle,{as:g.j,variant:"link",id:"dropdown-roles-".concat(r.id)}),Object(z.jsxs)(re.a.Menu,{children:[Object(z.jsx)(o.b,{authorize:ue.view,children:Object(z.jsx)(re.a.Item,{as:Z.b,to:{pathname:"/iam/roles/".concat(r.id),state:{rol:r}},children:"Ver"})}),Object(z.jsx)(o.b,{authorize:ue.edit,children:Object(z.jsx)(re.a.Item,{as:Z.b,to:{pathname:"/iam/roles/".concat(r.id,"/editar"),state:{rol:r}},children:"Editar"})}),Object(z.jsx)(o.b,{authorize:ue.delete,children:Object(z.jsx)(re.a.Item,{className:"text-danger",onClick:function(){window.confirm("Esta accion es irreversible, \xbfEsta seguro de continuar?")&&c.mutate(r.id)},children:"Eliminar"})})]})]})},be=function(){var e=Object(l.a)(),r=Object(t.useState)(0),n=Object(u.a)(r,2),a=n[0],i=n[1],s=Object(t.useState)({current:1,size:10}),b=Object(u.a)(s,2),O=b[0],m=b[1],f=Object(t.useState)({}),v=Object(u.a)(f,2),R=v[0],A=v[1],_=["roles.buscar",O,R],I=Object(E.a)(_,(function(){return y(R,O)}),{enabled:ue.view(e),refetchOnReconnect:!1,refetchOnWindowFocus:!1,onSuccess:function(e){var r=e.data.meta;i(r.total)}});return Object(z.jsxs)("div",{className:"px-1",children:[Object(z.jsx)("h2",{style:{fontSize:"1.75rem"},children:"Roles"}),Object(z.jsx)("div",{className:"d-flex my-2",children:Object(z.jsx)($.a,{className:"ml-auto flex-nowrap",children:Object(z.jsx)(o.b,{authorize:ue.register,children:Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsxs)(x.a,{as:Z.b,to:"/iam/roles/registrar",className:"d-flex align-items-center",children:[Object(z.jsx)(c.g,{className:"mr-2"}),"Nuevo"]})})})})}),Object(z.jsxs)(o.b,{authorize:ue.view,children:[Object(z.jsxs)($.a,{children:[Object(z.jsx)(h.a,{className:"mb-2",children:Object(z.jsx)(de,{onSearch:function(e){A({texto:e})}})}),Object(z.jsx)(h.a,{className:"mb-2",xs:"auto",children:Object(z.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(z.jsx)("span",{children:"Mostrar"}),Object(z.jsxs)(j.a.Control,{className:"mx-2",as:"select",value:O.size,onChange:function(e){var r=e.target.value;m((function(e){return{current:1,size:parseInt(r)}}))},children:[Object(z.jsx)("option",{value:10,children:"10"}),Object(z.jsx)("option",{value:20,children:"20"}),Object(z.jsx)("option",{value:30,children:"30"}),Object(z.jsx)("option",{value:50,children:"50"}),Object(z.jsx)("option",{value:100,children:"100"})]}),Object(z.jsx)("span",{children:"filas"})]})})]}),Object(z.jsxs)(J.a,{responsive:!0,children:[Object(z.jsx)("thead",{children:Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{style:{width:1},children:"#"}),Object(z.jsx)("th",{children:"Nombre"}),Object(z.jsx)("th",{children:"Descripcion"}),Object(z.jsx)("th",{style:{width:1}})]})}),Object(z.jsx)("tbody",{children:function(){if(I.isFetching)return Object(z.jsx)("tr",{children:Object(z.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(z.jsx)(p.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(I.isError){var e,r,n=I.error;return Object(z.jsx)("tr",{children:Object(z.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=n.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||n.message})})}if(I.data){var t=I.data.data.records;return 0==t.length?Object(z.jsx)("tr",{children:Object(z.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):t.map((function(e,r){return Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{children:r+1}),Object(z.jsx)("td",{className:"text-capitalize",children:e.name}),Object(z.jsx)("td",{children:e.description}),Object(z.jsx)("td",{children:Object(z.jsx)(je,{rol:e,queryKey:_})})]},e.id)}))}}()})]}),Object(z.jsxs)("div",{className:"row",children:[Object(z.jsx)(h.a,{children:Object(z.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(a," resultados")})}),Object(z.jsx)(h.a,{children:Object(z.jsx)(g.f,{current:O.current,total:Math.ceil((a-O.size)/O.size)+1,onChange:function(e){return m((function(r){return Object(d.a)(Object(d.a)({},r),{},{current:e})}))}})})]})]})]})},Oe=function(){var e,r=Object(i.h)(),n=(r.pathname,r.state),a=Object(i.i)().id,c=Object(ne.b)("queryLoader"),s=Object(E.a)(["cargar",a],(function(){return D(parseInt(a))}),{enabled:!(null===n||void 0===n?void 0:n.rol),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,onSuccess:function(){c.close()},onError:function(e){c.open({state:"error",error:e})}}),o=Object(R.a)((function(){return M(parseInt(a))}),{onSuccess:function(){c.close()},onError:function(e){c.open({state:e,error:e})}}),l=(null===(e=s.data)||void 0===e?void 0:e.data)||(null===n||void 0===n?void 0:n.rol);return Object(t.useEffect)((function(){s.isFetching&&c.open({state:"loading"})}),[s.isFetching]),Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)("h2",{style:{fontSize:"1.75rem"},children:null===l||void 0===l?void 0:l.name}),Object(z.jsx)(J.a,{children:Object(z.jsxs)("tbody",{children:[Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",style:{width:"1px"},children:"Nombre"}),Object(z.jsx)("td",{className:"text-capitalize",children:null===l||void 0===l?void 0:l.name})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{className:"text-nowrap",scope:"row",children:"Descripci\xf3n"}),Object(z.jsx)("td",{className:(null===l||void 0===l?void 0:l.description)?"":"bg-light",children:(null===l||void 0===l?void 0:l.description)||"Sin descripci\xf3n"})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Fecha de creaci\xf3n"}),Object(z.jsx)("td",{children:null===l||void 0===l?void 0:l.createdAt})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Fecha de actualizaci\xf3n"}),Object(z.jsx)("td",{children:null===l||void 0===l?void 0:l.updatedAt})]}),Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{scope:"row",children:"Permisos"}),Object(z.jsx)("td",{className:"d-flex ".concat((null===l||void 0===l?void 0:l.permissionNames.length)?"":"bg-light"),children:(null===l||void 0===l?void 0:l.permissionNames.length)?Object(z.jsx)("ul",{className:"d-inline-block",children:null===l||void 0===l?void 0:l.permissionNames.map((function(e,r){return Object(z.jsx)("li",{className:"text-capitalize",children:e},r)}))}):"No se agregaron permisos"})]})]})}),l?Object(z.jsxs)(j.a.Row,{children:[Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsx)(x.a,{as:Z.b,to:{pathname:"/iam/roles/".concat(l.id,"/editar"),state:{rol:l}},children:"Editar"})}),Object(z.jsx)(h.a,{xs:"auto",children:Object(z.jsxs)(x.a,{variant:"danger",onClick:function(){c.open({state:"loading"}),o.mutate()},children:[o.isLoading?Object(z.jsx)(p.a,{className:"mr-2",animation:"border",size:"sm"}):null,"Eliminar"]})})]}):null]})},me=n(615),he=function(){var e=Object(i.j)().url,r=Object(l.a)(),n=Object(t.useMemo)((function(){var n=[];return Y.index(r)&&n.push({id:"users",icon:Object(z.jsx)(c.p,{}),path:"".concat(e,"/usuarios"),title:"Usuarios"}),ue.index(r)&&n.push({id:"roles",icon:Object(z.jsx)(c.k,{}),path:"".concat(e,"/roles"),title:"Roles"}),n}),[r]);return Object(z.jsx)(s.a,{sidebar:{header:Object(z.jsx)("div",{className:"d-flex justify-content-center",children:Object(z.jsx)(me.a,{src:"/logo-lg.png"})}),items:n},children:Object(z.jsxs)(i.d,{children:[Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios"),authorize:Y.index,children:Object(z.jsx)(ae,{})}),Object(z.jsx)(o.c,{exact:!0,path:["".concat(e,"/usuarios/registrar"),"".concat(e,"/usuarios/:id/editar")],authorize:function(r,n){return n=="".concat(e,"/usuarios/registrar")?Y.register(r):Y.edit(r)},children:Object(z.jsx)(K,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios/:id/cambiar-contrasena"),authorize:Y.changePassword,children:Object(z.jsx)(H,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios/cambiar-contrasena"),children:Object(z.jsx)(H,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/usuarios/:id"),authorize:Y.view,children:Object(z.jsx)(ie,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/roles"),authorize:ue.index,children:Object(z.jsx)(be,{})}),Object(z.jsx)(o.c,{exact:!0,path:["".concat(e,"/roles/registrar"),"".concat(e,"/roles/:id/editar")],authorize:function(r,n){return n=="".concat(e,"/roles/registrar")?ue.register(r):ue.edit(r)},children:Object(z.jsx)(le,{})}),Object(z.jsx)(o.c,{exact:!0,path:"".concat(e,"/roles/:id"),authorize:ue.view,children:Object(z.jsx)(Oe,{})})]})})};r.default=he}}]);
//# sourceMappingURL=4.5774f9f8.chunk.js.map