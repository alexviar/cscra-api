{"version":3,"sources":["commons/auth/constants/Permisos.ts","commons/components/layouts/SidebarLayout.tsx","apps/clinica/mora/services/EmpleadorService.ts","apps/clinica/mora/services/ListaMoraService.ts","apps/clinica/mora/components/ListaMoraFilterForm.tsx","apps/clinica/mora/policies/index.ts","apps/clinica/mora/components/RowOptions.tsx","apps/clinica/mora/components/ListaMoraIndex.tsx","apps/clinica/mora/components/ListaMoraItemForm.tsx","commons/components/icons/FcDebt.tsx","apps/clinica/solicitud_atencion_externa/services/SolicitudesAtencionExternaService.ts","apps/clinica/solicitud_atencion_externa/components/SolicitudAtencionExternaFilterForm.tsx","apps/clinica/solicitud_atencion_externa/components/Dm11Viewer.tsx","apps/clinica/solicitud_atencion_externa/components/RowOptions.tsx","apps/clinica/solicitud_atencion_externa/policies/index.ts","apps/clinica/solicitud_atencion_externa/components/SolicitudAtencionExternaIndex.tsx","apps/clinica/solicitud_atencion_externa/utils/EstadosAfi.ts","apps/clinica/solicitud_atencion_externa/utils/EstadosEmp.ts","apps/clinica/solicitud_atencion_externa/components/AseguradoChooser.tsx","commons/utils/nombreCompleto.ts","apps/clinica/solicitud_atencion_externa/services/AseguradosService.ts","apps/clinica/solicitud_atencion_externa/components/AseguradoCard.tsx","apps/clinica/medicos/services/MedicoService.ts","apps/clinica/solicitud_atencion_externa/services/ProveedoresService.ts","apps/clinica/solicitud_atencion_externa/services/PrestacionesService.ts","apps/clinica/solicitud_atencion_externa/components/MedicosTypeahead.tsx","apps/clinica/solicitud_atencion_externa/components/PrestacionesTypeahead.tsx","apps/clinica/solicitud_atencion_externa/components/ProveedoresTypeahead.tsx","apps/clinica/solicitud_atencion_externa/components/PrestacionesSolicitadasCard.tsx","apps/clinica/solicitud_atencion_externa/components/SolicitudAtencionExternaForm.tsx","apps/clinica/especialidades/services/EspecialidadesServices.ts","apps/clinica/especialidades/components/EspecialidadesFilter.tsx","apps/clinica/especialidades/components/ImportarForm.tsx","apps/clinica/especialidades/components/EspecialidadesIndex.tsx","apps/clinica/especialidades/components/EspecialidadForm.tsx","commons/components/ImportModal.tsx","apps/clinica/prestaciones/services/PrestacionesService.ts","apps/clinica/prestaciones/componentes/PrestacionesFilterForm.tsx","apps/clinica/prestaciones/componentes/PrestacionesIndex.tsx","apps/clinica/prestaciones/componentes/PrestacionForm.tsx","apps/clinica/medicos/policies/index.ts","apps/clinica/medicos/components/MedicosFilterForm.tsx","apps/clinica/medicos/components/RowOptions.tsx","apps/clinica/medicos/components/MedicosIndex.tsx","apps/clinica/medicos/components/EspecialidadesTypeahead.tsx","apps/clinica/medicos/components/MedicosForm.tsx","apps/clinica/proveedores/policies/index.ts","apps/clinica/proveedores/services/ProveedoresService.ts","apps/clinica/proveedores/services/ContratosService.ts","apps/clinica/proveedores/components/ProveedoresFilterForm.tsx","apps/clinica/proveedores/components/RowOptions.tsx","apps/clinica/proveedores/components/ProveedoresIndex.tsx","apps/clinica/proveedores/components/ProveedorView.tsx","apps/clinica/proveedores/components/ProveedorEmpresaForm.tsx","apps/clinica/proveedores/components/ProveedorMedicoForm.tsx","apps/clinica/proveedores/components/ProveedorForm.tsx","apps/clinica/proveedores/components/ContactoForm.tsx","apps/clinica/proveedores/components/PrestacionesContratadasControl.tsx","apps/clinica/proveedores/components/ContratoForm.tsx","apps/clinica/proveedores/components/ProveedorWizard.tsx","apps/clinica/ClinicaApp.tsx"],"names":["VER_SOLICITUDES_DE_ATENCION_EXTERNA","VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL","VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR","REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA","REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL","EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA","EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL","EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR","VER_USUARIOS","VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","REGISTRAR_USUARIOS","REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","EDITAR_USUARIOS","EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","BLOQUEAR_USUARIOS","BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","DESBLOQUEAR_USUARIOS","DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","CAMBIAR_CONTRASEÑA","CAMBIAR_CONTRASEÑA_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","VER_ROLES","REGISTRAR_ROLES","EDITAR_ROLES","ELIMINAR_ROLES","VER_LISTA_DE_MORA","VER_LISTA_DE_MORA_REGIONAL","AGREGAR_EMPLEADOR_EN_MORA","AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL","QUITAR_EMPLEADOR_EN_MORA","QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL","VER_MEDICOS","VER_MEDICOS_REGIONAL","REGISTRAR_MEDICOS","REGISTRAR_MEDICOS_REGIONAL","EDITAR_MEDICOS","EDITAR_MEDICOS_REGIONAL","BAJA_MEDICOS","BAJA_MEDICOS_REGIONAL","VER_PROVEEDORES","VER_PROVEEDORES_REGIONAL","REGISTRAR_PROVEEDORES","REGISTRAR_PROVEEDORES_REGIONAL","EDITAR_PROVEEDORES","EDITAR_PROVEEDORES_REGIONAL","REGISTRAR_CONTRATO_PROVEEDOR","REGISTRAR_CONTRATO_PROVEEDOR_REGIONAL","BAJA_PROVEEDORES","BAJA_PROVEEDORES_REGIONAL","VER_ESPECIALIDADES","REGISTRAR_ESPECIALIDADES","EDITAR_ESPECIALIDADES","ELIMINAR_ESPECIALIDADES","IMPORTAR_ESPECIALIDADES","VER_PRESTACIONES","REGISTRAR_PRESTACIONES","EDITAR_PRESTACIONES","ELIMINAR_PRESTACIONES","IMPORTAR_PRESTACIONES","SidebarLayout","sidebar","children","showSidebar","useSelector","state","main","useRouteMatch","path","url","className","id","EmpleadorService","numeroPatronal","apiClient","get","params","numero_patronal","ListaMoraService","filter","page","keysToUnderscore","idEmpleador","post","empleador_id","console","log","ListaMoraFilterForm","props","ListaMoraPolicy","index","user","canAny","Permisos","view","agregar","quitar","RowOptions","item","modal","useModal","queryClient","useQueryClient","useMutation","empleadorId","onSuccess","close","setQueryData","oldData","data","records","i","useEffect","status","open","error","Dropdown","Toggle","as","VerticalEllipsisDropdownToggle","variant","Menu","authorize","Item","href","onClick","window","confirm","mutate","useState","current","size","setPage","loggedUser","useLoggedUser","can","regionalId","setFilter","showFilterForm","buscar","useQuery","enabled","refetchOnMount","refetchOnWindowFocus","refetchOnReconnect","total","meta","didMountRef","useRef","refetch","style","fontSize","Form","Row","Col","xs","Button","visible","Link","to","onApply","Control","value","onChange","e","target","parseInt","Table","responsive","width","isFetching","colSpan","Spinner","animation","isError","response","message","map","lineHeight","nombre","renderRows","Math","ceil","schema","yup","shape","label","trim","uppercase","required","useForm","mode","resolver","yupResolver","defaultValues","handleSubmit","register","watch","setError","clearErrors","setValue","trigger","reset","formState","formErrors","errors","history","useHistory","buscarEmpleador","guardar","invalidateQueries","replace","type","onSubmit","isSuccess","Alert","guardarError","renderAlert","Group","sm","Label","InputGroup","hasValidation","isInvalid","Append","then","valid","Feedback","readOnly","isLoading","FcDebt","GenIcon","SolicitudesAtencionExternaService","regional_id","asegurado_id","medico_id","proveedor_id","prestaciones_solicitadas","SolicitudAtencionExternaFilterForm","Dm11Viewer","centered","show","onHide","Header","Body","solicitud","urlDm11","SolicitudATPolicy","emit","SolicitudAtencionExternaIndex","useLocation","pathname","setTotal","getDefaultFilter","registradoPor","ProtectedContent","onFilter","length","numero","fecha","asegurado","matricula","medico","proveedor","EstadosAfi","1","2","EstadosEmp","3","AseguradoChooser","forwardRef","ref","asegurados","ImperativeModal","Modal","title","scope","matriculaComplemento","apellidoPaterno","apellidoMaterno","nombres","estado","onSelect","AseguradosService","include","AseguradoCard","useFormContext","control","useWatch","name","aseguradoChooserRef","empleador","titular","tipo","baja","regDate","fechaValidezSeguro","fechaExtincion","fecha_baja","aportes","dirtyFields","tieneBaja","fechaRegBaja","hasErrors","Card","Accordion","eventKey","Collapse","lg","md","htmlFor","FormControl","validate","afterDate","now","moment","isSameOrBefore","fechaBaja","MedicosService","ci","apellido_paterno","apellido_materno","especialidad_id","raiz","ci_complemento","complemento","put","ProveedorService","PrestacionesService","source","axios","CancelToken","promise","cancel","MedicosTypeahead","feedback","filterBy","onLoad","options","useMemo","Array","isArray","text","isMatch","nombreCompleto","especialidad","labelKey","minLength","renderMenuItemChildren","PrestacionesTypeahead","prestacion","ProveedoresTypeahead","activos","subtitle","PrestacionesSolicitadasCard","count","setCount","proveedoresTypeaheadController","useController","useFieldArray","fields","append","remove","prestacionesSolicitadas","overflow","prestacionSolicitada","render","field","fieldState","contrato","prestaciones","some","pc","ps","selected","onBlur","every","nota","hoy","estadoAfiSchema","oneOf","Object","values","test","context","parent","createError","date","validezSchema","matches","nullable","notRequired","min","toDate","when","is","subtract","regional","of","max","SolicitudAtencionExternaForm","formMethods","dm11Viewer","registrar","prestacion_id","registrarError","keys","forEach","key","localKey","defaultActiveKey","EspecialidadesService","undefined","delete","archivo","separador","formato","formData","FormData","headers","EspecialidadesFilter","onSearch","srOnly","minWidth","ImportarForm","modalRef","setVisible","formatoSaltoLinea","aggrement","importFile","vars","column","File","rules","maxLength","Check","inline","Footer","form","EspecialidadesIndex","importModalRef","eliminar","ButtonGroup","split","Pagination","EspecialidadForm","useParams","continueRef","location","cargar","inputs","renderBody","ImportModal","importar","file","import","separator","format","PrestacionesFilterForm","PrestacionesIndex","buscarPrestaciones","PrestacionForm","verPrestacion","MedicoPolicy","edit","MedicosFilterForm","cambiarEstado","MedicosIndex","ciText","estadoText","EspecialidadesTypeahead","typeError","ciComplemento","transform","MedicosForm","regionales","setRegionales","especialidades","setEspecialidades","ignoreAuthorization","onError","String","r","especialidadId","ProveedorPolicy","ProveedoresService","infoContacto","ContratosService","proveedorId","ProveedoresFilterForm","ProveedoresIndex","ProveedorView","locationState","loader","tipoId","nit","renderGeneralInfo","emptyStringTo","ProveedorEmpresaForm","emptyStringToNull","ProveedorMedicoForm","align","ProveedorForm","setTipo","disabled","checked","municipio","direccion","ubicacion","telefono1","telefono2","ContactoForm","departamentos","setDepartamentos","provincias","setProvincias","municipios","setMunicipios","departamento","provincia","lat","lng","municipioId","latitud","longitud","m","p","provinciaId","d","departamentoId","center","PrestacionesContratadasControl","inicio","fin","ContratoForm","idProveedor","methods","prestacion_ids","GeneralInfoStep","nextStep","ContactInfoStep","previousStep","ContractInfoStep","FinishStep","generalInfo","contactInfo","contractInfo","contacto","general","toISOString","prestacionIds","push","ProveedorWizard","setGeneralInfo","setContactInfo","setContractInfo","ClinicaApp","sidebarItems","items","icon","exact","ListaMoraItemForm","ListaMoraIndex"],"mappings":"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","file":"static/js/5.230279bb.chunk.js","sourcesContent":["/**\r\n * Permisos de solicitud de transferencia externa\r\n */\r\nexport const VER_SOLICITUDES_DE_ATENCION_EXTERNA = \"Ver solicitudes de atencion externa\";\r\nexport const VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL = \"Ver solicitudes de atencion externa (misma regional)\";\r\nexport const VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR = \"Ver solicitudes de atencion externa (registrado por)\";\r\nexport const REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA = \"Registrar solicitudes de atencion externa\";\r\nexport const REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL = \"Registrar solicitudes de atencion externa (misma regional)\";\r\n// export const REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR = \"Registrar solicitudes de atencion externa (registrado por)\";\r\nexport const EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA = \"Emitir solicitudes de atencion externa\";\r\nexport const EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL = \"Emitir solicitudes de atencion externa (misma regional)\";\r\nexport const EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR = \"Emitir solicitudes de atencion externa (registrado por)\";\r\n  \r\n/**\r\n * Permisos de usuarios\r\n */\r\nexport const VER_USUARIOS = \"Ver usuarios\";\r\nexport const VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Ver usuarios (misma regional)\";\r\nexport const REGISTRAR_USUARIOS = \"Registrar usuarios\";\r\nexport const REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Registrar usuarios (misma regional)\";\r\nexport const EDITAR_USUARIOS = \"Editar usuarios\";\r\nexport const EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Editar usuarios (misma regional)\";\r\nexport const BLOQUEAR_USUARIOS = \"Bloquear usuarios\";\r\nexport const BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Bloquear usuarios (misma regional)\";\r\nexport const DESBLOQUEAR_USUARIOS = \"Desbloquear usuarios\";\r\nexport const DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Desbloquear usuarios (misma regional)\";\r\nexport const CAMBIAR_CONTRASEÑA = \"Cambiar contraseña\";\r\nexport const CAMBIAR_CONTRASEÑA_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Cambiar contraseña (misma regional)\";\r\n\r\n/**\r\n * Permisos de roles\r\n */\r\nexport const VER_ROLES = \"Ver roles\";\r\nexport const REGISTRAR_ROLES = \"Registrar roles\";\r\nexport const EDITAR_ROLES = \"Editar roles\";\r\nexport const ELIMINAR_ROLES = \"Eliminar roles\";\r\n\r\n\r\n/**\r\n * Permisos de lista de mora\r\n */\r\nexport const VER_LISTA_DE_MORA = \"Ver lista de mora\"\r\nexport const VER_LISTA_DE_MORA_REGIONAL = \"Ver lista de mora (regional)\"\r\nexport const AGREGAR_EMPLEADOR_EN_MORA = \"Agregar empleador en mora\";\r\nexport const AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL = \"Agregar empleador en mora (misma regional)\";\r\nexport const QUITAR_EMPLEADOR_EN_MORA = \"Quitar empleador en mora\";\r\nexport const QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL = \"Quitar empleador en mora (misma regional)\";\r\n\r\n\r\n\r\n/**\r\n * Medicos\r\n */\r\nexport const VER_MEDICOS = \"Ver médicos\";\r\nexport const VER_MEDICOS_REGIONAL = \"Ver médicos (regional)\";\r\nexport const REGISTRAR_MEDICOS = \"Registrar médicos\";\r\nexport const REGISTRAR_MEDICOS_REGIONAL = \"Registrar médicos (regional)\";\r\nexport const EDITAR_MEDICOS = \"Editar médicos\";\r\nexport const EDITAR_MEDICOS_REGIONAL = \"Editar médicos (regional)\";\r\nexport const BAJA_MEDICOS = \"Baja médicos\";\r\nexport const BAJA_MEDICOS_REGIONAL = \"Baja médicos (regional)\";\r\n\r\n/**\r\n* Proveedores\r\n*/\r\nexport const VER_PROVEEDORES = \"Ver proveedores\";\r\nexport const VER_PROVEEDORES_REGIONAL = \"Ver proveedores (regional)\";\r\nexport const REGISTRAR_PROVEEDORES = \"Registrar proveedores\";\r\nexport const REGISTRAR_PROVEEDORES_REGIONAL = \"Registrar proveedores (regional)\";\r\nexport const EDITAR_PROVEEDORES = \"Editar proveedores\";\r\nexport const EDITAR_PROVEEDORES_REGIONAL = \"Editar proveedores (regional)\";\r\nexport const REGISTRAR_CONTRATO_PROVEEDOR = \"Registrar contratos de preveedores\";\r\nexport const REGISTRAR_CONTRATO_PROVEEDOR_REGIONAL = \"Registrar contratos de preveedores (regional)\";\r\nexport const BAJA_PROVEEDORES = \"Baja proveedores\";\r\nexport const BAJA_PROVEEDORES_REGIONAL = \"Baja proveedores (regional)\";\r\n\r\n/**\r\n* Especialidades\r\n*/\r\nexport const VER_ESPECIALIDADES = \"Ver especialidades\";\r\nexport const REGISTRAR_ESPECIALIDADES = \"Registrar especialidades\";\r\nexport const EDITAR_ESPECIALIDADES = \"Editar especialidades\";\r\nexport const ELIMINAR_ESPECIALIDADES = \"Eliminar especialidades\";\r\nexport const IMPORTAR_ESPECIALIDADES = \"Importar especialidades\";\r\n\r\n/**\r\n* Prestaciones\r\n*/\r\nexport const VER_PRESTACIONES = \"Ver prestaciones\";\r\nexport const REGISTRAR_PRESTACIONES = \"Registrar prestaciones\";\r\nexport const EDITAR_PRESTACIONES = \"Editar prestaciones\";\r\nexport const ELIMINAR_PRESTACIONES = \"Eliminar prestaciones\";\r\nexport const IMPORTAR_PRESTACIONES = \"Importar prestaciones\";","import React from 'react'\r\nimport { Container } from 'react-bootstrap'\r\nimport { useSelector } from 'react-redux'\r\nimport { useRouteMatch, Switch, Route, Redirect } from 'react-router-dom'\r\nimport { Sidebar, SidebarProps } from '../Sidebar'\r\nimport \"./simple-sidebar.css\"\r\n\r\ntype Props = {\r\n  sidebar: SidebarProps\r\n  children: React.ReactNode\r\n}\r\nexport const SidebarLayout = ({sidebar, children}: Props)=>{\r\n  const showSidebar = useSelector((state:any)=>state.main.showSidebar)\r\n  const { path, url } = useRouteMatch()\r\n  \r\n  return <div className={\"position-relative d-flex flex-grow-1 bg-light\" + (showSidebar ? \"\" : \" toggled\")}  id=\"wrapper\">\r\n    <Sidebar className=\"bg-white shadow-sm\" {...sidebar}/>\r\n    <Container className=\"d-flex flex-column flex-grow-1\">\r\n      {/* <Switch>\r\n        <Route exact path={path}>\r\n            <Redirect to={`${path}/organizacion`} />\r\n        </Route>\r\n        <Route  path={`${path}/organizacion`}><Organization /></Route>\r\n        <Route  path={`${path}/empleados/registrar`}><EmployeeForm /></Route>\r\n        <Route  exact path={`${path}/empleados`}><EmployeesList /></Route>\r\n      </Switch> */}\r\n      <div className=\"d-flex flex-column bg-white rounded-lg shadow-sm m-2 p-3 flex-grow-1\">\r\n        {children}\r\n      </div>\r\n    </Container>\r\n  </div>\r\n}\r\n\r\nexport default SidebarLayout","import apiClient from \"../../../../commons/services/apiClient\"\r\n\r\ntype Empleador = {\r\n  id: number,\r\n  numeroPatronal: string,\r\n  nombre: string\r\n}\r\n\r\nexport const EmpleadorService = {\r\n  buscarPorPatronal: (numeroPatronal: string) => {\r\n    return apiClient.get<Empleador>(\"empleadores/buscar-por-patronal\", {\r\n      params: {\r\n        numero_patronal: numeroPatronal\r\n      }\r\n    })\r\n  }\r\n}","import { apiClient, Page, PaginatedResponse} from \"../../../../commons/services\"\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type ListaMoraFilter = {\r\n  numeroPatronal?: string,\r\n  nombre?: string,\r\n  nit?: number,\r\n  regionalId?: number\r\n}\r\n\r\nexport type ListaMoraItem = {\r\n  id: number,\r\n  empleadorId: number,\r\n  numeroPatronal: string,\r\n  nombre: string\r\n}\r\n\r\nexport const ListaMoraService = {\r\n  buscar: (filter: ListaMoraFilter, page: Page)=>{\r\n    return apiClient.get<PaginatedResponse<ListaMoraItem>>(\"/lista-mora\", {\r\n      params: keysToUnderscore({\r\n        page, filter\r\n      })\r\n    })\r\n  },\r\n  agregar: (idEmpleador: number) =>{\r\n    return apiClient.post<ListaMoraItem>(\"lista-mora/agregar\", {\r\n      empleador_id: idEmpleador\r\n    })\r\n  },\r\n  quitar: (idEmpleador: number) =>{\r\n    console.log(idEmpleador)\r\n    return apiClient.post<ListaMoraItem>(\"lista-mora/quitar\", {\r\n      empleador_id: idEmpleador\r\n    })\r\n  }\r\n}","import React from \"react\"\r\nimport { ListaMoraFilter as Filter } from \"../services\"\r\n\r\ntype Props = {\r\n  onApply: (filter: Filter) => void\r\n}\r\n\r\nexport const ListaMoraFilterForm = (props: Props)=>{\r\n  return null\r\n}","import { Permisos } from \"../../../../commons/auth/constants\";\r\nimport { useLoggedUser } from \"../../../../commons/auth/hooks\";\r\n\r\nexport const ListaMoraPolicy = {\r\n  index: (user: ReturnType<typeof useLoggedUser>) => {\r\n    return user.canAny([\r\n      Permisos.VER_LISTA_DE_MORA,\r\n      Permisos.VER_LISTA_DE_MORA_REGIONAL,\r\n      Permisos.AGREGAR_EMPLEADOR_EN_MORA,\r\n      Permisos.AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n  view: (user: ReturnType<typeof useLoggedUser>) => {\r\n    return user.canAny([\r\n      Permisos.VER_LISTA_DE_MORA,\r\n      Permisos.VER_LISTA_DE_MORA_REGIONAL\r\n    ])\r\n  },\r\n  agregar: (user: ReturnType<typeof useLoggedUser>) => {\r\n    return user.canAny([\r\n      Permisos.AGREGAR_EMPLEADOR_EN_MORA,\r\n      Permisos.AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n  quitar: (user: ReturnType<typeof useLoggedUser>) => {\r\n    return user.canAny([\r\n      Permisos.QUITAR_EMPLEADOR_EN_MORA,\r\n      Permisos.QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n}","import { useEffect } from \"react\"\r\nimport { Dropdown } from \"react-bootstrap\"\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { ListaMoraItem, ListaMoraService } from \"../services\"\r\nimport { ListaMoraPolicy } from \"../policies\"\r\n\r\ntype Props = {\r\n  item: ListaMoraItem\r\n}\r\nexport const RowOptions = ({item}: Props) => {\r\n\r\n  const modal = useModal<{\r\n    state: \"loading\" | \"error\"\r\n    error?: Error\r\n  }>(\"queryLoader\")\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const quitar = useMutation(()=>{\r\n    return ListaMoraService.quitar(item.empleadorId)\r\n  }, {\r\n    onSuccess: ()=>{\r\n      modal.close()\r\n      queryClient.setQueryData(\"listaMora.buscar\", (oldData: any) => {\r\n        console.log(oldData)\r\n        return {\r\n          ...oldData,\r\n          data: {\r\n            ...oldData.data,\r\n            records: oldData.data.records.filter((i: any)=>{\r\n              return i !== item\r\n            })\r\n          }\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(quitar.status == \"loading\"){\r\n      modal.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n    else if(quitar.status == \"error\"){\r\n      console.log(quitar.error)\r\n      modal.open({\r\n        state: \"error\",\r\n        error: quitar.error\r\n      })\r\n    }\r\n  }, [quitar.status])\r\n\r\n  return <Dropdown>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-${item.id}`}\r\n    />\r\n    \r\n    <Dropdown.Menu>\r\n      <ProtectedContent\r\n        authorize={ListaMoraPolicy.quitar}\r\n      >\r\n        <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n          if (window.confirm(\"¿Está seguro?\")) {\r\n            quitar.mutate()\r\n          }\r\n        }}>Quitar</Dropdown.Item>\r\n      </ProtectedContent>\r\n    </Dropdown.Menu>\r\n  </Dropdown>  \r\n}","import { AxiosError } from \"axios\"\r\nimport { useEffect, useRef, useState } from \"react\"\r\nimport { Button, Col, Form, Spinner, Table } from \"react-bootstrap\"\r\nimport { FaFilter, FaSync, FaPlus } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport {Pagination} from \"../../../../commons/components\"\r\nimport { useLoggedUser, ProtectedContent, Permisos } from \"../../../../commons/auth\"\r\nimport { ListaMoraService, ListaMoraFilter as Filter } from \"../services\"\r\nimport { ListaMoraFilterForm } from \"./ListaMoraFilterForm\"\r\nimport { RowOptions } from \"./RowOptions\"\r\nimport { ListaMoraPolicy } from \"../policies\"\r\n\r\nexport default () => {\r\n  const [page, setPage] = useState({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser();\r\n  \r\n  const getDefaultFilter = ()=>{\r\n    const filter: Filter = {}\r\n    if(!loggedUser.can(Permisos.VER_LISTA_DE_MORA)){\r\n      if(loggedUser.can(Permisos.VER_LISTA_DE_MORA_REGIONAL)){\r\n        filter.regionalId = loggedUser.regionalId;\r\n      }\r\n    }\r\n    return filter\r\n  }\r\n\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n\r\n  const [filterFormVisible, showFilterForm] = useState(false)\r\n\r\n  const queryKey = \"listaMora.buscar\"\r\n  const buscar = useQuery(queryKey, () => {\r\n    return ListaMoraService.buscar(filter, page)\r\n  }, {\r\n    enabled: ListaMoraPolicy.view(loggedUser),\r\n    refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const total = buscar.data?.data?.meta?.total || 0\r\n  \r\n  const didMountRef = useRef(false)\r\n  useEffect(()=>{\r\n    if(!didMountRef.current) {\r\n      didMountRef.current = true\r\n      return\r\n    }\r\n    if(ListaMoraPolicy.view(loggedUser)) buscar.refetch()\r\n  }, [page, filter, loggedUser])\r\n\r\n  const renderRows = () => {\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    else if (buscar.isError) {\r\n      const { error } = buscar\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {(error as AxiosError).response?.data?.message || (error as AxiosError).message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if(buscar.data){\r\n      const { records } = buscar.data.data\r\n      return records.map((item, index) => {\r\n        return <tr key={item.id}>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {index + 1}\r\n          </td>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {item.numeroPatronal}\r\n          </td>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {item.nombre}\r\n          </td>\r\n          <td>\r\n            <RowOptions item={item} />\r\n          </td>\r\n        </tr>\r\n      })\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h1 style={{ fontSize: \"1.75rem\" }}>Empleadores en mora</h1>\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\">\r\n        <ProtectedContent\r\n          authorize={ListaMoraPolicy.view}\r\n        >\r\n          <Col xs=\"auto\" >\r\n            <Button className=\"my-2\" onClick={() => {\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col xs=\"auto\" >\r\n            <Button className=\"my-2\" onClick={() => {\r\n              showFilterForm(visible => !visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={ListaMoraPolicy.agregar}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button as={Link}\r\n              to=\"/clinica/lista-mora/agregar\"\r\n              className=\"my-2\"\r\n            >\r\n              <FaPlus className=\"mr-1\" />\r\n              Agregar\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={ListaMoraPolicy.view}\r\n    >\r\n    <Form.Row className=\"mb-2\">\r\n      <Col>\r\n        <ListaMoraFilterForm\r\n          onApply={(filter) => {\r\n            setFilter(filter)\r\n          }}\r\n        />\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n          <span>Mostrar</span>\r\n          <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n            const value = e.target.value\r\n            setPage((page) => ({\r\n              ...page,\r\n              size: parseInt(value)\r\n            }))\r\n          }}>\r\n            <option value={10}>10</option>\r\n            <option value={20}>20</option>\r\n            <option value={30}>30</option>\r\n            <option value={50}>50</option>\r\n            <option value={100}>100</option>\r\n          </Form.Control>\r\n          <span>filas</span>\r\n        </div>\r\n      </Col>\r\n    </Form.Row>\r\n    <Table responsive className=\"text-nowrap\">\r\n      <thead>\r\n        <tr>\r\n          <th style={{ width: 1 }}>#</th>\r\n          <th style={{ width: 1 }}>Nº Patronal</th>\r\n          <th >Nombre</th>\r\n          <th style={{ width: 1 }}></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {renderRows()}\r\n      </tbody>\r\n    </Table>\r\n    {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    </ProtectedContent>\r\n  </div>\r\n}","import { AxiosError, AxiosResponse } from 'axios'\r\nimport { useEffect } from 'react'\r\nimport { Alert, Button, Col, Form, InputGroup, Spinner } from 'react-bootstrap'\r\nimport { useForm } from 'react-hook-form'\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { FaSearch } from 'react-icons/fa'\r\nimport { useMutation, useQuery, useQueryClient } from 'react-query'\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { EmpleadorService, ListaMoraItem, ListaMoraService } from '../services'\r\n\r\ntype Inputs = {\r\n  numeroPatronal: string,\r\n  nombre: string\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  numeroPatronal: yup.string().label(\"número patronal\").trim().uppercase().required(),\r\n  nombre: yup.string().required()\r\n})\r\n\r\nexport default ()=>{\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    watch,\r\n    setError,\r\n    clearErrors,\r\n    setValue,\r\n    reset,\r\n    trigger,\r\n    formState\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      nombre: \"\",\r\n      numeroPatronal: \"\"\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n  \r\n  console.log(\"Vlues\", watch(), formErrors)\r\n\r\n  const history = useHistory()\r\n\r\n  const queryClient = useQueryClient()\r\n  \r\n  const onBuscarEmpleadorSuccess = ({data}: any) => {\r\n    console.log(\"Nombre\",data.nombre)\r\n    setValue(\"nombre\", data.nombre)\r\n  }\r\n  const numeroPatronal = watch(\"numeroPatronal\")\r\n  const buscarEmpleador = useQuery([\"buscarEmpleadorPorPatronal\", numeroPatronal], ()=>{\r\n    return EmpleadorService.buscarPorPatronal(numeroPatronal)\r\n  }, {\r\n    enabled: false,\r\n    onSuccess: onBuscarEmpleadorSuccess\r\n  })\r\n\r\n  const guardar = useMutation((empleadorId: number)=>{\r\n    return ListaMoraService.agregar(empleadorId)\r\n  }, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"listaMora.buscar\")\r\n      history.replace(\"/clinica/lista-mora\")\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscarEmpleador.isError){\r\n      const error = buscarEmpleador.error as AxiosError\r\n      setError(\"numeroPatronal\", {\r\n        type: \"searchError\",\r\n        message: error.response?.status == 404 ? \"Empleador no encontrado\" : \"Ocurrio un error\"\r\n      })\r\n    }\r\n  }, [buscarEmpleador.isError])\r\n\r\n  const renderAlert = ()=>{\r\n    if(guardar.isSuccess){\r\n      return <Alert variant=\"success\">\r\n      La operacion se realizó exitosamente\r\n    </Alert>\r\n    }\r\n    if(guardar.isError){\r\n      const guardarError = guardar.error as AxiosError\r\n      return <Alert variant=\"danger\">\r\n        {guardarError.response?.data?.message || guardarError.message}\r\n      </Alert>\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <Form id=\"form-empleador-mora\"\r\n    onSubmit={handleSubmit(()=>{\r\n      guardar.mutate(buscarEmpleador.data!.data.id)\r\n    })}\r\n  >\r\n    <h1 style={{fontSize: \"1.75rem\"}}>Agregar empleador en mora</h1>\r\n    {renderAlert()}\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>\r\n          Nº Patronal\r\n        </Form.Label>\r\n        <InputGroup hasValidation className=\"mb-2\">\r\n          <Form.Control\r\n            isInvalid={!!formErrors.numeroPatronal}\r\n            className=\"text-uppercase\" {...register(\"numeroPatronal\")} />\r\n          <InputGroup.Append >\r\n            <Button variant={formErrors.numeroPatronal ? \"danger\" : \"outline-secondary\"} onClick={()=>{\r\n              trigger(\"numeroPatronal\")\r\n              .then((valid)=>{\r\n                if(!formErrors.numeroPatronal){\r\n                  clearErrors()\r\n                  if(!buscarEmpleador.data){\r\n                    buscarEmpleador.refetch()\r\n                  }\r\n                }\r\n              })\r\n            }}>\r\n              {buscarEmpleador.isFetching ? <Spinner animation=\"border\" size=\"sm\" /> : <FaSearch />}\r\n            </Button>\r\n          </InputGroup.Append>\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.numeroPatronal?.message}</Form.Control.Feedback>\r\n        </InputGroup>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n          <Form.Label>\r\n            Nombre\r\n          </Form.Label>\r\n          <Form.Control\r\n            readOnly\r\n            isInvalid={!!formState.errors.nombre}\r\n            {...register(\"nombre\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formState.errors.nombre?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Button type=\"subimt\">\r\n      {guardar.isLoading ? <Spinner className=\"mr-2\" animation=\"border\" size=\"sm\" /> : null}\r\n      <span className=\"\"></span>Agregar\r\n    </Button>\r\n  </Form>\r\n}","import { GenIcon, IconBaseProps } from \"react-icons/lib\";\r\n\r\nexport const FcDebt = function FcDebt (props: IconBaseProps) {\r\n  //@ts-ignore\r\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"version\":\"1\",\"viewBox\":\"0 0 48 48\",\"enableBackground\":\"new 0 0 48 48\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M10,12c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5S12.8,12,10,12z\"}},{\"tag\":\"path\",\"attr\":{\"d\":\"M2,22v8l3,2l1,14h8l1-14l3-2v-8c0-4.4-3.6-8-8-8h0C5.6,14,2,17.6,2,22z\"}},{\"tag\":\"g\",\"attr\":{},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M22.4,40.4c-0.6,2.5-1,3.6-2.4,3.6c-0.6,0-1.2-0.5-1.9-1.1c-1-0.8-2.2-1.9-4.1-1.9v2c1.1,0,1.9,0.7,2.8,1.4 c0.9,0.7,1.9,1.6,3.2,1.6c3.1,0,3.8-2.9,4.4-5.2C25,38.2,25.4,37,27,37v-2C23.7,35,22.9,38.1,22.4,40.4z\"}},{\"tag\":\"polygon\",\"attr\":{\"points\":\"14.4,40 10,40 10,44 14.1,44\"}}]},\r\n    //@ts-ignore\r\n    {\"tag\":\"circle\",\"attr\":{\"cx\":\"36\",\"cy\":\"36\",\"r\":\"10\"}},\r\n    //@ts-ignore\r\n    {\"tag\":\"path\",\"attr\":{\"fill\":\"#fff\",\"d\":\"M35,34c0.1,0.2,0.1,0.3,0.3,0.4c0.1,0.1,0.3,0.2,0.5,0.4c0.2,0.1,0.5,0.2,0.8,0.3c0.5,0.2,0.9,0.4,1.3,0.6 c0.4,0.2,0.7,0.4,1,0.7c0.3,0.3,0.5,0.6,0.7,0.9c0.2,0.4,0.2,0.8,0.2,1.3c0,0.4-0.1,0.8-0.2,1.2c-0.1,0.4-0.3,0.7-0.6,0.9 c-0.3,0.3-0.6,0.5-0.9,0.6c-0.4,0.2-0.8,0.3-1.2,0.3v1.5h-1.2v-1.5c-0.4,0-0.8-0.1-1.2-0.3c-0.4-0.2-0.7-0.4-1-0.6 c-0.3-0.3-0.5-0.6-0.7-1.1c-0.2-0.4-0.3-0.9-0.3-1.5h2.2c0,0.4,0,0.7,0.1,0.9c0.1,0.2,0.2,0.4,0.4,0.6c0.2,0.1,0.3,0.2,0.5,0.3 c0.2,0.1,0.4,0.1,0.6,0.1c0.2,0,0.4,0,0.6-0.1c0.2-0.1,0.3-0.2,0.4-0.3c0.1-0.1,0.2-0.3,0.3-0.4c0.1-0.2,0.1-0.3,0.1-0.5 c0-0.2,0-0.4-0.1-0.6c-0.1-0.2-0.1-0.3-0.3-0.4c-0.1-0.1-0.3-0.3-0.5-0.4c-0.2-0.1-0.4-0.2-0.7-0.3c-0.5-0.2-0.9-0.4-1.3-0.6 c-0.4-0.2-0.7-0.4-1-0.7c-0.3-0.3-0.5-0.6-0.7-0.9c-0.2-0.4-0.2-0.8-0.2-1.3c0-0.4,0.1-0.8,0.2-1.2c0.1-0.3,0.3-0.7,0.6-0.9 c0.3-0.3,0.6-0.5,0.9-0.6c0.4-0.2,0.8-0.3,1.2-0.3v-1.6h1.2v1.6c0.4,0.1,0.8,0.2,1.2,0.4c0.4,0.2,0.6,0.4,0.9,0.7 c0.2,0.3,0.4,0.6,0.6,1c0.1,0.4,0.2,0.9,0.2,1.4h-2.2c0-0.6-0.1-1-0.4-1.3c-0.2-0.3-0.6-0.4-1-0.4c-0.2,0-0.4,0-0.6,0.1 c-0.2,0.1-0.3,0.2-0.4,0.3C35.1,32.7,35,32.8,35,33s-0.1,0.3-0.1,0.5C34.9,33.7,34.9,33.9,35,34z\"}}\r\n    // //@ts-ignore\r\n    // {\"tag\":\"path\",\"attr\":{\"d\":\"M34.36918731037488,32.43804760584102 c0.2049905379011744,-0.1362195187343288 0.4575917813793953,-0.25921384147503324 0.7498686128384906,-0.353112733029765 v2.2456382797173764 a3.04840767653036,3.04840767653036 0 0 1 -0.7498686128384906,-0.353112733029765 C33.88911269580633,33.657410676453175 33.79653632385097,33.358521246997256 33.79653632385097,33.207754012669945 c0,-0.1507672343273157 0.09257637195536918,-0.449656663783222 0.5726509865239253,-0.7697064068289254 zM37.764095121938205,39.620651549978284 v-2.2456382797173764 c0.2909543118597318,0.09389889155473126 0.5448780749373151,0.21689321429543612 0.7498686128384906,0.353112733029765 c0.4813971341679188,0.3213722626450675 0.5726509865239253,0.6189391725016105 0.5726509865239253,0.7697064068289254 c0,0.1507672343273157 -0.09257637195536918,0.449656663783222 -0.5726509865239253,0.7697064068289254 a3.04840767653036,3.04840767653036 0 0 1 -0.7498686128384906,0.353112733029765 z\"}},\r\n    // //@ts-ignore\r\n    // {\"tag\":\"path\",\"attr\":{\"fill-rule\":\"evenodd\", \"clip-rule\": \"evenodd\",\"d\":\"M36.456693151701,46.34645688299114 a10.519685476315033,10.519685476315033 0 1 0 0,-21.039370952630065 a10.519685476315033,10.519685476315033 0 0 0 0,21.039370952630065 zm1.314960684539379,-17.094488899011928 a1.314960684539379,1.314960684539379 0 1 0 -2.629921369078758,0 v0.120976382977623 a5.963346704386084,5.963346704386084 0 0 0 -2.203874107288,0.8705039731650693 C31.988456745636196,30.874629468700803 31.196850413543487,31.89372399921882 31.196850413543487,33.19685003759734 c0,1.3018110776939853 0.7916063320927069,2.320905608212004 1.741007946330138,2.9534016974754462 c0.6311811285789025,0.4207874190526019 1.385968561504506,0.7166535730739616 2.203874107288,0.8705039731650693 v2.5523386886909347 c-0.5141496276548978,-0.16700000693650122 -0.8941732654867787,-0.4168425369989835 -1.108511857066697,-0.662740185007847 a1.314960684539379,1.314960684539379 0 1 0 -1.9855906336544624,1.7225984967465875 c0.7390079047111311,0.8534094842660581 1.8580394472541435,1.414897696564372 3.094102490721159,1.6476457377278424 V42.401574829373004 a1.314960684539379,1.314960684539379 0 1 0 2.629921369078758,0 v-0.120976382977623 a5.963346704386084,5.963346704386084 0 0 0 2.203874107288,-0.8705039731650693 C40.92492955776581,40.77891334465141 41.71653588985852,39.75981881413339 41.71653588985852,38.45669277575487 c0,-1.3018110776939853 -0.7916063320927069,-2.320905608212004 -1.741007946330138,-2.9534016974754462 A5.963346704386084,5.963346704386084 0 0 0 37.77165383624038,34.63278710511435 V32.08044841642341 c0.5141496276548978,0.16700000693650122 0.8941732654867787,0.4168425369989835 1.108511857066697,0.662740185007847 a1.314960684539379,1.314960684539379 0 1 0 1.9869055943390022,-1.7225984967465875 c-0.7403228653956706,-0.8534094842660581 -1.8580394472541435,-1.414897696564372 -3.0954174514056985,-1.6476457377278424 V29.25196798397921 z\"}}\r\n  ]})(props);\r\n}","import { apiClient, PaginatedResponse, Page } from \"../../../../commons/services\"\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type SolicitudesAtencionExternaFilter = {\r\n  id?: number,\r\n  desde?: string,\r\n  hasta?: string,\r\n  matricula_asegurado?: string,\r\n  doctor_id?: number,\r\n  proveedor_id?: number\r\n  regionalId?: number\r\n  registradoPor?: number\r\n}\r\n\r\nexport type SolicitudAtencionExterna = {\r\n  id: number,\r\n  numero: number,\r\n  fecha: string,\r\n  asegurado: {\r\n    matricula: string\r\n  },\r\n  medico: string,\r\n  proveedor: string,\r\n  urlDm11: string\r\n}\r\n\r\nexport const SolicitudesAtencionExternaService = {\r\n  buscar: (filter: SolicitudesAtencionExternaFilter, page: Page)=>{\r\n    return apiClient.get<PaginatedResponse<SolicitudAtencionExterna>>(\"solicitudes-atencion-externa\", {\r\n      params: {filter: keysToUnderscore(filter), page}\r\n    })\r\n  },\r\n  generarDm11: (solicitud_id: number) => {\r\n    return apiClient.put<{url: string}>(`solicitudes-atencion-externa/${solicitud_id}/generar-dm11`)\r\n  },\r\n  registrar: (regional_id: number, asegurado_id: string, medico_id: number, proveedor_id: number, prestaciones_solicitadas: {prestacion_id: number, nota: string}[]) => {\r\n    return apiClient.post(\"solicitudes-atencion-externa\", {\r\n      regional_id,\r\n      asegurado_id,\r\n      medico_id,\r\n      proveedor_id,\r\n      prestaciones_solicitadas\r\n    })\r\n  }\r\n}","import React from \"react\"\r\nimport { SolicitudesAtencionExternaFilter } from \"../services/SolicitudesAtencionExternaService\"\r\n\r\ntype Props = {\r\n  onFilter: (filter: SolicitudesAtencionExternaFilter)=>void\r\n}\r\nexport const SolicitudAtencionExternaFilterForm = (props: Props)=>{\r\n  return null\r\n}","import { useEffect, useState } from \"react\"\r\nimport { Alert, Modal as BSModal, Spinner } from \"react-bootstrap\"\r\nimport { PDFViewer } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\n\r\nexport const Dm11Viewer = ()=>{\r\n  //@ts-ignore\r\n  const modal = useModal(\"dm11Viewer\")\r\n\r\n  return <BSModal centered show={modal.show} onHide={()=>{\r\n    modal.close()\r\n  }}>\r\n    <BSModal.Header>\r\n      D.M. - 11\r\n    </BSModal.Header>\r\n    <BSModal.Body>\r\n      {modal.url ? <PDFViewer url={modal.url}/> : null}\r\n    </BSModal.Body>\r\n  </BSModal>\r\n}\r\n\r\n// export const Dm11Viewer = forwardRef<Dm11ViewerRef, ModalProps>((props, ref) => {\r\n//   const [url, setUrl] = useState(\"\")\r\n//   const imperativeModalRef = useRef<ImperativeModalRef>(null)\r\n//   // const [visible, show] = useState(false)\r\n\r\n//   useImperativeHandle(ref, ()=>({\r\n//     show: (visible: boolean)=>imperativeModalRef.current?.show(visible),\r\n//     setUrl\r\n//   }), [])\r\n//   return <ImperativeModal {...props} ref={imperativeModalRef}>\r\n//     <Modal.Header>\r\n//       D.M. - 11\r\n//     </Modal.Header>\r\n//     <Modal.Body>\r\n//       {url ? <PDFViewer url={url}/> : null}\r\n//     </Modal.Body>\r\n//     <Modal.Footer>\r\n\r\n//     </Modal.Footer>\r\n//   </ImperativeModal>\r\n// })","import { Dropdown } from \"react-bootstrap\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { SolicitudATPolicy } from \"../policies\"\r\nimport { SolicitudAtencionExterna } from \"../services\"\r\n\r\ntype Props = {\r\n  solicitud: SolicitudAtencionExterna\r\n}\r\nexport const RowOptions = ({solicitud}: Props) => {\r\n\r\n  const modal = useModal(\"dm11Viewer\")\r\n\r\n  return   <Dropdown>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-solicitud-${solicitud.id}`}\r\n    />\r\n    <Dropdown.Menu >\r\n      <Dropdown.Item href=\"#\" onClick={() => {\r\n        modal.open({\r\n          url: solicitud.urlDm11\r\n        })\r\n      }}>Ver D.M. - 11</Dropdown.Item>\r\n    </Dropdown.Menu>\r\n  </Dropdown>\r\n}","import { Permisos } from \"../../../../commons/auth/constants\";\r\nimport { useLoggedUser } from \"../../../../commons/auth/hooks\";\r\n\r\nexport const SolicitudATPolicy = {\r\n  index: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR,\r\n      Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n  register: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n  view: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR,\r\n    ])\r\n  },\r\n  emit: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,\r\n      Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR\r\n    ])\r\n  }\r\n}","import { AxiosError } from \"axios\"\r\nimport { useRef, useState} from \"react\"\r\nimport { Button, Col, Dropdown, Form, Spinner, Table } from \"react-bootstrap\"\r\nimport {FaFilter, FaPlus, FaSync} from \"react-icons/fa\"\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport { useMutation, useQuery } from \"react-query\"\r\nimport { Pagination } from \"../../../../commons/components\"\r\nimport { Page } from \"../../../../commons/services/Page\"\r\nimport { SolicitudesAtencionExternaFilter as Filter, SolicitudesAtencionExternaService } from \"../services/SolicitudesAtencionExternaService\"\r\nimport { SolicitudAtencionExternaFilterForm } from \"./SolicitudAtencionExternaFilterForm\"\r\nimport { Dm11Viewer } from \"./Dm11Viewer\"\r\nimport { Permisos } from \"../../../../commons/auth/constants\"\r\nimport { useLoggedUser } from \"../../../../commons/auth/hooks\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components/ProtectedContent\"\r\nimport { RowOptions } from \"./RowOptions\"\r\nimport { SolicitudATPolicy } from \"../policies\"\r\n\r\nexport const SolicitudAtencionExternaIndex = ()=>{\r\n  const {pathname: path} = useLocation()\r\n  const [total, setTotal] = useState(0)\r\n  const [page, setPage] = useState<Page>({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser();\r\n\r\n  const getDefaultFilter = ()=>{\r\n    const filter: Filter = {}\r\n    if(!loggedUser.can(Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA)){\r\n      if(loggedUser?.can(Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL)){\r\n        filter.regionalId = loggedUser.regionalId;\r\n      }\r\n      if(loggedUser?.can(Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR)){\r\n        filter.registradoPor = loggedUser.id;\r\n      }\r\n    }\r\n    return filter\r\n  }\r\n\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n\r\n  const buscar = useQuery([\"solicitudesAtencionExterna.buscar\", page, filter], ()=>{\r\n    return SolicitudesAtencionExternaService.buscar({...filter, ...getDefaultFilter()}, page)\r\n  }, {\r\n    enabled: loggedUser.canAny([\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR,\r\n    ]),\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: ({data: {meta}}) => {\r\n      setTotal(meta.total)\r\n    }\r\n  })\r\n\r\n  const renderRows = ()=>{\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.isError) {\r\n      const { error } = buscar\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {(error as AxiosError).response?.data?.message || (error as AxiosError).message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.data){\r\n      const records = buscar.data!.data.records\r\n      if(records.length === 0){\r\n        return  <tr>\r\n          <td className=\"bg-light text-center\" colSpan={100}>\r\n            No se encontraron resultados\r\n          </td>\r\n      </tr>\r\n      }\r\n      return records.map((solicitud, index)=>{\r\n        return <tr key={solicitud.id}>\r\n          <td>{index + 1}</td>\r\n          <td>{solicitud.numero}</td>\r\n          <td>{solicitud.fecha}</td>\r\n          <td>{solicitud.asegurado.matricula}</td>\r\n          <td>{solicitud.medico}</td>\r\n          <td>{solicitud.proveedor}</td>\r\n          <td>\r\n            <RowOptions solicitud={solicitud} />\r\n          </td>\r\n        </tr>\r\n      })\r\n    }\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h1 style={{fontSize: \"1.75rem\"}}>Solicitudes de atención externa</h1>\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\" >\r\n        <ProtectedContent\r\n          authorize={SolicitudATPolicy.view}\r\n        >\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              // showUsersFilter(visible=>!visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={SolicitudATPolicy.register}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button\r\n              as={Link}\r\n              to={`${path}/registrar`}\r\n              className=\"d-flex align-items-center\">\r\n                <FaPlus className=\"mr-2\" />Nuevo\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={SolicitudATPolicy.view}\r\n    >\r\n      <Form.Row className=\"mb-2\">\r\n        <Col>\r\n          <SolicitudAtencionExternaFilterForm onFilter={(filter)=>{\r\n            setFilter(filter)\r\n          }} />\r\n        </Col>\r\n        <Col xs={\"auto\"}>\r\n          <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n              <span>Mostrar</span>\r\n              <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n                const value = e.target.value\r\n                setPage((page) => ({\r\n                  ...page,\r\n                  size: parseInt(value)\r\n                }))\r\n              }}>\r\n                <option value={10}>10</option>\r\n                <option value={20}>20</option>\r\n                <option value={30}>30</option>\r\n                <option value={50}>50</option>\r\n                <option value={100}>100</option>\r\n              </Form.Control>\r\n              <span>filas</span>\r\n          </div>\r\n        </Col>\r\n      </Form.Row>\r\n      <Table responsive>\r\n        <thead>\r\n          <tr>\r\n            <th style={{width: 1}}>#</th>\r\n            <th>Nº</th>\r\n            <th>Fecha y hora</th>\r\n            <th>Matrícula asegurado</th>\r\n            <th>Doctor</th>\r\n            <th>Proveedor</th>\r\n            <th style={{width: 1}}></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {renderRows()}\r\n        </tbody>\r\n      </Table>\r\n      {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    </ProtectedContent>\r\n    <Dm11Viewer />\r\n  </div>\r\n}","export const EstadosAfi: {[k: number]: string} = {\r\n  1: \"Alta\",\r\n  2: \"Baja\"\r\n}","export const EstadosEmp: {[k: number]: string} = {\r\n  1: \"Alta\",\r\n  2: \"Baja\",\r\n  3: \"Baja temporal\"\r\n}","import React, { forwardRef, useImperativeHandle, useRef, useCallback } from \"react\"\r\nimport { Button, Modal, ModalProps, Table } from \"react-bootstrap\"\r\nimport { ImperativeModal, ImperativeModalRef } from \"../../../../commons/components/ImperativeModal\"\r\nimport { nombreCompleto } from \"../../../../commons/utils/nombreCompleto\"\r\nimport { Asegurado } from \"../services\"\r\nimport { EstadosAfi } from \"../utils\"\r\n\r\ntype Props = Omit<ModalProps, \"children\"> & {\r\n  asegurados: Asegurado[]\r\n  onSelect: (asegurado: Asegurado) => void\r\n  title: string\r\n}\r\n\r\n\r\nexport const AseguradoChooser = forwardRef<ImperativeModalRef, Props>((props, ref) => {\r\n  console.log(props.asegurados.length)\r\n  return <ImperativeModal {...props} ref={ref}>\r\n    <Modal.Header>\r\n      {props.title}\r\n    </Modal.Header>\r\n    <Modal.Body>\r\n      <Table responsive className=\"small\">\r\n        <thead>\r\n          <tr>\r\n            <th style={{width: 1}}>#</th>\r\n            <th>Matricula</th>\r\n            <th>Nombre completo</th>\r\n            <th>Estado</th>\r\n            <th></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {!!props.asegurados.length ? props.asegurados.map((asegurado, index)=>{\r\n            return <tr key={asegurado.id}>\r\n              <th scope=\"row\">{index+1}</th>\r\n              <td>{asegurado.matricula}-{asegurado.matriculaComplemento}</td>\r\n              <td>{nombreCompleto(asegurado.apellidoPaterno, asegurado.apellidoMaterno, asegurado.nombres)}</td>\r\n              <td className={EstadosAfi[asegurado.estado] ? \"\" : \"bg-ligth\"}>{EstadosAfi[asegurado.estado] || \"Desconocido\"}</td>\r\n              <td><Button onClick={()=>{\r\n                console.log(asegurado)\r\n                props.onSelect(asegurado)\r\n              }}\r\n              >Seleccionar</Button></td>\r\n            </tr>\r\n          }) : <tr><td className=\"bg-light text-center\" colSpan={100}>No se encontraron resultados</td></tr>}\r\n        </tbody>\r\n      </Table>\r\n    </Modal.Body>\r\n  </ImperativeModal>\r\n})","export function nombreCompleto(apellidoPaterno: string | null, apellidoMaterno: string, nombres: string){\r\n  return (apellidoPaterno ? apellidoPaterno + \" \" : \"\") + `${apellidoMaterno}  ${nombres}`\r\n}","import { AxiosTransformer } from \"axios\"\r\nimport { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\n\r\n// export type Titular = {\r\n//   id: string,\r\n//   matricula: string,\r\n//   apellidoPaterno: string | null,\r\n//   apellidoMaterno: string,\r\n//   nombres: string,\r\n//   estado: string,\r\n//   fechaBaja?: string,\r\n//   fechaExtinsion?: string,\r\n//   empleador: {\r\n//     id: number,\r\n//     numeroPatronal: string,\r\n//     nombre: string,\r\n//     estado: string,\r\n//     aportes: string\r\n//   }\r\n// }\r\n\r\n// type Beneficiario = Titular & {\r\n//   fechaExtinsion?: string\r\n// }\r\n\r\n// export type Asegurado = Titular | Beneficiario\r\nexport type Asegurado = {\r\n  id: string,\r\n  matricula: string,\r\n  matriculaComplemento: string,\r\n  apellidoPaterno: string | null,\r\n  apellidoMaterno: string,\r\n  nombres: string,\r\n  tipo_id: number,\r\n  estado: number,\r\n  baja: {\r\n    regDate: string,\r\n    fechaValidezSeguro: string\r\n  },\r\n  fechaExtinsion?: string\r\n  titularId: string\r\n  empleador: {\r\n    id: number,\r\n    numeroPatronal: string,\r\n    nombre: string,\r\n    estado: string,\r\n    fechaBaja: string,\r\n    aportes: string\r\n  }\r\n  titular?: {\r\n    id: string,\r\n    matricula: string,\r\n    apellidoPaterno: string | null,\r\n    apellidoMaterno: string | null,\r\n    nombres: string,\r\n    estado: string,\r\n    baja: {\r\n      regDate: string,\r\n      fechaValidezSeguro: string\r\n    },\r\n  }\r\n}\r\n\r\nexport const AseguradosService = {\r\n  buscarPorMatricula: (matricula: string) =>{\r\n    return apiClient.get<PaginatedResponse<Asegurado>>(\"asegurados\", {\r\n      params: {\r\n        filter: {\r\n          matricula\r\n        },\r\n        page: {\r\n          size: 10\r\n        },\r\n        include: \"empleador,titular\"\r\n      },\r\n      // transformResponse: [...apiClient.defaults.transformResponse as AxiosTransformer[], (response:any)=>{\r\n      //   console.log(response)\r\n      //   return response\r\n      // }]\r\n    })\r\n  }\r\n}","import { useEffect, useRef } from \"react\"\r\nimport { Accordion, Card, Form, Col, InputGroup, FormControl, Button, Spinner } from \"react-bootstrap\"\r\nimport { useFormContext, useWatch, ValidationRule } from \"react-hook-form\"\r\nimport { FaSearch } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { nombreCompleto } from \"../../../../commons/utils/nombreCompleto\"\r\nimport { AseguradoChooser } from \"./AseguradoChooser\"\r\nimport { Asegurado, AseguradosService } from \"../services/AseguradosService\"\r\nimport { ImperativeModalRef } from \"../../../../commons/components/ImperativeModal\"\r\nimport moment from 'moment';\r\n\r\nimport { EstadosAfi, EstadosEmp } from \"../utils\"\r\n\r\nexport type AseguradoInputs = {\r\n  regionalId: number,\r\n  asegurado: {\r\n    id: string\r\n    matricula: string\r\n    apellidoPaterno: string | null\r\n    apellidoMaterno: string\r\n    nombres: string\r\n    fechaExtincion: string | null\r\n    tipo: number\r\n    estado: string\r\n    tieneBaja: boolean\r\n    fechaRegBaja: string,\r\n    fechaValidezSeguro?: string | null\r\n  },\r\n  titular: {\r\n    id?: string\r\n    matricula?: string\r\n    apellidoPaterno?: string | null\r\n    apellidoMaterno?: string\r\n    nombres?: string\r\n    estado?: string\r\n    tieneBaja: boolean\r\n    fechaRegBaja: string,\r\n    fechaValidezSeguro?: string | null\r\n  },\r\n  empleador: {\r\n    id: string, \r\n    numeroPatronal: string, \r\n    nombre: string,\r\n    estado: string,\r\n    aportes: string,\r\n    fechaBaja: string | null\r\n  }\r\n}\r\n\r\nexport const AseguradoCard = ()=>{\r\n\r\n  const {\r\n    register,\r\n    formState,\r\n    trigger,\r\n    setValue,\r\n    clearErrors,\r\n    control,\r\n    watch\r\n  } = useFormContext<AseguradoInputs>()\r\n\r\n  const asegurado = useWatch({\r\n    control,\r\n    name: 'asegurado', // without supply name will watch the entire form, or ['firstName', 'lastName'] to watch both\r\n  });\r\n  const titular = useWatch({\r\n    control,\r\n    name: 'titular', // without supply name will watch the entire form, or ['firstName', 'lastName'] to watch both\r\n  });\r\n  const empleador = useWatch({\r\n    control,\r\n    name: 'empleador', // without supply name will watch the entire form, or ['firstName', 'lastName'] to watch both\r\n  }); \r\n\r\n  const aseguradoChooserRef = useRef<ImperativeModalRef|null>(null)\r\n\r\n  const matricula = asegurado.matricula\r\n  const buscar = useQuery([\"asegurados.buscar\", matricula], ()=>{\r\n    return AseguradosService.buscarPorMatricula(matricula)\r\n  }, {\r\n    enabled: false,\r\n    onSuccess: ({data: {records}}) =>{\r\n      if(records.length == 1){\r\n        const asegurado = records[0]\r\n        onChange(asegurado)\r\n      }\r\n      else {\r\n        aseguradoChooserRef.current?.show(true)\r\n      }\r\n    }\r\n  })\r\n\r\n  const onChange = ({empleador, titular, ...asegurado}: any) => {\r\n    setValue(\"asegurado.id\", asegurado.id)\r\n    setValue(\"asegurado.apellidoPaterno\", asegurado.apellidoPaterno || \"\")\r\n    setValue(\"asegurado.apellidoMaterno\", asegurado.apellidoMaterno || \"\")\r\n    setValue(\"asegurado.nombres\", asegurado.nombres)\r\n    setValue(\"asegurado.tipo\", asegurado.tipo)\r\n    setValue(\"asegurado.estado\", EstadosAfi[asegurado.estado])\r\n    setValue(\"asegurado.tieneBaja\", !!asegurado.baja)\r\n    setValue(\"asegurado.fechaRegBaja\", asegurado.baja?.regDate)\r\n    setValue(\"asegurado.fechaValidezSeguro\", asegurado.baja?.fechaValidezSeguro)\r\n    setValue(\"asegurado.fechaExtincion\", asegurado.fechaExtincion)\r\n    \r\n    setValue(\"titular.id\", titular?.id)\r\n    setValue(\"titular.matricula\", titular?.matricula)\r\n    setValue(\"titular.apellidoPaterno\", titular?.apellidoPaterno)\r\n    setValue(\"titular.apellidoMaterno\", titular?.apellidoMaterno)\r\n    setValue(\"titular.nombres\", titular?.nombres)\r\n    setValue(\"titular.estado\", EstadosAfi[titular?.estado])\r\n    setValue(\"titular.tieneBaja\", !!titular?.baja)\r\n    setValue(\"titular.fechaRegBaja\", titular?.baja?.regDate)\r\n    setValue(\"titular.fechaValidezSeguro\", titular?.baja?.fechaValidezSeguro)\r\n\r\n    setValue(\"empleador.id\", empleador?.id)\r\n    setValue(\"empleador.numeroPatronal\", empleador?.numeroPatronal)\r\n    setValue(\"empleador.nombre\", empleador?.nombre)\r\n    setValue(\"empleador.estado\", EstadosEmp[empleador?.estado])\r\n    setValue(\"empleador.fechaBaja\", empleador?.fecha_baja)\r\n    setValue(\"empleador.aportes\", empleador?.aportes == 2 ? \"Sí\" : empleador?.aportes == 1 ? \"No\" : \"\")\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if(asegurado.id && formState.dirtyFields.asegurado?.matricula){\r\n      setValue(\"asegurado.id\", \"\")\r\n      setValue(\"asegurado.apellidoPaterno\", \"\")\r\n      setValue(\"asegurado.apellidoMaterno\", \"\")\r\n      setValue(\"asegurado.nombres\", \"\")\r\n      setValue(\"asegurado.tipo\", -1)\r\n      setValue(\"asegurado.estado\", \"\")\r\n      setValue(\"asegurado.tieneBaja\", false)\r\n      setValue(\"asegurado.fechaRegBaja\", \"\")\r\n      setValue(\"asegurado.fechaValidezSeguro\", null)\r\n      setValue(\"asegurado.fechaExtincion\", null)\r\n      setValue(\"titular\", {\r\n        id: \"\",\r\n        matricula: \"\",\r\n        apellidoPaterno: \"\",\r\n        apellidoMaterno: \"\",\r\n        nombres: \"\",\r\n        estado: \"\",\r\n        tieneBaja: false,\r\n        fechaRegBaja: \"\",\r\n        fechaValidezSeguro: null\r\n      })\r\n      setValue(\"empleador.id\", \"\")\r\n      setValue(\"empleador.numeroPatronal\", \"\")\r\n      setValue(\"empleador.nombre\", \"\")\r\n      setValue(\"empleador.estado\", \"\")\r\n      setValue(\"empleador.fechaBaja\", \"\")\r\n      setValue(\"empleador.aportes\", \"\")\r\n    }\r\n  }, [matricula])\r\n\r\n  const formErrors = formState.errors\r\n  const hasErrors = formErrors.asegurado || formErrors.titular || formErrors.empleador\r\n\r\n  return <Card >\r\n    <Accordion.Toggle as={Card.Header} className={\"text-light \" + (hasErrors ? \"bg-danger\" : \"bg-primary\")} eventKey=\"0\">\r\n      Asegurado\r\n    </Accordion.Toggle>\r\n    <Accordion.Collapse eventKey=\"0\">\r\n      <Card.Body>\r\n        <Form.Row>\r\n          <Col lg={3} md={6}>\r\n            <Form.Label htmlFor=\"asegurado-matricula\">\r\n              Matrícula\r\n            </Form.Label>\r\n            <InputGroup hasValidation className=\"mb-2\">\r\n              <FormControl id=\"asegurado-matricula\"\r\n                isInvalid={!!formErrors.asegurado?.matricula || !!formErrors.asegurado?.id}\r\n                className=\"text-uppercase\" {...register(\"asegurado.matricula\")} />\r\n              <InputGroup.Append >\r\n                <Button variant=\"outline-secondary\" onClick={()=>{\r\n                  trigger(\"asegurado.matricula\")\r\n                  if(!formErrors.asegurado?.matricula){\r\n                    if(formState.dirtyFields.asegurado?.matricula)\r\n                      delete formState.dirtyFields.asegurado.matricula\r\n                    clearErrors([\"asegurado\", \"titular\", \"empleador\"])\r\n                    if(!buscar.data){\r\n                      buscar.refetch()\r\n                    }\r\n                    else{\r\n                      const {data: {records}} = buscar.data\r\n                      if(records.length == 1){\r\n                        // const asegurado = records[0]\r\n                        // onChange(asegurado)\r\n                      }\r\n                      else {\r\n                        aseguradoChooserRef.current?.show(true)\r\n                      }\r\n                    }\r\n                  }\r\n                }}>\r\n                  {buscar.isFetching ? <Spinner animation=\"border\" size=\"sm\" /> : <FaSearch />}\r\n                </Button>\r\n              </InputGroup.Append>\r\n              <Form.Control.Feedback type=\"invalid\">{formErrors.asegurado?.matricula?.message}</Form.Control.Feedback>\r\n            </InputGroup>\r\n          </Col>\r\n          <Form.Group as={Col} lg={3} md={6}>\r\n            <Form.Label>Apellido Paterno</Form.Label>\r\n            <Form.Control \r\n              readOnly\r\n              {...register(\"asegurado.apellidoPaterno\")}\r\n            />\r\n          </Form.Group>\r\n          <Form.Group as={Col} lg={3} md={6}>\r\n            <Form.Label>Apellido Materno</Form.Label>\r\n            <Form.Control \r\n              readOnly\r\n              {...register(\"asegurado.apellidoMaterno\")}\r\n            />\r\n          </Form.Group>\r\n          <Form.Group as={Col} lg={3} md={6}>\r\n            <Form.Label>Nombre</Form.Label>\r\n            <Form.Control \r\n              readOnly\r\n              {...register(\"asegurado.nombres\")}\r\n            />\r\n          </Form.Group>\r\n        </Form.Row>\r\n        <Form.Row>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Estado</Form.Label>\r\n            <Form.Control \r\n              readOnly\r\n              isInvalid={!!formErrors.asegurado?.estado}\r\n              {...register(\"asegurado.estado\")}\r\n            >\r\n            </Form.Control>\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.asegurado?.estado?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Validez del seguro</Form.Label>\r\n            <Form.Control \r\n              readOnly\r\n              type=\"date\"\r\n              isInvalid={!!formErrors.asegurado?.fechaValidezSeguro}\r\n              {...register(\"asegurado.fechaValidezSeguro\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{\r\n              formErrors.asegurado?.fechaValidezSeguro?.message\r\n            }</Form.Control.Feedback>\r\n          </Form.Group>\r\n          {asegurado.tipo == 2 ? <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Fecha extinsion</Form.Label>\r\n            <Form.Control \r\n              readOnly\r\n              type=\"date\"\r\n              isInvalid={!!formErrors.asegurado?.fechaExtincion}\r\n              {...register(\"asegurado.fechaExtincion\", {\r\n                validate: {\r\n                  afterDate: (value) => {\r\n                    const now = moment()\r\n                    if(value && moment(value, \"DD/MM/YYYY\").isSameOrBefore(now)){\r\n                      return \"Se ha cumplido la fecha de extincion\"\r\n                    } \r\n                  }\r\n                }\r\n              })}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.asegurado?.fechaExtincion?.message}</Form.Control.Feedback>\r\n          </Form.Group> : null}\r\n        </Form.Row>\r\n        { asegurado.tipo == 2 ? <div /*className={asegurado.tipo == 2 ? \"\" : \"d-none\"}*/ >\r\n          {/* {watch(\"titular.id\") ? <> */}\r\n          <h2 style={{fontSize: \"1.25rem\"}}>Titular</h2>\r\n          <Form.Row>\r\n            <Form.Group as={Col} lg={3} md={6}>\r\n              <Form.Label>Matricula</Form.Label>\r\n              <Form.Control \r\n                readOnly\r\n                {...register(\"titular.matricula\")}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group as={Col} lg={3} md={6}>\r\n              <Form.Label>Apellido Paterno</Form.Label>\r\n              <Form.Control \r\n                readOnly\r\n                {...register(\"titular.apellidoPaterno\")}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group as={Col} lg={3} md={6}>\r\n              <Form.Label>Apellido Materno</Form.Label>\r\n              <Form.Control \r\n                readOnly\r\n                {...register(\"titular.apellidoMaterno\")}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group as={Col} lg={3} md={6}>\r\n              <Form.Label>Nombre</Form.Label>\r\n              <Form.Control \r\n                readOnly\r\n                {...register(\"titular.nombres\")}\r\n              />\r\n            </Form.Group>\r\n          </Form.Row>\r\n          <Form.Row>\r\n            <Form.Group as={Col} sm={4}>\r\n              <Form.Label>Estado</Form.Label>\r\n              <Form.Control \r\n                readOnly\r\n                isInvalid={!!formErrors.titular?.estado}\r\n                {...register(\"titular.estado\")}\r\n              >\r\n              </Form.Control>\r\n              <Form.Control.Feedback type=\"invalid\">{formErrors.titular?.estado?.message}</Form.Control.Feedback>\r\n            </Form.Group>\r\n            <Form.Group as={Col} sm={4}>\r\n              <Form.Label>Fecha de baja</Form.Label>\r\n              <Form.Control \r\n                readOnly\r\n                type=\"date\"\r\n                isInvalid={!!formErrors.titular?.fechaValidezSeguro}\r\n                {...register(\"titular.fechaValidezSeguro\")}\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">{formErrors.titular?.fechaValidezSeguro?.message}</Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Form.Row>\r\n          {/* </> : null} */}\r\n        </div>\r\n        : null}\r\n        <h2 style={{fontSize: \"1.25rem\"}}>Empleador</h2>\r\n        <Form.Row>\r\n          <Form.Group as={Col} md={4}>\r\n            <Form.Label>Nº Patronal</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.empleador?.numeroPatronal}\r\n              {...register(\"empleador.numeroPatronal\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.empleador?.numeroPatronal?.message}</Form.Control.Feedback>\r\n          </Form.Group> \r\n          <Form.Group as={Col} md={8}>\r\n            <Form.Label>Nombre</Form.Label>\r\n            <Form.Control \r\n              readOnly\r\n              {...register(\"empleador.nombre\")}\r\n            />\r\n          </Form.Group>\r\n        </Form.Row>\r\n        <Form.Row>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Estado</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.empleador?.estado}\r\n              {...register(\"empleador.estado\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.empleador?.estado?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Fecha de baja</Form.Label>\r\n            <Form.Control \r\n              readOnly\r\n              type=\"date\"\r\n              isInvalid={!!formErrors.empleador?.fechaBaja}\r\n              {...register(\"empleador.fechaBaja\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.empleador?.fechaBaja?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>En mora</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.empleador?.aportes}\r\n              {...register(\"empleador.aportes\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.empleador?.aportes?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n        </Form.Row>\r\n        <AseguradoChooser ref={aseguradoChooserRef}\r\n          title=\"Resultados\"\r\n          asegurados={buscar.data?.data.records || []}\r\n          onSelect={(asegurado: Asegurado)=>{\r\n            // asegurado.matricula = watch(\"asegurado.matricula\")\r\n            onChange(asegurado)\r\n            aseguradoChooserRef.current!.show(false)\r\n          }}\r\n        />\r\n      </Card.Body>\r\n    </Accordion.Collapse>\r\n  </Card>\r\n}","import { apiClient, PaginatedResponse, Page } from \"../../../../commons/services\"\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type Medico = {\r\n  id: number,\r\n  ci: {\r\n    raiz: number,\r\n    complemento: string,\r\n  },\r\n  ciText: string,\r\n  apellidoPaterno: string,\r\n  apellidoMaterno: string,\r\n  nombres: string,\r\n  nombreCompleto: string,\r\n  sexo: string,\r\n  especialidadId: number\r\n  especialidad: string\r\n  estado: number\r\n  estadoText: string\r\n  regionalId: number\r\n}\r\n\r\nexport type MedicoFilter = {\r\n  ci?: string,\r\n  nombre?: string,\r\n  especialidadId?: number\r\n  regionalId?: number\r\n  tipo?: number\r\n}\r\n\r\nexport const MedicosService = {\r\n  buscar: (filter?: MedicoFilter, page?: Page) => {\r\n    return apiClient.get<PaginatedResponse<Medico> | Medico[]>(\"medicos\", {\r\n      params: keysToUnderscore({\r\n        filter,\r\n        page\r\n      })\r\n    })\r\n  },\r\n  load: (id: number) => {\r\n    return apiClient.get<Medico>(`medicos/${id!}`);\r\n  },\r\n  registrar: (ci: {\r\n    raiz: number,\r\n    complemento: string,\r\n  }, apellido_paterno: string, apellido_materno: string, nombres: string, especialidad_id: number, regional_id: number) => {\r\n    return apiClient.post<Medico>(\"medicos\", {\r\n      ci: ci.raiz,\r\n      ci_complemento: ci.complemento,\r\n      apellido_paterno,\r\n      apellido_materno,\r\n      nombres,\r\n      especialidad_id,\r\n      regional_id\r\n    })\r\n  },\r\n  actualizar: (id: number, ci: {\r\n    raiz: number,\r\n    complemento: string,\r\n  }, apellido_paterno: string, apellido_materno: string, nombres: string, especialidad_id: number, regional_id: number) => {\r\n    return apiClient.put<Medico>(`medicos/${id}`, {\r\n      ci: ci.raiz,\r\n      ci_complemento: ci.complemento,\r\n      apellido_paterno,\r\n      apellido_materno,\r\n      nombres,\r\n      especialidad_id,\r\n      regional_id\r\n    })\r\n  },\r\n  cambiarEstado: (id: number, estado: number) => {\r\n    return apiClient.put(`medicos/${id}/cambiar-estado`, {\r\n      estado\r\n    })\r\n  }\r\n}","import { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\nimport axios from 'axios'\r\nimport { Medico } from \"../../medicos/services/MedicoService\"\r\n\r\nexport type Empresa = {\r\n  id: number,\r\n  nombre: string\r\n}\r\n\r\nexport type Proveedor = {\r\n  id: number\r\n  nombre: string\r\n  medico?: Medico\r\n  regionalId: number\r\n  contrato: {\r\n    prestaciones: {\r\n      id: number\r\n      nombre: string\r\n    }[]\r\n  }\r\n}\r\n\r\nexport type Filter = {\r\n  regionalId?: number,\r\n  activos?: number\r\n}\r\n\r\nexport const ProveedorService = {\r\n  buscar: (filter?: Filter, page?: Page) => {\r\n    return apiClient.get<Proveedor[]>(\"proveedores\", {\r\n      params: {\r\n        filter,\r\n        page\r\n      }\r\n    })\r\n  },\r\n  buscarPorNombre: (nombre: string) =>{\r\n    // Create a new CancelToken source for this request\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source()\r\n  \r\n    const promise = apiClient.get<Proveedor[]>(\"proveedores/buscar-nombre\", {\r\n      params: {nombre},\r\n      cancelToken: source.token\r\n    })\r\n    // Cancel the request if React Query calls the `promise.cancel` method\r\n    //@ts-ignore\r\n    promise.cancel = () => {\r\n      source.cancel('Query was cancelled by React Query')\r\n    }\r\n    return promise\r\n  }\r\n}","import axios from \"axios\";\r\nimport { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\n\r\nexport type Prestacion = {\r\n  id: number,\r\n  nombre: string,\r\n}\r\n\r\nexport const PrestacionesService = {\r\n  buscarPorNombre: (nombre: string) => {\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source()\r\n  \r\n    const promise = apiClient.get<Prestacion[]>(\"/prestaciones/buscar-nombre\", {\r\n      params: {\r\n        nombre\r\n      }\r\n    })\r\n    //@ts-ignore\r\n    promise.cancel = () => {\r\n      source.cancel('Query was cancelled by React Query')\r\n    }\r\n    return promise\r\n  },\r\n  buscar: (filter: {nombre?: string}, page?: Page) => {\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source()\r\n  \r\n    const promise = apiClient.get<PaginatedResponse<Prestacion>|Prestacion[]>(\"prestaciones\", {\r\n      params: {\r\n        filter, page\r\n      }\r\n    })\r\n    //@ts-ignore\r\n    promise.cancel = () => {\r\n      source.cancel('Query was cancelled by React Query')\r\n    }\r\n    return promise\r\n  }\r\n}","\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { AxiosPromise } from \"axios\"\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\"\r\nimport { FaSync } from \"react-icons/fa\"\r\nimport { Typeahead, TypeaheadProps } from 'react-bootstrap-typeahead'\r\nimport { useQuery } from 'react-query'\r\nimport { Medico, MedicosService } from \"../services\"\r\nimport { isMatch } from \"../../../../commons/utils\"\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css'\r\n\r\n\r\nexport const MedicosTypeahead = ({isInvalid, feedback, filterBy, ...props}: {feedback?: string, onLoad?: (options: Medico[])=>void} & Omit<TypeaheadProps<Medico>, \"isLoading\" | \"options\" | \"onSearch\">) => {\r\n  const queryKey = \"medicos.buscar\"\r\n\r\n  const buscar = useQuery(queryKey, ()=>{\r\n    return MedicosService.buscar() as AxiosPromise<Medico[]>\r\n  }, {\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscar.data){\r\n      props.onLoad && props.onLoad(buscar.data?.data)\r\n    }\r\n  }, [buscar.data])\r\n  \r\n  const options = useMemo(()=>{\r\n    if(Array.isArray(buscar.data?.data)){\r\n        return buscar.data?.data!\r\n    }\r\n    else if(buscar.data?.data){\r\n        console.error(buscar.data?.data)\r\n    }\r\n    return []\r\n  }, [buscar.data?.data])\r\n\r\n  return <InputGroup hasValidation>\r\n    <Typeahead\r\n      {...props}\r\n      className={(buscar.isError || isInvalid) ? \"is-invalid\" : \"\"}\r\n      isInvalid={buscar.isError || isInvalid}\r\n      filterBy={(medico, props)=>{\r\n        return (!props.text || isMatch(medico.nombreCompleto, props) || isMatch(medico.especialidad, props))\r\n          && (!filterBy || typeof filterBy === \"function\" && filterBy(medico, props))\r\n      }}\r\n      isLoading={buscar.isFetching}\r\n      options={options}\r\n      labelKey=\"nombreCompleto\"\r\n      minLength={0}\r\n      renderMenuItemChildren={(medico) => {\r\n        return <div>\r\n          <div>{medico.nombreCompleto}</div>\r\n          <div className={\"small text-secondary\"}>{medico.especialidad}</div> \r\n        </div>\r\n      }}\r\n    />\r\n    {buscar.isError ? <>\r\n      <InputGroup.Append>\r\n        <Button variant=\"outline-danger\" onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n      </InputGroup.Append>\r\n      <Form.Control.Feedback type=\"invalid\">{buscar.error?.response?.message || buscar.error?.message}</Form.Control.Feedback>\r\n    </>\r\n    : null}\r\n    {feedback ? <Form.Control.Feedback type=\"invalid\">{feedback}</Form.Control.Feedback> : null}\r\n  </InputGroup>\r\n}","\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { AxiosPromise } from \"axios\"\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\"\r\nimport { FaSync } from \"react-icons/fa\"\r\nimport { Typeahead, TypeaheadProps } from 'react-bootstrap-typeahead'\r\nimport { useQuery } from 'react-query'\r\nimport { Prestacion, PrestacionesService } from \"../services/PrestacionesService\";\r\nimport { isMatch } from \"../../../../commons/utils\";\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\r\n\r\nexport type { Prestacion }\r\n\r\nexport const PrestacionesTypeahead = ({isInvalid, feedback, filterBy, ...props}: {feedback?: string, onLoad?: (options: Prestacion[])=>void} & Omit<TypeaheadProps<Prestacion>, \"isLoading\" | \"options\">) => {\r\n  const queryKey = \"prestaciones.buscar\"\r\n\r\n  const buscar = useQuery(queryKey, ()=>{\r\n    return PrestacionesService.buscar({}) as AxiosPromise<Prestacion[]>\r\n  }, {\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscar.data){\r\n      props.onLoad && props.onLoad(buscar.data?.data)\r\n    }\r\n  }, [buscar.data])\r\n\r\n  const options = useMemo(()=>{\r\n    if(Array.isArray(buscar.data?.data)){\r\n        return buscar.data?.data!\r\n    }\r\n    else if(buscar.data?.data){\r\n        console.error(buscar.data?.data)\r\n    }\r\n    return []\r\n  }, [buscar.data?.data])\r\n\r\n  return <InputGroup hasValidation>\r\n    <Typeahead\r\n      {...props}\r\n      className={(buscar.isError || isInvalid) ? \"is-invalid\" : \"\"}\r\n      isInvalid={buscar.isError || isInvalid}\r\n      filterBy={(prestacion, props)=>{\r\n        return (!props.text || isMatch(prestacion.nombre, props)) \r\n          && (!filterBy || (typeof filterBy === \"function\" && filterBy(prestacion, props)))\r\n      }}\r\n      isLoading={buscar.isFetching}\r\n      options={options}\r\n      labelKey=\"nombre\"\r\n    />\r\n    {buscar.isError ? <>\r\n      <InputGroup.Append>\r\n        <Button variant=\"outline-danger\" onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n      </InputGroup.Append>\r\n      <Form.Control.Feedback type=\"invalid\">{buscar.error?.response?.message || buscar.error?.message}</Form.Control.Feedback>\r\n    </>\r\n    : null}\r\n    {feedback ? <Form.Control.Feedback type=\"invalid\">{feedback}</Form.Control.Feedback> : null}\r\n  </InputGroup>\r\n}","\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\"\r\nimport { FaSync } from \"react-icons/fa\"\r\nimport { Typeahead, TypeaheadProps } from 'react-bootstrap-typeahead'\r\nimport { useQuery } from 'react-query'\r\nimport { Proveedor, Empresa, ProveedorService } from \"../services/ProveedoresService\"\r\nimport { isMatch } from \"../../../../commons/utils\"\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css'\r\n\r\n\r\nexport const ProveedoresTypeahead = ({isInvalid, feedback, filterBy, ...props}: {feedback?: string, onLoad?: (options: Proveedor[])=>void} &  Omit<TypeaheadProps<Proveedor>, \"isLoading\" | \"options\" | \"onSearch\">) => {\r\n  const queryKey = \"proveedores.buscar\"\r\n\r\n  const buscar = useQuery(queryKey, ()=>{\r\n    return ProveedorService.buscar({\r\n      activos: 1\r\n    })\r\n  }, {\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscar.data){\r\n      props.onLoad && props.onLoad(buscar.data?.data)\r\n    }\r\n  }, [buscar.data])\r\n\r\n  const options = useMemo(()=>{\r\n    if(Array.isArray(buscar.data?.data)){\r\n        return buscar.data?.data!\r\n    }\r\n    else if(buscar.data?.data){\r\n        console.error(buscar.data?.data)\r\n    }\r\n    return []\r\n  }, [buscar.data?.data])\r\n\r\n  return <InputGroup hasValidation>\r\n    <Typeahead\r\n      {...props}\r\n      className={(buscar.isError || isInvalid) ? \"is-invalid\" : \"\"}\r\n      isInvalid={buscar.isError || isInvalid}\r\n      filterBy={(proveedor, props)=>{\r\n        return  (!props.text || (proveedor.medico ? isMatch(proveedor.medico.nombreCompleto, props) : isMatch(proveedor.nombre, props)))\r\n          && (!filterBy || (typeof filterBy === \"function\" && filterBy(proveedor, props)))\r\n      }}\r\n      isLoading={buscar.isFetching}\r\n      options={options}\r\n      labelKey={(proveedor: Proveedor)=>{\r\n        if(proveedor.medico){\r\n          const medico = proveedor.medico\r\n          const nombre_completo = medico.nombres + (medico.apellidoPaterno ? \" \" + medico.apellidoPaterno : \"\") + (medico.apellidoMaterno ? \" \" + medico.apellidoMaterno : \"\")\r\n          return nombre_completo\r\n        }\r\n        else {\r\n          return (proveedor as Empresa).nombre\r\n        }\r\n      }}\r\n      minLength={0}\r\n      renderMenuItemChildren={(proveedor) => {\r\n        let title, subtitle;\r\n        if(proveedor.medico){\r\n          const medico = proveedor.medico\r\n          title = medico.nombres + (medico.apellidoPaterno ? \" \" + medico.apellidoPaterno : \"\") + (medico.apellidoMaterno ? \" \" + medico.apellidoMaterno : \"\")\r\n          subtitle = medico.especialidad\r\n        }\r\n        else {\r\n          title = proveedor.nombre\r\n          subtitle = \"Empresa\"\r\n        }\r\n        return <div>\r\n          <div>{title}</div>\r\n          <div className={\"small text-secondary\"}>{subtitle}</div> \r\n        </div>\r\n      }}\r\n    />\r\n    {buscar.isError ? <>\r\n      <InputGroup.Append>\r\n        <Button variant=\"outline-danger\" onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n      </InputGroup.Append>\r\n      <Form.Control.Feedback type=\"invalid\">{buscar.error?.response?.message || buscar.error?.message}</Form.Control.Feedback>\r\n    </>\r\n    : null}\r\n    {feedback ? <Form.Control.Feedback type=\"invalid\">{feedback}</Form.Control.Feedback> : null}\r\n  </InputGroup>\r\n}","import { useState } from \"react\"\r\nimport { Card, Accordion, Form, Table, Button } from \"react-bootstrap\"\r\nimport { useFormContext, useFieldArray, Controller, useController } from \"react-hook-form\"\r\nimport { FaPlus, FaMinus } from \"react-icons/fa\"\r\nimport { Prestacion, PrestacionesTypeahead } from \"./PrestacionesTypeahead\"\r\nimport { Proveedor } from \"../services/ProveedoresService\"\r\nimport { ProveedoresTypeahead } from \"./ProveedoresTypeahead\"\r\nimport { Regional } from \"../../../../commons/services\"\r\n\r\nexport type PrestacionesSolicitadasInputs = {\r\n  regional: Regional[],\r\n  prestacionesSolicitadas: {\r\n    id: number,\r\n    prestacion: Prestacion[],\r\n    nota: string,\r\n  }[],\r\n  proveedor?: Proveedor[]\r\n}\r\n\r\nexport const PrestacionesSolicitadasCard = () => {\r\n  const [count, setCount] = useState(1)\r\n  const { register, control, formState, watch } = useFormContext<PrestacionesSolicitadasInputs>()\r\n  const proveedoresTypeaheadController = useController({\r\n    name:\"proveedor\",\r\n    control\r\n  })\r\n  const { fields, append, remove } = useFieldArray({\r\n    control,\r\n    name: \"prestacionesSolicitadas\"\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n  const hasErrors = !!formErrors.prestacionesSolicitadas || !!formErrors.proveedor\r\n\r\n  return <Card style={{ overflow: \"visible\" }} >\r\n    <Accordion.Toggle as={Card.Header} className={\"text-light \" + (hasErrors ? \"bg-danger\" : \"bg-primary\")} eventKey=\"3\">\r\n      Prestaciones\r\n    </Accordion.Toggle>\r\n    <Accordion.Collapse eventKey=\"3\">\r\n      <div>\r\n        <Table className={formErrors.prestacionesSolicitadas ? \"is-invalid\": \"\"}>\r\n          <thead>\r\n            <tr>\r\n              <th style={{ width: 1 }}>#</th>\r\n              <th>Prestacion</th>\r\n              <th>Proveedor</th>\r\n              <th>Nota</th>\r\n              <th style={{ width: 1 }}></th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {fields.map((prestacionSolicitada, index) => {\r\n              return <tr key={prestacionSolicitada.id}>\r\n                <td>{index + 1}</td>\r\n                <td>\r\n                  <Controller\r\n                    name={`prestacionesSolicitadas.${index}.prestacion` as const}\r\n                    control={control}\r\n                    render={({ field, fieldState }) => {\r\n                      return <>\r\n                        <PrestacionesTypeahead\r\n                          id={`solicitud-atencion-externa/prestacionesSolicitadas.${index}.prestacion`}\r\n                          className={!!fieldState.error ? \"is-invalid\" : \"\"}\r\n                          isInvalid={!!fieldState.error}\r\n                          filterBy={(prestacion) => {\r\n                            const proveedor = watch(\"proveedor.0\")\r\n                            const prestacionesSolicitadas = watch(\"prestacionesSolicitadas\")\r\n                            return !proveedor ||\r\n                              proveedor.contrato.prestaciones.some(pc => pc.id == prestacion.id) && \r\n                              !prestacionesSolicitadas.some(ps=>ps.prestacion?.length && ps.prestacion[0].id == prestacion.id)\r\n                          }}\r\n                          feedback={fieldState.error?.message}\r\n                          selected={field.value}\r\n                          onBlur={field.onBlur}\r\n                          onChange={field.onChange}\r\n                        />\r\n                      </>\r\n                    }}\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <ProveedoresTypeahead\r\n                    id={`solicitud-atencion-externa/proveedor`}\r\n                    className={proveedoresTypeaheadController.fieldState?.error ? \"is-invalid\" : \"\"}\r\n                    isInvalid={!!proveedoresTypeaheadController.fieldState?.error}\r\n                    filterBy={(proveedor)=> !!(\r\n                      proveedor.regionalId == watch(\"regional.0.id\") &&\r\n                      watch(\"prestacionesSolicitadas\").every(ps=> proveedor.contrato.prestaciones.some(pc=>pc.id == (ps.prestacion.length && ps.prestacion[0].id)))\r\n                    )}\r\n                    feedback={proveedoresTypeaheadController.fieldState?.error?.message}\r\n                    onChange={proveedoresTypeaheadController.field.onChange}\r\n                    onBlur={proveedoresTypeaheadController.field.onBlur}\r\n                    selected={proveedoresTypeaheadController.field.value}\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <Form.Control as=\"textarea\" \r\n                    isInvalid={!!(formState.errors.prestacionesSolicitadas && formState.errors.prestacionesSolicitadas[index]?.nota)}\r\n                    {...register(`prestacionesSolicitadas.${index}.nota` as const)}\r\n                  />\r\n                  <Form.Control.Feedback type=\"invalid\">{formState.errors.prestacionesSolicitadas && formState.errors.prestacionesSolicitadas[index]?.nota?.message}</Form.Control.Feedback>\r\n                </td>\r\n                <td>\r\n                  <Button variant=\"link\" onClick={() => {\r\n                    console.log(\"Remove\", index)\r\n                    remove(index)\r\n                  }} className=\"btn-icon\"><FaMinus /></Button>\r\n                </td>\r\n              </tr>\r\n            })}\r\n            <tr>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n              <td>\r\n                <Button variant=\"link\" onClick={() => {\r\n                  console.log(count)\r\n                  append({\r\n                    id: count\r\n                  })\r\n                  setCount(count => count+1)\r\n                }} className=\"btn-icon\"><FaPlus /></Button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </Table>\r\n        <Form.Control.Feedback type=\"invalid\">{\r\n          //@ts-ignore\r\n          formErrors.prestacionesSolicitadas?.message}</Form.Control.Feedback>\r\n      </div>\r\n    </Accordion.Collapse>\r\n  </Card>\r\n}","import React, { ComponentProps, useRef, useEffect } from \"react\"\r\nimport { AxiosError } from \"axios\"\r\nimport { Accordion, Alert, Button, Card,Col,Form, Spinner } from \"react-bootstrap\"\r\nimport { useForm, Controller, FormProvider } from \"react-hook-form\"\r\nimport moment from \"moment\"\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { AseguradoCard, AseguradoInputs } from \"./AseguradoCard\"\r\nimport { MedicosTypeahead } from \"./MedicosTypeahead\"\r\nimport { PrestacionesSolicitadasInputs, PrestacionesSolicitadasCard } from \"./PrestacionesSolicitadasCard\"\r\nimport { useMutation } from \"react-query\"\r\nimport { Medico, SolicitudesAtencionExternaService } from \"../services\"\r\nimport { Regional, RegionalesTypeahead } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { Dm11Viewer } from \"./Dm11Viewer\"\r\nimport { Permisos } from \"../../../../commons/auth/constants\"\r\nimport { useLoggedUser } from \"../../../../commons/auth/hooks\"\r\nimport { EstadosAfi, EstadosEmp } from \"../utils\"\r\n\r\ntype Inputs = AseguradoInputs & PrestacionesSolicitadasInputs & {\r\n  regional: Regional[]\r\n  medico?: Medico[]\r\n}\r\n\r\nconst hoy = moment()\r\n\r\nconst estadoAfiSchema = yup.string().label(\"estado\").oneOf(Object.values(EstadosAfi), \"Estado desconocido\")\r\n.test(\"estado-incoherente\", \"\", function(value, context) {\r\n  if(value == EstadosAfi[1] && context.parent.tieneBaja){\r\n    return context.createError({\r\n      message: \"El asegurado figura como activo, pero hay un registro de su baja con fecha ${date}\",\r\n      params: {\r\n        date: context.parent.fechaRegBaja\r\n      }\r\n    })\r\n  }\r\n  if(value == EstadosAfi[2] && !context.parent.tieneBaja){\r\n    return context.createError({\r\n      message: \"El asegurado figura como dado de baja, aunque no se encontraron registros de la baja\"\r\n    })\r\n  }\r\n  return true\r\n})\r\n\r\nconst validezSchema = yup.mixed().label(\"fecha de extinsion\")\r\n.test(\"min\", \"\", function(value, context){\r\n  const {estado, tieneBaja} = context.parent\r\n  if(estado == EstadosAfi[2] && tieneBaja)\r\n    if(!value) return context.createError({\r\n      message: \"Fecha sin especificar, se asume que el seguro ya no tiene validez\"\r\n    })\r\n    if(moment(value).isSameOrBefore(hoy)) return context.createError({\r\n      message: \"El seguro ya no tiene validez\"\r\n    })\r\n  return true\r\n})\r\n\r\nconst schema = yup.object().shape({\r\n  asegurado: yup.object().shape({\r\n    matricula: yup.string().label(\"matricula\").trim().uppercase().required().matches(/^\\d{2}-\\d{4}-[a-zA-ZñÑ]{2,3}$/, \"Formato incorrecto.\"),\r\n    estado: estadoAfiSchema,\r\n    fechaExtincion: yup.lazy(value => value ? \r\n      yup.date().label(\"fecha de extinsion\").nullable().notRequired().min(hoy.toDate(), \"Fecha de extinsion alcanzada\") :\r\n      yup.mixed()),\r\n    fechaValidezSeguro: validezSchema\r\n  }),\r\n  titular: yup.lazy(value => value?.id ? yup.object().shape({\r\n    matricula: yup.string().label(\"matricula\").required(),\r\n    estado: estadoAfiSchema,\r\n    fechaValidezSeguro: validezSchema\r\n  }): yup.object() ),\r\n  empleador: yup.object().shape({\r\n    numeroPatronal: yup.string().label(\"numero patronal\").required(),\r\n    estado: yup.string().label(\"estado\").oneOf(Object.values(EstadosEmp), \"Estado desconocido\")\r\n    .test(\"estado-incoherente\", \"El empleador figura como activo, pero tiene fecha de baja\", function(value, context) {\r\n      return value != EstadosEmp[1] || !context.parent.fechaBaja\r\n    }),\r\n    fechaBaja: yup.mixed().when(\"estado\", {\r\n      is: (estado: string) => estado == EstadosEmp[2] || estado == EstadosEmp[3],\r\n      then: yup.date().required(\"Fecha sin especificar, se asume que el seguro ya no tiene validez\")\r\n               .min(hoy.subtract(2, \"months\").toDate())\r\n    }),\r\n    aportes: yup.lazy(value => value ? yup.string().oneOf([\"No\"], \"El empleador esta en mora\") : yup.string())\r\n  }),\r\n  regional: yup.array().length(1, \"Debe seleccionar una regional\"),\r\n  medico: yup.array().length(1, \"Debe seleccionar un medico\"),\r\n  proveedor: yup.array().length(1, \"Debe seleccionar un proveedor\"),\r\n  prestacionesSolicitadas: yup.array().of(yup.object().shape({\r\n    prestacion: yup.array().length(1, \"Debe seleccionar una prestacion\"),\r\n    nota: yup.string().label(\"nota\").nullable().notRequired().max(150)\r\n  })).min(1, \"Debe solicitar un servicio\").max(1, \"Solo puede solicitar un servicio por solicitud\")\r\n})\r\n\r\nexport const SolicitudAtencionExternaForm = ()=>{\r\n  const formMethods = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      regional: [],\r\n      medico: [],\r\n      proveedor: [],\r\n      prestacionesSolicitadas: [{\r\n        id: 0,\r\n        prestacion: [],\r\n        nota: \"\"\r\n      }],\r\n      asegurado: {},\r\n      titular: {},\r\n      empleador: {}\r\n    }\r\n  })\r\n  const {\r\n    handleSubmit,\r\n    trigger,\r\n    formState,\r\n    control,\r\n    reset,\r\n    setValue,\r\n    setError,\r\n    watch\r\n  } = formMethods\r\n\r\n  const dm11Viewer = useModal(\"dm11Viewer\")\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  console.log(\"Errors\", watch(), formState.errors)\r\n\r\n  const registrar = useMutation((values: Inputs)=>{\r\n    return SolicitudesAtencionExternaService.registrar(\r\n      values.regional![0].id,\r\n      values.asegurado.id,\r\n      values.medico![0].id,\r\n      values.proveedor![0].id,\r\n      values.prestacionesSolicitadas.map(({prestacion, nota})=>({\r\n        prestacion_id: prestacion![0].id,\r\n        nota\r\n      }))\r\n    )\r\n  }, {\r\n    onSuccess: ({data: {urlDm11, regionalId}}) => {\r\n      if(loggedUser.canAny([\r\n        Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n        Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR\r\n      ]) || (loggedUser.can(Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL) && regionalId == loggedUser.regionalId)){\r\n        dm11Viewer.open({url: urlDm11})\r\n        reset()\r\n      }\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n  const registrarError = registrar.error as AxiosError\r\n\r\n  const serverKeyErrorMappers = (key: string)=>{\r\n\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if(registrarError?.response?.status == 422){\r\n      const {errors} = registrarError.response?.data\r\n      Object.keys(errors).forEach((key: any)=>{\r\n        let localKey = key\r\n        if(key == \"asegurado.id\") localKey = \"asegurado.matricula\"\r\n        setError(localKey, {type: \"serverError\", message: errors[key]})\r\n      })\r\n    }\r\n  }, [registrarError])\r\n\r\n  const renderAlert = ()=>{\r\n    if(registrar.isSuccess){\r\n      return <Alert variant=\"success\">\r\n      La operacion se realizó exitosamente\r\n    </Alert>\r\n    }\r\n    if(registrar.isError){\r\n      return registrarError.response?.status != 422 ? <Alert variant=\"danger\">\r\n        {registrarError ? registrarError.response?.data?.message || registrarError.message : \"\"}\r\n      </Alert> : null\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <FormProvider {...formMethods}>\r\n    <Form onSubmit={handleSubmit((values)=>{\r\n      registrar.mutate(values)\r\n    })}>\r\n      <h1 style={{fontSize: \"1.75rem\"}}>Solicitud de atención externa</h1>\r\n      {renderAlert()}\r\n      <Accordion className=\"mt-3\"  defaultActiveKey=\"0\">\r\n        <AseguradoCard />\r\n        <Card style={{overflow: \"visible\"}} >\r\n          <Accordion.Toggle as={Card.Header} className={\"text-light \" + (formErrors.regional ? \"bg-danger\" : \"bg-primary\")} eventKey=\"1\">\r\n            Regional\r\n          </Accordion.Toggle>\r\n          <Accordion.Collapse eventKey=\"1\">\r\n            <Card.Body>\r\n              <Form.Row>\r\n                <Form.Group as={Col}>\r\n                  <Form.Label>Nombre</Form.Label>\r\n                  <Controller \r\n                    control={control}\r\n                    name=\"regional\"\r\n                    render={({field, fieldState})=>{\r\n                      return <RegionalesTypeahead\r\n                        id=\"solicitud-atencion-externa-form/regionales\"\r\n                        filterBy={(regional: Regional)=>{\r\n                          return (loggedUser.can(Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA) ? true : \r\n                            (regional.id == loggedUser.regionalId))\r\n                        }}\r\n                        isInvalid={!!fieldState.error}\r\n                        feedback={fieldState.error?.message}\r\n                        selected={field.value}\r\n                        onBlur={field.onBlur}\r\n                        onChange={(regional)=>{\r\n                          setValue(\"medico\", [])\r\n                          setValue(\"proveedor\", [])\r\n                          field.onChange(regional)\r\n                        }}\r\n                      />\r\n                    }}\r\n                  />\r\n                </Form.Group> \r\n              </Form.Row>\r\n            </Card.Body>\r\n          </Accordion.Collapse>\r\n        </Card>\r\n        <Card style={{overflow: \"visible\"}} >\r\n          <Accordion.Toggle as={Card.Header}  className={\"text-light \" + (formErrors.medico ? \"bg-danger\" : \"bg-primary\")} eventKey=\"2\">\r\n            Médico\r\n          </Accordion.Toggle>\r\n          <Accordion.Collapse eventKey=\"2\">\r\n            <Card.Body>\r\n              <Form.Row>\r\n                <Form.Group as={Col}>\r\n                  <Form.Label>Nombre</Form.Label>\r\n                  <Controller \r\n                    control={control}\r\n                    name=\"medico\"\r\n                    render={({field, fieldState})=>{\r\n                      return <><MedicosTypeahead\r\n                        id=\"solicitud-atencion-externa-form/medicos\"\r\n                        filterBy={(medico) => medico.regionalId == watch(\"regional.0.id\")}\r\n                        className={fieldState.error ? \"is-invalid\" : \"\"}\r\n                        isInvalid={!!formState.errors.medico}\r\n                        selected={field.value}\r\n                        onBlur={field.onBlur}\r\n                        onChange={field.onChange}\r\n                      />\r\n                      <Form.Control.Feedback type=\"invalid\">{fieldState.error?.message}</Form.Control.Feedback></>\r\n                    }}\r\n                  />\r\n                </Form.Group> \r\n              </Form.Row>\r\n            </Card.Body>\r\n          </Accordion.Collapse>\r\n        </Card>\r\n        <PrestacionesSolicitadasCard />\r\n      </Accordion>\r\n      <Button className=\"mt-3\" type=\"submit\">\r\n        {registrar.isLoading ? <Spinner animation=\"border\" size=\"sm\"/> : null}\r\n        Guardar\r\n      </Button>\r\n    </Form>\r\n    <Dm11Viewer />\r\n  </FormProvider>\r\n}","import axios, { AxiosPromise } from \"axios\"\r\nimport { PaginatedResponse } from \"../../../../commons/services\"\r\nimport apiClient from \"../../../../commons/services/apiClient\"\r\nimport { Page } from \"../../../../commons/services/Page\"\r\n\r\nexport type Especialidad = {\r\n  id: number,\r\n  nombre: string,\r\n}\r\n\r\ninterface EspecialidadesService {\r\n  buscar(filter: string): AxiosPromise<Especialidad[]>\r\n  buscar(filter: string, page: Page): AxiosPromise<PaginatedResponse<Especialidad>>\r\n  ver: (id: number) => AxiosPromise<Especialidad>\r\n  registrar: (nombre: string) => AxiosPromise<Especialidad>\r\n  actualizar: (id: number, nombre: string) => AxiosPromise<Especialidad>\r\n  eliminar: (id: number) => AxiosPromise<Especialidad>\r\n  importar(archivo: File, separador: string, formato: string): AxiosPromise\r\n\r\n}\r\n\r\nexport const EspecialidadesService: EspecialidadesService = {\r\n  buscar: (filter: string, page?: Page) => {\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source()\r\n  \r\n    const promise = apiClient.get(\"/especialidades\", {\r\n      params: {\r\n        filter: {\r\n          nombre: filter || undefined\r\n        },\r\n        page\r\n      }\r\n    })\r\n    //@ts-ignore\r\n    promise.cancel = () => {\r\n      source.cancel('Query was cancelled by React Query')\r\n    }\r\n    return promise\r\n  },\r\n  ver: (id: number) => {\r\n    return apiClient.get<Especialidad>(`especialidades/${id}`)\r\n  },\r\n  registrar: (nombre: string) => {\r\n    return apiClient.post<Especialidad>(\"especialidades\", {\r\n      nombre\r\n    })\r\n  },\r\n  actualizar: (id: number, nombre: string) => {\r\n    return apiClient.put<Especialidad>(`especialidades/${id}`, {\r\n      nombre\r\n    })\r\n  },\r\n  eliminar: (id: number) => {\r\n    return apiClient.delete(`especialidades/${id}`)\r\n  },\r\n  importar: (archivo: File, separador: string, formato: string) =>{\r\n    const formData = new FormData()\r\n    formData.append(\"archivo\", archivo, archivo.name)\r\n    formData.append(\"separador\", separador)\r\n    formData.append(\"formato\", formato)\r\n    return apiClient.post(\"/especialidades/importar\", formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    })\r\n  }\r\n}","import React from \"react\"\r\nimport { Form, Button, Col } from \"react-bootstrap\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { FaSearch } from \"react-icons/fa\"\r\n\r\ntype Props = {\r\n  onSearch: (nombre: string) => void \r\n}\r\nexport const EspecialidadesFilter = (props: Props) =>{\r\n  const { register, handleSubmit } = useForm<{nombre: string}>()\r\n  return <Form onSubmit={handleSubmit(({nombre})=>{\r\n    props.onSearch(nombre)\r\n  })} >\r\n    <Form.Row className=\"flex-nowrap\">\r\n      <Col>\r\n        <Form.Label htmlFor=\"nombre\" srOnly>Nombre</Form.Label>\r\n        <Form.Control id=\"nombre\" style={{minWidth: \"10rem\"}} {...register(\"nombre\")}></Form.Control>\r\n      </Col>\r\n      <Col xs={\"auto\"}>\r\n        <Button className=\"ml-2\" type=\"submit\"><FaSearch /></Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import React, { useState, useEffect, MutableRefObject } from \"react\"\r\nimport { Form, Modal, Row, Col, Button } from \"react-bootstrap\"\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useMutation } from \"react-query\";\r\nimport * as rules from \"../../../../commons/components/rules\"\r\nimport { EspecialidadesService } from \"../services\";\r\n\r\ntype Inputs = {\r\n  archivo: FileList|null,\r\n  separador: string,\r\n  formatoSaltoLinea: string,\r\n  aggrement: boolean\r\n}\r\nexport const ImportarForm = ({modalRef}: {modalRef: MutableRefObject<{show: (visible: boolean)=>void}|undefined>})=>{\r\n  const [visible, setVisible] = useState(false);\r\n\r\n  const {\r\n    register,\r\n    formState,\r\n    handleSubmit\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    defaultValues: {\r\n      archivo: null,\r\n      separador: \",\",\r\n      formatoSaltoLinea: \"UNIX\",\r\n      aggrement: false\r\n    }\r\n  })\r\n\r\n  const importFile = useMutation((vars: {archivo: File, separador: string, formatoSaltoLinea: string})=>{\r\n    return EspecialidadesService.importar(vars.archivo, vars.separador, vars.formatoSaltoLinea)\r\n  })\r\n\r\n  useEffect(()=>{\r\n    modalRef.current = {\r\n      show: setVisible\r\n    }\r\n  }, [])\r\n  return <Modal centered show={visible} onHide={()=>setVisible(false)}>\r\n    <Modal.Header>\r\n      Importar Datos\r\n    </Modal.Header>\r\n    <Modal.Body>\r\n      <Form id=\"importar-especialidades-form\" onSubmit={handleSubmit(({archivo, separador, formatoSaltoLinea})=>{\r\n        importFile.mutate({\r\n          archivo: archivo![0],\r\n          separador,\r\n          formatoSaltoLinea\r\n        })\r\n      })}>\r\n        <Form.Group as={Row}>\r\n          <Form.Label column sm={4}>Archivo</Form.Label>\r\n          <Col className=\"d-flex align-items-center\" sm={\"auto\"}>\r\n            <Form.File\r\n              isInvalid={!!formState.errors.archivo}\r\n              {...register(\"archivo\", {\r\n                required: rules.required(),\r\n              })}\r\n              feedback={formState.errors.archivo?.message}\r\n            />\r\n          </Col>\r\n        </Form.Group>\r\n        <Form.Group as={Row}>\r\n          <Form.Label column sm={4}>Separador</Form.Label>\r\n          <Col xs={\"auto\"}>\r\n            <Form.Control className=\"text-center\" maxLength={1} style={{width: \"2.5rem\"}}\r\n              isInvalid={!!formState.errors.separador}\r\n              {...register(\"separador\", {\r\n                required: rules.required()\r\n              })}\r\n            ></Form.Control>\r\n            <Form.Control.Feedback type={\"invalid\"}>{formState.errors.separador?.message}</Form.Control.Feedback>\r\n          </Col>\r\n        </Form.Group>\r\n        <Form.Group as={Row}>\r\n          <Form.Label column sm={4}>Salto de linea</Form.Label>\r\n          <Col className=\"d-flex\" xs={\"auto\"}>\r\n            <Form.Check inline type=\"radio\" label=\"DOS\" value=\"DOS\" {...register(\"formatoSaltoLinea\")}></Form.Check>\r\n            <Form.Check inline type=\"radio\" label=\"UNIX\" value=\"UNIX\" {...register(\"formatoSaltoLinea\")}></Form.Check>\r\n          </Col>\r\n        </Form.Group>\r\n        <Form.Check label=\"Entiendo los riesgos y he revisado cuidadosamente el contenido del archivo.\"\r\n          isInvalid={!!formState.errors.aggrement}\r\n          feedback={formState.errors.aggrement?.message}\r\n          {...register(\"aggrement\", {\r\n            required: rules.required()\r\n          })}\r\n        ></Form.Check>\r\n      </Form>\r\n    </Modal.Body>\r\n    <Modal.Footer>\r\n        <Button variant=\"danger\" type=\"submit\" form=\"importar-especialidades-form\">Importar</Button>\r\n        <Button>Cancelar</Button>\r\n    </Modal.Footer>\r\n  </Modal>\r\n}","import { AxiosError } from \"axios\"\r\nimport React, {useState, useRef} from \"react\"\r\nimport { Dropdown, ButtonGroup, Button, Form, Table, Spinner, Row, Col } from \"react-bootstrap\"\r\nimport { FaSync, FaEdit, FaTrash } from \"react-icons/fa\"\r\nimport { useMutation, useQuery } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport Pagination from \"../../../../commons/components/Pagination\"\r\nimport VerticalEllipsisDropdownToggle from \"../../../../commons/components/VerticalEllipsisDropdownToggle\"\r\nimport { Page } from \"../../../../commons/services/Page\"\r\nimport { EspecialidadesService } from \"../services\"\r\nimport { EspecialidadesFilter } from \"./EspecialidadesFilter\"\r\nimport { ImportarForm } from \"./ImportarForm\"\r\n\r\nexport const EspecialidadesIndex = ()=>{\r\n  const [total, setTotal] = useState(0)\r\n  const [page, setPage] = useState<Page>({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const [filter, setFilter] = useState(\"\")\r\n\r\n  const importModalRef = useRef<{show(visible: boolean): void}>()\r\n\r\n  const buscar = useQuery([\"especialidades.buscar\", page, filter], ()=>{\r\n    return EspecialidadesService.buscar(filter, page)\r\n  }, {\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: ({data: {meta}}) => {\r\n      setTotal(meta.total)\r\n    }\r\n  })\r\n\r\n  const eliminar = useMutation((id: number)=>{\r\n    return EspecialidadesService.eliminar(id)\r\n  })\r\n\r\n  const renderRows = ()=>{\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.isError) {\r\n      const { error } = buscar\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {(error as AxiosError).response?.data?.message || (error as AxiosError).message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    const records = buscar.data!.data.records\r\n    if(records.length == 0){\r\n      return  <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          No se encontraron resultados\r\n        </td>\r\n    </tr>\r\n    }\r\n    return records.map((especialidad, index)=>{\r\n      return <tr key={especialidad.id}>\r\n        <td>{index + 1}</td>\r\n        <td>{especialidad.nombre}</td>\r\n        <td>\r\n          <Dropdown>\r\n            <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n              variant=\"link\" id={`dropdown-especialidad-${especialidad.id}`}\r\n            />\r\n\r\n            <Dropdown.Menu>\r\n              <Dropdown.Item as={Link} replace to={{\r\n                pathname: `/clinica/configuracion/especialidades/${especialidad.id}/editar`,\r\n                state: {\r\n                  especialidad\r\n                }\r\n              }} ><FaEdit /><span className=\"ml-2 align-middle\">Editar</span></Dropdown.Item>\r\n              <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n                if (window.confirm(\"¿Está seguro?\")) {\r\n                  eliminar.mutate(especialidad.id)\r\n                }\r\n              }}>Eliminar</Dropdown.Item>\r\n            </Dropdown.Menu>\r\n          </Dropdown>\r\n        </td>\r\n      </tr>\r\n    })\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h2 style={{fontSize: \"1.75rem\"}}>Especialidades</h2>\r\n    <Row className=\"mb-2\">\r\n      <Col className=\"ml-auto pr-0\" xs=\"auto\" >\r\n        <Button onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Dropdown as={ButtonGroup}>\r\n          <Button as={Link} replace to={\"/clinica/configuracion/especialidades/registrar\"}>Nuevo</Button>\r\n          <Dropdown.Toggle split id=\"especialidades-dropdown\" />\r\n          <Dropdown.Menu>\r\n            <Dropdown.Item onClick={()=>{\r\n              console.log(importModalRef)\r\n              importModalRef.current && importModalRef.current.show(true)\r\n            }}\r\n            >Importar</Dropdown.Item>\r\n          </Dropdown.Menu>\r\n        </Dropdown>\r\n      </Col>\r\n    </Row>\r\n    <Row>\r\n      <Col className=\"mb-2\">\r\n        <EspecialidadesFilter onSearch={(filter)=>{\r\n          setFilter(filter)\r\n        }} />\r\n      </Col>\r\n      <Col className=\"mb-2\" xs={\"auto\"}>\r\n        <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n            <span>Mostrar</span>\r\n            <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n              const value = e.target.value\r\n              setPage((page) => ({\r\n                current: 1,\r\n                size: parseInt(value)\r\n              }))\r\n            }}>\r\n              <option value={10}>10</option>\r\n              <option value={20}>20</option>\r\n              <option value={30}>30</option>\r\n              <option value={50}>50</option>\r\n              <option value={100}>100</option>\r\n            </Form.Control>\r\n            <span>filas</span>\r\n        </div>\r\n      </Col>\r\n    </Row>\r\n    <Table responsive>\r\n      <thead>\r\n        <tr>\r\n          <th style={{width: 1}}>#</th>\r\n          <th>Nombre</th>\r\n          <th style={{width: 1}}></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {renderRows()}\r\n      </tbody>\r\n    </Table>\r\n    {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    <ImportarForm modalRef={importModalRef} />\r\n  </div>\r\n}","import { useEffect, useRef } from \"react\"\r\nimport { Alert, Button, Form, Modal, Spinner } from \"react-bootstrap\"\r\nimport { useParams, useHistory } from \"react-router-dom\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { useMutation, useQuery} from \"react-query\"\r\nimport * as rules from \"../../../../commons/components/rules\"\r\nimport { Especialidad, EspecialidadesService } from \"../services\"\r\nimport { AxiosError } from \"axios\"\r\n\r\nexport type Inputs = {\r\n  nombre: string\r\n}\r\n\r\nexport const EspecialidadForm = ()=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    especialidad: Especialidad\r\n  }>()\r\n  \r\n  const { state} = history.location\r\n\r\n  const continueRef = useRef<boolean>(false)\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    setValue,\r\n    formState,\r\n  } = useForm<Inputs>()\r\n\r\n  const guardar = useMutation(({nombre}: Inputs)=>{\r\n    return id ? EspecialidadesService.actualizar(parseInt(id), nombre) : EspecialidadesService.registrar(nombre)\r\n  }, {\r\n    onSuccess: ()=>{\r\n      if(!continueRef.current)\r\n        history.replace(\"/clinica/configuracion/especialidades\")\r\n    }\r\n  })\r\n\r\n  const cargar = useQuery([\"especialidades.cargar\", id], ()=>{\r\n    return EspecialidadesService.ver(parseInt(id as string))\r\n  }, {\r\n    enabled: !!id && !history.location.state?.especialidad,\r\n    refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const especialidad = cargar.data?.data || history.location.state?.especialidad\r\n\r\n  useEffect(()=>{\r\n    if(especialidad){\r\n      setValue(\"nombre\", especialidad.nombre)\r\n    }\r\n  }, [especialidad])\r\n\r\n  const renderBody = ()=>{\r\n    if(cargar.isFetching){\r\n      return <Spinner animation=\"border\">Cargando</Spinner>\r\n    }\r\n    const error = cargar.error as AxiosError\r\n    if(error){\r\n      return <Alert variant=\"danger\">\r\n        {error.response?.data?.message || error.message}\r\n      </Alert>\r\n    }\r\n    return <Form id=\"especialidad-form\"\r\n      onSubmit={handleSubmit((inputs)=>{\r\n        guardar.mutate(inputs)\r\n      })}\r\n    >\r\n      {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n        {guardar.isError ? guardar.error.response?.data?.message || guardar.error.message : \"Guardado\"}\r\n      </Alert> : null}\r\n      <Form.Group>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.nombre}\r\n          {...register(\"nombre\", {\r\n            required: rules.required()\r\n          })}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.nombre?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form>\r\n  }\r\n\r\n\r\n  return <Modal\r\n    show\r\n    centered\r\n    onHide={()=>{\r\n      history.replace(\"/clinica/configuracion/especialidades\")\r\n    }}\r\n  >\r\n    <Modal.Header>\r\n      {id ? \"Editar\" : \"Registrar\" }\r\n    </Modal.Header> \r\n    <Modal.Body>\r\n      {renderBody()}\r\n    </Modal.Body>\r\n    <Modal.Footer>\r\n      {!id ? <Button \r\n        type=\"submit\"\r\n        form=\"especialidad-form\"\r\n        onClick={()=>{\r\n          continueRef.current = true\r\n        }}\r\n      >\r\n        {guardar.isLoading && continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar y continuar\r\n      </Button> : null}\r\n      <Button\r\n        type=\"submit\"\r\n        form=\"especialidad-form\"\r\n        onClick={()=>{\r\n          continueRef.current = false\r\n        }}\r\n      >\r\n        {guardar.isLoading && !continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button>\r\n    </Modal.Footer>\r\n  </Modal>\r\n}","import { AxiosResponse } from \"axios\"\r\nimport { forwardRef, useImperativeHandle, useRef } from \"react\"\r\nimport { Alert, Button, Col, Form, Modal, ModalProps, Row, Spinner } from \"react-bootstrap\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { useMutation } from \"react-query\"\r\nimport { ImperativeModal, ImperativeModalRef } from \"./ImperativeModal\"\r\nimport * as rules from \"./rules\"\r\n\r\ntype ImportOptions= {\r\n  separator: string,\r\n  format: string \r\n}\r\n\r\ntype Inputs = {\r\n  archivo: FileList|null,\r\n  separador: string,\r\n  formatoSaltoLinea: string,\r\n  aggrement: boolean\r\n}\r\n\r\ntype Props = {\r\n  // import: (file: File, options: ImportOptions) => void\r\n  import: (\r\n    file: File,\r\n    options: ImportOptions\r\n  )=>Promise<any>\r\n} & ModalProps\r\n\r\nexport const ImportModal = forwardRef<ImperativeModalRef, Props>((props, ref)=>{\r\n  \r\n  const {\r\n    register,\r\n    formState,\r\n    handleSubmit\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    defaultValues: {\r\n      archivo: null,\r\n      separador: \",\",\r\n      formatoSaltoLinea: \"UNIX\",\r\n      aggrement: false\r\n    }\r\n  })\r\n\r\n  const importar = useMutation(({file, options}: {file: File, options: ImportOptions})=>{\r\n    return props.import(file, options)\r\n  })\r\n\r\n  // const imperativeModalRef = useRef<ImperativeModalRef>(null)\r\n\r\n  // useImperativeHandle(ref, () => ({\r\n  //   show: (show: boolean)=>{\r\n  //     imperativeModalRef.current?.show(show)\r\n  //   }\r\n  // }),[])\r\n  \r\n  return <ImperativeModal ref={ref} {...props}>\r\n  <Modal.Header>\r\n    Importar Datos\r\n  </Modal.Header>\r\n  <Modal.Body>\r\n    <Form id=\"importar-especialidades-form\" onSubmit={handleSubmit(({archivo, separador: separator, formatoSaltoLinea: format})=>{\r\n      importar.mutate({\r\n        file: archivo![0],\r\n        options: {\r\n          separator,\r\n          format\r\n        }\r\n      })\r\n    })}>\r\n      {importar.data ? <Alert variant={importar.isError ? \"danger\" : \"success\"}>\r\n        {importar.isError ? \"Error\" : \"Importacion existosa\"}\r\n      </Alert> :  null}\r\n      <Form.Group as={Row}>\r\n        <Form.Label column sm={4}>Archivo</Form.Label>\r\n        <Col className=\"d-flex align-items-center\" sm={\"auto\"}>\r\n          <Form.File\r\n            isInvalid={!!formState.errors.archivo}\r\n            {...register(\"archivo\", {\r\n              required: rules.required(),\r\n            })}\r\n            feedback={formState.errors.archivo?.message}\r\n          />\r\n        </Col>\r\n      </Form.Group>\r\n      <Form.Group as={Row}>\r\n        <Form.Label column sm={4}>Separador</Form.Label>\r\n        <Col xs={\"auto\"}>\r\n          <Form.Control className=\"text-center\" maxLength={1} style={{width: \"2.5rem\"}}\r\n            isInvalid={!!formState.errors.separador}\r\n            {...register(\"separador\", {\r\n              required: rules.required()\r\n            })}\r\n          ></Form.Control>\r\n          <Form.Control.Feedback type={\"invalid\"}>{formState.errors.separador?.message}</Form.Control.Feedback>\r\n        </Col>\r\n      </Form.Group>\r\n      <Form.Group as={Row}>\r\n        <Form.Label column sm={4}>Salto de linea</Form.Label>\r\n        <Col className=\"d-flex\" xs={\"auto\"}>\r\n          <Form.Check inline type=\"radio\" label=\"DOS\" value=\"DOS\" {...register(\"formatoSaltoLinea\")}></Form.Check>\r\n          <Form.Check inline type=\"radio\" label=\"UNIX\" value=\"UNIX\" {...register(\"formatoSaltoLinea\")}></Form.Check>\r\n        </Col>\r\n      </Form.Group>\r\n      <Form.Check label=\"Entiendo los riesgos y he revisado cuidadosamente el contenido del archivo.\"\r\n        isInvalid={!!formState.errors.aggrement}\r\n        feedback={formState.errors.aggrement?.message}\r\n        {...register(\"aggrement\", {\r\n          required: rules.required()\r\n        })}\r\n      ></Form.Check>\r\n    </Form>\r\n  </Modal.Body>\r\n  <Modal.Footer>\r\n      <Button variant=\"danger\" type=\"submit\" form=\"importar-especialidades-form\">\r\n        {importar.isLoading ? <Spinner animation=\"border\" size=\"sm\"/> : null}\r\n        Importar\r\n      </Button>\r\n      <Button>Cancelar</Button>\r\n  </Modal.Footer>\r\n</ImperativeModal>\r\n\r\n})","import { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\n\r\nexport type Prestacion = {\r\n  id: number,\r\n  nombre: string,\r\n}\r\n\r\nexport const PrestacionesService = {\r\n  buscar: (page: Page, filter: string) => {\r\n    return apiClient.get<PaginatedResponse<Prestacion>>(\"/prestaciones\", {\r\n      params: {\r\n        filter: {\r\n          nombre: filter || undefined\r\n        },\r\n        page\r\n      }\r\n    })\r\n  },\r\n  ver: (id: number) => {\r\n    return apiClient.get<Prestacion>(`prestaciones/${id}`)\r\n  },\r\n  registrar: (nombre: string) => {\r\n    return apiClient.post<Prestacion>(\"prestaciones\", {\r\n      nombre\r\n    })\r\n  },\r\n  actualizar: (id: number, nombre: string) => {\r\n    return apiClient.put<Prestacion>(`prestaciones/${id}`, {\r\n      nombre\r\n    })\r\n  },\r\n  eliminar: (id: number) => {\r\n    return apiClient.delete(`prestaciones/${id}`)\r\n  },\r\n  importar: (archivo: File, separador: string, formato: string) =>{\r\n    const formData = new FormData()\r\n    formData.append(\"archivo\", archivo, archivo.name)\r\n    formData.append(\"separador\", separador)\r\n    formData.append(\"formato\", formato)\r\n    return apiClient.post(\"/prestaciones/importar\", formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    })\r\n  }\r\n}","import React from \"react\"\r\nimport { Form, Button, Col } from \"react-bootstrap\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { FaSearch } from \"react-icons/fa\"\r\n\r\ntype Props = {\r\n  onSearch: (nombre: string) => void \r\n}\r\nexport const PrestacionesFilterForm = (props: Props) =>{\r\n  const { register, handleSubmit } = useForm<{nombre: string}>()\r\n  return <Form onSubmit={handleSubmit(({nombre})=>{\r\n    props.onSearch(nombre)\r\n  })} >\r\n    <Form.Row className=\"flex-nowrap\">\r\n      <Col>\r\n        <Form.Label htmlFor=\"nombre\" srOnly>Nombre</Form.Label>\r\n        <Form.Control id=\"nombre\" style={{minWidth: \"10rem\"}} {...register(\"nombre\")}></Form.Control>\r\n      </Col>\r\n      <Col xs={\"auto\"}>\r\n        <Button className=\"ml-2\" type=\"submit\"><FaSearch /></Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import { AxiosError } from \"axios\"\r\nimport {useState, useRef} from \"react\"\r\nimport { Dropdown, ButtonGroup, Button, Form, Table, Spinner, Row, Col } from \"react-bootstrap\"\r\nimport { FaSync, FaEdit, FaTrash } from \"react-icons/fa\"\r\nimport { useQuery, useMutation } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { ImperativeModalRef } from \"../../../../commons/components/ImperativeModal\"\r\nimport { ImportModal } from \"../../../../commons/components/ImportModal\"\r\nimport Pagination from \"../../../../commons/components/Pagination\"\r\nimport VerticalEllipsisDropdownToggle from \"../../../../commons/components/VerticalEllipsisDropdownToggle\"\r\nimport { Page } from \"../../../../commons/services/Page\"\r\nimport { PrestacionesService } from \"../services\"\r\nimport { PrestacionesFilterForm } from \"./PrestacionesFilterForm\"\r\n\r\nexport const PrestacionesIndex = ()=>{\r\n  const [total, setTotal] = useState(0)\r\n  const [page, setPage] = useState<Page>({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const [filter, setFilter] = useState(\"\")\r\n\r\n  const importModalRef = useRef<ImperativeModalRef>(null)\r\n\r\n  const buscarPrestaciones = useQuery([\"buscarPrestaciones\", page, filter], ()=>{\r\n    return PrestacionesService.buscar(page, filter)\r\n  }, {\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: ({data: {meta}}) => {\r\n      setTotal(meta.total)\r\n    }\r\n  })\r\n\r\n  const eliminar = useMutation((id: number)=>{\r\n    return PrestacionesService.eliminar(id)\r\n  })\r\n\r\n  const renderRows = ()=>{\r\n    if (buscarPrestaciones.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscarPrestaciones.isError) {\r\n      const { error } = buscarPrestaciones\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {(error as AxiosError).response?.data?.message || (error as AxiosError).message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    const records = buscarPrestaciones.data!.data.records\r\n    if(records.length == 0){\r\n      return  <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          No se encontraron resultados\r\n        </td>\r\n    </tr>\r\n    }\r\n    return records.map((prestacion, index)=>{\r\n      return <tr key={prestacion.id}>\r\n        <td>{index + 1}</td>\r\n        <td>{prestacion.nombre}</td>\r\n        <td>\r\n          <Dropdown>\r\n            <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n              variant=\"link\" id={`dropdown-prestacion-${prestacion.id}`}\r\n            />\r\n            <Dropdown.Menu>\r\n              <Dropdown.Item as={Link} replace to={{\r\n                pathname: `/clinica/configuracion/prestaciones/${prestacion.id}/editar`,\r\n                state: {\r\n                  prestacion\r\n                }\r\n              }} ><FaEdit /><span className=\"ml-2 align-middle\">Editar</span></Dropdown.Item>\r\n              <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n                if (window.confirm(\"¿Está seguro?\")) {\r\n                  eliminar.mutate(prestacion.id)\r\n                }\r\n              }}><FaTrash /><span className=\"ml-2 align-middle\">Eliminar</span></Dropdown.Item>\r\n            </Dropdown.Menu>\r\n          </Dropdown>\r\n        </td>\r\n      </tr>\r\n    })\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h2 style={{fontSize: \"1.75rem\"}}>Servicios subrogados</h2>\r\n    <Row className=\"mb-2\">\r\n      <Col className=\"ml-auto pr-0\" xs=\"auto\" >\r\n        <Button onClick={()=>buscarPrestaciones.refetch()}><FaSync /></Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Dropdown as={ButtonGroup}>\r\n          <Button as={Link} replace to={\"/clinica/configuracion/prestaciones/registrar\"}>Nuevo</Button>\r\n          <Dropdown.Toggle split id=\"especialidades-dropdown\" />\r\n          <Dropdown.Menu>\r\n            <Dropdown.Item onClick={()=>{\r\n              console.log(importModalRef)\r\n              importModalRef.current && importModalRef.current.show(true)\r\n            }}\r\n            >Importar</Dropdown.Item>\r\n          </Dropdown.Menu>\r\n        </Dropdown>\r\n      </Col>\r\n    </Row>\r\n    <Row>\r\n      <Col className=\"mb-2\">\r\n        <PrestacionesFilterForm onSearch={(filter)=>{\r\n          setFilter(filter)\r\n        }} />\r\n      </Col>\r\n      <Col className=\"mb-2\" xs={\"auto\"}>\r\n        <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n            <span>Mostrar</span>\r\n            <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n              const value = e.target.value\r\n              setPage((page) => ({\r\n                ...page,\r\n                size: parseInt(value)\r\n              }))\r\n            }}>\r\n              <option value={10}>10</option>\r\n              <option value={20}>20</option>\r\n              <option value={30}>30</option>\r\n              <option value={50}>50</option>\r\n              <option value={100}>100</option>\r\n            </Form.Control>\r\n            <span>filas</span>\r\n        </div>\r\n      </Col>\r\n    </Row>\r\n    <Table responsive>\r\n      <thead>\r\n        <tr>\r\n          <th style={{width: 1}}>#</th>\r\n          <th>Nombre</th>\r\n          <th style={{width: 1}}></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {renderRows()}\r\n      </tbody>\r\n    </Table>\r\n    <div className=\"d-flex flex-row\">\r\n      <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n      <Pagination\r\n        current={page.current}\r\n        total={Math.ceil((total - page.size) / page.size) + 1}\r\n        onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n      />\r\n    </div>\r\n    <ImportModal ref={importModalRef}\r\n      import={(file, options)=>{\r\n        return PrestacionesService.importar(file, options.separator, options.format)\r\n      }}\r\n    />\r\n  </div>\r\n}","import { useEffect, useRef } from \"react\"\r\nimport { Alert, Button, Form, Modal, Spinner } from \"react-bootstrap\"\r\nimport { useParams, useHistory } from \"react-router-dom\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { useMutation, useQuery} from \"react-query\"\r\nimport * as rules from \"../../../../commons/components/rules\"\r\nimport { Prestacion, PrestacionesService } from \"../services\"\r\nimport { AxiosError } from \"axios\"\r\n\r\nexport type Inputs = {\r\n  nombre: string\r\n}\r\n\r\nexport const PrestacionForm = ()=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    prestacion: Prestacion\r\n  }>()\r\n  \r\n  const { state} = history.location\r\n  \r\n  const prestacion = state?.prestacion\r\n\r\n  const continueRef = useRef<boolean>(false)\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    setValue,\r\n    formState,\r\n  } = useForm<Inputs>()\r\n\r\n  const guardar = useMutation(({nombre}: Inputs)=>{\r\n    return id ? PrestacionesService.actualizar(parseInt(id), nombre) : PrestacionesService.registrar(nombre)\r\n  }, {\r\n    onSuccess: ()=>{\r\n      if(!continueRef.current)\r\n        history.replace(\"/clinica/configuracion/prestaciones\")\r\n    }\r\n  })\r\n\r\n  const verPrestacion = useQuery([\"verPrestacion\", id], ()=>{\r\n    return PrestacionesService.ver(parseInt(id as string))\r\n  }, {\r\n    enabled: !!id && !prestacion,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(verPrestacion.data?.data || prestacion){\r\n      setValue(\"nombre\", (verPrestacion.data?.data || prestacion).nombre)\r\n    }\r\n  }, [verPrestacion.data])\r\n\r\n  const renderBody = ()=>{\r\n    if(verPrestacion.isFetching){\r\n      return <Spinner animation=\"border\">Cargando</Spinner>\r\n    }\r\n    const error = verPrestacion.error as AxiosError\r\n    if(error){\r\n      return <Alert variant=\"danger\">\r\n        {error.response?.data?.message || error.message}\r\n      </Alert>\r\n    }\r\n    return <Form id=\"prestacion-form\"\r\n      onSubmit={handleSubmit((inputs)=>{\r\n        guardar.mutate(inputs)\r\n      })}\r\n    >\r\n      {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n        {guardar.isError ? guardar.error.response?.data?.message || guardar.error.message : \"Guardado\"}\r\n      </Alert> : null}\r\n      <Form.Group>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.nombre}\r\n          {...register(\"nombre\", {\r\n            required: rules.required()\r\n          })}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.nombre?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form>\r\n  }\r\n\r\n\r\n  return <Modal\r\n    show\r\n    centered\r\n    onHide={()=>{\r\n      history.replace(\"/clinica/configuracion/prestaciones\")\r\n    }}\r\n  >\r\n    <Modal.Header>\r\n      {id ? \"Editar\" : \"Registrar\" }\r\n    </Modal.Header> \r\n    <Modal.Body>\r\n      {renderBody()}\r\n    </Modal.Body>\r\n    <Modal.Footer>\r\n      {!id ? <Button \r\n        type=\"submit\"\r\n        form=\"prestacion-form\"\r\n        onClick={()=>{\r\n          continueRef.current = true\r\n        }}\r\n      >\r\n        {guardar.isLoading && continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar y continuar\r\n      </Button> : null}\r\n      <Button\r\n        type=\"submit\"\r\n        form=\"prestacion-form\"\r\n        onClick={()=>{\r\n          continueRef.current = false\r\n        }}\r\n      >\r\n        {guardar.isLoading && !continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button>\r\n    </Modal.Footer>\r\n  </Modal>\r\n}","import { Permisos, useLoggedUser } from \"../../../../commons/auth\";\r\n\r\nexport const MedicoPolicy = {\r\n  index: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.VER_MEDICOS,\r\n      Permisos.VER_MEDICOS_REGIONAL,\r\n      Permisos.REGISTRAR_MEDICOS,\r\n      Permisos.REGISTRAR_MEDICOS_REGIONAL\r\n    ])\r\n  },\r\n  register: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.REGISTRAR_MEDICOS,\r\n      Permisos.REGISTRAR_MEDICOS_REGIONAL\r\n    ])\r\n  },\r\n  edit: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.EDITAR_MEDICOS,\r\n      Permisos.EDITAR_MEDICOS_REGIONAL\r\n    ])\r\n  },\r\n  view: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.VER_MEDICOS,\r\n      Permisos.VER_MEDICOS_REGIONAL\r\n    ])\r\n  },\r\n  baja: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.BAJA_MEDICOS,\r\n      Permisos.BAJA_MEDICOS_REGIONAL\r\n    ])\r\n  }\r\n}","import React from \"react\"\r\nimport { MedicoFilter as Filter } from \"../services\"\r\n\r\ntype Props = {\r\n  onFilter: (filter: Filter) => void\r\n}\r\n\r\nexport const MedicosFilterForm = (props: Props)=>{\r\n  return null\r\n}","import { useEffect } from \"react\"\r\nimport { Dropdown } from \"react-bootstrap\"\r\n// import { FaEdit } from \"react-icons/fa\"\r\nimport { useMutation, useQueryClient } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { Medico, MedicosService } from \"../services\"\r\nimport { MedicoPolicy } from \"../policies\"\r\n\r\ntype Props = {\r\n  medico: Medico\r\n}\r\nexport const RowOptions = ({medico}: Props) => {\r\n\r\n  const modal = useModal<{\r\n    state: \"loading\" | \"error\"\r\n    error?: Error\r\n  }>(\"queryLoader\")\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const cambiarEstado = useMutation(()=>{\r\n    return MedicosService.cambiarEstado(medico.id, medico.estado == 1 ? 2 : 1)\r\n  }, {\r\n    onSuccess: ()=>{\r\n      modal.close()\r\n      queryClient.setQueryData(\"listaMora.buscar\", (oldData: any) => {\r\n        console.log(oldData)\r\n        return {\r\n          ...oldData,\r\n          data: {\r\n            ...oldData.data,\r\n            records: oldData.data.records.map((i: any)=>{\r\n              return i == medico ? {\r\n                ...i,\r\n                estado: 2\r\n              } : i\r\n            })\r\n          }\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(cambiarEstado.status == \"loading\"){\r\n      modal.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n    else if(cambiarEstado.status == \"error\"){\r\n      modal.open({\r\n        state: \"error\",\r\n        error: cambiarEstado.error\r\n      })\r\n    }\r\n  }, [cambiarEstado.status])\r\n\r\n  return <Dropdown>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-medicos-${medico.id}`}\r\n    />\r\n    \r\n    <Dropdown.Menu>\r\n      <ProtectedContent\r\n        authorize={MedicoPolicy.edit}\r\n      >\r\n        <Dropdown.Item as={Link} to={{\r\n          pathname: `/clinica/medicos/${medico.id}/editar`,\r\n          state: {\r\n            medico\r\n          }\r\n        }} ><span className=\"align-middle\">Editar</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n      <ProtectedContent\r\n        authorize={MedicoPolicy.baja}\r\n      >\r\n        <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n          if (window.confirm(\"¿Está seguro?\")) {\r\n            cambiarEstado.mutate()\r\n          }\r\n        }}>{medico.estado == 1 ? \"Baja\" : \"Alta\"}</Dropdown.Item>\r\n      </ProtectedContent>\r\n    </Dropdown.Menu>\r\n  </Dropdown>  \r\n}\r\n\r\n{/* <Dropdown>\r\n<Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n  variant=\"link\" id={`dropdown-${medico.id}`}\r\n/>\r\n\r\n<Dropdown.Menu>\r\n  <Dropdown.Item as={Link} to={{\r\n    pathname: `/clinica/medicos/${medico.id}/editar`,\r\n    state: {\r\n      medico: medico\r\n    }\r\n  }} ><FaEdit /><span className=\"ml-2 align-middle\">Editar</span></Dropdown.Item>\r\n  <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n    if (window.confirm(\"¿Está seguro?\")) {\r\n      eliminar.mutate(medico.id)\r\n    }\r\n  }}><FaTrash /><span className=\"ml-2 align-middle\" >Eliminar</span></Dropdown.Item>\r\n</Dropdown.Menu>\r\n</Dropdown> */}\r\n","import { AxiosError, AxiosPromise } from \"axios\"\r\nimport { useEffect, useRef, useState } from \"react\"\r\nimport { Button, Col, Form, Row, Spinner, Table } from \"react-bootstrap\"\r\nimport { FaFilter, FaSync, FaPlus } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport { Pagination } from \"../../../../commons/components\"\r\nimport { ProtectedContent, useLoggedUser, Permisos } from \"../../../../commons/auth\"\r\nimport { PaginatedResponse } from \"../../../../commons/services\"\r\nimport { MedicoPolicy } from \"../policies\"\r\nimport { Medico, MedicosService, MedicoFilter as Filter } from \"../services\"\r\nimport { MedicosFilterForm } from \"./MedicosFilterForm\"\r\nimport { RowOptions } from \"./RowOptions\"\r\n\r\nexport const MedicosIndex = () => {\r\n  const {pathname: path} = useLocation()\r\n  const [page, setPage] = useState({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser();\r\n  \r\n  const getDefaultFilter = ()=>{\r\n    const filter: Filter = { tipo: 1 }\r\n    if(!loggedUser.can(Permisos.VER_MEDICOS)){\r\n      if(loggedUser.can(Permisos.VER_MEDICOS_REGIONAL)){\r\n        filter.regionalId = loggedUser.regionalId;\r\n      }\r\n    }\r\n    return filter\r\n  }\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n  \r\n  const [filterFormVisible, showFilterForm] = useState(false)\r\n\r\n  const queryKey = \"medicos.buscar\";\r\n  const buscar = useQuery(queryKey, () => {\r\n    return MedicosService.buscar(filter, page) as AxiosPromise<PaginatedResponse<Medico>>\r\n  }, {\r\n    enabled: MedicoPolicy.view(loggedUser),\r\n    refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const total = buscar.data?.data?.meta?.total || 0\r\n\r\n  const didMountRef = useRef(false)\r\n  useEffect(()=>{\r\n    if(!didMountRef.current) {\r\n      didMountRef.current = true\r\n      return\r\n    }\r\n    if(MedicoPolicy.view(loggedUser)) buscar.refetch()\r\n  }, [page, filter, loggedUser])\r\n\r\n  const renderRows = () => {\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.isError) {\r\n      const error = buscar.error as AxiosError\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {error.response?.data?.message || error.message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if(buscar.data){\r\n      const records = buscar.data.data.records\r\n      if(records.length == 0){\r\n        return  <tr>\r\n          <td className=\"bg-light text-center\" colSpan={100}>\r\n            No se encontraron resultados\r\n          </td>\r\n      </tr>\r\n      }\r\n      return records.map((medico, index) => {\r\n        return <tr key={medico.id}>\r\n          <th scope=\"row\">\r\n            {index + 1}\r\n          </th>\r\n          <td>\r\n            {medico.ciText}\r\n          </td>\r\n          <td>\r\n            {medico.nombreCompleto}\r\n          </td>\r\n          <td>\r\n            {medico.especialidad}\r\n          </td>\r\n          <td>\r\n            {medico.estadoText}\r\n          </td>\r\n          <td>\r\n            <RowOptions medico={medico} />\r\n          </td>\r\n        </tr>\r\n      })\r\n    }\r\n  }\r\n\r\n  \r\n  return <div className=\"px-1\">\r\n    <h1 style={{fontSize: \"1.75rem\"}}>Medicos</h1>\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\" >\r\n        <ProtectedContent\r\n          authorize={MedicoPolicy.view}\r\n        >\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col className={\"pr-0\"} xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              showFilterForm(visible=>!visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={MedicoPolicy.register}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button\r\n              as={Link}\r\n              to={`${path}/registrar`}\r\n              className=\"d-flex align-items-center\">\r\n                <FaPlus className=\"mr-1\" /><span>Nuevo</span>\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={MedicoPolicy.view}\r\n    >\r\n      <Row>\r\n        <Col className=\"mb-2\">\r\n          <MedicosFilterForm onFilter={(filter)=>{\r\n            setFilter(filter)\r\n          }} />\r\n        </Col>\r\n        <Col className=\"mb-2\" xs={\"auto\"}>\r\n          <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n              <span>Mostrar</span>\r\n              <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n                const value = e.target.value\r\n                setPage((page) => ({\r\n                  ...page,\r\n                  size: parseInt(value)\r\n                }))\r\n              }}>\r\n                <option value={10}>10</option>\r\n                <option value={20}>20</option>\r\n                <option value={30}>30</option>\r\n                <option value={50}>50</option>\r\n                <option value={100}>100</option>\r\n              </Form.Control>\r\n              <span>filas</span>\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n      <Table responsive>\r\n        <thead>\r\n          <tr>\r\n            <th style={{width: 1}}>#</th>\r\n            <th>C.I.</th>\r\n            <th>Nombre</th>\r\n            <th>Especialidad</th>\r\n            <th>Estado</th>\r\n            <th style={{width: 1}}></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {renderRows()}\r\n        </tbody>\r\n      </Table>\r\n      {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    </ProtectedContent>\r\n  </div>\r\n}","\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\"\r\nimport { Typeahead, TypeaheadProps } from 'react-bootstrap-typeahead'\r\nimport { FaSync } from 'react-icons/fa'\r\nimport { useQuery } from 'react-query'\r\nimport { Especialidad, EspecialidadesService } from \"../../especialidades/services\";\r\nimport { isMatch } from \"../../../../commons/utils\";\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\r\n\r\nexport type { Especialidad }\r\n\r\nexport const EspecialidadesTypeahead = ({isInvalid, feedback, filterBy, ...props}: {feedback?: string, onLoad?: (options: Especialidad[])=>void} & Omit<TypeaheadProps<Especialidad>, \"isLoading\" | \"options\" | \"onSearch\">) => {\r\n  const queryKey = \"especialidades.buscar\"\r\n\r\n  const buscar = useQuery(queryKey, ()=>{\r\n    return EspecialidadesService.buscar(\"\")\r\n  }, {\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscar.data){\r\n      props.onLoad && props.onLoad(buscar.data?.data)\r\n    }\r\n  }, [buscar.data])\r\n\r\n  const options = useMemo(()=>{\r\n    if(Array.isArray(buscar.data?.data)){\r\n        return buscar.data?.data!\r\n    }\r\n    else if(buscar.data?.data){\r\n        console.error(buscar.data?.data)\r\n    }\r\n    return []\r\n  }, [buscar.data?.data])\r\n\r\n  return <InputGroup hasValidation>\r\n    <Typeahead\r\n      {...props}\r\n      className={\"is-invalid\"}\r\n      isInvalid={buscar.isError || isInvalid}\r\n      filterBy={(especialidad, props)=>{\r\n        return (!props.text || isMatch(especialidad.nombre, props)) \r\n          && (!filterBy || (typeof filterBy === \"function\" && filterBy(especialidad, props)))\r\n      }}\r\n      isLoading={buscar.isFetching}\r\n      options={options}\r\n      labelKey=\"nombre\"\r\n    />\r\n    {buscar.isError ? <>\r\n      <InputGroup.Append>\r\n        <Button variant=\"outline-danger\" onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n      </InputGroup.Append>\r\n      <Form.Control.Feedback type=\"invalid\">{buscar.error?.response?.message || buscar.error?.message}</Form.Control.Feedback>\r\n    </>\r\n    : null}\r\n    {feedback ? <Form.Control.Feedback type=\"invalid\">{feedback}</Form.Control.Feedback> : null}\r\n  </InputGroup>\r\n}","import { AxiosError } from 'axios'\r\nimport { useEffect, useState, useRef } from 'react'\r\nimport { Alert, Button, Col, Form, Spinner } from 'react-bootstrap'\r\nimport { Controller, useForm } from 'react-hook-form'\r\nimport { useMutation, useQuery } from 'react-query'\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { Medico, MedicosService } from '../services'\r\nimport { useHistory, useParams } from 'react-router'\r\nimport { Regional, RegionalesTypeahead } from '../../../../commons/components'\r\nimport { Permisos, useLoggedUser } from '../../../../commons/auth'\r\nimport { useModal } from '../../../../commons/reusable-modal'\r\nimport { Especialidad, EspecialidadesTypeahead } from './EspecialidadesTypeahead'\r\n\r\ntype Inputs = {\r\n  ci: string\r\n  ciComplemento: string\r\n  apellidoPaterno: string\r\n  apellidoMaterno: string\r\n  nombres: string\r\n  especialidad: Especialidad[]\r\n  regional: Regional[]\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  ci: yup.number().label(\"número de carnet\").typeError(\"El ${path} no es un numero valido\"),\r\n  ciComplemento: yup.string().label(\"número complemento\").transform(value => value === \"\" ? null : value).trim()\r\n    .uppercase().nullable().notRequired()\r\n    .length(2)\r\n    .matches(/(?=.*[A-Z])(?=.*[0-9])/, \"El complemento del carnet esta conformado por un numero y una letra. (No confundir con el expedido)\"),\r\n  apellidoPaterno: yup.string().label(\"apellido paterno\").trim().when(\"apellidoMaterno\", {\r\n    is: (apellidoMaterno: string) => !apellidoMaterno,\r\n    then: yup.string().required(\"Debe proporcionar al menos un apellido\")\r\n  }),\r\n  apellidoMaterno: yup.string().label(\"apellido materno\").trim().when(\"apellidoPaterno\", {\r\n    is: (apellidoPaterno: string) => !apellidoPaterno,\r\n    then: yup.string().required(\"Debe proporcionar al menos un apellido\")\r\n  }),\r\n  nombres: yup.string().label(\"nombres\").trim().required(),\r\n  especialidad: yup.array().length(1, \"Debe indicar una especialidad\"),\r\n  regional: yup.array().length(1, \"Debe indicar una regional\")\r\n}, [[\"apellidoMaterno\", \"apellidoPaterno\"]])\r\n\r\nexport const MedicosForm = ()=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    medico?: Medico\r\n    ignoreAuthorization?: boolean\r\n  }>()\r\n\r\n  const modal = useModal(\"queryLoader\")\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const [regionales, setRegionales] = useState<Regional[]>([])\r\n  const [especialidades, setEspecialidades] = useState<Especialidad[]>([])\r\n\r\n  const continueRef = useRef<boolean>(false)\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    clearErrors,\r\n    setError,\r\n    setValue,\r\n    control,\r\n    formState,\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      especialidad: [],\r\n      regional: []\r\n    }\r\n  })\r\n\r\n  console.log(\"Errors\", formState.errors)\r\n\r\n  const guardar = useMutation((inputs: Inputs)=>{\r\n    return id ? MedicosService.actualizar(parseInt(id), {\r\n        raiz: parseInt(inputs.ci),\r\n        complemento: inputs.ciComplemento\r\n      },\r\n      inputs.apellidoPaterno,\r\n      inputs.apellidoMaterno,\r\n      inputs.nombres,\r\n      inputs.especialidad![0].id,\r\n      inputs.regional![0].id\r\n    ) : MedicosService.registrar({\r\n        raiz: parseInt(inputs.ci),\r\n        complemento: inputs.ciComplemento\r\n      },\r\n      inputs.apellidoPaterno,\r\n      inputs.apellidoMaterno,\r\n      inputs.nombres,\r\n      inputs.especialidad![0].id,\r\n      inputs.regional![0].id\r\n    )\r\n  }, {\r\n    onSuccess: ()=>{\r\n      if(!continueRef.current)\r\n        history.replace(\"/clinica/medicos\", {\r\n          ignoreAuthorization: true\r\n        })\r\n    },\r\n    onError: (error) => {\r\n      if(error?.response?.status == 422){\r\n        const {errors} = error.response?.data\r\n        Object.keys(errors).forEach((key: any)=>{\r\n          let localKey = key\r\n          // if(key == \"asegurado.id\") localKey = \"asegurado.matricula\"\r\n          setError(localKey, {type: \"serverError\", message: errors[key]})\r\n        })\r\n      }\r\n    }\r\n  })\r\n\r\n  const cargar = useQuery([\"medicos.cargar\", id], ()=>{\r\n    return MedicosService.load(parseInt(id as string))\r\n  }, {\r\n    enabled: !!id && !history.location.state?.medico,\r\n    refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n    onSuccess: () => {\r\n      modal.close()\r\n    },\r\n    onError: (error) => {\r\n      modal.open({\r\n        state: \"error\",\r\n        error: error\r\n      })\r\n    }\r\n  })\r\n\r\n  const medico = cargar.data?.data || history.location.state?.medico\r\n\r\n  useEffect(()=>{\r\n    if(medico){\r\n      setValue(\"ci\", String(medico.ci.raiz))\r\n      setValue(\"ciComplemento\", medico.ci.complemento)\r\n      setValue(\"apellidoPaterno\", medico.apellidoPaterno)\r\n      setValue(\"apellidoMaterno\", medico.apellidoMaterno)\r\n      setValue(\"nombres\", medico.nombres)\r\n    }\r\n  }, [medico])\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isFetching){\r\n      modal.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n  }, [cargar.isFetching])\r\n\r\n  useEffect(()=>{\r\n    if(medico && regionales.length){\r\n      setValue(\"regional\", regionales.filter(r=>r.id == medico.regionalId))\r\n    }\r\n  }, [medico, regionales])\r\n\r\n  useEffect(()=>{\r\n    if(medico && especialidades.length){\r\n      setValue(\"especialidad\", especialidades.filter(r=>r.id == medico.especialidadId))\r\n    }\r\n  }, [medico, especialidades])\r\n\r\n  return <Form id=\"medico-form\"\r\n    onSubmit={handleSubmit((inputs)=>{\r\n      guardar.mutate(inputs)\r\n    })}\r\n  >\r\n    <h1 style={{fontSize: \"2rem\"}}>{id ? \"Actualizar\" : \"Registrar Medico\"}</h1>\r\n    {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n      {guardar.isError ? (guardar.error as AxiosError).response?.data?.message || (guardar.error as AxiosError).message : \"Guardado\"}\r\n    </Alert> : null}\r\n    <Form.Row>\r\n      <Form.Group as={Col} md={4} xs={8}>\r\n        <Form.Label>Carnet de identidad</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.ci}\r\n          {...register(\"ci\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.ci?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} md={2} xs={4}>\r\n        <Form.Label>Complemento</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.ciComplemento}\r\n          {...register(\"ciComplemento\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.ciComplemento?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} md={4}>\r\n        <Form.Label>Apellido Paterno</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.apellidoPaterno}\r\n          {...register(\"apellidoPaterno\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.apellidoPaterno?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} md={4}>\r\n        <Form.Label>Apellido Materno</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.apellidoMaterno}\r\n          {...register(\"apellidoMaterno\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.apellidoMaterno?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} md={4}>\r\n        <Form.Label>Nombres</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.nombres}\r\n          {...register(\"nombres\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.nombres?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} md={8}>\r\n        <Form.Label>Especialidad</Form.Label>\r\n        <Controller\r\n          name=\"especialidad\"\r\n          control={control}\r\n          render={({field, fieldState})=>{\r\n            return <>\r\n              <EspecialidadesTypeahead\r\n                id=\"medicos-form/especialidades-typeahead\"\r\n                onLoad={(especialidades)=>setEspecialidades(especialidades)}\r\n                feedback={fieldState.error?.message}\r\n                isInvalid={!!fieldState.error}\r\n                selected={field.value}\r\n                onChange={field.onChange}\r\n                onBlur={field.onBlur}\r\n              />\r\n            </>\r\n          }}\r\n        />\r\n      </Form.Group>\r\n      <Form.Group as={Col} md={4}>\r\n        <Form.Label>Regional</Form.Label>\r\n        <Controller\r\n          name=\"regional\"\r\n          control={control}\r\n          render={({field, fieldState})=>{\r\n            return <>\r\n              <RegionalesTypeahead\r\n                id=\"medicos-form/regionales-typeahead\"\r\n                onLoad={(regionales)=>setRegionales(regionales)}\r\n                filterBy={(regional) => loggedUser.can(Permisos.REGISTRAR_MEDICOS) || loggedUser.regionalId == regional.id}\r\n                feedback={fieldState.error?.message}\r\n                className={fieldState.error ? \"is-invalid\" : \"\"}\r\n                isInvalid={!!fieldState.error}\r\n                selected={field.value}\r\n                onChange={field.onChange}\r\n                onBlur={field.onBlur}\r\n              />\r\n            </>\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <div className=\"m-n1\">\r\n      {!id ? <Button \r\n        className=\"m-1\"\r\n        type=\"submit\"\r\n        onClick={()=>{\r\n          continueRef.current = true\r\n        }}\r\n      >\r\n        {guardar.isLoading && continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar y continuar\r\n      </Button> : null}\r\n      <Button\r\n        className=\"m-1\"\r\n        type=\"submit\"\r\n        onClick={()=>{\r\n          continueRef.current = false\r\n        }}\r\n      >\r\n        {guardar.isLoading && !continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button>\r\n      <Button \r\n        className=\"m-1\"\r\n        variant=\"secondary\"\r\n        type=\"reset\"\r\n        onClick={()=>{\r\n          setValue(\"regional\", [])\r\n          setValue(\"especialidad\", [])\r\n          clearErrors()\r\n        }}\r\n      >Limpiar</Button>\r\n    </div>\r\n  </Form>\r\n}","import { Permisos, useLoggedUser } from \"../../../../commons/auth\";\r\n\r\nexport const ProveedorPolicy = {\r\n  index: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.VER_PROVEEDORES,\r\n      Permisos.VER_PROVEEDORES_REGIONAL,\r\n      Permisos.REGISTRAR_PROVEEDORES,\r\n      Permisos.REGISTRAR_PROVEEDORES_REGIONAL\r\n    ])\r\n  },\r\n  register: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.REGISTRAR_PROVEEDORES,\r\n      Permisos.REGISTRAR_PROVEEDORES_REGIONAL\r\n    ])\r\n  },\r\n  edit: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.EDITAR_PROVEEDORES,\r\n      Permisos.EDITAR_PROVEEDORES_REGIONAL\r\n    ])\r\n  },\r\n  view: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.VER_PROVEEDORES,\r\n      Permisos.VER_PROVEEDORES_REGIONAL\r\n    ])\r\n  },\r\n  baja: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user.canAny([\r\n      Permisos.BAJA_PROVEEDORES,\r\n      Permisos.BAJA_PROVEEDORES_REGIONAL\r\n    ])\r\n  }\r\n}","import { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\nimport axios, { AxiosPromise } from 'axios'\r\nimport { Medico } from \"../../medicos/services\"\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type Empresa = {\r\n  id: number,\r\n  nombre: string\r\n}\r\n\r\nexport type Proveedor = {\r\n  id: number\r\n  nit: number | null\r\n  nombre: string | null\r\n  medico: Medico | null\r\n  tipoId: number\r\n  tipo: string\r\n  regionalId: number\r\n\r\n  municipioId: number\r\n  municipio: { id: number, nombre: string}\r\n  provincia: { id: number, nombre: string}\r\n  departamento: { id: number, nombre: string}\r\n  direccion: string\r\n  ubicacion: {\r\n    latitud: number,\r\n    longitud: number\r\n  }\r\n  telefono1: number\r\n  telefono2: number | null\r\n\r\n  contrato: {\r\n    inicio: string\r\n    fin: string\r\n    regionalId: number\r\n    prestaciones: {\r\n      id: number\r\n      nombre: string\r\n    }[]\r\n  }\r\n}\r\n\r\nexport type Filter = {\r\n  regionalId?: number\r\n}\r\n\r\n\r\ninterface IProveedorService {\r\n  buscar(filter: Filter): AxiosPromise<Proveedor[]>\r\n  buscar(filter: Filter, page: Page): AxiosPromise<PaginatedResponse<Proveedor>>\r\n  cargar(id: number): AxiosPromise<Proveedor>\r\n  registrar(fields: {\r\n    general: {\r\n      tipoId: 1,\r\n      nit?: number,\r\n      ci: number,\r\n      ciComplemento?: string\r\n      apellidoPaterno?: string\r\n      apellidoMaterno?: string\r\n      nombres: string\r\n      especialidadId: number\r\n    } | {\r\n      tipoId: 2,\r\n      nit?: number,\r\n      nombre: string,\r\n    },\r\n    contacto?: {\r\n      municipioId: number,\r\n      direccion: string,\r\n      ubicacion: {\r\n        latitud: number,\r\n        longitud: number\r\n      },\r\n      telefono1: number,\r\n      telefono2?: number\r\n    },\r\n    contrato: {\r\n      inicio: string,\r\n      fin: string,\r\n      prestacionIds: number[] \r\n    }\r\n  }): AxiosPromise<Proveedor>\r\n  actualizar(id: number, fields: {\r\n    tipoId: 1,\r\n    nit?: number,\r\n    ci: number,\r\n    ciComplemento?: string\r\n    apellidoPaterno?: string\r\n    apellidoMaterno?: string\r\n    nombres: string\r\n    especialidadId: number\r\n    regionalId: number\r\n  } | {\r\n    tipoId: 2,\r\n    nit?: number,\r\n    nombre: string,\r\n    regionalId: number\r\n  }): AxiosPromise<Proveedor>\r\n  eliminar(id: number): AxiosPromise\r\n  actualizarInformacionDeContacto(id: number, infoContacto: {\r\n    municipioId: number,\r\n    direccion: string,\r\n    ubicacion: {\r\n      latitud: number,\r\n      longitud: number\r\n    },\r\n    telefono1: number,\r\n    telefono2?: number\r\n  }): AxiosPromise<Proveedor>\r\n}\r\n\r\nexport const ProveedoresService: IProveedorService = {\r\n  buscar: (filter: Filter, page?: Page) => {\r\n    return apiClient.get(\"proveedores\", {\r\n      params: {\r\n        filter,\r\n        page\r\n      }\r\n    })\r\n  },\r\n  cargar: (id) => {\r\n    return apiClient.get(`proveedores/${id}`)\r\n  },\r\n  registrar: (fields) => {\r\n    return apiClient.post(\"proveedores\", keysToUnderscore(fields))\r\n  },\r\n  actualizar: (id, fields) =>{\r\n    return apiClient.put(`proveedores/${id}`, keysToUnderscore(fields))\r\n  },\r\n  eliminar: (id: number) => {\r\n    return apiClient.get(`proveedores/${id}`)\r\n  },\r\n  actualizarInformacionDeContacto: (id, infoContacto) => {\r\n    return apiClient.put(`proveedores/${id}/contacto`, keysToUnderscore(infoContacto))\r\n  }\r\n\r\n}","import { apiClient } from \"../../../../commons/services\"\r\n\r\nexport const ContratosService = {\r\n  registrar: (proveedorId: number, data: {\r\n    inicio: string,\r\n    fin: string,\r\n    prestacion_ids: number[] \r\n  }) =>{\r\n    return apiClient.post(`proveedores/${proveedorId}/contratos`,  data)\r\n  }\r\n}","import React from \"react\"\r\nimport { Filter } from \"../services\"\r\n\r\ntype Props = {\r\n  onFilter: (filter: Filter) => void\r\n}\r\n\r\nexport const ProveedoresFilterForm = (props: Props)=>{\r\n  return null\r\n}","import { useEffect } from \"react\"\r\nimport { Dropdown } from \"react-bootstrap\"\r\n// import { FaEdit } from \"react-icons/fa\"\r\nimport { useMutation, useQueryClient } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { Proveedor, ProveedoresService } from \"../services\"\r\nimport { ProveedorPolicy } from \"../policies\"\r\n\r\ntype Props = {\r\n  proveedor: Proveedor\r\n}\r\nexport const RowOptions = ({proveedor}: Props) => {\r\n\r\n  return <Dropdown>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-proveedores-${proveedor.id}`}\r\n    />\r\n\r\n    <Dropdown.Menu>\r\n      <ProtectedContent\r\n        authorize={ProveedorPolicy.view}\r\n      >\r\n        <Dropdown.Item as={Link} to={{\r\n          pathname: `/clinica/proveedores/${proveedor.id}`,\r\n          state: {\r\n            proveedor\r\n          }\r\n        }} ><span className=\"align-middle\">Ver</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n      <ProtectedContent\r\n        authorize={ProveedorPolicy.edit}\r\n      >\r\n        <Dropdown.Item as={Link} to={{\r\n          pathname: `/clinica/proveedores/${proveedor.id}/editar`,\r\n          state: {\r\n            proveedor\r\n          }\r\n        }} ><span className=\"align-middle\">Editar</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n    </Dropdown.Menu>\r\n  </Dropdown>\r\n}","import { AxiosError } from \"axios\"\r\nimport { useEffect, useState, useRef } from \"react\"\r\nimport { Button, Col, Form, Spinner, Table } from \"react-bootstrap\"\r\nimport { FaFilter, FaSync, FaPlus } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport { Pagination } from \"../../../../commons/components\"\r\nimport { ProtectedContent, useLoggedUser, Permisos } from \"../../../../commons/auth\"\r\nimport { ProveedorPolicy } from \"../policies\"\r\nimport { ProveedoresService, Filter } from \"../services\"\r\nimport { ProveedoresFilterForm } from \"./ProveedoresFilterForm\"\r\nimport { RowOptions } from \"./RowOptions\"\r\n\r\nexport const ProveedoresIndex = () => {\r\n  const {pathname: path} = useLocation()\r\n  const [page, setPage] = useState({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser(\r\n\r\n  )\r\n\r\n  const getDefaultFilter = () => {\r\n    const filter: Filter = {}\r\n    if(!loggedUser.can(Permisos.VER_PROVEEDORES)){\r\n      if(loggedUser.can(Permisos.VER_PROVEEDORES_REGIONAL)){\r\n        filter.regionalId = loggedUser.regionalId;\r\n      }\r\n    }\r\n    return filter\r\n  }\r\n\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n  const [filterFormVisible, showFilterForm] = useState(false)\r\n\r\n  const buscar = useQuery([\"proveedores.buscar\"], () => {\r\n    return ProveedoresService.buscar(filter, page)\r\n  }, {\r\n    enabled: ProveedorPolicy.view(loggedUser),\r\n    refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const total = buscar.data?.data?.meta?.total || 0\r\n\r\n  const didMountRef = useRef(false)\r\n  useEffect(()=>{\r\n    if(!didMountRef.current) {\r\n      didMountRef.current = true\r\n      return\r\n    }\r\n    if(ProveedorPolicy.view(loggedUser)) buscar.refetch()\r\n  }, [page, filter, loggedUser])\r\n\r\n  const renderRows = () => {\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    else if (buscar.isError) {\r\n      const error = buscar.error as AxiosError\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {error.response?.data?.message || error.message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if(buscar.data){\r\n      const records = buscar.data.data.records\r\n      if(records.length == 0){\r\n        return  <tr>\r\n          <td className=\"bg-light text-center\" colSpan={100}>\r\n            No se encontraron resultados\r\n          </td>\r\n      </tr>\r\n      }\r\n      return records.map((item, index) => {\r\n        return <tr key={item.id}>\r\n          <th scope=\"row\" style={{ lineHeight: \"26px\" }}>\r\n            {index + 1}\r\n          </th>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {(item.medico && item.medico.nombreCompleto) || item.nombre }\r\n          </td>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {item.tipo}\r\n          </td>\r\n          <td>\r\n            <RowOptions proveedor={item} />\r\n          </td>\r\n        </tr>\r\n      })\r\n    }\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h1 style={{fontSize: \"1.75rem\"}}>Proveedores</h1>\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\" >\r\n        <ProtectedContent\r\n          authorize={ProveedorPolicy.view}\r\n        >\r\n          <Col className={\"pr-0\"} xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col className={\"pr-0\"} xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              showFilterForm(visible=>!visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={ProveedorPolicy.register}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button\r\n              as={Link}\r\n              to={`${path}/registrar`}\r\n              className=\"d-flex align-items-center\">\r\n                <FaPlus /><span className=\"mr-2\">Nuevo</span>\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={ProveedorPolicy.view}\r\n    >\r\n      <Form.Row>\r\n        <Col className=\"mb-2\">\r\n          <ProveedoresFilterForm onFilter={(filter)=>{\r\n            setFilter(filter)\r\n          }} />\r\n        </Col>\r\n        <Col className=\"mb-2\" xs={\"auto\"}>\r\n          <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n              <span>Mostrar</span>\r\n              <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n                const value = e.target.value\r\n                setPage((page) => ({\r\n                  ...page,\r\n                  size: parseInt(value)\r\n                }))\r\n              }}>\r\n                <option value={10}>10</option>\r\n                <option value={20}>20</option>\r\n                <option value={30}>30</option>\r\n                <option value={50}>50</option>\r\n                <option value={100}>100</option>\r\n              </Form.Control>\r\n              <span>filas</span>\r\n          </div>\r\n        </Col>\r\n      </Form.Row>\r\n      <Table responsive>\r\n        <thead className=\"text-center\">\r\n          <tr>\r\n            <th style={{width: 1}}>#</th>\r\n            <th>Nombre</th>\r\n            <th style={{width: 1}}>Tipo</th>\r\n            <th style={{width: 1}}></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {renderRows()}\r\n        </tbody>\r\n      </Table>\r\n      {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    </ProtectedContent>\r\n  </div>\r\n}","import { useEffect, useRef } from 'react'\r\nimport { AxiosError } from 'axios'\r\nimport { Alert, Button, Col, Form, Modal, Spinner, Tab, Table } from 'react-bootstrap'\r\nimport { Proveedor, ProveedoresService } from '../services'\r\nimport { useQuery, useMutation } from 'react-query'\r\nimport { FaEdit } from 'react-icons/fa'\r\nimport { Link, useLocation, useParams } from 'react-router-dom'\r\nimport { useLoggedUser, ProtectedContent } from \"../../../../commons/auth\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProveedorPolicy } from \"../policies\"\r\n\r\n\r\nexport const ProveedorView = ()=>{\r\n  const { pathname, state: locationState } = useLocation<{\r\n    proveedor?: Proveedor\r\n  }>()\r\n  const { id } = useParams<{\r\n    id: string\r\n  }>()\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const loader = useModal(\"queryLoader\")\r\n\r\n  const cargar = useQuery([\"cargar\", id], ()=>{\r\n    return ProveedoresService.cargar(parseInt(id))\r\n  }, {\r\n    enabled: !locationState?.proveedor,\r\n    refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n    onSuccess: () => {\r\n      loader.close()\r\n    },\r\n    onError: (error) => {\r\n      loader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  // const eliminar = useMutation(()=>{\r\n  //   return ProveedorService.eliminar(parseInt(id))\r\n  // }, {\r\n  //   onSuccess: () => {\r\n  //     loader.close()\r\n  //   },\r\n  //   onError: (error) =>{\r\n  //     loader.open({\r\n  //       state: \"error\",\r\n  //       error\r\n  //     })\r\n  //   }\r\n  // })\r\n\r\n  const proveedor = cargar.data?.data || locationState?.proveedor\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isFetching){\r\n      loader.open({state: \"loading\"})\r\n    }\r\n  }, [cargar.isFetching])\r\n\r\n  // useEffect(()=>{\r\n  //   if(eliminar.isLoading){\r\n  //     loader.open({state: \"loading\"})\r\n  //   }\r\n  // }, [eliminar.isLoading])\r\n\r\n  const renderGeneralInfo = ()=>{\r\n    if(proveedor?.tipoId == 1){\r\n      return <tbody>\r\n        <tr>\r\n          <th scope=\"row\">Tipo</th>\r\n          <td >Médico especialista</td>\r\n        </tr>\r\n        <tr>\r\n          <th scope=\"row\" style={{width: '1px'}}>Carnet de identidad</th>\r\n          <td>{proveedor?.medico?.ciText}</td>\r\n        </tr>\r\n        <tr>\r\n          <th scope=\"row\" style={{width: '1px'}}>Nombre</th>\r\n          <td>{proveedor?.medico?.nombreCompleto}</td>\r\n        </tr>\r\n        <tr>\r\n          <th scope=\"row\">Especialidad</th>\r\n          <td>{proveedor?.medico?.especialidad}</td>\r\n        </tr>\r\n      </tbody>\r\n    }\r\n    else if(proveedor?.tipoId == 2){\r\n      return <tbody>\r\n        <tr>\r\n          <th scope=\"row\">Tipo</th>\r\n          <td >Empresa</td>\r\n        </tr>\r\n        <tr>\r\n          <th scope=\"row\" style={{width: '1px'}}>NIT</th>\r\n          <td>{proveedor?.nit}</td>\r\n        </tr>\r\n        <tr>\r\n          <th scope=\"row\" style={{width: '1px'}}>Nombre</th>\r\n          <td>{proveedor?.nombre}</td>\r\n        </tr>\r\n      </tbody>\r\n    }\r\n    return null\r\n  }\r\n  \r\n  return <>\r\n    <h2 style={{fontSize: \"1.75rem\"}}>Proveedor</h2>\r\n    <div id=\"general-info\">\r\n      <Table>\r\n        {renderGeneralInfo()}\r\n      </Table>\r\n      {proveedor ? <Form.Row>\r\n        <ProtectedContent\r\n          authorize={ProveedorPolicy.edit}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button as={Link} to={{\r\n              pathname: `/clinica/proveedores/${proveedor.id}/editar`,\r\n              state: {\r\n                proveedor\r\n              }\r\n            }} >Editar</Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        {/* <Col xs=\"auto\">\r\n          <Button variant=\"danger\" onClick={()=>{\r\n            modalRef.current?.show(true)\r\n            eliminar.mutate()\r\n          }}>\r\n            {eliminar.isLoading ? <Spinner className=\"mr-2\" animation=\"border\" size=\"sm\" /> : null}\r\n            Eliminar\r\n          </Button>\r\n        </Col> */}\r\n      </Form.Row> : null}\r\n    </div>\r\n  </>\r\n}","import { useEffect, useState } from \"react\"\r\nimport { Button, Form, Col, Spinner } from \"react-bootstrap\"\r\nimport { Controller, useForm } from \"react-hook-form\"\r\nimport { useParams, useHistory } from \"react-router\"\r\nimport { yupResolver } from \"@hookform/resolvers/yup\"\r\nimport * as yup from \"yup\"\r\nimport { useMutation } from \"react-query\"\r\nimport { Regional, RegionalesTypeahead } from '../../../../commons/components'\r\nimport { Permisos, useLoggedUser } from '../../../../commons/auth'\r\nimport { Proveedor, ProveedoresService } from '../services'\r\n\r\nexport type Inputs = {\r\n  tipo?: 2\r\n  nit?: number,\r\n  nombre?: string,\r\n  regional?: Regional[]\r\n}\r\n\r\ntype Props = {\r\n  proveedor?: Proveedor,\r\n  onSubmit?: (data: Inputs) => void\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  nit: yup.number().label(\"NIT\")\r\n  .emptyStringTo()\r\n  .typeError(\"El ${path} no es un numero valido\")\r\n  .required(),\r\n  // .nullable()\r\n  // .notRequired(),\r\n  nombre: yup.string().required().max(150),  \r\n  regional: yup.array().length(1, \"Debe indicar una regional\")\r\n})\r\n\r\nexport const ProveedorEmpresaForm = ({proveedor, onSubmit}: Props)=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory()\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const {\r\n    control,\r\n    formState,\r\n    handleSubmit,\r\n    setValue,\r\n    register\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      tipo: 2,\r\n      nit: proveedor?.nit as number,\r\n      nombre: proveedor?.nombre as string,\r\n      regional: []\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n\r\n  const [ regionales, setRegionales ] = useState<Regional[]>([])\r\n\r\n  const guardar = useMutation((values: Inputs)=>{\r\n    return ProveedoresService.actualizar(parseInt(id!), {\r\n      tipoId: values.tipo!,\r\n      nit: values.nit!,\r\n      nombre: values.nombre!,\r\n      regionalId: values.regional![0].id\r\n    })\r\n  }, {\r\n    onSuccess: ({data}) => {\r\n      history.replace(`/clinica/proveedores/${data.id}`)\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(proveedor && regionales.length){\r\n      setValue(\"regional\", regionales.filter(r=>r.id == proveedor.regionalId))\r\n    }\r\n  }, [proveedor, regionales])\r\n\r\n  return <Form id=\"proveedor-form\" onSubmit={handleSubmit(onSubmit || ((values)=>{\r\n    guardar.mutate(values)\r\n  }))}>\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>NIT</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formErrors.nit}\r\n          {...register(\"nit\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.nit?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={8}>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formErrors.nombre}\r\n          {...register(\"nombre\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.nombre?.message}</Form.Control.Feedback>\r\n      </Form.Group>      \r\n      <Form.Group as={Col} md={4}>\r\n          <Form.Label>Regional</Form.Label>\r\n          <Controller\r\n            name=\"regional\"\r\n            control={control}\r\n            render={({field, fieldState})=>{\r\n              return <>\r\n                <RegionalesTypeahead\r\n                  id=\"proveedor-form/regionales-typeahead\"\r\n                  onLoad={(regionales)=>setRegionales(regionales)}\r\n                  filterBy={(regional) => {\r\n                    if(loggedUser.can(Permisos.REGISTRAR_PROVEEDORES)) return true \r\n                    if(loggedUser.can(Permisos.REGISTRAR_PROVEEDORES_REGIONAL) && loggedUser.regionalId == regional.id) return true\r\n                    if(id && loggedUser.can(Permisos.EDITAR_PROVEEDORES)) return true\r\n                    if(id && loggedUser.can(Permisos.EDITAR_PROVEEDORES_REGIONAL) && loggedUser.regionalId == regional.id) return true\r\n                    return false\r\n                  }}\r\n                  feedback={fieldState.error?.message}\r\n                  isInvalid={!!fieldState.error}\r\n                  selected={field.value}\r\n                  onChange={field.onChange}\r\n                  onBlur={field.onBlur}\r\n                />\r\n              </>\r\n            }}\r\n          />\r\n        </Form.Group>\r\n      \r\n    </Form.Row>\r\n    {!onSubmit ? <Button\r\n        type=\"submit\"\r\n      >\r\n        {guardar.isLoading ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button> : null}\r\n  </Form>\r\n}","import { AxiosError, AxiosResponse } from 'axios'\r\nimport { useEffect, useState, useRef } from 'react'\r\nimport { Alert, Button, Col, Form, InputGroup, Modal, Spinner } from 'react-bootstrap'\r\nimport { Controller, useForm } from 'react-hook-form'\r\nimport { useMutation, useQuery } from 'react-query'\r\nimport { useHistory, useParams } from 'react-router'\r\nimport { yupResolver } from \"@hookform/resolvers/yup\"\r\nimport * as yup from 'yup'\r\nimport { Especialidad, EspecialidadesTypeahead } from '../../medicos/components/EspecialidadesTypeahead'\r\nimport { Regional, RegionalesTypeahead } from '../../../../commons/components'\r\nimport { Permisos, useLoggedUser } from '../../../../commons/auth'\r\nimport { Proveedor, ProveedoresService } from '../services'\r\n\r\nexport type Inputs = {\r\n  tipo?: 1\r\n  nit?: number\r\n  ci?: number\r\n  ciComplemento?: string\r\n  apellidoPaterno?: string\r\n  apellidoMaterno?: string\r\n  nombres?: string\r\n  especialidad?: Especialidad[]\r\n  regional?: Regional[]\r\n}\r\n\r\ntype Props = {\r\n  proveedor?: Proveedor,\r\n  onSubmit?: (data: Inputs) => void\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  nit: yup.number().label(\"NIT\")\r\n    .emptyStringToNull()\r\n    .typeError(\"El ${path} no es un numero valido\")\r\n    .nullable()\r\n    .notRequired(),\r\n  ci: yup.number().label(\"número de carnet\")\r\n    .emptyStringToNull()\r\n    .typeError(\"El ${path} no es un numero valido\")\r\n    .nullable()\r\n    .required(),\r\n  ciComplemento: yup.string().transform(value => value === \"\" ? null : value).trim().uppercase().nullable().notRequired()\r\n    .length(2).matches(/[0-1A-Z]/),\r\n  apellidoPaterno: yup.string().label(\"apellido paterno\").trim().when(\"apellidoMaterno\", {\r\n    is: (apellidoMaterno: string) => !apellidoMaterno,\r\n    then: yup.string().required(\"Debe proporcionar al menos un apellido\").max(50)\r\n  }),\r\n  apellidoMaterno: yup.string().label(\"apellido materno\").trim().when(\"apellidoPaterno\", {\r\n    is: (apellidoPaterno: string) => !apellidoPaterno,\r\n    then: yup.string().required(\"Debe proporcionar al menos un apellido\").max(50)\r\n  }),\r\n  nombres: yup.string().label(\"nombres\").trim().required().label(\"'Nombres'\").max(50),\r\n  especialidad: yup.array().length(1, \"Debe indicar una especialidad\"),\r\n  regional: yup.array().length(1, \"Debe indicar una regional\")\r\n}, [[\"apellidoMaterno\", \"apellidoPaterno\"]])\r\n\r\n\r\nexport const ProveedorMedicoForm = ({proveedor, onSubmit}: Props)=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory()\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const [especialidades, setEspecialidades] = useState<Especialidad[]>([])\r\n  const [regionales, setRegionales] = useState<Regional[]>([])\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    setValue,\r\n    control,\r\n    formState,\r\n    watch\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      tipo: 1,\r\n      nit: proveedor?.nit as number,\r\n      ci: proveedor?.medico?.ci?.raiz,\r\n      ciComplemento: proveedor?.medico?.ci.complemento,\r\n      apellidoPaterno: proveedor?.medico?.apellidoPaterno||\"\",\r\n      apellidoMaterno: proveedor?.medico?.apellidoMaterno||\"\",\r\n      nombres: proveedor?.medico?.nombres||\"\",\r\n      especialidad: [],\r\n      regional: [],\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n\r\n  const guardar = useMutation((inputs: Inputs)=>{\r\n    return ProveedoresService.actualizar(parseInt(id!), {\r\n      tipoId: 1,\r\n      nit: inputs.nit,\r\n      ci: inputs.ci!,\r\n      ciComplemento: inputs.ciComplemento,\r\n      apellidoPaterno: inputs.apellidoPaterno,\r\n      apellidoMaterno: inputs.apellidoMaterno,\r\n      nombres: inputs.nombres!,\r\n      especialidadId: inputs.especialidad![0].id,\r\n      regionalId: inputs.regional![0].id\r\n    })\r\n  }, {\r\n    onSuccess: ({data})=>{\r\n      history.replace(`/clinica/proveedores/${data.id}`)\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(proveedor && especialidades.length){\r\n      setValue(\"especialidad\", especialidades.filter(r=>r.id == proveedor.medico?.especialidadId))\r\n    }\r\n  }, [proveedor, especialidades])\r\n\r\n  useEffect(()=>{\r\n    if(proveedor && regionales.length){\r\n      setValue(\"regional\", regionales.filter(r=>r.id == proveedor.regionalId))\r\n    }\r\n  }, [proveedor, regionales])\r\n\r\n  console.log(\"Errors\", formErrors, watch())\r\n\r\n  return <>\r\n    <Form id=\"proveedor-form\"\r\n      onSubmit={handleSubmit(onSubmit || ((inputs)=>{\r\n        guardar.mutate(inputs)\r\n      }))}\r\n    >\r\n      {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n        {guardar.isError ? (guardar.error as AxiosError).response?.data?.message || (guardar.error as AxiosError).message : \"Guardado\"}\r\n      </Alert> : null}\r\n      <Form.Row>\r\n        <Form.Group as={Col} md={4} xs={8}>\r\n          <Form.Label>NIT</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.nit}\r\n            {...register(\"nit\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.nit?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={4} xs={8}>\r\n          <Form.Label>Carnet de identidad</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.ci}\r\n            {...register(\"ci\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.ci?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={2} xs={4}>\r\n          <Form.Label>Complemento</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.ciComplemento}\r\n            {...register(\"ciComplemento\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.ciComplemento?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n      </Form.Row>\r\n      <Form.Row>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Apellido Paterno</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.apellidoPaterno}\r\n            {...register(\"apellidoPaterno\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.apellidoPaterno?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Apellido Materno</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.apellidoMaterno}\r\n            {...register(\"apellidoMaterno\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.apellidoMaterno?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Nombres</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.nombres}\r\n            {...register(\"nombres\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.nombres?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n      </Form.Row>\r\n      <Form.Row>\r\n        <Form.Group as={Col} md={8}>\r\n          <Form.Label>Especialidad</Form.Label>\r\n          <Controller\r\n            name=\"especialidad\"\r\n            control={control}\r\n            render={({field, fieldState})=>{\r\n              return <>\r\n                <EspecialidadesTypeahead\r\n                  id=\"medicos-form/especialidades-typeahead\"\r\n                  align=\"left\"\r\n                  onLoad={(especialidades)=>setEspecialidades(especialidades)}\r\n                  feedback={fieldState.error?.message}\r\n                  className={formState.errors.especialidad ? \"is-invalid\" : \"\"}\r\n                  isInvalid={!!fieldState.error}\r\n                  selected={field.value}\r\n                  onChange={field.onChange}\r\n                  onBlur={field.onBlur}\r\n                />\r\n              </>\r\n            }}\r\n          />\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Regional</Form.Label>\r\n          <Controller\r\n            name=\"regional\"\r\n            control={control}\r\n            render={({field, fieldState})=>{\r\n              return <>\r\n                <RegionalesTypeahead\r\n                  id=\"proveedor-form/regionales-typeahead\"\r\n                  onLoad={(regionales)=>setRegionales(regionales)}\r\n                  filterBy={(regional) => {\r\n                    if(loggedUser.can(Permisos.REGISTRAR_PROVEEDORES)) return true \r\n                    if(loggedUser.can(Permisos.REGISTRAR_PROVEEDORES_REGIONAL) && loggedUser.regionalId == regional.id) return true\r\n                    if(id && loggedUser.can(Permisos.EDITAR_PROVEEDORES)) return true\r\n                    if(id && loggedUser.can(Permisos.EDITAR_PROVEEDORES_REGIONAL) && loggedUser.regionalId == regional.id) return true\r\n                    return false\r\n                  }}\r\n                  feedback={fieldState.error?.message}\r\n                  isInvalid={!!fieldState.error}\r\n                  selected={field.value}\r\n                  onChange={field.onChange}\r\n                  onBlur={field.onBlur}\r\n                />\r\n              </>\r\n            }}\r\n          />\r\n        </Form.Group>\r\n      </Form.Row>\r\n      {!onSubmit ? <Button\r\n        type=\"submit\"\r\n      >\r\n        {guardar.isLoading ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button> : null}\r\n    </Form>\r\n  </>\r\n}","\r\nimport { useState, useEffect } from \"react\"\r\nimport { Form, Col} from \"react-bootstrap\"\r\nimport { useHistory, useParams } from \"react-router\"\r\nimport { useQuery } from \"react-query\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { Inputs as PEInputs, ProveedorEmpresaForm } from \"./ProveedorEmpresaForm\"\r\nimport { Inputs as ProveedorMedicoInput, ProveedorMedicoForm } from \"./ProveedorMedicoForm\"\r\nimport { Proveedor, ProveedoresService } from \"../services\"\r\nimport { ContactoForm } from \"./ContactoForm\"\r\nimport { ContratoForm } from \"./ContratoForm\"\r\n\r\nexport type { ProveedorMedicoInput }\r\n\r\nexport type Inputs = PEInputs | ProveedorMedicoInput\r\n\r\nexport const ProveedorForm = (props: { onSubmit?: (data: PEInputs | ProveedorMedicoInput) => void})=>{\r\n  const [tipo, setTipo] = useState(0)\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    proveedor: Proveedor\r\n  }>()\r\n\r\n  const loader = useModal(\"queryLoader\")\r\n\r\n  const cargar = useQuery([\"proveedor.cargar\", id], ()=>{\r\n    return ProveedoresService.cargar(parseInt(id!))\r\n  }, {\r\n    enabled: !!id && !history.location.state?.proveedor,\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: ()=>{\r\n      loader.close()\r\n    },\r\n    onError: (error) => {\r\n      loader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const proveedor = cargar.data?.data || history.location.state?.proveedor\r\n\r\n  useEffect(()=>{\r\n    if(proveedor){\r\n      setTipo(proveedor.tipoId)\r\n    }\r\n  }, [proveedor])\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isLoading){\r\n      loader.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n  }, [cargar.isLoading])\r\n\r\n  const renderForm = () => {\r\n    if(tipo == 1) {\r\n      return <ProveedorMedicoForm proveedor={proveedor} \r\n        onSubmit={props.onSubmit}\r\n      />\r\n    } \r\n    if(tipo == 2){\r\n      return <ProveedorEmpresaForm proveedor={proveedor}\r\n        onSubmit={props.onSubmit}\r\n      />\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <>\r\n    <h1 style={{fontSize: \"1.75rem\"}}>{id ? \"Actualizacion de Proveedor\" : \"Registro de Proveedor\"}</h1>\r\n    <Form.Group as={Form.Row}>\r\n      <Form.Label column sm={\"auto\"}>Tipo de proveedor</Form.Label>\r\n      <Col className=\"d-flex\" xs={\"auto\"}>\r\n        <Form.Check disabled={!!id} inline type=\"radio\" label=\"Médico\" value={1} checked={tipo == 1} onChange={(e)=>{\r\n          if(e.target.checked && !id)\r\n            setTipo(1) \r\n        }} ></Form.Check>\r\n        <Form.Check disabled={!!id}  inline type=\"radio\" label=\"Empresa\" value={2} checked={tipo == 2} onChange={(e)=>{\r\n          if(e.target.checked && !id)\r\n            setTipo(2) \r\n        }} ></Form.Check>\r\n      </Col>\r\n    </Form.Group>\r\n    {renderForm()}\r\n  </>\r\n}","import { useState, useEffect } from \"react\"\r\nimport { AxiosError } from \"axios\" \r\nimport { Alert, Button, Col, Form, Spinner } from \"react-bootstrap\"\r\nimport { LatLngExpression } from \"leaflet\"\r\nimport { Controller, useForm } from \"react-hook-form\"\r\nimport { useHistory, useParams } from \"react-router-dom\"\r\nimport { useQuery, useMutation } from \"react-query\"\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { Departamento, DepartamentosTypeahead, Provincia, ProvinciasTypeahead, Municipio, MunicipiosTypeahead, LocationInput } from \"../../../../commons/components\"\r\nimport { Permisos, useLoggedUser } from '../../../../commons/auth'\r\nimport { useModal } from '../../../../commons/reusable-modal'\r\nimport { Proveedor, ProveedoresService } from \"../services\"\r\n\r\nexport type Inputs = {\r\n  departamento?: Departamento[]\r\n  provincia?: Provincia[]\r\n  municipio?: Municipio[]\r\n  direccion?: string,\r\n  ubicacion?: LatLngExpression\r\n  telefono1?: number\r\n  telefono2?: number | null\r\n}\r\n\r\ntype Props = {\r\n  onSubmit?: (data: Inputs) => void\r\n  onOmit?: () => void\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  municipio: yup.array().label(\"municipio\").length(1, \"Debe indicar un municipio\"),\r\n  direccion: yup.string().label(\"dirección\").trim().required(),\r\n  ubicacion: yup.mixed().label(\"ubicación\").required(),\r\n  telefono1: yup.number().label(\"telefono 1\").typeError(\"No es un numero válido\")\r\n    .emptyStringTo().required(),\r\n  telefono2: yup.number().label(\"telefono 2\")\r\n  .emptyStringToNull()\r\n  .typeError(\"No es un numero válido\").nullable().notRequired()\r\n})\r\n\r\nexport const ContactoForm = (props: Props)=>{\r\n  const {id} = useParams<{id: string}>()\r\n  const history = useHistory<{\r\n    proveedor?: Proveedor\r\n  }>()\r\n\r\n  const loader = useModal(\"queryLoader\")\r\n\r\n  const [departamentos, setDepartamentos] = useState<Departamento[]>([])\r\n  const [provincias, setProvincias] = useState<Provincia[]>([])\r\n  const [municipios, setMunicipios] = useState<Municipio[]>([])\r\n  \r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    control,\r\n    watch,\r\n    setError,\r\n    setValue,\r\n    formState\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      departamento: [],\r\n      provincia: [],\r\n      municipio: [],\r\n      ubicacion: [-17.78629, -63.18117]\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n\r\n  console.log(\"Errors\", formErrors, watch())\r\n\r\n  const cargar = useQuery([\"proveedor.cargar\", id], ()=>{\r\n    return ProveedoresService.cargar(parseInt(id))\r\n  }, {\r\n    enabled: !!id && !history.location.state?.proveedor,\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: () => {\r\n      loader.close()\r\n    },\r\n    onError: (error) => {\r\n      loader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const guardar = useMutation((values: Inputs) =>{\r\n    let lat, lng\r\n    if(Array.isArray(values.ubicacion)){\r\n      [lat, lng] = values.ubicacion!\r\n    }\r\n    else{\r\n      ({lat, lng} = values.ubicacion!)\r\n    }\r\n\r\n    return ProveedoresService.actualizarInformacionDeContacto(parseInt(id), {\r\n      municipioId: values.municipio![0].id,\r\n      direccion: values.direccion!,\r\n      ubicacion: {\r\n        latitud: lat,\r\n        longitud: lng\r\n      },\r\n      telefono1: values.telefono1!,\r\n      telefono2: values.telefono2!\r\n    })\r\n  }, {\r\n    onSuccess: ({data})=>{\r\n      history.replace(`/clinica/proveedores/${data.id}`)\r\n    },\r\n    onError: (error) => {\r\n      if(error?.response?.status == 422){\r\n        const {errors} = error.response?.data\r\n        Object.keys(errors).forEach((key: any)=>{\r\n          let localKey = key\r\n          // if(key == \"asegurado.id\") localKey = \"asegurado.matricula\"\r\n          setError(localKey, {type: \"serverError\", message: errors[key]})\r\n        })\r\n      }\r\n    }\r\n  })\r\n\r\n  const proveedor = history.location.state?.proveedor || cargar.data?.data\r\n  \r\n  useEffect(()=>{\r\n    setValue(\"direccion\", proveedor?.direccion || \"\")\r\n    const { latitud, longitud } = proveedor?.ubicacion || { \r\n      latitud: -17.78629,\r\n      longitud: -63.18117\r\n    }\r\n    setValue(\"ubicacion\", [ latitud, longitud ])\r\n    setValue(\"telefono1\", proveedor?.telefono1)\r\n    setValue(\"telefono2\", proveedor?.telefono2)\r\n  }, [proveedor])\r\n\r\n  useEffect(()=>{\r\n    if(proveedor){\r\n      const municipio = municipios.filter(m=>m.id == proveedor?.municipioId)\r\n      const provincia = provincias.filter(p=>municipios.some(m=>m.provinciaId == p.id))\r\n      const departamento = departamentos.filter(d=>provincias.some(p=>p.departamentoId == d.id))\r\n      setValue(\"municipio\", municipio)\r\n      setValue(\"provincia\", provincia)\r\n      setValue(\"departamento\", departamento)\r\n    }\r\n  }, [proveedor, departamentos, provincias, municipios])\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isLoading){\r\n      loader.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n  }, [cargar.isLoading])\r\n\r\n  const renderAlert = ()=>{\r\n    if(guardar.isSuccess){\r\n      return <Alert variant=\"success\">\r\n      La operacion se realizó exitosamente\r\n    </Alert>\r\n    }\r\n    if(guardar.isError){\r\n      const guardarError = guardar.error as AxiosError\r\n      return <Alert variant=\"danger\">\r\n        {guardarError ? guardarError.response?.data?.message || guardarError.message : \"\"}\r\n      </Alert>\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <Form id=\"proveedor-contacto-form\" onSubmit={handleSubmit(props.onSubmit || ((data) => {\r\n    guardar.mutate(data)\r\n  }))}>\r\n    <h1 style={{fontSize: \"1.75rem\"}}>Información de contacto</h1>\r\n    {renderAlert()}\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Departamento</Form.Label>\r\n        <Controller\r\n          name=\"departamento\"\r\n          control={control}\r\n          render={({field, fieldState})=>{\r\n            return <DepartamentosTypeahead\r\n              id=\"contacto-form/departamentos\"\r\n              onLoad={(departamentos)=>{\r\n                setDepartamentos(departamentos)\r\n              }}\r\n              feedback={fieldState.error?.message}\r\n              isInvalid={!!fieldState.error}\r\n              selected={field.value}\r\n              onChange={(value)=>{\r\n                field.onChange(value)\r\n                setValue(\"provincia\", [])\r\n                setValue(\"municipio\", [])\r\n              }}\r\n              onBlur={field.onBlur}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Provincia</Form.Label>\r\n        <Controller\r\n          name=\"provincia\"\r\n          control={control}\r\n          render={({field, fieldState})=>{\r\n            return <ProvinciasTypeahead\r\n              id=\"contacto-form/provincias\"\r\n              onLoad={(provincias)=>{\r\n                setProvincias(provincias)\r\n              }}\r\n              filterBy={(provincia) => {\r\n                const departamento = watch(\"departamento\")\r\n                return !!departamento!.length && provincia.departamentoId == departamento![0].id\r\n              }}\r\n              feedback={fieldState.error?.message}\r\n              isInvalid={!!fieldState.error}\r\n              selected={field.value}\r\n              onChange={(value) => {\r\n                field.onChange(value)\r\n                setValue(\"municipio\", [])\r\n              }}\r\n              onBlur={field.onBlur}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Municipio</Form.Label>\r\n        <Controller\r\n          name=\"municipio\"\r\n          control={control}\r\n          render={({field, fieldState})=>{\r\n            return <MunicipiosTypeahead\r\n              id=\"contacto-form/municipios\"\r\n              onLoad={(municipios)=>{\r\n                setMunicipios(municipios)\r\n              }}\r\n              filterBy={(municipio) => {\r\n                const provincia = watch(\"provincia\")!\r\n                return !!provincia.length && municipio.provinciaId == provincia[0].id\r\n              }}\r\n              feedback={fieldState.error?.message}\r\n              isInvalid={!!fieldState.error}\r\n              selected={field.value}\r\n              onChange={field.onChange}\r\n              onBlur={field.onBlur}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Direccion</Form.Label>\r\n        <Form.Control as=\"textarea\"\r\n          isInvalid={!!formErrors.direccion}\r\n          {...register(\"direccion\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.direccion?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Ubicación</Form.Label>\r\n        <Controller\r\n          name=\"ubicacion\"\r\n          control={control}\r\n          render={({field, fieldState})=>{\r\n            return <>\r\n              <LocationInput\r\n                isInvalid={!!fieldState.error}\r\n                center={field.value || [-17.78629, -63.18117]}\r\n                value={field.value!}\r\n                onChange={field.onChange}\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">{fieldState.error?.message}</Form.Control.Feedback>\r\n            </>\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Teléfono 1</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formErrors.telefono1}\r\n          {...register(\"telefono1\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.telefono1?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Teléfono 2</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formErrors.telefono2}\r\n          {...register(\"telefono2\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.telefono2?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    {!props.onSubmit ? <Button>\r\n      {guardar.isLoading ? <Spinner animation=\"border\" size=\"sm\"/> : null}\r\n      <span className=\"ml-2 align-middle\">Guardar</span>\r\n    </Button> : null}\r\n  </Form>\r\n}","import { useEffect } from \"react\"\r\nimport { Button, Col, Form } from \"react-bootstrap\"\r\nimport { Controller, useFieldArray, useFormContext } from \"react-hook-form\"\r\nimport { FaPlus } from \"react-icons/fa\"\r\nimport { PrestacionesTypeahead } from \"../../solicitud_atencion_externa/components/PrestacionesTypeahead\"\r\nimport { Prestacion } from \"../../prestaciones/services\"\r\nimport { ArancelesControl } from \"./ArancelesControl\"\r\nimport * as rules from \"../../../../commons/components/rules\"\r\n\r\nexport type Inputs = {\r\n  prestaciones: {\r\n    id: string\r\n    prestacion: Prestacion,\r\n    // aranceles: {\r\n    //   nombre: string,\r\n    //   precio: string,\r\n    //   etiqueta: string\r\n    // }[]\r\n  }[]\r\n}\r\n\r\nexport const PrestacionesContratadasControl = ()=>{\r\n  const {\r\n    register,\r\n    control,\r\n    trigger,\r\n    formState: { errors: formErrors },\r\n    watch\r\n  } = useFormContext<Inputs>()\r\n  const {\r\n    fields,\r\n    append,\r\n    remove\r\n  } = useFieldArray({\r\n    name: \"prestaciones\",\r\n    control\r\n  })\r\n\r\n  return <div>\r\n    <h2 style={{fontSize: \"1.25rem\"}}>Servicios subrogados</h2>\r\n    <div className={formErrors.prestaciones ? \"is-invalid\" : \"\"}>\r\n      {fields.map((field,index)=>{\r\n        return <Form.Row key={field.id} className=\"py-2 border-bottom\">\r\n          <Form.Group as={Col} xs={12}>\r\n            {/* <Form.Label>\r\n              Prestaciones\r\n            </Form.Label> */}\r\n              <Controller\r\n                name={`prestaciones.${index}.prestacion` as const}\r\n                control={control}\r\n                rules={{\r\n                  required: rules.required(),\r\n                }}\r\n                render={({ field, fieldState }) => {\r\n                  return <>\r\n                  <Form.Row>\r\n                    <Col>\r\n                      <PrestacionesTypeahead\r\n                        id={`proveedor-contrato/prestaciones.${index}`}\r\n                        className={!!fieldState.error ? \"is-invalid\" : \"\"}\r\n                        isInvalid={!!fieldState.error}\r\n                        filterBy={(prestacion) => {\r\n                          const prestaciones = watch(\"prestaciones\")\r\n                          return !prestaciones.some(p=>p.prestacion?.id == prestacion.id)\r\n                        }}\r\n                        selected={field.value ? [field.value]:[]}\r\n                        onChange={(prestacion) => {\r\n                          field.onChange(prestacion.length ? prestacion[0] : 0)\r\n                        }}\r\n                        onBlur={field.onBlur}\r\n                      />\r\n                      <Form.Control.Feedback type=\"invalid\">{fieldState.error?.message}</Form.Control.Feedback>\r\n                    </Col>\r\n                    <Col xs=\"auto\">\r\n                        <Button variant=\"danger\" onClick={()=>{\r\n                          remove(index)\r\n                        }}>\r\n                          Quitar\r\n                        </Button>\r\n                    </Col>\r\n                  </Form.Row>\r\n                  </>\r\n                }}\r\n              />\r\n          </Form.Group>\r\n          {/* <Col className=\"px-3\" xs={12}>\r\n            <ArancelesControl index={index} />\r\n          </Col> */}\r\n        </Form.Row>\r\n      })}\r\n    </div>\r\n    <Form.Control.Feedback type=\"invalid\">{\r\n      //@ts-ignore\r\n      formErrors.prestaciones?.message}</Form.Control.Feedback>\r\n    <Form.Row className=\"py-2\">\r\n      <Col className=\"ml-auto\" xs={\"auto\"}>\r\n        <Button\r\n          onClick={()=>{\r\n            append({\r\n              // aranceles: [{\r\n              //   nombre: \"\",\r\n              //   precio: \"\",\r\n              //   etiqueta: \"\"\r\n              // }]\r\n            })\r\n          }}\r\n        >Agregar</Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </div>\r\n}","import { useEffect, useState } from \"react\"\r\nimport { Alert, Button, Col, Form, Spinner } from \"react-bootstrap\"\r\nimport { Controller, FormProvider, useForm } from \"react-hook-form\"\r\nimport { useParams, useHistory } from \"react-router\"\r\nimport { useMutation } from \"react-query\"\r\nimport { yupResolver } from \"@hookform/resolvers/yup\"\r\nimport * as yup from \"yup\"\r\nimport { PrestacionesContratadasControl, Inputs as PCInputs } from \"./PrestacionesContratadasControl\"\r\n// import { Regional, RegionalesTypeahead } from '../../../../commons/components'\r\nimport { Permisos, useLoggedUser } from \"../../../../commons/auth\"\r\nimport { ContratosService } from \"../services\"\r\n\r\nexport type Inputs = {\r\n  inicio?: string\r\n  fin?: string\r\n  // regional?: Regional[]\r\n} & PCInputs\r\n\r\ntype Props = {\r\n  onSubmit?: (data: Inputs) => void\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  inicio: yup.date().label(\"fecha de inicio\").emptyStringTo().typeError(\"No es una fecha valida\")\r\n    .required(),\r\n  fin: yup.date().label(\"fecha de finalizacion\").emptyStringTo(null).typeError(\"No es una fecha valida\")\r\n    .min(yup.ref(\"inicio\"), \"La fecha de finalizacion debe ser mayor a la fecha de inicio\")\r\n    .nullable().notRequired(),\r\n  // regional: yup.array().length(1, \"Debe seleccionar una regional\"),\r\n  prestaciones: yup.array().min(1, \"Debe seleccionar al menos una prestación\")\r\n})\r\n\r\nexport const ContratoForm = ({onSubmit}: Props)=>{\r\n  const {idProveedor} = useParams<{\r\n    idProveedor: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    proveedor: {id: number}\r\n  }>()\r\n\r\n  const loggedUser = useLoggedUser()\r\n  \r\n  // const [regionales, setRegionales] = useState<Regional[]>([])\r\n\r\n  const methods = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      prestaciones: [{\r\n        // aranceles: [{}]\r\n      }],\r\n      // regional: []\r\n    }\r\n  })\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    formState,\r\n    control\r\n  } = methods\r\n\r\n  const formErrors = formState.errors\r\n\r\n  console.log(\"Errors\", formErrors)\r\n\r\n  const guardar = useMutation((values: Inputs)=>{\r\n    return ContratosService.registrar(parseInt(idProveedor) || history.location.state!.proveedor!.id, {\r\n      inicio: values.inicio!,\r\n      fin: values.fin!,\r\n      prestacion_ids: values.prestaciones.map(p=>p.prestacion.id)\r\n    })\r\n  }, {\r\n    onSuccess: ({data}) => {\r\n      history.replace(`/clinica/proveedores/${parseInt(idProveedor) || history.location.state!.proveedor!.id}`)\r\n    }\r\n  })\r\n\r\n  return <FormProvider {...methods}>\r\n    <Form id=\"proveedor-contrato-form\" onSubmit={handleSubmit(onSubmit || ((values)=>{\r\n      console.log(values)\r\n      guardar.mutate(values)\r\n    }))}>\r\n      <h1 style={{fontSize: \"1.75rem\"}}>Contrato</h1>\r\n      <Form.Row>\r\n        <Form.Group as={Col} sm={6}>\r\n          <Form.Label>Inicio</Form.Label>\r\n          <Form.Control type=\"date\"\r\n            isInvalid={!!formState.errors.inicio}\r\n            {...register(\"inicio\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formState.errors.inicio?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} sm={6}>\r\n          <Form.Label>Fin</Form.Label>\r\n          <Form.Control type=\"date\"\r\n            isInvalid={!!formState.errors.fin}\r\n            {...register(\"fin\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formState.errors.fin?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n      </Form.Row>\r\n      {/* <Form.Row>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Regional</Form.Label>\r\n          <Controller\r\n            name=\"regional\"\r\n            control={control}\r\n            render={({field, fieldState})=>{\r\n              return <>\r\n                <RegionalesTypeahead\r\n                  id=\"proveedor-contrato-form/regionales-typeahead\"\r\n                  onLoad={(regionales)=>setRegionales(regionales)}\r\n                  filterBy={(regional) => {\r\n                    if(idProveedor){\r\n                      if(loggedUser.can(Permisos.REGISTRAR_CONTRATO_PROVEEDOR) \r\n                        || (loggedUser.can(Permisos.REGISTRAR_CONTRATO_PROVEEDOR_REGIONAL) && loggedUser.regionalId == regional.id)) return true\r\n                    }\r\n                    else{\r\n                      if(loggedUser.can(Permisos.REGISTRAR_PROVEEDORES) \r\n                        || (loggedUser.can(Permisos.REGISTRAR_PROVEEDORES_REGIONAL) && loggedUser.regionalId == regional.id)) return true\r\n                    }\r\n                    return false\r\n                  }}\r\n                  feedback={fieldState.error?.message}\r\n                  isInvalid={!!fieldState.error}\r\n                  selected={field.value}\r\n                  onChange={field.onChange}\r\n                  onBlur={field.onBlur}\r\n                />\r\n              </>\r\n            }}\r\n          />\r\n        </Form.Group>\r\n      </Form.Row> */}\r\n      <Form.Row>\r\n        <Col>\r\n          <PrestacionesContratadasControl />\r\n        </Col>\r\n      </Form.Row>\r\n      {!onSubmit ? <Button type=\"submit\">\r\n        {guardar.isLoading ? <Spinner className=\"mr-1\" animation=\"border\" size=\"sm\"/> : null}\r\n        <span className=\"align-middle\">Guardar</span>\r\n      </Button> : null}\r\n    </Form>\r\n  </FormProvider>\r\n}","import { useState } from \"react\"\r\nimport { Button, Col, Form, Spinner } from \"react-bootstrap\"\r\nimport StepWizard, { StepWizardChildProps } from \"react-step-wizard\"\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { useMutation } from \"react-query\"\r\nimport { Inputs as ProveedorInputs, ProveedorMedicoInput, ProveedorForm } from \"./ProveedorForm\"\r\nimport { Inputs as ContactoInputs, ContactoForm } from \"./ContactoForm\"\r\nimport { Inputs as ContratoInputs, ContratoForm } from \"./ContratoForm\"\r\nimport { ProveedoresService } from \"../services\"\r\n\r\n\r\nconst GeneralInfoStep = (props: Partial<StepWizardChildProps> & {\r\n  onSubmit: (data: ProveedorInputs) => void\r\n}) => {\r\n  return <>\r\n    <ProveedorForm onSubmit={(data) => {\r\n      props.onSubmit(data)\r\n      props.nextStep!()\r\n    }} />\r\n    <Form.Row>\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        <Button\r\n          type=\"submit\"\r\n          form=\"proveedor-form\"\r\n        >\r\n          Siguiente\r\n        </Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </>\r\n}\r\n\r\nconst ContactInfoStep = (props: Partial<StepWizardChildProps> & {\r\n  onSubmit: (data: ContactoInputs) => void\r\n}) => {\r\n  return <>\r\n    <ContactoForm onSubmit={(data) => {\r\n        props.onSubmit(data)\r\n        props.nextStep!()\r\n      }}\r\n    />\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button onClick={props.previousStep}>\r\n          Anterior\r\n        </Button>\r\n      </Col>\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        <Button variant=\"link\" \r\n          onClick={props.nextStep}>\r\n          Omitir\r\n        </Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Button\r\n          type=\"submit\"\r\n          form=\"proveedor-contacto-form\"\r\n        >\r\n          Siguiente\r\n        </Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </>\r\n}\r\n\r\nconst ContractInfoStep = (props: Partial<StepWizardChildProps> & {\r\n  onSubmit: (data: ContratoInputs) => void\r\n}) => {\r\n  return <>\r\n    <ContratoForm onSubmit={(data) => {\r\n      props.onSubmit(data)\r\n      props.nextStep!()\r\n    }} />\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button onClick={props.previousStep}>\r\n          Anterior\r\n        </Button>\r\n      </Col>\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        <Button\r\n          type=\"submit\"\r\n          form=\"proveedor-contrato-form\"\r\n        >\r\n          Siguiente\r\n        </Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </>\r\n}\r\n\r\nconst FinishStep = ({\r\n  generalInfo,\r\n  contactInfo,\r\n  contractInfo\r\n}: Partial<StepWizardChildProps> & {\r\n  generalInfo: ProveedorInputs\r\n  contactInfo?: ContactoInputs\r\n  contractInfo: ContratoInputs\r\n}) => {\r\n\r\n  // console.log(generalInfo, contactInfo, contractInfo)\r\n\r\n  const history = useHistory()\r\n\r\n  function isMedico(data: ProveedorInputs): data is ProveedorMedicoInput{\r\n    return data.tipo == 1\r\n  }\r\n\r\n  const guardar = useMutation(()=>{\r\n\r\n    const general = isMedico(generalInfo) ? {\r\n      tipoId: generalInfo.tipo!,\r\n      nit: generalInfo.nit,\r\n      ci: generalInfo.ci!,\r\n      ciComplemento: generalInfo.ciComplemento,\r\n      apellidoPaterno: generalInfo.apellidoPaterno,\r\n      apellidoMaterno: generalInfo.apellidoMaterno,\r\n      nombres: generalInfo.nombres!,\r\n      especialidadId: generalInfo.especialidad![0].id,\r\n      regionalId: generalInfo.regional![0].id\r\n    } : {\r\n      tipoId: generalInfo.tipo!,\r\n      nit: generalInfo.nit,\r\n      nombre: generalInfo.nombre!,\r\n      regionalId: generalInfo.regional![0].id\r\n    }\r\n\r\n    let contacto\r\n    if(contactInfo){\r\n      let lat, lng\r\n      if(Array.isArray(contactInfo.ubicacion)){\r\n        [lat, lng] = contactInfo.ubicacion!\r\n      }\r\n      else{\r\n        ({lat, lng} = contactInfo.ubicacion!)\r\n      }\r\n      contacto = {\r\n        municipioId: contactInfo.municipio![0].id,\r\n        direccion: contactInfo.direccion!,\r\n        ubicacion: {\r\n          latitud: lat,\r\n          longitud: lng\r\n        },\r\n        telefono1: contactInfo.telefono1!,\r\n        telefono2: contactInfo.telefono2!\r\n      }\r\n    }\r\n\r\n    const contrato = {\r\n      inicio: (contractInfo.inicio! as any).toISOString().split(\"T\")[0],\r\n      fin: (contractInfo.fin as any)?.toISOString()?.split(\"T\")[0],\r\n      // regionalId: contractInfo.regional![0].id,\r\n      prestacionIds: contractInfo.prestaciones!.map(pc => pc.prestacion.id)\r\n    }\r\n\r\n\r\n\r\n    return ProveedoresService.registrar({\r\n      general, contacto, contrato\r\n    })\r\n  }, {\r\n    onSuccess: ({data})=>{\r\n      history.push(`/clinica/proveedores/${data.id}`)\r\n    }\r\n  })\r\n\r\n  return <div>\r\n    Fin.\r\n    <Button\r\n      onClick={()=>{\r\n        guardar.mutate()\r\n      }}\r\n    >\r\n      {guardar.isLoading ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n      Guardar\r\n    </Button>\r\n  </div>\r\n}\r\n\r\nexport const ProveedorWizard = () => {\r\n\r\n  const [generalInfo, setGeneralInfo] = useState<ProveedorInputs>()\r\n  const [contactInfo, setContactInfo] = useState<ContactoInputs>()\r\n  const [contractInfo, setContractInfo] = useState<ContratoInputs>()\r\n\r\n  return <StepWizard>\r\n    <GeneralInfoStep onSubmit={(data)=>{\r\n      setGeneralInfo(data)\r\n    }} />\r\n    <ContactInfoStep onSubmit={(data)=>{\r\n      setContactInfo(data)\r\n    }} />\r\n    <ContractInfoStep onSubmit={(data)=>{\r\n      setContractInfo(data)\r\n    }} />\r\n    <FinishStep \r\n      generalInfo={generalInfo!}\r\n      contactInfo={contactInfo}\r\n      contractInfo={contractInfo!}\r\n    />\r\n  </StepWizard>\r\n}","import { useMemo } from \"react\"\r\nimport { Route, Switch, useRouteMatch } from 'react-router-dom';\r\nimport SidebarLayout from '../../commons/components/layouts/SidebarLayout';\r\nimport { FaCog, /*FaCoins,*/ FaHandshake, FaUserMd } from 'react-icons/fa';\r\nimport { BiTransfer } from 'react-icons/bi';\r\nimport ListaMoraIndex from './mora/components/ListaMoraIndex';\r\nimport ListaMoraItemForm from './mora/components/ListaMoraItemForm';\r\nimport { FcDebt } from '../../commons/components/icons/FcDebt';\r\nimport { SolicitudAtencionExternaIndex } from './solicitud_atencion_externa/components/SolicitudAtencionExternaIndex';\r\nimport { SolicitudAtencionExternaForm } from './solicitud_atencion_externa/components/SolicitudAtencionExternaForm';\r\nimport { SolicitudATPolicy } from './solicitud_atencion_externa/policies';\r\nimport { EspecialidadesIndex, EspecialidadForm } from './especialidades/components';\r\nimport { PrestacionesIndex, PrestacionForm } from './prestaciones/componentes';\r\nimport { MedicosIndex, MedicosForm, MedicoPolicy } from './medicos';\r\nimport { \r\n  ProveedoresIndex,\r\n  ProveedorView,\r\n  ProveedorWizard,\r\n  ProveedorForm,\r\n  ContactoForm,\r\n  ContratoForm,\r\n  ProveedorPolicy\r\n} from './proveedores';\r\nimport { Permisos, ProtectedRoute, useLoggedUser } from '../../commons/auth';\r\n\r\nexport const ClinicaApp = ()=>{\r\n  const { url } = useRouteMatch()\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const sidebarItems = useMemo(()=>{\r\n    const items = [] as any[]\r\n\r\n    items.push(\r\n      {\r\n        id: \"lista-mora\",\r\n        path: `${url}/lista-mora`,\r\n        title: \"Lista de mora\",\r\n        icon: <FcDebt  />\r\n      }\r\n    )\r\n\r\n    if(SolicitudATPolicy.index(loggedUser)) {\r\n      items.push({\r\n        id: \"atencion-externa\",\r\n        path: `${url}/atencion-externa`,\r\n        title: \"Atención externa\",\r\n        icon: <BiTransfer />\r\n      })\r\n    }\r\n    if(MedicoPolicy.index(loggedUser)){\r\n      items.push({\r\n        id: \"medicos\",\r\n        path: `${url}/medicos`,\r\n        title: \"Medicos\",\r\n        icon: <FaUserMd />,\r\n      })\r\n    }\r\n    if(ProveedorPolicy.index(loggedUser)){\r\n      items.push({\r\n        id: \"proveedores\",\r\n        path: `${url}/proveedores`,\r\n        title: \"Proveedores\",\r\n        icon: <FaHandshake />\r\n      })\r\n    }\r\n\r\n    items.push(\r\n      {\r\n        id: \"configuracion\",\r\n        // path: `${url}/configuracion`,\r\n        title: \"Configuración\",\r\n        icon: <FaCog />,\r\n        items: [\r\n          {\r\n            id: \"configuracion/especialidades\",\r\n            path: `${url}/configuracion/especialidades`,\r\n            title: \"Especialidades\",\r\n            icon: <FaCog />,\r\n          },\r\n          {\r\n            id: \"configuracion/prestaciones\",\r\n            path: `${url}/configuracion/prestaciones`,\r\n            title: \"Servicios subrogados\",\r\n            icon: <FaCog />,\r\n          }\r\n        ]\r\n      }\r\n    )\r\n    return items\r\n  }, [loggedUser])\r\n\r\n  return <SidebarLayout sidebar={{\r\n    items: sidebarItems\r\n  }}>\r\n    <Switch>\r\n      <Route exact path={`${url}/lista-mora/agregar`}>\r\n        <ListaMoraItemForm />\r\n      </Route>\r\n      <Route path={`${url}/lista-mora`}>\r\n        <ListaMoraIndex />\r\n      </Route>\r\n      <ProtectedRoute exact path={`${url}/atencion-externa`}\r\n        authorize={SolicitudATPolicy.index}>\r\n        <SolicitudAtencionExternaIndex />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/atencion-externa/registrar`}\r\n        authorize={SolicitudATPolicy.register}\r\n      >\r\n        <SolicitudAtencionExternaForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/medicos`}\r\n        authorize={MedicoPolicy.index}\r\n      >\r\n        <MedicosIndex />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={[`${url}/medicos/registrar`, `${url}/medicos/:id/editar`]}\r\n        authorize={(user, path) => path == `${url}/medicos/registrar` ? MedicoPolicy.register(user) : MedicoPolicy.edit(user) }\r\n      >\r\n        <MedicosForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores`}\r\n        authorize={ProveedorPolicy.index}\r\n      >\r\n        <ProveedoresIndex />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/registrar`}\r\n        authorize={ProveedorPolicy.register}\r\n      >\r\n        <ProveedorWizard />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:id`}\r\n        authorize={ProveedorPolicy.view}\r\n      >\r\n        <ProveedorView />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:id/editar`}\r\n        authorize={ProveedorPolicy.edit}>\r\n        <ProveedorForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:id/editar-contacto`}\r\n        authorize={(user)=>ProveedorPolicy.register(user) || ProveedorPolicy.edit(user)}\r\n      >\r\n        <ContactoForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:idProveedor/contratos/registrar`}\r\n        authorize={(user)=>ProveedorPolicy.register(user) || ProveedorPolicy.edit(user)}\r\n      >\r\n        <ContratoForm />\r\n      </ProtectedRoute>\r\n      <Route path={`${url}/configuracion/especialidades`}>\r\n        <EspecialidadesIndex />\r\n      </Route>\r\n      <Route path={`${url}/configuracion/prestaciones`}>\r\n        <PrestacionesIndex />\r\n      </Route>\r\n    </Switch>\r\n    \r\n    <Route exact path={[`${url}/configuracion/prestaciones/registrar`, `${url}/configuracion/prestaciones/:id/editar`]}>\r\n      <PrestacionForm />\r\n    </Route>\r\n    <Route exact path={[`${url}/configuracion/especialidades/registrar`, `${url}/configuracion/especialidades/:id/editar`]}>\r\n      <EspecialidadForm />\r\n    </Route>\r\n  </SidebarLayout>\r\n}\r\n\r\nexport default ClinicaApp"],"sourceRoot":""}