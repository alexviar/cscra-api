{"version":3,"sources":["commons/auth/index.ts","commons/auth/constants/Permisos.ts","commons/click-outside-handler/useOnClickOutside.ts","commons/click-outside-handler/ClickOutsideHandler.tsx","commons/components/layouts/Sidebar.tsx","commons/components/layouts/SidebarLayout.tsx","apps/clinica/mora/services/EmpleadorService.ts","apps/clinica/mora/services/ListaMoraService.ts","apps/clinica/mora/components/ListaMoraFilterForm.tsx","apps/clinica/mora/policies/index.ts","apps/clinica/mora/components/RowOptions.tsx","apps/clinica/mora/components/ListaMoraIndex.tsx","apps/clinica/mora/components/ListaMoraItemForm.tsx","commons/components/icons/FcDebt.tsx","apps/clinica/solicitud_atencion_externa/services/SolicitudesAtencionExternaService.ts","apps/clinica/solicitud_atencion_externa/services/AseguradosService.ts","apps/clinica/medicos/services/MedicoService.ts","apps/clinica/proveedores/services/ProveedoresService.ts","apps/clinica/solicitud_atencion_externa/services/PrestacionesService.ts","apps/clinica/solicitud_atencion_externa/components/MedicosTypeahead.tsx","apps/clinica/solicitud_atencion_externa/components/ProveedoresTypeahead.tsx","apps/clinica/solicitud_atencion_externa/components/SolicitudAtencionExternaFilterForm.tsx","apps/clinica/solicitud_atencion_externa/components/Dm11Viewer.tsx","apps/clinica/solicitud_atencion_externa/components/RowOptions.tsx","apps/clinica/solicitud_atencion_externa/policies/index.ts","apps/clinica/solicitud_atencion_externa/components/SolicitudAtencionExternaIndex.tsx","apps/clinica/solicitud_atencion_externa/components/AseguradoChooser.tsx","apps/clinica/solicitud_atencion_externa/components/AseguradoCard.tsx","apps/clinica/solicitud_atencion_externa/components/PrestacionesTypeahead.tsx","apps/clinica/solicitud_atencion_externa/components/PrestacionesSolicitadasCard.tsx","apps/clinica/solicitud_atencion_externa/utils/EstadosAfi.ts","apps/clinica/solicitud_atencion_externa/utils/EstadosEmp.ts","apps/clinica/solicitud_atencion_externa/components/SolicitudAtencionExternaForm.tsx","apps/clinica/especialidades/services/EspecialidadesServices.ts","apps/clinica/especialidades/components/EspecialidadesFilter.tsx","apps/clinica/especialidades/components/EspecialidadesIndex.tsx","apps/clinica/especialidades/components/EspecialidadForm.tsx","apps/clinica/prestaciones/services/PrestacionesService.ts","apps/clinica/prestaciones/componentes/PrestacionesFilterForm.tsx","apps/clinica/prestaciones/componentes/PrestacionesIndex.tsx","apps/clinica/prestaciones/componentes/PrestacionForm.tsx","apps/clinica/medicos/policies/index.ts","apps/clinica/medicos/components/EspecialidadesTypeahead.tsx","apps/clinica/medicos/components/MedicosFilterForm.tsx","apps/clinica/medicos/components/RowOptions.tsx","apps/clinica/medicos/components/MedicosIndex.tsx","apps/clinica/medicos/components/MedicoView.tsx","apps/clinica/medicos/components/MedicosForm.tsx","apps/clinica/proveedores/policies/ProveedorPolicy.ts","apps/clinica/proveedores/components/ProveedoresFilterForm.tsx","apps/clinica/proveedores/components/RowOptions.tsx","apps/clinica/proveedores/components/ProveedoresIndex.tsx","apps/clinica/contratos/policies/ContratoPolicy.ts","apps/clinica/contratos/services/ContratosService.ts","apps/clinica/contratos/components/ContratoFilterForm.tsx","apps/clinica/contratos/components/RowOptions.tsx","apps/clinica/contratos/components/ContratosIndex.tsx","apps/clinica/contratos/components/ContratoView.tsx","apps/clinica/contratos/components/PrestacionesContratadasControl.tsx","apps/clinica/contratos/components/ContratoForm.tsx","apps/clinica/proveedores/components/ProveedorView.tsx","apps/clinica/proveedores/components/ProveedorEmpresaForm.tsx","apps/clinica/proveedores/components/ProveedorMedicoForm.tsx","apps/clinica/proveedores/components/ProveedorForm.tsx","apps/clinica/proveedores/components/ContactoForm.tsx","apps/clinica/proveedores/components/ProveedorWizard.tsx","apps/clinica/ClinicaApp.tsx"],"names":["VER_SOLICITUDES_DE_ATENCION_EXTERNA","VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL","VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR","REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA","REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL","EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA","EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL","EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR","VER_USUARIOS","VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","REGISTRAR_USUARIOS","REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","EDITAR_USUARIOS","EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","BLOQUEAR_USUARIOS","BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","DESBLOQUEAR_USUARIOS","DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","CAMBIAR_CONTRASEÑA","CAMBIAR_CONTRASEÑA_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO","VER_ROLES","REGISTRAR_ROLES","EDITAR_ROLES","ELIMINAR_ROLES","VER_LISTA_DE_MORA","VER_LISTA_DE_MORA_REGIONAL","AGREGAR_EMPLEADOR_EN_MORA","AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL","QUITAR_EMPLEADOR_EN_MORA","QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL","VER_MEDICOS","VER_MEDICOS_REGIONAL","REGISTRAR_MEDICOS","REGISTRAR_MEDICOS_REGIONAL","EDITAR_MEDICOS","EDITAR_MEDICOS_REGIONAL","BAJA_MEDICOS","BAJA_MEDICOS_REGIONAL","VER_PROVEEDORES","VER_PROVEEDORES_REGIONAL","REGISTRAR_PROVEEDORES","REGISTRAR_PROVEEDORES_REGIONAL","EDITAR_PROVEEDORES","EDITAR_PROVEEDORES_REGIONAL","BAJA_PROVEEDOR","BAJA_PROVEEDOR_REGIONAL","VER_CONTRATOS_PROVEEDOR","VER_CONTRATOS_PROVEEDOR_REGIONAL","REGISTRAR_CONTRATOS_PROVEEDOR","REGISTRAR_CONTRATOS_PROVEEDOR_REGIONAL","CONSUMIR_CONTRATOS_PROVEEDOR","CONSUMIR_CONTRATOS_PROVEEDOR_REGIONAL","EXTENDER_CONTRATOS_PROVEEDOR","EXTENDER_CONTRATOS_PROVEEDOR_REGIONAL","ANULAR_CONTRATOS_PROVEEDOR","ANULAR_CONTRATOS_PROVEEDOR_REGIONAL","VER_ESPECIALIDADES","REGISTRAR_ESPECIALIDADES","EDITAR_ESPECIALIDADES","ELIMINAR_ESPECIALIDADES","IMPORTAR_ESPECIALIDADES","VER_PRESTACIONES","REGISTRAR_PRESTACIONES","EDITAR_PRESTACIONES","ELIMINAR_PRESTACIONES","IMPORTAR_PRESTACIONES","useOnClickOutside","ref","handler","useEffect","listener","event","el","current","contains","target","document","querySelector","addEventListener","removeEventListener","ClickOutsideHandler","children","onClickOutside","props","containerRef","useRef","SidebarItem","item","match","useRouteMatch","path","ListGroup","Item","as","Link","to","action","active","className","style","padding","icon","verticalAlign","marginLeft","title","id","items","map","subitem","paddingLeft","Sidebar","side","header","renderItem","left","right","variant","SidebarLayout","sidebar","showSidebar","useSelector","state","sidebarVisibility","dispatch","useDispatch","onClickOutsideHandler","React","useCallback","toggle","type","Container","EmpleadorService","numeroPatronal","apiClient","get","params","numero_patronal","ListaMoraService","filter","page","keysToUnderscore","idEmpleador","post","empleador_id","console","log","ListaMoraFilterForm","useForm","handleSubmit","register","reset","Form","onSubmit","inputs","nombre","onApply","Row","Group","Col","sm","Label","Control","xs","Button","onClick","ListaMoraPolicy","index","user","canAny","Permisos","view","agregar","quitar","RowOptions","queryKey","modal","useModal","queryClient","useQueryClient","useMutation","empleadorId","onSuccess","close","setQueryData","oldData","data","records","i","status","open","error","Dropdown","Toggle","VerticalEllipsisDropdownToggle","Menu","authorize","href","window","confirm","mutate","useState","size","setPage","loggedUser","useLoggedUser","can","regionalId","setFilter","filterFormVisible","showFilterForm","buscar","useQuery","enabled","refetchOnWindowFocus","refetchOnReconnect","total","meta","fontSize","refetch","visible","Collapse","in","value","onChange","e","parseInt","Table","responsive","width","isFetching","colSpan","Spinner","animation","isError","response","message","length","lineHeight","renderRows","Math","ceil","schema","yup","shape","label","trim","uppercase","required","mode","resolver","yupResolver","defaultValues","watch","setError","clearErrors","setValue","trigger","formState","formErrors","errors","history","useHistory","buscarEmpleador","guardar","invalidateQueries","replace","isSuccess","Alert","guardarError","renderAlert","InputGroup","hasValidation","isInvalid","Append","then","valid","Feedback","readOnly","isLoading","FcDebt","GenIcon","SolicitudesAtencionExternaService","regional_id","asegurado_id","medico_id","proveedor_id","prestaciones_solicitadas","AseguradosService","matricula","include","MedicosService","tipo","ci","apellido_paterno","apellido_materno","nombres","especialidad_id","raiz","ci_complemento","complemento","put","estado","ProveedoresService","fields","infoContacto","PrestacionesService","source","axios","CancelToken","promise","cancel","MedicosTypeahead","feedback","filterBy","onLoad","options","useMemo","Array","isArray","clearButton","emptyLabel","align","disabled","medico","text","isMatch","nombreCompleto","especialidad","labelKey","minLength","renderMenuItemChildren","ProveedoresTypeahead","proveedor","SolicitudAtencionExternaFilterForm","control","input","onFilter","numero","matriculaAsegurado","desde","hasta","medicoId","proveedorId","name","render","field","selected","onBlur","Dm11Viewer","centered","show","onHide","Header","Body","url","solicitud","position","urlDm11","SolicitudATPolicy","emit","SolicitudAtencionExternaIndex","useLocation","pathname","setTotal","getDefaultFilter","registradoPor","ProtectedContent","fecha","asegurado","AseguradoChooser","asegurados","Modal","scope","matriculaComplemento","estadoText","onSelect","AseguradoCard","useFormContext","aseguradoChooserVisible","showAseguradoChooser","empleador","apellidoPaterno","apellidoMaterno","valSeguro","afiliacion","baja","fechaValidezSeguro","moment","format","fechaBaja","enMora","titular","extincion","fechaExtincion","parentesco","code","getParentesco","valSeguroTit","dirtyFields","hasErrors","Card","Accordion","eventKey","lg","md","htmlFor","FormControl","validation","PrestacionesTypeahead","allowNew","registrar","inactive","option","customOption","newSelectionPrefix","prestacion","PrestacionesSolicitadasCard","proveedoresTypeaheadController","useController","useFieldArray","append","remove","prestacionesSolicitadas","overflow","prestacionSolicitada","fieldState","contrato","prestaciones","some","pc","ps","activos","every","nota","EstadosAfi","1","2","EstadosEmp","3","hoy","estadoAfiSchema","oneOf","Object","values","test","context","parent","tieneBaja","createError","date","fechaRegBaja","validezSchema","isSameOrBefore","matches","nullable","notRequired","min","toDate","validateSync","when","is","subtract","aportes","regional","of","max","SolicitudAtencionExternaForm","setAsegurado","formMethods","dm11Viewer","prestacion_id","registrarError","keys","forEach","key","localKey","defaultActiveKey","EspecialidadesService","undefined","delete","EspecialidadesFilter","onSearch","srOnly","minWidth","EspecialidadesIndex","eliminar","Pagination","EspecialidadForm","useParams","continueRef","cargar","location","refetchOnMount","renderBody","Footer","form","PrestacionesFilterForm","PrestacionesIndex","PrestacionForm","verPrestacion","MedicoPolicy","edit","EspecialidadesTypeahead","MedicosFilterForm","numCi","compCi","ciComplemento","especialidadId","Check","inline","cambiarEstado","MedicosIndex","ciText","MedicoView","locationState","loader","onError","typeError","transform","otherwise","emptyStringToNull","MedicosForm","regionales","setRegionales","especialidades","setEspecialidades","ignoreAuthorization","String","r","ProveedorPolicy","ProveedoresFilterForm","tipos","medicos","push","empresas","prestacionesId","p","multiple","ProveedoresIndex","ContratoPolicy","consumir","extender","anular","ContratosService","idProveedor","idContrato","ContratoFilterForm","queryLoader","ContratosIndex","inicio","fin","extension","ContratoView","PrestacionesContratadasControl","maxHeight","overflowY","emptyStringTo","ContratoForm","methods","toISOString","split","prestacionIds","tab","DefaultIcon","L","iconUrl","shadowUrl","iconShadow","iconSize","iconAnchor","Marker","prototype","ProveedorView","tipoId","nit","renderGeneralInfo","Tabs","Tab","ubicacion","latitud","longitud","municipio","provincia","departamento","direccion","telefono1","telefono2","MapContainer","center","zoom","dragging","scrollWheelZoom","doubleClickZoom","minHeight","height","TileLayer","attribution","Popup","join","renderContactInfo","ProveedorEmpresaForm","actualizar","ProveedorMedicoForm","ProveedorForm","setTipo","column","checked","ContactoForm","departamentos","setDepartamentos","provincias","setProvincias","municipios","setMunicipios","lat","lng","actualizarInformacionDeContacto","municipioId","find","m","provinciaId","d","departamentoId","GeneralInfoStep","nextStep","ContactInfoStep","previousStep","ContractInfoStep","FinishStep","generalInfo","contactInfo","contractInfo","contacto","general","element","ProveedorWizard","setGeneralInfo","setContactInfo","setContractInfo","ClinicaApp","sidebarItems","Image","src","exact","ListaMoraItemForm","ListaMoraIndex"],"mappings":"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","file":"static/js/6.40b99d3d.chunk.js","sourcesContent":["export { ProtectedContent, ProtectedRoute } from \"./components\"\r\nexport * from \"./hooks\"\r\nexport { Permisos } from \"./constants\"","/**\r\n * Permisos de solicitud de transferencia externa\r\n */\r\nexport const VER_SOLICITUDES_DE_ATENCION_EXTERNA = \"Ver solicitudes de atencion externa\";\r\nexport const VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL = \"Ver solicitudes de atencion externa (misma regional)\";\r\nexport const VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR = \"Ver solicitudes de atencion externa (registrado por)\";\r\nexport const REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA = \"Registrar solicitudes de atencion externa\";\r\nexport const REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL = \"Registrar solicitudes de atencion externa (misma regional)\";\r\n// export const REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR = \"Registrar solicitudes de atencion externa (registrado por)\";\r\nexport const EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA = \"Emitir solicitudes de atencion externa\";\r\nexport const EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL = \"Emitir solicitudes de atencion externa (misma regional)\";\r\nexport const EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR = \"Emitir solicitudes de atencion externa (registrado por)\";\r\n  \r\n/**\r\n * Permisos de usuarios\r\n */\r\nexport const VER_USUARIOS = \"Ver usuarios\";\r\nexport const VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Ver usuarios (misma regional)\";\r\nexport const REGISTRAR_USUARIOS = \"Registrar usuarios\";\r\nexport const REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Registrar usuarios (misma regional)\";\r\nexport const EDITAR_USUARIOS = \"Editar usuarios\";\r\nexport const EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Editar usuarios (misma regional)\";\r\nexport const BLOQUEAR_USUARIOS = \"Bloquear usuarios\";\r\nexport const BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Bloquear usuarios (misma regional)\";\r\nexport const DESBLOQUEAR_USUARIOS = \"Desbloquear usuarios\";\r\nexport const DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Desbloquear usuarios (misma regional)\";\r\nexport const CAMBIAR_CONTRASEÑA = \"Cambiar contraseña\";\r\nexport const CAMBIAR_CONTRASEÑA_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO = \"Cambiar contraseña (misma regional)\";\r\n\r\n/**\r\n * Permisos de roles\r\n */\r\nexport const VER_ROLES = \"Ver roles\";\r\nexport const REGISTRAR_ROLES = \"Registrar roles\";\r\nexport const EDITAR_ROLES = \"Editar roles\";\r\nexport const ELIMINAR_ROLES = \"Eliminar roles\";\r\n\r\n\r\n/**\r\n * Permisos de lista de mora\r\n */\r\nexport const VER_LISTA_DE_MORA = \"Ver lista de mora\"\r\nexport const VER_LISTA_DE_MORA_REGIONAL = \"Ver lista de mora (regional)\"\r\nexport const AGREGAR_EMPLEADOR_EN_MORA = \"Agregar empleador en mora\";\r\nexport const AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL = \"Agregar empleador en mora (misma regional)\";\r\nexport const QUITAR_EMPLEADOR_EN_MORA = \"Quitar empleador en mora\";\r\nexport const QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL = \"Quitar empleador en mora (misma regional)\";\r\n\r\n\r\n\r\n/**\r\n * Medicos\r\n */\r\nexport const VER_MEDICOS = \"Ver médicos\";\r\nexport const VER_MEDICOS_REGIONAL = \"Ver médicos (regional)\";\r\nexport const REGISTRAR_MEDICOS = \"Registrar médicos\";\r\nexport const REGISTRAR_MEDICOS_REGIONAL = \"Registrar médicos (regional)\";\r\nexport const EDITAR_MEDICOS = \"Editar médicos\";\r\nexport const EDITAR_MEDICOS_REGIONAL = \"Editar médicos (regional)\";\r\nexport const BAJA_MEDICOS = \"Baja médicos\";\r\nexport const BAJA_MEDICOS_REGIONAL = \"Baja médicos (regional)\";\r\n\r\n/**\r\n* Proveedores\r\n*/\r\nexport const VER_PROVEEDORES = \"Ver proveedores\";\r\nexport const VER_PROVEEDORES_REGIONAL = \"Ver proveedores (regional)\";\r\nexport const REGISTRAR_PROVEEDORES = \"Registrar proveedores\";\r\nexport const REGISTRAR_PROVEEDORES_REGIONAL = \"Registrar proveedores (regional)\";\r\nexport const EDITAR_PROVEEDORES = \"Editar proveedores\";\r\nexport const EDITAR_PROVEEDORES_REGIONAL = \"Editar proveedores (regional)\";\r\nexport const BAJA_PROVEEDOR = \"Baja proveedores\";\r\nexport const BAJA_PROVEEDOR_REGIONAL = \"Baja proveedores (regional)\";\r\n\r\nexport const VER_CONTRATOS_PROVEEDOR = \"Ver contratos de proveedores\";\r\nexport const VER_CONTRATOS_PROVEEDOR_REGIONAL = \"Ver contratos de proveedores (regional)\";\r\nexport const REGISTRAR_CONTRATOS_PROVEEDOR = \"Registrar contratos de proveedores\";\r\nexport const REGISTRAR_CONTRATOS_PROVEEDOR_REGIONAL = \"Registrar contratos de proveedores (regional)\";\r\nexport const CONSUMIR_CONTRATOS_PROVEEDOR = \"Consumir contratos de proveedores\";\r\nexport const CONSUMIR_CONTRATOS_PROVEEDOR_REGIONAL = \"Consumir contratos de proveedores (regional)\";\r\nexport const EXTENDER_CONTRATOS_PROVEEDOR = \"Extender contratos de proveedores\";\r\nexport const EXTENDER_CONTRATOS_PROVEEDOR_REGIONAL = \"Extender contratos de proveedores (regional)\";\r\nexport const ANULAR_CONTRATOS_PROVEEDOR = \"Anular contratos de proveedores\";\r\nexport const ANULAR_CONTRATOS_PROVEEDOR_REGIONAL = \"Anular contratos de proveedores (regional)\";\r\n\r\n/**\r\n* Especialidades\r\n*/\r\nexport const VER_ESPECIALIDADES = \"Ver especialidades\";\r\nexport const REGISTRAR_ESPECIALIDADES = \"Registrar especialidades\";\r\nexport const EDITAR_ESPECIALIDADES = \"Editar especialidades\";\r\nexport const ELIMINAR_ESPECIALIDADES = \"Eliminar especialidades\";\r\nexport const IMPORTAR_ESPECIALIDADES = \"Importar especialidades\";\r\n\r\n/**\r\n* Prestaciones\r\n*/\r\nexport const VER_PRESTACIONES = \"Ver prestaciones\";\r\nexport const REGISTRAR_PRESTACIONES = \"Registrar prestaciones\";\r\nexport const EDITAR_PRESTACIONES = \"Editar prestaciones\";\r\nexport const ELIMINAR_PRESTACIONES = \"Eliminar prestaciones\";\r\nexport const IMPORTAR_PRESTACIONES = \"Importar prestaciones\";","import { RefObject, useEffect } from 'react'\r\n\r\ntype AnyEvent = MouseEvent | TouchEvent\r\n\r\nexport function useOnClickOutside<T extends HTMLElement = HTMLElement>(\r\n  ref: RefObject<T>,\r\n  handler: (event: AnyEvent) => void,\r\n) {\r\n  useEffect(() => {\r\n    const listener = (event: AnyEvent) => {\r\n      const el = ref?.current\r\n\r\n      // Do nothing if clicking ref's element or descendent elements\r\n      if (!el || el.contains(event.target as Node) || document.querySelector('html') == event.target) {\r\n        return\r\n      }\r\n      handler(event)\r\n    }\r\n\r\n    document.addEventListener(`mousedown`, listener)\r\n    document.addEventListener(`touchstart`, listener)\r\n\r\n    return () => {\r\n      document.removeEventListener(`mousedown`, listener)\r\n      document.removeEventListener(`touchstart`, listener)\r\n    }\r\n\r\n    // Reload only if ref or handler changes\r\n  }, [ref, handler])\r\n}\r\n\r\nexport default useOnClickOutside\r\n","import { FC, useRef, ComponentProps } from 'react'\r\nimport { useOnClickOutside } from './useOnClickOutside'\r\n\r\ntype Props = {\r\n  onClickOutside: (event: MouseEvent | TouchEvent) => void\r\n} & ComponentProps<\"div\">\r\nexport const ClickOutsideHandler:FC<Props> = ({children, onClickOutside, ...props}) => {\r\n  const containerRef = useRef<HTMLDivElement>(null)\r\n  useOnClickOutside(containerRef, onClickOutside)\r\n  return <div ref={containerRef} {...props}>\r\n    {children}\r\n  </div>\r\n}","import React, { ComponentProps } from 'react'\r\nimport { ListGroup } from 'react-bootstrap';\r\nimport { Link, useRouteMatch } from 'react-router-dom'\r\n\r\ntype MenuItem = {\r\n  id: string,\r\n  title: string,\r\n  path: string,\r\n  icon?: React.ReactNode,\r\n  items?: undefined\r\n} | {\r\n  id: string,\r\n  title: string,\r\n  path?: string,\r\n  icon?: React.ReactNode,\r\n  items: {\r\n    id: string,\r\n    title: string,\r\n    path: string,\r\n    icon?: React.ReactNode,\r\n  }[]\r\n}\r\n\r\nconst SidebarItem = (item: MenuItem)=>{\r\n  const match = useRouteMatch(item.path || \"\")\r\n\r\n  return <>\r\n    {item.path ?\r\n      <ListGroup.Item as={Link} to={item.path} \r\n        action\r\n        active={!!match}\r\n        className=\"border-0 text-nowrap\"\r\n        style={{\r\n          padding: \".5rem 1rem\"\r\n        }}\r\n        key={item.id}>\r\n          {item.icon}<span style={{verticalAlign: 'middle', marginLeft: '0.5rem'}}>{item.title}</span>\r\n      </ListGroup.Item> : \r\n      <div\r\n        className=\"list-group-item border-0 text-nowrap\"\r\n        style={{\r\n          padding: \".5rem 1rem\"\r\n        }}\r\n        key={item.id}>\r\n          {item.icon}<span style={{verticalAlign: 'middle', marginLeft: '0.5rem'}}>{item.title}</span>\r\n      </div>\r\n    }\r\n    {item.items && item.items.map(subitem=>{\r\n      return <Link to={subitem.path} \r\n        style={{\r\n          padding: \".5rem 1rem\",\r\n          paddingLeft: \"2rem\"\r\n        }}\r\n        className=\"list-group-item list-group-item-action border-0 text-nowrap\" \r\n        key={subitem.id}>\r\n          {subitem.icon || null}<span style={{verticalAlign: 'middle', marginLeft: '0.5rem'}}>{subitem.title}</span>\r\n      </Link>\r\n    })}\r\n  </>\r\n}\r\n\r\nexport type SidebarProps = ComponentProps<\"div\"> & {\r\n  side?: 'left' | 'right',\r\n  header?: string | JSX.Element,\r\n  items?: MenuItem[],\r\n  renderItem?: (item: MenuItem) => JSX.Element\r\n}\r\nexport const Sidebar = (props: SidebarProps) => {\r\n  const {className=\"\", side=\"right\", header=\"\", items=[], renderItem} = props\r\n  const borderClass = {left: 'border-left', right: 'border-right'}\r\n  return <div className={`${className}  ${borderClass[side]}`} id=\"sidebar-wrapper\">\r\n    <div className=\"sidebar-heading mt-2\">{header}</div>\r\n    <hr className=\"mx-2\"></hr>\r\n    <ListGroup variant=\"flush\">\r\n      {items.map(item=>(\r\n        <SidebarItem key={item.id} {...item} />\r\n      ))}      \r\n    </ListGroup>\r\n    {/* <div className=\"list-group list-group-flush\">\r\n      {items.map(item=><a href=\"#\" className=\"list-group-item list-group-item-action\" key={item.id}>{renderItem ? renderItem(item):item.title}</a>)}\r\n    </div> */}\r\n  </div>\r\n  \r\n}","import React from 'react'\r\nimport { Container } from 'react-bootstrap'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { ClickOutsideHandler } from '../../click-outside-handler'\r\nimport { Sidebar, SidebarProps } from './Sidebar'\r\nimport \"./simple-sidebar.css\"\r\n\r\ntype Props = {\r\n  sidebar: SidebarProps\r\n  children: React.ReactNode\r\n}\r\nexport const SidebarLayout = ({sidebar, children}: Props) => {\r\n  const showSidebar = useSelector((state:any) => state.sidebarVisibility)\r\n  const dispatch = useDispatch()\r\n\r\n  const onClickOutsideHandler = React.useCallback((event: MouseEvent | TouchEvent)=>{\r\n    const toggle = document.querySelector('[aria-label=\"Toggle navigation\"]')\r\n    if(!toggle?.contains(event.target as Node)){\r\n      dispatch({\r\n        type: \"CLOSE_SIDEBAR\"\r\n      })\r\n    }\r\n  }, [showSidebar])\r\n  \r\n  return <div className={\"position-relative d-flex flex-grow-1 bg-light\" + (showSidebar ? \" toggled\" : \"\")}  id=\"wrapper\">\r\n    <ClickOutsideHandler onClickOutside={onClickOutsideHandler}>\r\n      <Sidebar className=\"bg-white shadow-sm\" {...sidebar}/>\r\n    </ClickOutsideHandler>\r\n    <Container className=\"d-flex flex-column flex-grow-1\">\r\n      <div className=\"d-flex flex-column bg-white rounded-lg shadow-sm m-2 p-3 flex-grow-1\">\r\n        {children}\r\n      </div>\r\n    </Container>\r\n  </div>\r\n}\r\n\r\nexport default SidebarLayout","import apiClient from \"../../../../commons/services/apiClient\"\r\n\r\ntype Empleador = {\r\n  id: number,\r\n  numeroPatronal: string,\r\n  nombre: string\r\n}\r\n\r\nexport const EmpleadorService = {\r\n  buscarPorPatronal: (numeroPatronal: string) => {\r\n    return apiClient.get<Empleador>(\"empleadores/buscar-por-patronal\", {\r\n      params: {\r\n        numero_patronal: numeroPatronal\r\n      }\r\n    })\r\n  }\r\n}","import { apiClient, Page, PaginatedResponse} from \"../../../../commons/services\"\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type ListaMoraFilter = {\r\n  numeroPatronal?: string,\r\n  nombre?: string,\r\n  nit?: number,\r\n  regionalId?: number\r\n}\r\n\r\nexport type ListaMoraItem = {\r\n  id: number,\r\n  empleadorId: number,\r\n  numeroPatronal: string,\r\n  nombre: string\r\n}\r\n\r\nexport const ListaMoraService = {\r\n  buscar: (filter: ListaMoraFilter, page: Page)=>{\r\n    return apiClient.get<PaginatedResponse<ListaMoraItem>>(\"/lista-mora\", {\r\n      params: keysToUnderscore({\r\n        page, filter\r\n      })\r\n    })\r\n  },\r\n  agregar: (idEmpleador: number) =>{\r\n    return apiClient.post<ListaMoraItem>(\"lista-mora/agregar\", {\r\n      empleador_id: idEmpleador\r\n    })\r\n  },\r\n  quitar: (idEmpleador: number) =>{\r\n    console.log(idEmpleador)\r\n    return apiClient.post<ListaMoraItem>(\"lista-mora/quitar\", {\r\n      empleador_id: idEmpleador\r\n    })\r\n  }\r\n}","import { Button, Col, Form } from \"react-bootstrap\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { ListaMoraFilter as Filter } from \"../services\"\r\n\r\ntype Inputs = {\r\n  numeroPatronal: string\r\n  nombre: string\r\n}\r\n\r\ntype Props = {\r\n  onApply: (filter: Filter) => void\r\n}\r\n\r\nexport const ListaMoraFilterForm = (props: Props)=>{\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    reset\r\n  } = useForm<Inputs>()\r\n\r\n  return <Form onSubmit={handleSubmit((inputs)=>{\r\n    const filter: Filter = {}\r\n    if(inputs.nombre) filter.nombre = inputs.nombre\r\n    if(inputs.numeroPatronal) filter.numeroPatronal = inputs.numeroPatronal\r\n    props.onApply(filter)\r\n  })}>\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Nº Patronal</Form.Label>\r\n        <Form.Control {...register(\"numeroPatronal\")} />\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={8}>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control {...register(\"nombre\")} />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button type=\"submit\">Aplicar</Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Button variant=\"secondary\" onClick={()=>reset()}>Limpiar</Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import { Permisos } from \"../../../../commons/auth/constants\";\r\nimport { User } from \"../../../../commons/auth/hooks\";\r\n\r\nexport const ListaMoraPolicy = {\r\n  index: (user: User) => {\r\n    return user?.canAny([\r\n      Permisos.VER_LISTA_DE_MORA,\r\n      Permisos.VER_LISTA_DE_MORA_REGIONAL,\r\n      Permisos.AGREGAR_EMPLEADOR_EN_MORA,\r\n      Permisos.AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n  view: (user: User) => {\r\n    return user?.canAny([\r\n      Permisos.VER_LISTA_DE_MORA,\r\n      Permisos.VER_LISTA_DE_MORA_REGIONAL\r\n    ])\r\n  },\r\n  agregar: (user: User) => {\r\n    return user?.canAny([\r\n      Permisos.AGREGAR_EMPLEADOR_EN_MORA,\r\n      Permisos.AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n  quitar: (user: User) => {\r\n    return user?.canAny([\r\n      Permisos.QUITAR_EMPLEADOR_EN_MORA,\r\n      Permisos.QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n}","import { useEffect } from \"react\"\r\nimport { Dropdown } from \"react-bootstrap\"\r\nimport { useMutation, useQueryClient, QueryKey } from \"react-query\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { ListaMoraItem, ListaMoraService } from \"../services\"\r\nimport { ListaMoraPolicy } from \"../policies\"\r\n\r\ntype Props = {\r\n  item: ListaMoraItem\r\n  queryKey: QueryKey\r\n}\r\nexport const RowOptions = ({item, queryKey}: Props) => {\r\n\r\n  const modal = useModal(\"queryLoader\")\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const quitar = useMutation(()=>{\r\n    return ListaMoraService.quitar(item.empleadorId)\r\n  }, {\r\n    onSuccess: ()=>{\r\n      modal.close()\r\n      queryClient.setQueryData(queryKey, (oldData: any) => {\r\n        console.log(oldData)\r\n        return {\r\n          ...oldData,\r\n          data: {\r\n            ...oldData.data,\r\n            records: oldData.data.records.filter((i: any)=>{\r\n              return i !== item\r\n            })\r\n          }\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(quitar.status == \"loading\"){\r\n      modal.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n    else if(quitar.status == \"error\"){\r\n      console.log(quitar.error)\r\n      modal.open({\r\n        state: \"error\",\r\n        error: quitar.error\r\n      })\r\n    }\r\n  }, [quitar.status])\r\n\r\n  return <Dropdown>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-${item.id}`}\r\n    />\r\n    \r\n    <Dropdown.Menu>\r\n      <ProtectedContent\r\n        authorize={ListaMoraPolicy.quitar}\r\n      >\r\n        <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n          if (window.confirm(\"¿Está seguro?\")) {\r\n            quitar.mutate()\r\n          }\r\n        }}>Quitar</Dropdown.Item>\r\n      </ProtectedContent>\r\n    </Dropdown.Menu>\r\n  </Dropdown>  \r\n}","import { AxiosError } from \"axios\"\r\nimport { useEffect, useRef, useState } from \"react\"\r\nimport { Button, Col, Collapse, Form, Spinner, Table } from \"react-bootstrap\"\r\nimport { FaFilter, FaSync, FaPlus } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport {Pagination} from \"../../../../commons/components\"\r\nimport { useLoggedUser, ProtectedContent, Permisos } from \"../../../../commons/auth\"\r\nimport { ListaMoraService, ListaMoraFilter as Filter } from \"../services\"\r\nimport { ListaMoraFilterForm } from \"./ListaMoraFilterForm\"\r\nimport { RowOptions } from \"./RowOptions\"\r\nimport { ListaMoraPolicy } from \"../policies\"\r\n\r\nexport default () => {\r\n  const [page, setPage] = useState({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser();\r\n  \r\n  const getDefaultFilter = ()=>{\r\n    const filter: Filter = {}\r\n    if(!loggedUser?.can(Permisos.VER_LISTA_DE_MORA)){\r\n      if(loggedUser?.can(Permisos.VER_LISTA_DE_MORA_REGIONAL)){\r\n        filter.regionalId = loggedUser.regionalId;\r\n      }\r\n    }\r\n    return filter\r\n  }\r\n\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n\r\n  const [filterFormVisible, showFilterForm] = useState(false)\r\n\r\n  const queryKey = [\"listaMora.buscar\", filter, page]\r\n  const buscar = useQuery(queryKey, () => {\r\n    return ListaMoraService.buscar(filter, page)\r\n  }, {\r\n    enabled: ListaMoraPolicy.view(loggedUser),\r\n    // refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const total = buscar.data?.data?.meta?.total || 0\r\n\r\n  const renderRows = () => {\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    else if (buscar.isError) {\r\n      const { error } = buscar\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {(error as AxiosError).response?.data?.message || (error as AxiosError).message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if(buscar.data)\r\n    {\r\n      const records = buscar.data!.data.records\r\n      if(records.length == 0){\r\n        return  <tr>\r\n          <td className=\"bg-light text-center\" colSpan={100}>\r\n            No se encontraron resultados\r\n          </td>\r\n      </tr>\r\n      }\r\n      return records.map((item, index) => {\r\n        return <tr key={item.id}>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {index + 1}\r\n          </td>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {item.numeroPatronal}\r\n          </td>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {item.nombre}\r\n          </td>\r\n          <td>\r\n            <RowOptions item={item} queryKey={queryKey} />\r\n          </td>\r\n        </tr>\r\n      })\r\n    }    \r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h1 style={{ fontSize: \"1.75rem\" }}>Empleadores en mora</h1>\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\">\r\n        <ProtectedContent\r\n          authorize={ListaMoraPolicy.view}\r\n        >\r\n          <Col xs=\"auto\" >\r\n            <Button className=\"my-2\" onClick={() => {\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col xs=\"auto\" >\r\n            <Button className=\"my-2\" onClick={() => {\r\n              showFilterForm(visible => !visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={ListaMoraPolicy.agregar}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button as={Link}\r\n              to=\"/clinica/lista-mora/agregar\"\r\n              className=\"my-2\"\r\n            >\r\n              <FaPlus className=\"mr-1\" />\r\n              Agregar\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={ListaMoraPolicy.view}\r\n    >\r\n      <Collapse in={filterFormVisible}>\r\n        <div>\r\n          <ListaMoraFilterForm\r\n            onApply={(filter) => {\r\n              setFilter(filter)\r\n              setPage(page => ({...page, current: 1}))\r\n            }}\r\n          />\r\n        </div>\r\n      </Collapse>\r\n      <div className=\"d-flex\">\r\n        <div className=\"ml-auto mb-2\">\r\n          <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n            <span>Mostrar</span>\r\n            <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n              const value = e.target.value\r\n              setPage((page) => ({\r\n                ...page,\r\n                size: parseInt(value)\r\n              }))\r\n            }}>\r\n              <option value={10}>10</option>\r\n              <option value={20}>20</option>\r\n              <option value={30}>30</option>\r\n              <option value={50}>50</option>\r\n              <option value={100}>100</option>\r\n            </Form.Control>\r\n            <span>filas</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <Table responsive className=\"text-nowrap\">\r\n        <thead>\r\n          <tr>\r\n            <th style={{ width: 1 }}>#</th>\r\n            <th style={{ width: 1 }}>Nº Patronal</th>\r\n            <th >Nombre</th>\r\n            <th style={{ width: 1 }}></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {renderRows()}\r\n        </tbody>\r\n      </Table>\r\n      {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n          <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n          <Pagination\r\n            current={page.current}\r\n            total={Math.ceil((total - page.size) / page.size) + 1}\r\n            onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n          />\r\n        </div> : null}\r\n    </ProtectedContent>\r\n  </div>\r\n}","import { AxiosError, AxiosResponse } from 'axios'\r\nimport { useEffect } from 'react'\r\nimport { Alert, Button, Col, Form, InputGroup, Spinner } from 'react-bootstrap'\r\nimport { useForm } from 'react-hook-form'\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { FaSearch } from 'react-icons/fa'\r\nimport { useMutation, useQuery, useQueryClient } from 'react-query'\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { EmpleadorService, ListaMoraItem, ListaMoraService } from '../services'\r\n\r\ntype Inputs = {\r\n  numeroPatronal: string,\r\n  nombre: string\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  numeroPatronal: yup.string().label(\"número patronal\").trim().uppercase().required(),\r\n  nombre: yup.string().required()\r\n})\r\n\r\nexport default ()=>{\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    watch,\r\n    setError,\r\n    clearErrors,\r\n    setValue,\r\n    reset,\r\n    trigger,\r\n    formState\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      nombre: \"\",\r\n      numeroPatronal: \"\"\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n  \r\n  console.log(\"Vlues\", watch(), formErrors)\r\n\r\n  const history = useHistory()\r\n\r\n  const queryClient = useQueryClient()\r\n  \r\n  const onBuscarEmpleadorSuccess = ({data}: any) => {\r\n    console.log(\"Nombre\",data.nombre)\r\n    setValue(\"nombre\", data.nombre)\r\n  }\r\n  const numeroPatronal = watch(\"numeroPatronal\")\r\n  const buscarEmpleador = useQuery([\"buscarEmpleadorPorPatronal\", numeroPatronal], ()=>{\r\n    return EmpleadorService.buscarPorPatronal(numeroPatronal)\r\n  }, {\r\n    enabled: false,\r\n    onSuccess: onBuscarEmpleadorSuccess\r\n  })\r\n\r\n  const guardar = useMutation((empleadorId: number)=>{\r\n    return ListaMoraService.agregar(empleadorId)\r\n  }, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"listaMora.buscar\")\r\n      history.replace(\"/clinica/lista-mora\")\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscarEmpleador.isError){\r\n      const error = buscarEmpleador.error as AxiosError\r\n      setError(\"numeroPatronal\", {\r\n        type: \"searchError\",\r\n        message: error.response?.status == 404 ? \"Empleador no encontrado\" : \"Ocurrio un error\"\r\n      })\r\n    }\r\n  }, [buscarEmpleador.isError])\r\n\r\n  const renderAlert = ()=>{\r\n    if(guardar.isSuccess){\r\n      return <Alert variant=\"success\">\r\n      La operacion se realizó exitosamente\r\n    </Alert>\r\n    }\r\n    if(guardar.isError){\r\n      const guardarError = guardar.error as AxiosError\r\n      return <Alert variant=\"danger\">\r\n        {guardarError.response?.data?.message || guardarError.message}\r\n      </Alert>\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <Form id=\"form-empleador-mora\"\r\n    onSubmit={handleSubmit(()=>{\r\n      guardar.mutate(buscarEmpleador.data!.data.id)\r\n    })}\r\n  >\r\n    <h1 style={{fontSize: \"1.75rem\"}}>Agregar empleador en mora</h1>\r\n    {renderAlert()}\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>\r\n          Nº Patronal\r\n        </Form.Label>\r\n        <InputGroup hasValidation className=\"mb-2\">\r\n          <Form.Control\r\n            isInvalid={!!formErrors.numeroPatronal}\r\n            className=\"text-uppercase\" {...register(\"numeroPatronal\")} />\r\n          <InputGroup.Append >\r\n            <Button variant={formErrors.numeroPatronal ? \"danger\" : \"outline-secondary\"} onClick={()=>{\r\n              trigger(\"numeroPatronal\")\r\n              .then((valid)=>{\r\n                if(!formErrors.numeroPatronal){\r\n                  clearErrors()\r\n                  if(!buscarEmpleador.data){\r\n                    buscarEmpleador.refetch()\r\n                  }\r\n                }\r\n              })\r\n            }}>\r\n              {buscarEmpleador.isFetching ? <Spinner animation=\"border\" size=\"sm\" /> : <FaSearch />}\r\n            </Button>\r\n          </InputGroup.Append>\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.numeroPatronal?.message}</Form.Control.Feedback>\r\n        </InputGroup>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n          <Form.Label>\r\n            Nombre\r\n          </Form.Label>\r\n          <Form.Control\r\n            readOnly\r\n            isInvalid={!!formState.errors.nombre}\r\n            {...register(\"nombre\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formState.errors.nombre?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Button type=\"subimt\">\r\n      {guardar.isLoading ? <Spinner className=\"mr-2\" animation=\"border\" size=\"sm\" /> : null}\r\n      <span className=\"\"></span>Agregar\r\n    </Button>\r\n  </Form>\r\n}","import { GenIcon, IconBaseProps } from \"react-icons/lib\";\r\n\r\nexport const FcDebt = function FcDebt (props: IconBaseProps) {\r\n  //@ts-ignore\r\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"version\":\"1\",\"viewBox\":\"0 0 48 48\",\"enableBackground\":\"new 0 0 48 48\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M10,12c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5S12.8,12,10,12z\"}},{\"tag\":\"path\",\"attr\":{\"d\":\"M2,22v8l3,2l1,14h8l1-14l3-2v-8c0-4.4-3.6-8-8-8h0C5.6,14,2,17.6,2,22z\"}},{\"tag\":\"g\",\"attr\":{},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M22.4,40.4c-0.6,2.5-1,3.6-2.4,3.6c-0.6,0-1.2-0.5-1.9-1.1c-1-0.8-2.2-1.9-4.1-1.9v2c1.1,0,1.9,0.7,2.8,1.4 c0.9,0.7,1.9,1.6,3.2,1.6c3.1,0,3.8-2.9,4.4-5.2C25,38.2,25.4,37,27,37v-2C23.7,35,22.9,38.1,22.4,40.4z\"}},{\"tag\":\"polygon\",\"attr\":{\"points\":\"14.4,40 10,40 10,44 14.1,44\"}}]},\r\n    //@ts-ignore\r\n    {\"tag\":\"circle\",\"attr\":{\"cx\":\"36\",\"cy\":\"36\",\"r\":\"10\"}},\r\n    //@ts-ignore\r\n    {\"tag\":\"path\",\"attr\":{\"fill\":\"#fff\",\"d\":\"M35,34c0.1,0.2,0.1,0.3,0.3,0.4c0.1,0.1,0.3,0.2,0.5,0.4c0.2,0.1,0.5,0.2,0.8,0.3c0.5,0.2,0.9,0.4,1.3,0.6 c0.4,0.2,0.7,0.4,1,0.7c0.3,0.3,0.5,0.6,0.7,0.9c0.2,0.4,0.2,0.8,0.2,1.3c0,0.4-0.1,0.8-0.2,1.2c-0.1,0.4-0.3,0.7-0.6,0.9 c-0.3,0.3-0.6,0.5-0.9,0.6c-0.4,0.2-0.8,0.3-1.2,0.3v1.5h-1.2v-1.5c-0.4,0-0.8-0.1-1.2-0.3c-0.4-0.2-0.7-0.4-1-0.6 c-0.3-0.3-0.5-0.6-0.7-1.1c-0.2-0.4-0.3-0.9-0.3-1.5h2.2c0,0.4,0,0.7,0.1,0.9c0.1,0.2,0.2,0.4,0.4,0.6c0.2,0.1,0.3,0.2,0.5,0.3 c0.2,0.1,0.4,0.1,0.6,0.1c0.2,0,0.4,0,0.6-0.1c0.2-0.1,0.3-0.2,0.4-0.3c0.1-0.1,0.2-0.3,0.3-0.4c0.1-0.2,0.1-0.3,0.1-0.5 c0-0.2,0-0.4-0.1-0.6c-0.1-0.2-0.1-0.3-0.3-0.4c-0.1-0.1-0.3-0.3-0.5-0.4c-0.2-0.1-0.4-0.2-0.7-0.3c-0.5-0.2-0.9-0.4-1.3-0.6 c-0.4-0.2-0.7-0.4-1-0.7c-0.3-0.3-0.5-0.6-0.7-0.9c-0.2-0.4-0.2-0.8-0.2-1.3c0-0.4,0.1-0.8,0.2-1.2c0.1-0.3,0.3-0.7,0.6-0.9 c0.3-0.3,0.6-0.5,0.9-0.6c0.4-0.2,0.8-0.3,1.2-0.3v-1.6h1.2v1.6c0.4,0.1,0.8,0.2,1.2,0.4c0.4,0.2,0.6,0.4,0.9,0.7 c0.2,0.3,0.4,0.6,0.6,1c0.1,0.4,0.2,0.9,0.2,1.4h-2.2c0-0.6-0.1-1-0.4-1.3c-0.2-0.3-0.6-0.4-1-0.4c-0.2,0-0.4,0-0.6,0.1 c-0.2,0.1-0.3,0.2-0.4,0.3C35.1,32.7,35,32.8,35,33s-0.1,0.3-0.1,0.5C34.9,33.7,34.9,33.9,35,34z\"}}\r\n    // //@ts-ignore\r\n    // {\"tag\":\"path\",\"attr\":{\"d\":\"M34.36918731037488,32.43804760584102 c0.2049905379011744,-0.1362195187343288 0.4575917813793953,-0.25921384147503324 0.7498686128384906,-0.353112733029765 v2.2456382797173764 a3.04840767653036,3.04840767653036 0 0 1 -0.7498686128384906,-0.353112733029765 C33.88911269580633,33.657410676453175 33.79653632385097,33.358521246997256 33.79653632385097,33.207754012669945 c0,-0.1507672343273157 0.09257637195536918,-0.449656663783222 0.5726509865239253,-0.7697064068289254 zM37.764095121938205,39.620651549978284 v-2.2456382797173764 c0.2909543118597318,0.09389889155473126 0.5448780749373151,0.21689321429543612 0.7498686128384906,0.353112733029765 c0.4813971341679188,0.3213722626450675 0.5726509865239253,0.6189391725016105 0.5726509865239253,0.7697064068289254 c0,0.1507672343273157 -0.09257637195536918,0.449656663783222 -0.5726509865239253,0.7697064068289254 a3.04840767653036,3.04840767653036 0 0 1 -0.7498686128384906,0.353112733029765 z\"}},\r\n    // //@ts-ignore\r\n    // {\"tag\":\"path\",\"attr\":{\"fill-rule\":\"evenodd\", \"clip-rule\": \"evenodd\",\"d\":\"M36.456693151701,46.34645688299114 a10.519685476315033,10.519685476315033 0 1 0 0,-21.039370952630065 a10.519685476315033,10.519685476315033 0 0 0 0,21.039370952630065 zm1.314960684539379,-17.094488899011928 a1.314960684539379,1.314960684539379 0 1 0 -2.629921369078758,0 v0.120976382977623 a5.963346704386084,5.963346704386084 0 0 0 -2.203874107288,0.8705039731650693 C31.988456745636196,30.874629468700803 31.196850413543487,31.89372399921882 31.196850413543487,33.19685003759734 c0,1.3018110776939853 0.7916063320927069,2.320905608212004 1.741007946330138,2.9534016974754462 c0.6311811285789025,0.4207874190526019 1.385968561504506,0.7166535730739616 2.203874107288,0.8705039731650693 v2.5523386886909347 c-0.5141496276548978,-0.16700000693650122 -0.8941732654867787,-0.4168425369989835 -1.108511857066697,-0.662740185007847 a1.314960684539379,1.314960684539379 0 1 0 -1.9855906336544624,1.7225984967465875 c0.7390079047111311,0.8534094842660581 1.8580394472541435,1.414897696564372 3.094102490721159,1.6476457377278424 V42.401574829373004 a1.314960684539379,1.314960684539379 0 1 0 2.629921369078758,0 v-0.120976382977623 a5.963346704386084,5.963346704386084 0 0 0 2.203874107288,-0.8705039731650693 C40.92492955776581,40.77891334465141 41.71653588985852,39.75981881413339 41.71653588985852,38.45669277575487 c0,-1.3018110776939853 -0.7916063320927069,-2.320905608212004 -1.741007946330138,-2.9534016974754462 A5.963346704386084,5.963346704386084 0 0 0 37.77165383624038,34.63278710511435 V32.08044841642341 c0.5141496276548978,0.16700000693650122 0.8941732654867787,0.4168425369989835 1.108511857066697,0.662740185007847 a1.314960684539379,1.314960684539379 0 1 0 1.9869055943390022,-1.7225984967465875 c-0.7403228653956706,-0.8534094842660581 -1.8580394472541435,-1.414897696564372 -3.0954174514056985,-1.6476457377278424 V29.25196798397921 z\"}}\r\n  ]})(props);\r\n}","import { apiClient, PaginatedResponse, Page } from \"../../../../commons/services\"\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type SolicitudesAtencionExternaFilter = {\r\n  numero?: number\r\n  desde?: string\r\n  hasta?: string\r\n  numeroPatronal?: string\r\n  matriculaAsegurado?: string\r\n  medicoId?: number\r\n  proveedorId?: number\r\n  regionalId?: number\r\n  registradoPor?: number\r\n}\r\n\r\nexport type SolicitudAtencionExterna = {\r\n  id: number,\r\n  numero: number,\r\n  fecha: string,\r\n  asegurado: {\r\n    matricula: string\r\n  },\r\n  medico: string,\r\n  proveedor: string,\r\n  urlDm11: string\r\n}\r\n\r\nexport const SolicitudesAtencionExternaService = {\r\n  buscar: (filter: SolicitudesAtencionExternaFilter, page: Page)=>{\r\n    return apiClient.get<PaginatedResponse<SolicitudAtencionExterna>>(\"solicitudes-atencion-externa\", {\r\n      params: keysToUnderscore({filter, page})\r\n    })\r\n  },\r\n  generarDm11: (solicitud_id: number) => {\r\n    return apiClient.put<{url: string}>(`solicitudes-atencion-externa/${solicitud_id}/generar-dm11`)\r\n  },\r\n  registrar: (regional_id: number, asegurado_id: string, medico_id: number, proveedor_id: number, prestaciones_solicitadas: {prestacion_id: number, nota: string}[]) => {\r\n    return apiClient.post(\"solicitudes-atencion-externa\", {\r\n      regional_id,\r\n      asegurado_id,\r\n      medico_id,\r\n      proveedor_id,\r\n      prestaciones_solicitadas\r\n    })\r\n  }\r\n}","import { AxiosTransformer } from \"axios\"\r\nimport { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\n\r\n// export type Titular = {\r\n//   id: string,\r\n//   matricula: string,\r\n//   apellidoPaterno: string | null,\r\n//   apellidoMaterno: string,\r\n//   nombres: string,\r\n//   estado: string,\r\n//   fechaBaja?: string,\r\n//   fechaExtinsion?: string,\r\n//   empleador: {\r\n//     id: number,\r\n//     numeroPatronal: string,\r\n//     nombre: string,\r\n//     estado: string,\r\n//     aportes: string\r\n//   }\r\n// }\r\n\r\n// type Beneficiario = Titular & {\r\n//   fechaExtinsion?: string\r\n// }\r\n\r\ninterface Afiliacion {\r\n  id: string\r\n  baja: {\r\n    regDate: string,\r\n    fechaValidezSeguro: string\r\n  } | null\r\n}\r\n\r\ninterface AfiliacionBeneficiario extends Afiliacion  {\r\n  parentesco: number\r\n  idAfiliacionTitular: string\r\n  fechaExtincion: string | null\r\n}\r\n\r\ninterface Afiliado {\r\n  id: string\r\n  matricula: string\r\n  matriculaComplemento: string\r\n  apellidoPaterno: string | null\r\n  apellidoMaterno: string | null\r\n  nombres: string\r\n  nombreCompleto: string\r\n  estado: number\r\n  estadoText: string\r\n  tipo: number\r\n  empleador: {\r\n    id: number\r\n    numeroPatronal: string\r\n    nombre: string\r\n    estado: number\r\n    estadoText: string\r\n    fechaBaja: string\r\n    enMora: boolean\r\n  }\r\n}\r\n\r\nexport interface Titular extends Afiliado {\r\n  tipo: 1\r\n  afiliacion: Afiliacion\r\n}\r\n\r\nexport interface Beneficiario extends Afiliado {\r\n  tipo: 2\r\n  titular: Titular\r\n  afiliacion: AfiliacionBeneficiario\r\n}\r\n\r\nexport type Asegurado = Titular | Beneficiario\r\n\r\n// export type Asegurado = {\r\n//   id: string,\r\n//   matricula: string,\r\n//   matriculaComplemento: string,\r\n//   apellidoPaterno: string | null,\r\n//   apellidoMaterno: string,\r\n//   nombres: string,\r\n//   tipo_id: number,\r\n//   estado: number,\r\n//   baja: {\r\n//     regDate: string,\r\n//     fechaValidezSeguro: string\r\n//   },\r\n//   fechaExtinsion?: string\r\n//   titularId: string\r\n//   empleador: {\r\n//     id: number,\r\n//     numeroPatronal: string,\r\n//     nombre: string,\r\n//     estado: string,\r\n//     fechaBaja: string,\r\n//     aportes: string\r\n//   }\r\n//   titular?: {\r\n//     id: string,\r\n//     matricula: string,\r\n//     apellidoPaterno: string | null,\r\n//     apellidoMaterno: string | null,\r\n//     nombres: string,\r\n//     estado: string,\r\n//     baja: {\r\n//       regDate: string,\r\n//       fechaValidezSeguro: string\r\n//     },\r\n//   }\r\n// }\r\n\r\nexport const AseguradosService = {\r\n  buscarPorMatricula: (matricula: string) =>{\r\n    return apiClient.get<PaginatedResponse<Asegurado>>(\"asegurados\", {\r\n      params: {\r\n        filter: {\r\n          matricula\r\n        },\r\n        page: {\r\n          size: 10\r\n        },\r\n        include: \"empleador,titular\"\r\n      },\r\n      // transformResponse: [...apiClient.defaults.transformResponse as AxiosTransformer[], (response:any)=>{\r\n      //   console.log(response)\r\n      //   return response\r\n      // }]\r\n    })\r\n  }\r\n}","import { apiClient, PaginatedResponse, Page } from \"../../../../commons/services\"\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type Medico = {\r\n  id: number,\r\n  tipo: number\r\n  ci: {\r\n    raiz: number,\r\n    complemento: string,\r\n  },\r\n  ciText: string,\r\n  apellidoPaterno: string,\r\n  apellidoMaterno: string,\r\n  nombres: string,\r\n  nombreCompleto: string,\r\n  sexo: string,\r\n  especialidadId: number\r\n  especialidad: string\r\n  estado: number\r\n  estadoText: string\r\n  regionalId: number\r\n  regional: string\r\n}\r\n\r\nexport type MedicoFilter = {\r\n  ci?: string,\r\n  ciComplemento?: string\r\n  nombre?: string,\r\n  especialidadId?: number\r\n  regionalId?: number\r\n  estado?: number\r\n  tipo?: number\r\n}\r\n\r\nexport const MedicosService = {\r\n  buscar: (filter?: MedicoFilter, page?: Page) => {\r\n    return apiClient.get<PaginatedResponse<Medico> | Medico[]>(\"medicos\", {\r\n      params: keysToUnderscore({\r\n        filter,\r\n        page\r\n      })\r\n    })\r\n  },\r\n  load: (id: number) => {\r\n    return apiClient.get<Medico>(`medicos/${id!}`);\r\n  },\r\n  registrar: (tipo: number,\r\n    ci: {\r\n      raiz: number,\r\n      complemento: string,\r\n    }, apellido_paterno: string, apellido_materno: string, nombres: string, especialidad_id: number, regional_id: number) => {\r\n    return apiClient.post<Medico>(\"medicos\", {\r\n      tipo,\r\n      ci: ci.raiz,\r\n      ci_complemento: ci.complemento,\r\n      apellido_paterno,\r\n      apellido_materno,\r\n      nombres,\r\n      especialidad_id,\r\n      regional_id\r\n    })\r\n  },\r\n  actualizar: (id: number, tipo: number,\r\n    ci: {\r\n      raiz: number,\r\n      complemento: string,\r\n    }, apellido_paterno: string, apellido_materno: string, nombres: string, especialidad_id: number, regional_id: number) => {\r\n    return apiClient.put<Medico>(`medicos/${id}`, {\r\n      tipo,\r\n      ci: ci.raiz,\r\n      ci_complemento: ci.complemento,\r\n      apellido_paterno,\r\n      apellido_materno,\r\n      nombres,\r\n      especialidad_id,\r\n      regional_id\r\n    })\r\n  },\r\n  cambiarEstado: (id: number, estado: number) => {\r\n    return apiClient.put(`medicos/${id}/cambiar-estado`, {\r\n      estado\r\n    })\r\n  }\r\n}","import { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\nimport axios, { AxiosPromise } from 'axios'\r\nimport { Medico } from \"../../medicos/services\"\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type Empresa = {\r\n  id: number,\r\n  nombre: string\r\n}\r\n\r\nexport type Proveedor = {\r\n  id: number\r\n  tipoId: number\r\n  tipo: string  \r\n  nit: number | null\r\n\r\n  nombre: string | null\r\n\r\n  ci: number,\r\n  ciComplemento: string,\r\n  ciText: string,\r\n  apellidoPaterno: string,\r\n  apellidoMaterno: string,\r\n  nombres: string,\r\n  nombreCompleto: string,\r\n  \r\n  regionalId: number\r\n  regional: {\r\n    id: number\r\n    nombre: string\r\n  }\r\n  sexo: string,\r\n  especialidadId: number,\r\n  especialidad: {\r\n    id: number,\r\n    nombre: string\r\n  }\r\n\r\n  municipioId: number\r\n  municipio: { \r\n    id: number\r\n    nombre: string\r\n    provincia: { \r\n      id: number\r\n      nombre: string\r\n      departamento: { \r\n        id: number\r\n        nombre: string\r\n      }\r\n    }\r\n  }\r\n  direccion: string\r\n  ubicacion: {\r\n    latitud: number,\r\n    longitud: number\r\n  }\r\n  telefono1: number\r\n  telefono2: number | null\r\n\r\n  contrato: {\r\n    inicio: string\r\n    fin: string\r\n    extension: string\r\n    estadoText: string\r\n    prestaciones: {\r\n      id: number\r\n      nombre: string\r\n    }[]\r\n  }\r\n}\r\n\r\nexport type Contrato = {\r\n  inicio: string\r\n  fin: string\r\n  extension: string\r\n  estadoText: string\r\n  prestaciones: {\r\n    id: number\r\n    nombre: string\r\n  }[]  \r\n}\r\n\r\nexport type Filter = {\r\n  tipos?: number[]\r\n  nombre?: string\r\n  regionalId?: number\r\n  activos?: number\r\n  prestacionesId?: number[]\r\n}\r\n\r\n\r\nclass ProveedorService {\r\n  buscar(filter: Filter): AxiosPromise<Proveedor[]>;\r\n  buscar(filter: Filter, page: Page): AxiosPromise<PaginatedResponse<Proveedor>>;\r\n  buscar(filter: Filter, page?: Page) {\r\n    return apiClient.get(\"proveedores\", {\r\n      params: keysToUnderscore({\r\n        filter,\r\n        page\r\n      })\r\n    })\r\n  }\r\n  cargar(id: number): AxiosPromise<Proveedor>{\r\n    return apiClient.get(`proveedores/${id}`)\r\n  }\r\n  registrar(fields: {\r\n    general: {\r\n      tipoId: 1,\r\n      nit?: number,\r\n      ci: number,\r\n      ciComplemento?: string\r\n      apellidoPaterno?: string\r\n      apellidoMaterno?: string\r\n      nombres: string\r\n      especialidadId: number\r\n    } | {\r\n      tipoId: 2,\r\n      nit?: number,\r\n      nombre: string,\r\n    },\r\n    contacto?: {\r\n      municipioId: number,\r\n      direccion: string,\r\n      ubicacion: {\r\n        latitud: number,\r\n        longitud: number\r\n      },\r\n      telefono1: number,\r\n      telefono2?: number\r\n    },\r\n    contrato: {\r\n      inicio: string,\r\n      fin: string,\r\n      prestacionIds: number[] \r\n    }\r\n  }): AxiosPromise<Proveedor> {\r\n    return apiClient.post(\"proveedores\", keysToUnderscore(fields))\r\n  }\r\n  actualizar(id: number, fields: {\r\n    tipoId: 1,\r\n    nit?: number,\r\n    ci: number,\r\n    ciComplemento?: string\r\n    apellidoPaterno?: string\r\n    apellidoMaterno?: string\r\n    nombres: string\r\n    especialidadId: number\r\n    regionalId: number\r\n  } | {\r\n    tipoId: 2,\r\n    nit?: number,\r\n    nombre: string,\r\n    regionalId: number\r\n  }): AxiosPromise<Proveedor>{\r\n    return apiClient.put(`proveedores/${id}`, keysToUnderscore(fields))\r\n  }\r\n  actualizarInformacionDeContacto(id: number, infoContacto: {\r\n    municipioId: number,\r\n    direccion: string,\r\n    ubicacion: {\r\n      latitud: number,\r\n      longitud: number\r\n    },\r\n    telefono1: number,\r\n    telefono2?: number\r\n  }): AxiosPromise<Proveedor>{\r\n    return apiClient.put(`proveedores/${id}/contacto`, keysToUnderscore(infoContacto))\r\n  }\r\n}\r\n\r\nexport const ProveedoresService = new ProveedorService()","import axios from \"axios\";\r\nimport { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\n\r\nexport type Prestacion = {\r\n  id: number,\r\n  nombre: string,\r\n}\r\n\r\nexport const PrestacionesService = {\r\n  registrar: (nombre: string) => {\r\n    return apiClient.post<Prestacion>(\"prestaciones\", {\r\n      nombre\r\n    })\r\n  },\r\n  buscarPorNombre: (nombre: string) => {\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source()\r\n  \r\n    const promise = apiClient.get<Prestacion[]>(\"/prestaciones/buscar-nombre\", {\r\n      params: {\r\n        nombre\r\n      }\r\n    })\r\n    //@ts-ignore\r\n    promise.cancel = () => {\r\n      source.cancel('Query was cancelled by React Query')\r\n    }\r\n    return promise\r\n  },\r\n  buscar: (filter: {nombre?: string}, page?: Page) => {\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source()\r\n  \r\n    const promise = apiClient.get<PaginatedResponse<Prestacion>|Prestacion[]>(\"prestaciones\", {\r\n      params: {\r\n        filter, page\r\n      }\r\n    })\r\n    //@ts-ignore\r\n    promise.cancel = () => {\r\n      source.cancel('Query was cancelled by React Query')\r\n    }\r\n    return promise\r\n  }\r\n}","\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { AxiosPromise, AxiosError } from \"axios\"\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\"\r\nimport { FaSync } from \"react-icons/fa\"\r\nimport { Typeahead, TypeaheadProps } from 'react-bootstrap-typeahead'\r\nimport { useQuery } from 'react-query'\r\nimport { Medico, MedicoFilter, MedicosService } from \"../services\"\r\nimport { isMatch } from \"../../../../commons/utils\"\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css'\r\n\r\nexport type { Medico }\r\n\r\ntype Props = {\r\n  feedback?: string,\r\n  filter?: MedicoFilter\r\n  onLoad?: (options: Medico[])=>void\r\n} & Omit<TypeaheadProps<Medico>, \"isLoading\" | \"options\">\r\n\r\nexport const MedicosTypeahead = ({isInvalid, feedback, filter, filterBy, ...props}: Props) => {\r\n  const queryKey = [\"medicos.buscar\", filter]\r\n\r\n  const buscar = useQuery(queryKey, ()=>{\r\n    return MedicosService.buscar(filter) as AxiosPromise<Medico[]>\r\n  }, {\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscar.data){\r\n      props.onLoad && props.onLoad(buscar.data?.data)\r\n    }\r\n  }, [buscar.data])\r\n  \r\n  const options = useMemo(()=>{\r\n    if(Array.isArray(buscar.data?.data)){\r\n        return buscar.data?.data!\r\n    }\r\n    else if(buscar.data?.data){\r\n        console.error(buscar.data?.data)\r\n    }\r\n    return []\r\n  }, [buscar.data?.data])\r\n\r\n  return <InputGroup hasValidation>\r\n    <Typeahead\r\n      clearButton\r\n      emptyLabel=\"No se encontraron resultados\"\r\n      align=\"left\"\r\n      {...props}\r\n      disabled={!buscar.data}\r\n      className={(buscar.isError || isInvalid) ? \"is-invalid\" : \"\"}\r\n      isInvalid={buscar.isError || isInvalid}\r\n      filterBy={(medico, props)=>{\r\n        return (!props.text || isMatch(medico.nombreCompleto, props) || isMatch(medico.especialidad, props))\r\n          && (!filterBy || typeof filterBy === \"function\" && filterBy(medico, props))\r\n      }}\r\n      isLoading={!buscar.data}\r\n      options={options}\r\n      labelKey=\"nombreCompleto\"\r\n      minLength={0}\r\n      renderMenuItemChildren={(medico) => {\r\n        return <div>\r\n          <div>{medico.nombreCompleto}</div>\r\n          <div className={\"small text-secondary\"}>{medico.especialidad}</div> \r\n        </div>\r\n      }}\r\n    />\r\n    <InputGroup.Append>\r\n      <Button disabled={!buscar.data} variant={buscar.isError ? \"outline-danger\" : \"outline-secondary\"} onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n    </InputGroup.Append>\r\n    <Form.Control.Feedback type=\"invalid\">{\r\n      (buscar.error as AxiosError)?.response?.data?.message || (buscar.error as AxiosError)?.message\r\n      || feedback}</Form.Control.Feedback>\r\n  </InputGroup>\r\n}","\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\"\r\nimport { FaSync } from \"react-icons/fa\"\r\nimport { Typeahead, TypeaheadProps } from 'react-bootstrap-typeahead'\r\nimport { useQuery } from 'react-query'\r\nimport { AxiosError } from 'axios'\r\nimport { Proveedor, Filter as ProveedorFilter, ProveedoresService } from \"../services\"\r\nimport { isMatch } from \"../../../../commons/utils\"\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css'\r\n\r\nexport type { Proveedor }\r\n\r\ntype Props = {\r\n  feedback?: string,\r\n  filter?: ProveedorFilter\r\n  onLoad?: (options: Proveedor[])=>void\r\n} & Omit<TypeaheadProps<Proveedor>, \"isLoading\" | \"options\">\r\n\r\nexport const ProveedoresTypeahead = ({isInvalid, feedback, filter={}, filterBy, ...props}: Props) => {\r\n  const queryKey = [\"proveedores.buscar\", filter]\r\n\r\n  const buscar = useQuery(queryKey, ()=>{\r\n    return ProveedoresService.buscar(filter)\r\n  }, {\r\n    // refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscar.data){\r\n      props.onLoad && props.onLoad(buscar.data?.data)\r\n    }\r\n  }, [buscar.data])\r\n\r\n  const options = useMemo(()=>{\r\n    if(Array.isArray(buscar.data?.data)){\r\n        return buscar.data?.data!\r\n    }\r\n    else if(buscar.data?.data){\r\n        console.error(buscar.data?.data)\r\n    }\r\n    return []\r\n  }, [buscar.data?.data])\r\n\r\n  return <InputGroup hasValidation>\r\n    <Typeahead\r\n      clearButton\r\n      emptyLabel=\"No se encontraron resultados\"\r\n      align=\"left\"\r\n      {...props}\r\n      disabled={!buscar.data}\r\n      className={(buscar.isError || isInvalid) ? \"is-invalid\" : \"\"}\r\n      isInvalid={buscar.isError || isInvalid}\r\n      filterBy={(proveedor, props)=>{\r\n        return  (!props.text || (proveedor.nombre ? isMatch(proveedor.nombre, props) : isMatch(proveedor.nombreCompleto, props)))\r\n          && (!filterBy || (typeof filterBy === \"function\" && filterBy(proveedor, props)))\r\n      }}\r\n      isLoading={buscar.isFetching}\r\n      options={options}\r\n      labelKey={(proveedor: Proveedor)=>{\r\n        return proveedor.nombre || proveedor.nombreCompleto\r\n      }}\r\n      minLength={0}\r\n      renderMenuItemChildren={(proveedor) => {\r\n        return <div>\r\n          <div>{proveedor.nombre || proveedor.nombreCompleto}</div>\r\n          <div className={\"small text-secondary\"}>{proveedor.especialidad?.nombre || \"Empresa\"}</div> \r\n        </div>\r\n      }}\r\n    />\r\n    <InputGroup.Append>\r\n      <Button disabled={buscar.isFetching} variant={buscar.isError ? \"outline-danger\" : \"outline-secondary\"} onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n    </InputGroup.Append>\r\n    <Form.Control.Feedback type=\"invalid\">{\r\n      (buscar.error as AxiosError)?.response?.data?.message || (buscar.error as AxiosError)?.message\r\n      || feedback}</Form.Control.Feedback>\r\n  </InputGroup>\r\n}","import React from \"react\"\r\nimport { Button, Col, Form } from 'react-bootstrap'\r\nimport { useForm, Controller }  from 'react-hook-form'\r\nimport { SolicitudesAtencionExternaFilter } from \"../services/SolicitudesAtencionExternaService\"\r\nimport { Medico, MedicosTypeahead } from \"./MedicosTypeahead\"\r\nimport { Proveedor, ProveedoresTypeahead } from \"./ProveedoresTypeahead\"\r\n\r\ntype Inputs = {\r\n  numero: string\r\n  desde: string\r\n  hasta: string\r\n  numeroPatronal: string,\r\n  matricula: string,\r\n  medico: Medico[]\r\n  proveedor: Proveedor[]\r\n}\r\n\r\ntype Props = {\r\n  onFilter: (filter: SolicitudesAtencionExternaFilter)=>void\r\n}\r\nexport const SolicitudAtencionExternaFilterForm = (props: Props)=>{\r\n  const {\r\n    control,\r\n    formState,\r\n    handleSubmit,\r\n    register,\r\n    reset\r\n  } = useForm<Inputs>({\r\n    defaultValues: {\r\n      medico: [],\r\n      proveedor: []\r\n    }\r\n  })\r\n  console.log(formState)\r\n  return <Form className={\"mb-2\"} onSubmit={handleSubmit((input)=>{\r\n    const filter: SolicitudesAtencionExternaFilter = {}\r\n    console.log(input)\r\n    props.onFilter({\r\n      numero: parseInt(input.numero),\r\n      numeroPatronal: input.numeroPatronal,\r\n      matriculaAsegurado: input.matricula,\r\n      desde: input.desde,\r\n      hasta: input.hasta,\r\n      medicoId: input.medico.length && input.medico[0].id,\r\n      proveedorId: input.proveedor.length && input.proveedor[0].id\r\n    })\r\n  })}>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Número de solicitud</Form.Label>\r\n        <Form.Control {...register(\"numero\")}/>\r\n      </Form.Group>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Nº Patronal</Form.Label>\r\n        <Form.Control {...register(\"numeroPatronal\")} />\r\n      </Form.Group>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Matricula</Form.Label>\r\n        <Form.Control {...register(\"matricula\")} />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Médico</Form.Label>\r\n        <Controller\r\n          control={control}\r\n          name=\"medico\"\r\n          render={({field})=>{\r\n            return <MedicosTypeahead\r\n              id=\"solicitud-atencion-externa-filter/medicos\"\r\n              selected={field.value}\r\n              onBlur={field.onBlur}\r\n              onChange={field.onChange}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Proveedor</Form.Label>\r\n        <Controller\r\n          control={control}\r\n          name=\"proveedor\"\r\n          render={({field})=>{\r\n            return <ProveedoresTypeahead\r\n              id=\"solicitud-atencion-externa-filter/proveedores\"\r\n              selected={field.value}\r\n              onBlur={field.onBlur}\r\n              onChange={field.onChange}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n          <Form.Label>Desde</Form.Label>\r\n          <Form.Control\r\n            type=\"date\"\r\n            {...register(\"desde\")}\r\n          />\r\n        </Form.Group>\r\n        <Form.Group as={Col} sm={4}>\r\n          <Form.Label>Hasta</Form.Label>\r\n          <Form.Control\r\n            type=\"date\"\r\n            {...register(\"hasta\")}\r\n          />\r\n        </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button type=\"submit\">Aplicar</Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Button variant=\"secondary\" onClick={()=>reset()}>Limpiar</Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import { useEffect, useState } from \"react\"\r\nimport { Alert, Modal as BSModal, Spinner } from \"react-bootstrap\"\r\nimport { PDFViewer } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\n\r\nexport const Dm11Viewer = ()=>{\r\n  //@ts-ignore\r\n  const modal = useModal(\"dm11Viewer\")\r\n\r\n  return <BSModal centered show={modal.show} size=\"lg\" onHide={()=>{\r\n    modal.close()\r\n  }}>\r\n    <BSModal.Header>\r\n      D.M. - 11\r\n    </BSModal.Header>\r\n    <BSModal.Body>\r\n      {modal.url ? <PDFViewer url={modal.url}/> : null}\r\n    </BSModal.Body>\r\n  </BSModal>\r\n}","import { Dropdown } from \"react-bootstrap\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { SolicitudATPolicy } from \"../policies\"\r\nimport { SolicitudAtencionExterna } from \"../services\"\r\n\r\ntype Props = {\r\n  solicitud: SolicitudAtencionExterna\r\n}\r\nexport const RowOptions = ({solicitud}: Props) => {\r\n\r\n  const modal = useModal(\"dm11Viewer\")\r\n\r\n  return   <Dropdown style={{position: \"initial\"}}>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-solicitud-${solicitud.id}`}\r\n    />\r\n    <Dropdown.Menu >\r\n      <Dropdown.Item href=\"#\" onClick={() => {\r\n        modal.open({\r\n          url: solicitud.urlDm11\r\n        })\r\n      }}>Ver D.M. - 11</Dropdown.Item>\r\n    </Dropdown.Menu>\r\n  </Dropdown>\r\n}","import { Permisos, User } from \"../../../../commons/auth\";\r\n\r\nexport const SolicitudATPolicy = {\r\n  index: function(user: User){\r\n    return user?.canAny([\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR,\r\n      Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n  register: function(user: User){\r\n    return user?.canAny([\r\n      Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL\r\n    ])\r\n  },\r\n  view: function(user: User){\r\n    return user?.canAny([\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR,\r\n    ])\r\n  },\r\n  emit: function(user: User){\r\n    return user?.canAny([\r\n      Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,\r\n      Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR\r\n    ])\r\n  }\r\n}","import { useState} from \"react\"\r\nimport { AxiosError } from \"axios\"\r\nimport { Button, Col, Collapse, Form, Spinner, Table } from \"react-bootstrap\"\r\nimport {FaFilter, FaPlus, FaSync} from \"react-icons/fa\"\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport { useQuery } from \"react-query\"\r\nimport { Pagination } from \"../../../../commons/components\"\r\nimport { Page } from \"../../../../commons/services/Page\"\r\nimport { SolicitudesAtencionExternaFilter as Filter, SolicitudesAtencionExternaService } from \"../services/SolicitudesAtencionExternaService\"\r\nimport { SolicitudAtencionExternaFilterForm } from \"./SolicitudAtencionExternaFilterForm\"\r\nimport { Dm11Viewer } from \"./Dm11Viewer\"\r\nimport { Permisos } from \"../../../../commons/auth/constants\"\r\nimport { useLoggedUser } from \"../../../../commons/auth/hooks\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components/ProtectedContent\"\r\nimport { RowOptions } from \"./RowOptions\"\r\nimport { SolicitudATPolicy } from \"../policies\"\r\n\r\nexport const SolicitudAtencionExternaIndex = ()=>{\r\n  const {pathname: path} = useLocation()\r\n  const [total, setTotal] = useState(0)\r\n  const [page, setPage] = useState<Page>({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser();\r\n\r\n  const [filterFormVisible, showFilterForm] = useState(false)\r\n\r\n  const getDefaultFilter = ()=>{\r\n    const filter: Filter = {}\r\n    if(!loggedUser?.can(Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA)){\r\n      if(loggedUser?.can(Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL)){\r\n        filter.regionalId = loggedUser.regionalId;\r\n      }\r\n      if(loggedUser?.can(Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR)){\r\n        filter.registradoPor = loggedUser.id;\r\n      }\r\n    }\r\n    return filter\r\n  }\r\n\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n\r\n  const buscar = useQuery([\"solicitudesAtencionExterna.buscar\", page, filter], ()=>{\r\n    console.log({...filter, ...getDefaultFilter()})\r\n    return SolicitudesAtencionExternaService.buscar({...filter, ...getDefaultFilter()}, page)\r\n  }, {\r\n    enabled: loggedUser?.canAny([\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,\r\n      Permisos.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR,\r\n    ]),\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: ({data: {meta}}) => {\r\n      setTotal(meta.total)\r\n    }\r\n  })\r\n\r\n  const renderRows = ()=>{\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.isError) {\r\n      const { error } = buscar\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {(error as AxiosError).response?.data?.message || (error as AxiosError).message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.data){\r\n      const records = buscar.data!.data.records\r\n      if(records.length === 0){\r\n        return  <tr>\r\n          <td className=\"bg-light text-center\" colSpan={100}>\r\n            No se encontraron resultados\r\n          </td>\r\n      </tr>\r\n      }\r\n      return records.map((solicitud, index)=>{\r\n        return <tr key={solicitud.id}>\r\n          <td>{index + 1}</td>\r\n          <td>{solicitud.numero}</td>\r\n          <td>{solicitud.fecha}</td>\r\n          <td>{solicitud.asegurado.matricula}</td>\r\n          <td>{solicitud.medico}</td>\r\n          <td>{solicitud.proveedor}</td>\r\n          <td>\r\n            <RowOptions solicitud={solicitud} />\r\n          </td>\r\n        </tr>\r\n      })\r\n    }\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h1 style={{fontSize: \"1.75rem\"}}>Solicitudes de atención externa</h1>\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\" >\r\n        <ProtectedContent\r\n          authorize={SolicitudATPolicy.view}\r\n        >\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              showFilterForm(visible=>!visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={SolicitudATPolicy.register}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button\r\n              as={Link}\r\n              to={`${path}/registrar`}\r\n              className=\"d-flex align-items-center\">\r\n                <FaPlus className=\"mr-1\" /><span>Nuevo</span>\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={SolicitudATPolicy.view}\r\n    >\r\n      <Form.Row className=\"mb-2\">\r\n        <Col xs={12}>\r\n          <Collapse in={filterFormVisible}>\r\n            <div>\r\n              <SolicitudAtencionExternaFilterForm onFilter={(filter)=>{\r\n                setFilter(filter)\r\n                setPage(page=>({ ...page, current: 1 }))\r\n              }} />\r\n            </div>\r\n          </Collapse>\r\n        </Col>\r\n        <Col className=\"ml-auto\" xs={\"auto\"}>\r\n          <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n              <span>Mostrar</span>\r\n              <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n                const value = e.target.value\r\n                setPage((page) => ({\r\n                  ...page,\r\n                  size: parseInt(value)\r\n                }))\r\n              }}>\r\n                <option value={10}>10</option>\r\n                <option value={20}>20</option>\r\n                <option value={30}>30</option>\r\n                <option value={50}>50</option>\r\n                <option value={100}>100</option>\r\n              </Form.Control>\r\n              <span>filas</span>\r\n          </div>\r\n        </Col>\r\n      </Form.Row>\r\n      <Table responsive>\r\n        <thead>\r\n          <tr>\r\n            <th style={{width: 1}}>#</th>\r\n            <th>Nº</th>\r\n            <th>Fecha y hora</th>\r\n            <th>Matrícula asegurado</th>\r\n            <th>Doctor</th>\r\n            <th>Proveedor</th>\r\n            <th style={{width: 1}}></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {renderRows()}\r\n        </tbody>\r\n      </Table>\r\n      {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    </ProtectedContent>\r\n    <Dm11Viewer />\r\n  </div>\r\n}","import React, { forwardRef, useImperativeHandle, useRef, useCallback } from \"react\"\r\nimport { Button, Modal, ModalProps, Table } from \"react-bootstrap\"\r\nimport { Asegurado } from \"../services\"\r\n\r\ntype Props = Omit<ModalProps, \"children\"> & {\r\n  asegurados: Asegurado[]\r\n  onSelect: (asegurado: Asegurado) => void\r\n  title: string\r\n}\r\n\r\nexport const AseguradoChooser = (props: Props) => {\r\n  console.log(props.asegurados.length)\r\n  return <Modal {...props} >\r\n    <Modal.Header>\r\n      {props.title}\r\n    </Modal.Header>\r\n    <Modal.Body>\r\n      <Table responsive className=\"small\">\r\n        <thead>\r\n          <tr>\r\n            <th style={{width: 1}}>#</th>\r\n            <th>Matricula</th>\r\n            <th>Nombre completo</th>\r\n            <th>Estado</th>\r\n            <th></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {!!props.asegurados.length ? props.asegurados.map((asegurado, index)=>{\r\n            return <tr key={asegurado.id}>\r\n              <th scope=\"row\">{index+1}</th>\r\n              <td>{asegurado.matricula}-{asegurado.matriculaComplemento}</td>\r\n              <td>{asegurado.nombreCompleto}</td>\r\n              <td className={asegurado.estadoText ? \"\" : \"bg-ligth\"}>{asegurado.estadoText || \"Desconocido\"}</td>\r\n              <td><Button onClick={()=>{\r\n                console.log(asegurado)\r\n                props.onSelect(asegurado)\r\n              }}\r\n              >Seleccionar</Button></td>\r\n            </tr>\r\n          }) : <tr><td className=\"bg-light text-center\" colSpan={100}>No se encontraron resultados</td></tr>}\r\n        </tbody>\r\n      </Table>\r\n    </Modal.Body>\r\n  </Modal>\r\n}","import { useEffect, useState, useRef } from \"react\"\r\nimport { Accordion, Card, Form, Col, InputGroup, FormControl, Button, Spinner } from \"react-bootstrap\"\r\nimport { useFormContext } from \"react-hook-form\"\r\nimport { FaSearch } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { AseguradoChooser } from \"./AseguradoChooser\"\r\nimport { Asegurado, AseguradosService } from \"../services/AseguradosService\"\r\nimport moment from 'moment';\r\n\r\nexport type AseguradoInputs = {\r\n  regionalId: number\r\n  asegurado: {\r\n    matricula: string\r\n    apellidoPaterno: string\r\n    apellidoMaterno: string\r\n    nombres: string\r\n    parentesco: string\r\n    estado: string\r\n    fechaValidezSeguro: string\r\n    fechaExtincion: string\r\n  }\r\n  titular: {\r\n    matricula: string\r\n    apellidoPaterno: string\r\n    apellidoMaterno: string\r\n    nombres: string\r\n    estado: string\r\n    fechaValidezSeguro: string\r\n  }\r\n  empleador: {\r\n    numeroPatronal: string\r\n    nombre: string\r\n    estado: string\r\n    fechaBaja: string\r\n    enMora: string\r\n  }\r\n}\r\n\r\nexport const AseguradoCard = (props: {\r\n  value: Asegurado | null\r\n  onChange(asegurado: Asegurado | null): void\r\n}) => {\r\n\r\n  const {\r\n    register,\r\n    formState,\r\n    trigger,\r\n    setValue,\r\n    clearErrors,\r\n    control,\r\n    watch\r\n  } = useFormContext<AseguradoInputs>()\r\n\r\n  const [aseguradoChooserVisible, showAseguradoChooser] = useState(false)\r\n\r\n  const asegurado = props.value\r\n  const matricula = watch(\"asegurado.matricula\")\r\n  const buscar = useQuery([\"asegurados.buscar\", matricula], () => {\r\n    return AseguradosService.buscarPorMatricula(matricula)\r\n  }, {\r\n    enabled: false,\r\n    onSuccess: ({ data: { records } }) => {\r\n      if (records.length == 1) {\r\n        const asegurado = records[0]\r\n        console.log(\"Choosed\", asegurado)\r\n        props.onChange(asegurado)\r\n      }\r\n      else {\r\n        showAseguradoChooser(true)\r\n      }\r\n    }\r\n  })\r\n\r\n  const getParentesco = (code: number) => {\r\n    switch(code){\r\n      case 1: return \"Hijo(a)\"\r\n      case 2: return \"Esposa\"\r\n      case 3: return \"Conviviente\"\r\n      case 4: return \"Madre\"\r\n      case 5: return \"Padre\"\r\n      case 6: return \"Hermano(a)\"\r\n      case 7: return \"Esposo\"\r\n      case 8: return \"Derechohabiente\"\r\n      default: return \"\"\r\n    }\r\n  }\r\n\r\n  useEffect(()=>{\r\n    const empleador = asegurado?.empleador\r\n    console.log(\"empleador\", empleador)\r\n    // setValue(\"asegurado.matricula\", asegurado?.matricula || \"\")\r\n    setValue(\"asegurado.apellidoPaterno\", asegurado?.apellidoPaterno || \"\")\r\n    setValue(\"asegurado.apellidoMaterno\", asegurado?.apellidoMaterno || \"\")\r\n    setValue(\"asegurado.nombres\", asegurado?.nombres || \"\")\r\n    setValue(\"asegurado.estado\", asegurado?.estadoText || \"\")\r\n    const valSeguro = asegurado?.afiliacion?.baja?.fechaValidezSeguro\r\n    setValue(\"asegurado.fechaValidezSeguro\", valSeguro ? moment(valSeguro).format('L') : \"\")\r\n    setValue(\"empleador.numeroPatronal\", empleador?.numeroPatronal || \"\")\r\n    setValue(\"empleador.nombre\", empleador?.nombre || \"\")\r\n    setValue(\"empleador.estado\", empleador?.estadoText || \"\")\r\n    setValue(\"empleador.fechaBaja\", empleador?.fechaBaja || \"\")\r\n    setValue(\"empleador.enMora\", empleador?.enMora ? \"Sí\" : empleador?.enMora === false ? \"No\" : \"\")\r\n\r\n    if(asegurado?.tipo == 2) {\r\n      const titular = asegurado?.titular\r\n      const extincion = asegurado?.afiliacion?.fechaExtincion\r\n      const parentesco = getParentesco(asegurado?.afiliacion?.parentesco);\r\n\r\n      setValue(\"asegurado.parentesco\", parentesco)\r\n      setValue(\"asegurado.fechaExtincion\", extincion ? moment(extincion).format('L') : \"\")\r\n      setValue(\"titular.matricula\", titular?.matricula || \"\")\r\n      setValue(\"titular.apellidoPaterno\", titular?.apellidoPaterno || \"\")\r\n      setValue(\"titular.apellidoMaterno\", titular?.apellidoMaterno || \"\")\r\n      setValue(\"titular.nombres\", titular?.nombres || \"\")\r\n      setValue(\"titular.estado\", titular?.estadoText)\r\n      const valSeguroTit = titular?.afiliacion?.baja?.fechaValidezSeguro\r\n      setValue(\"titular.fechaValidezSeguro\", valSeguroTit ? moment(valSeguroTit).format('L') : \"\")\r\n    }\r\n  }, [asegurado])\r\n\r\n  useEffect(() => {\r\n    if (asegurado && formState.dirtyFields.asegurado?.matricula) {\r\n      props.onChange(null)\r\n    }\r\n  }, [matricula])\r\n\r\n  const formErrors = formState.errors\r\n  const hasErrors = formErrors.asegurado || formErrors.titular || formErrors.empleador\r\n\r\n  const buscarAseguradoHandler = () => {\r\n    trigger(\"asegurado.matricula\")\r\n      .then((validation) => {\r\n        console.log(\"Matricula validation\", validation)\r\n        if (!formErrors.asegurado?.matricula) {\r\n          if (formState.dirtyFields.asegurado?.matricula)\r\n            delete formState.dirtyFields.asegurado.matricula\r\n          clearErrors([\"asegurado\", \"titular\", \"empleador\"])\r\n          if (!buscar.data) {\r\n            buscar.refetch()\r\n          }\r\n          else {\r\n            const { data: { records } } = buscar.data\r\n            if (records.length == 1) {\r\n              const asegurado = records[0]\r\n              props.onChange(asegurado)\r\n            }\r\n            else {\r\n              showAseguradoChooser(true)\r\n            }\r\n          }\r\n        }\r\n      })\r\n  }\r\n\r\n  return <Card >\r\n    <Accordion.Toggle as={Card.Header} className={\"text-light \" + (hasErrors ? \"bg-danger\" : \"bg-primary\")} eventKey=\"0\">\r\n      Asegurado\r\n    </Accordion.Toggle>\r\n    <Accordion.Collapse eventKey=\"0\">\r\n      <Card.Body>\r\n        <Form.Row>\r\n          <Col lg={3} md={6}>\r\n            <Form.Label htmlFor=\"asegurado-matricula\">\r\n              Matrícula\r\n            </Form.Label>\r\n            <InputGroup hasValidation className=\"mb-2\">\r\n              <FormControl id=\"asegurado-matricula\"\r\n                isInvalid={!!formErrors.asegurado?.matricula /*|| !!formErrors.asegurado?.id*/}\r\n                className=\"text-uppercase\" {...register(\"asegurado.matricula\")} />\r\n              <InputGroup.Append >\r\n                <Button variant=\"outline-secondary\" onClick={buscarAseguradoHandler}>\r\n                  {buscar.isFetching ? <Spinner animation=\"border\" size=\"sm\" /> : <FaSearch />}\r\n                </Button>\r\n              </InputGroup.Append>\r\n              <Form.Control.Feedback type=\"invalid\">{formErrors.asegurado?.matricula?.message}</Form.Control.Feedback>\r\n            </InputGroup>\r\n          </Col>\r\n          <Form.Group as={Col} lg={3} md={6}>\r\n            <Form.Label>Apellido Paterno</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              {...register(\"asegurado.apellidoPaterno\")}\r\n            />\r\n          </Form.Group>\r\n          <Form.Group as={Col} lg={3} md={6}>\r\n            <Form.Label>Apellido Materno</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              {...register(\"asegurado.apellidoMaterno\")}\r\n            />\r\n          </Form.Group>\r\n          <Form.Group as={Col} lg={3} md={6}>\r\n            <Form.Label>Nombre</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              {...register(\"asegurado.nombres\")}\r\n            />\r\n          </Form.Group>\r\n        </Form.Row>\r\n        <Form.Row>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Estado</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.asegurado?.estado}\r\n              {...register(\"asegurado.estado\")}\r\n            >\r\n            </Form.Control>\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.asegurado?.estado?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n          {asegurado?.tipo == 2 && <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Parentesco</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.asegurado?.fechaValidezSeguro}\r\n              {...register(\"asegurado.parentesco\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{\r\n              formErrors.asegurado?.fechaValidezSeguro?.message\r\n            }</Form.Control.Feedback>\r\n          </Form.Group>}\r\n          {asegurado?.afiliacion?.baja && <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Validez del seguro</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.asegurado?.fechaValidezSeguro}\r\n              {...register(\"asegurado.fechaValidezSeguro\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{\r\n              formErrors.asegurado?.fechaValidezSeguro?.message\r\n            }</Form.Control.Feedback>\r\n          </Form.Group>}\r\n          {asegurado?.tipo == 2 ? <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Fecha de extinción</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.asegurado?.fechaExtincion}\r\n              {...register(\"asegurado.fechaExtincion\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.asegurado?.fechaExtincion?.message}</Form.Control.Feedback>\r\n          </Form.Group> : null}\r\n        </Form.Row>\r\n        {asegurado?.tipo == 2 && <div /*className={asegurado.tipo == 2 ? \"\" : \"d-none\"}*/ >\r\n          {/* {watch(\"titular.id\") ? <> */}\r\n          <hr />\r\n          <h2 style={{ fontSize: \"1.25rem\" }}>Titular</h2>\r\n          <Form.Row>\r\n            <Form.Group as={Col} lg={3} md={6}>\r\n              <Form.Label>Matricula</Form.Label>\r\n              <Form.Control\r\n                readOnly\r\n                {...register(\"titular.matricula\")}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group as={Col} lg={3} md={6}>\r\n              <Form.Label>Apellido Paterno</Form.Label>\r\n              <Form.Control\r\n                readOnly\r\n                {...register(\"titular.apellidoPaterno\")}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group as={Col} lg={3} md={6}>\r\n              <Form.Label>Apellido Materno</Form.Label>\r\n              <Form.Control\r\n                readOnly\r\n                {...register(\"titular.apellidoMaterno\")}\r\n              />\r\n            </Form.Group>\r\n            <Form.Group as={Col} lg={3} md={6}>\r\n              <Form.Label>Nombre</Form.Label>\r\n              <Form.Control\r\n                readOnly\r\n                {...register(\"titular.nombres\")}\r\n              />\r\n            </Form.Group>\r\n          </Form.Row>\r\n          <Form.Row>\r\n            <Form.Group as={Col} sm={4}>\r\n              <Form.Label>Estado</Form.Label>\r\n              <Form.Control\r\n                readOnly\r\n                isInvalid={!!formErrors.titular?.estado}\r\n                {...register(\"titular.estado\")}\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">{formErrors.titular?.estado?.message}</Form.Control.Feedback>\r\n            </Form.Group>\r\n            {asegurado?.titular?.afiliacion?.baja && <Form.Group as={Col} sm={4}>\r\n              <Form.Label>Validez del seguro</Form.Label>\r\n              <Form.Control\r\n                readOnly\r\n                isInvalid={!!formErrors.titular?.fechaValidezSeguro}\r\n                {...register(\"titular.fechaValidezSeguro\")}\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">{formErrors.titular?.fechaValidezSeguro?.message}</Form.Control.Feedback>\r\n            </Form.Group>}\r\n          </Form.Row>\r\n          {/* </> : null} */}\r\n        </div>}\r\n        <hr />\r\n        <h2 style={{ fontSize: \"1.25rem\"}}>Empleador</h2>\r\n        <Form.Row>\r\n          <Form.Group as={Col} md={4}>\r\n            <Form.Label>Nº Patronal</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.empleador?.numeroPatronal}\r\n              {...register(\"empleador.numeroPatronal\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.empleador?.numeroPatronal?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n          <Form.Group as={Col} md={8}>\r\n            <Form.Label>Nombre</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              {...register(\"empleador.nombre\")}\r\n            />\r\n          </Form.Group>\r\n        </Form.Row>\r\n        <Form.Row>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Estado</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.empleador?.estado}\r\n              {...register(\"empleador.estado\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.empleador?.estado?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>Fecha de baja</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.empleador?.fechaBaja}\r\n              {...register(\"empleador.fechaBaja\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.empleador?.fechaBaja?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n          <Form.Group as={Col} sm={4}>\r\n            <Form.Label>En mora</Form.Label>\r\n            <Form.Control\r\n              readOnly\r\n              isInvalid={!!formErrors.empleador?.enMora}\r\n              {...register(\"empleador.enMora\")}\r\n            />\r\n            <Form.Control.Feedback type=\"invalid\">{formErrors.empleador?.enMora?.message}</Form.Control.Feedback>\r\n          </Form.Group>\r\n        </Form.Row>\r\n        <AseguradoChooser\r\n          title=\"Resultados\"\r\n          show={aseguradoChooserVisible}\r\n          asegurados={buscar.data?.data.records || []}\r\n          onSelect={(asegurado: Asegurado) => {\r\n            // asegurado.matricula = watch(\"asegurado.matricula\")\r\n            props.onChange(asegurado)\r\n            showAseguradoChooser(false)\r\n          }}\r\n          onHide={()=>showAseguradoChooser(false)}\r\n        />\r\n      </Card.Body>\r\n    </Accordion.Collapse>\r\n  </Card>\r\n}","\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { AxiosPromise, AxiosError } from \"axios\"\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\"\r\nimport { FaSync } from \"react-icons/fa\"\r\nimport { Typeahead, TypeaheadProps } from 'react-bootstrap-typeahead'\r\nimport { useMutation, useQuery, useQueryClient } from 'react-query'\r\nimport { Prestacion, PrestacionesService } from \"../services\";\r\nimport { isMatch } from \"../../../../commons/utils\";\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\r\n\r\nexport type { Prestacion }\r\n\r\nexport const PrestacionesTypeahead = ({\r\n  isInvalid,\r\n  feedback,\r\n  filterBy,\r\n  onChange,\r\n  ...props\r\n}: {feedback?: string, onLoad?: (options: Prestacion[])=>void} & Omit<TypeaheadProps<Prestacion>, \"isLoading\" | \"options\">) => {\r\n  const queryKey = \"prestaciones.buscar\"\r\n  console.log(\"AllowNew\", props.allowNew)\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const buscar = useQuery(queryKey, ()=>{\r\n    return PrestacionesService.buscar({}) as AxiosPromise<Prestacion[]>\r\n  }, {\r\n    // refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false\r\n  })\r\n\r\n  const registrar = useMutation((nombre: string)=>{\r\n    return PrestacionesService.registrar(nombre)\r\n  }, {\r\n    onSuccess: ({data})=>{\r\n      queryClient.invalidateQueries(\"prestaciones.buscar\", {inactive: true})\r\n      queryClient.setQueryData(queryKey, (oldData: any) => {\r\n        return {\r\n          ...oldData,\r\n          data: {\r\n            ...oldData.data,\r\n            records: [oldData.data.records, data]\r\n          }\r\n        }\r\n      })\r\n      onChange && onChange([data])\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscar.data){\r\n      props.onLoad && props.onLoad(buscar.data?.data)\r\n    }\r\n  }, [buscar.data])\r\n\r\n  const options = useMemo(()=>{\r\n    if(Array.isArray(buscar.data?.data)){\r\n        return buscar.data?.data!\r\n    }\r\n    else if(buscar.data?.data){\r\n        console.error(buscar.data?.data)\r\n    }\r\n    return []\r\n  }, [buscar.data?.data])\r\n\r\n  const _onChange = (selected: Prestacion[])=>{\r\n    if(selected.length){\r\n      const option = selected[0] as any\r\n      if(option.customOption){\r\n        registrar.mutate(option.nombre)\r\n        return\r\n      }\r\n    }\r\n    console.log(\"Prestaciones\", selected)\r\n    onChange && onChange(selected)\r\n  }\r\n\r\n  return <InputGroup hasValidation>\r\n    <Typeahead\r\n      clearButton\r\n      allowNew\r\n      emptyLabel=\"No se encontraron coincidencias\"\r\n      align=\"left\"\r\n      {...props}\r\n      onChange={_onChange}\r\n      //@ts-ignore\r\n      newSelectionPrefix={<i>Crear nueva: </i>}\r\n      className={(buscar.isError || isInvalid) ? \"is-invalid\" : \"\"}\r\n      isInvalid={buscar.isError || isInvalid}\r\n      filterBy={(prestacion, props)=>{\r\n        return (!props.text || isMatch(prestacion.nombre, props)) \r\n          && (!filterBy || (typeof filterBy === \"function\" && filterBy(prestacion, props)))\r\n      }}\r\n      disabled={!buscar.data || registrar.isLoading}\r\n      isLoading={buscar.isFetching || registrar.isLoading}\r\n      options={options}\r\n      labelKey=\"nombre\"\r\n    />\r\n    <InputGroup.Append>\r\n      <Button disabled={!buscar.data || registrar.isLoading} variant={buscar.isError ? \"outline-danger\" : \"outline-secondary\"} onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n    </InputGroup.Append>\r\n    <Form.Control.Feedback type=\"invalid\">{\r\n      (buscar.error as AxiosError)?.response?.data?.message || (buscar.error as AxiosError)?.message\r\n      || (registrar.error as AxiosError)?.response?.data?.message || (registrar.error as AxiosError)?.message \r\n      || feedback}</Form.Control.Feedback>\r\n  </InputGroup>\r\n}","import { useState } from \"react\"\r\nimport { Card, Accordion, Form, Table, Button } from \"react-bootstrap\"\r\nimport { useFormContext, useFieldArray, Controller, useController } from \"react-hook-form\"\r\nimport { FaPlus, FaMinus } from \"react-icons/fa\"\r\nimport { Prestacion, PrestacionesTypeahead } from \"./PrestacionesTypeahead\"\r\nimport { Proveedor, ProveedoresTypeahead } from \"./ProveedoresTypeahead\"\r\nimport { Regional } from \"../../../../commons/services\"\r\n\r\nexport type PrestacionesSolicitadasInputs = {\r\n  regional: Regional[],\r\n  prestacionesSolicitadas: {\r\n    id: number,\r\n    prestacion: Prestacion[],\r\n    nota: string,\r\n  }[],\r\n  proveedor?: Proveedor[]\r\n}\r\n\r\nexport const PrestacionesSolicitadasCard = () => {\r\n  const [count, setCount] = useState(1)\r\n  const { register, control, formState, watch } = useFormContext<PrestacionesSolicitadasInputs>()\r\n  const proveedoresTypeaheadController = useController({\r\n    name:\"proveedor\",\r\n    control\r\n  })\r\n  const { fields, append, remove } = useFieldArray({\r\n    control,\r\n    name: \"prestacionesSolicitadas\"\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n  const hasErrors = !!formErrors.prestacionesSolicitadas || !!formErrors.proveedor\r\n\r\n  return <Card style={{ overflow: \"visible\" }} >\r\n    <Accordion.Toggle as={Card.Header} className={\"text-light \" + (hasErrors ? \"bg-danger\" : \"bg-primary\")} eventKey=\"3\">\r\n      Prestaciones\r\n    </Accordion.Toggle>\r\n    <Accordion.Collapse eventKey=\"3\">\r\n      <div>\r\n        <Table className={formErrors.prestacionesSolicitadas ? \"is-invalid\": \"\"}>\r\n          <thead>\r\n            <tr>\r\n              <th style={{ width: 1 }}>#</th>\r\n              <th>Prestacion</th>\r\n              <th>Proveedor</th>\r\n              <th>Nota</th>\r\n              <th style={{ width: 1 }}></th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {fields.map((prestacionSolicitada, index) => {\r\n              return <tr key={prestacionSolicitada.id}>\r\n                <td>{index + 1}</td>\r\n                <td>\r\n                  <Controller\r\n                    name={`prestacionesSolicitadas.${index}.prestacion` as const}\r\n                    control={control}\r\n                    render={({ field, fieldState }) => {\r\n                      return <>\r\n                        <PrestacionesTypeahead\r\n                          id={`solicitud-atencion-externa/prestacionesSolicitadas.${index}.prestacion`}\r\n                          allowNew={false}\r\n                          className={!!fieldState.error ? \"is-invalid\" : \"\"}\r\n                          isInvalid={!!fieldState.error}\r\n                          filterBy={(prestacion) => {\r\n                            const proveedor = watch(\"proveedor.0\")\r\n                            const prestacionesSolicitadas = watch(\"prestacionesSolicitadas\")\r\n                            return !proveedor ||\r\n                              proveedor.contrato.prestaciones.some(pc => pc.id == prestacion.id) && \r\n                              !prestacionesSolicitadas.some(ps=>ps.prestacion?.length && ps.prestacion[0].id == prestacion.id)\r\n                          }}\r\n                          feedback={fieldState.error?.message}\r\n                          selected={field.value}\r\n                          onBlur={field.onBlur}\r\n                          onChange={field.onChange}\r\n                        />\r\n                      </>\r\n                    }}\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <ProveedoresTypeahead\r\n                    id={`solicitud-atencion-externa/proveedor`}\r\n                    className={proveedoresTypeaheadController.fieldState?.error ? \"is-invalid\" : \"\"}\r\n                    isInvalid={!!proveedoresTypeaheadController.fieldState?.error}\r\n                    filter={{\r\n                      activos: 1\r\n                    }}\r\n                    filterBy={(proveedor)=> !!(\r\n                      proveedor.regionalId == watch(\"regional.0.id\") &&\r\n                      watch(\"prestacionesSolicitadas\").every(ps=> proveedor.contrato.prestaciones.some(pc=>pc.id == (ps.prestacion.length && ps.prestacion[0].id)))\r\n                    )}\r\n                    feedback={proveedoresTypeaheadController.fieldState?.error?.message}\r\n                    onChange={proveedoresTypeaheadController.field.onChange}\r\n                    onBlur={proveedoresTypeaheadController.field.onBlur}\r\n                    selected={proveedoresTypeaheadController.field.value}\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <Form.Control as=\"textarea\" \r\n                    isInvalid={!!(formState.errors.prestacionesSolicitadas && formState.errors.prestacionesSolicitadas[index]?.nota)}\r\n                    {...register(`prestacionesSolicitadas.${index}.nota` as const)}\r\n                  />\r\n                  <Form.Control.Feedback type=\"invalid\">{formState.errors.prestacionesSolicitadas && formState.errors.prestacionesSolicitadas[index]?.nota?.message}</Form.Control.Feedback>\r\n                </td>\r\n                <td>\r\n                  {/* <Button variant=\"link\" onClick={() => {\r\n                    console.log(\"Remove\", index)\r\n                    remove(index)\r\n                  }} className=\"btn-icon\"><FaMinus /></Button> */}\r\n                </td>\r\n              </tr>\r\n            })}\r\n            {/* <tr>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n              <td>\r\n                <Button variant=\"link\" onClick={() => {\r\n                  console.log(count)\r\n                  append({\r\n                    id: count\r\n                  })\r\n                  setCount(count => count+1)\r\n                }} className=\"btn-icon\"><FaPlus /></Button>\r\n              </td>\r\n            </tr> */}\r\n          </tbody>\r\n        </Table>\r\n        <Form.Control.Feedback type=\"invalid\">{\r\n          //@ts-ignore\r\n          formErrors.prestacionesSolicitadas?.message}</Form.Control.Feedback>\r\n      </div>\r\n    </Accordion.Collapse>\r\n  </Card>\r\n}","export const EstadosAfi: {[k: number]: string} = {\r\n  1: \"Activo\",\r\n  2: \"Baja\"\r\n}","export const EstadosEmp: {[k: number]: string} = {\r\n  1: \"Activo\",\r\n  2: \"Baja\",\r\n  3: \"Baja temporal\"\r\n}","import { useEffect, useState } from \"react\"\r\nimport { AxiosError } from \"axios\"\r\nimport { Accordion, Alert, Button, Card,Col,Form, Spinner } from \"react-bootstrap\"\r\nimport { useForm, Controller, FormProvider } from \"react-hook-form\"\r\nimport moment from \"moment\"\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { AseguradoCard, AseguradoInputs } from \"./AseguradoCard\"\r\nimport { MedicosTypeahead } from \"./MedicosTypeahead\"\r\nimport { PrestacionesSolicitadasInputs, PrestacionesSolicitadasCard } from \"./PrestacionesSolicitadasCard\"\r\nimport { useMutation } from \"react-query\"\r\nimport { Asegurado, Medico, SolicitudesAtencionExternaService } from \"../services\"\r\nimport { Regional, RegionalesTypeahead } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\n// import { Dm11Viewer } from \"./Dm11Viewer\"\r\nimport { Permisos } from \"../../../../commons/auth/constants\"\r\nimport { useLoggedUser } from \"../../../../commons/auth/hooks\"\r\nimport { EstadosAfi, EstadosEmp } from \"../utils\"\r\n\r\ntype Inputs = AseguradoInputs & PrestacionesSolicitadasInputs & {\r\n  regional: Regional[]\r\n  medico?: Medico[]\r\n}\r\n\r\nconst hoy = moment()\r\n\r\nconst estadoAfiSchema = yup.string().label(\"estado\").oneOf(Object.values(EstadosAfi), \"Estado desconocido\")\r\n.test(\"estado-incoherente\", \"\", function(value, context) {\r\n  if(value == EstadosAfi[1] && context.parent.tieneBaja){\r\n    return context.createError({\r\n      message: \"El asegurado figura como activo, pero hay un registro de su baja con fecha ${date}\",\r\n      params: {\r\n        date: context.parent.fechaRegBaja\r\n      }\r\n    })\r\n  }\r\n  if(value == EstadosAfi[2] && !context.parent.tieneBaja){\r\n    return context.createError({\r\n      message: \"El asegurado figura como dado de baja, aunque no se encontraron registros de la baja\"\r\n    })\r\n  }\r\n  return true\r\n})\r\n\r\nconst validezSchema = yup.mixed().label(\"fecha de extinsion\")\r\n.test(\"min\", \"\", function(value, context){\r\n  const {estado, tieneBaja} = context.parent\r\n  if(estado == EstadosAfi[2] && tieneBaja)\r\n    if(!value) return context.createError({\r\n      message: \"Fecha sin especificar, se asume que el seguro ya no tiene validez\"\r\n    })\r\n    if(moment(value).isSameOrBefore(hoy)) return context.createError({\r\n      message: \"El seguro ya no tiene validez\"\r\n    })\r\n  return true\r\n})\r\n\r\nconst schema = yup.object().shape({\r\n  asegurado: yup.object().shape({\r\n    matricula: yup.string().label(\"matricula\").trim().uppercase().required().matches(/^\\d{2}-\\d{4}-[a-zA-ZñÑ]{2,3}$/, \"Formato incorrecto.\"),\r\n    estado: estadoAfiSchema,\r\n    fechaExtincion: yup.lazy(value => value ? \r\n      yup.date().label(\"fecha de extinsion\").nullable().notRequired().min(hoy.toDate(), \"Fecha de extinsion alcanzada\") :\r\n      yup.mixed()),\r\n    fechaValidezSeguro: validezSchema\r\n  }),\r\n  titular: yup.mixed().test(\"titular\", \"\", (value, context) => {\r\n    const asegurado = context.options.context?.asegurado\r\n    if(asegurado?.tipo == 2 && asegurado?.afiliacion?.parentesco != 8) {\r\n      if(!asegurado.titular){\r\n        return context.createError({\r\n          message: \"No se encontraron datos del titular\"\r\n        })\r\n      }\r\n      try {\r\n        yup.object().shape({\r\n          estado: estadoAfiSchema,\r\n          fechaValidezSeguro: validezSchema\r\n        }).validateSync(value, {context: {asegurado: asegurado.titular}})\r\n      } catch (e){\r\n        return e\r\n      }\r\n    }\r\n    return true\r\n  }),\r\n  empleador: yup.object().shape({\r\n    numeroPatronal: yup.string().label(\"numero patronal\").required(),\r\n    estado: yup.string().label(\"estado\").oneOf(Object.values(EstadosEmp), \"Estado desconocido\")\r\n    .test(\"estado-incoherente\", \"El empleador figura como activo, pero tiene fecha de baja\", function(value, context) {\r\n      const empleador = context.options.context?.asegurado?.empleador\r\n      return empleador.estado != 1 || !empleador.fechaBaja\r\n    }),\r\n    fechaBaja: yup.mixed().when(\"estado\", {\r\n      is: (estado: string) => estado == EstadosEmp[2] || estado == EstadosEmp[3],\r\n      then: yup.date().required(\"Fecha sin especificar, se asume que el seguro ya no tiene validez\")\r\n               .min(hoy.subtract(2, \"months\").toDate())\r\n    }),\r\n    aportes: yup.lazy(value => value ? yup.string().oneOf([\"No\"], \"El empleador esta en mora\") : yup.string())\r\n  }),\r\n  regional: yup.array().length(1, \"Debe seleccionar una regional\"),\r\n  medico: yup.array().length(1, \"Debe seleccionar un medico\"),\r\n  proveedor: yup.array().length(1, \"Debe seleccionar un proveedor\"),\r\n  prestacionesSolicitadas: yup.array().of(yup.object().shape({\r\n    prestacion: yup.array().length(1, \"Debe seleccionar una prestacion\"),\r\n    nota: yup.string().label(\"nota\").nullable().notRequired().max(150)\r\n  })).min(1, \"Debe solicitar un servicio\").max(1, \"Solo puede solicitar un servicio por solicitud\")\r\n})\r\n\r\nexport const SolicitudAtencionExternaForm = ()=>{\r\n  const [asegurado, setAsegurado] = useState<Asegurado|null>(null)\r\n  console.log(\"Asegurado\", asegurado)\r\n  const formMethods = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    context: {\r\n      asegurado\r\n    },\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      regional: [],\r\n      medico: [],\r\n      proveedor: [],\r\n      prestacionesSolicitadas: [{\r\n        id: 0,\r\n        prestacion: [],\r\n        nota: \"\"\r\n      }],\r\n      asegurado: {},\r\n      titular: {},\r\n      empleador: {}\r\n    }\r\n  })\r\n  const {\r\n    handleSubmit,\r\n    formState,\r\n    control,\r\n    reset,\r\n    setValue,\r\n    setError,\r\n    watch\r\n  } = formMethods\r\n\r\n  const dm11Viewer = useModal(\"pdfModal\")\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  console.log(\"Errors\", watch(), formState.errors)\r\n  \r\n  const registrar = useMutation((values: Inputs)=>{\r\n    return SolicitudesAtencionExternaService.registrar(\r\n      values.regional![0].id,\r\n      asegurado!.id,\r\n      values.medico![0].id,\r\n      values.proveedor![0].id,\r\n      values.prestacionesSolicitadas.map(({prestacion, nota})=>({\r\n        prestacion_id: prestacion![0].id,\r\n        nota\r\n      }))\r\n    )\r\n  }, {\r\n    onSuccess: ({data: {urlDm11, regionalId}}) => {\r\n      if(loggedUser?.canAny([\r\n        Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA,\r\n        Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR\r\n      ]) || (loggedUser?.can(Permisos.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL) && regionalId == loggedUser?.regionalId)){\r\n        dm11Viewer.open({url: urlDm11, title: \"Formulario D.M. - 11\"})\r\n        reset()\r\n      }\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n  const registrarError = registrar.error as AxiosError\r\n\r\n  useEffect(()=>{\r\n    if(registrarError?.response?.status == 422){\r\n      const {errors} = registrarError.response?.data\r\n      Object.keys(errors).forEach((key: any)=>{\r\n        let localKey = key\r\n        if(key == \"asegurado.id\") localKey = \"asegurado.matricula\"\r\n        setError(localKey, {type: \"serverError\", message: errors[key]})\r\n      })\r\n    }\r\n  }, [registrarError])\r\n\r\n  const renderAlert = ()=>{\r\n    if(registrar.isSuccess){\r\n      return <Alert variant=\"success\">\r\n      La operacion se realizó exitosamente\r\n    </Alert>\r\n    }\r\n    if(registrar.isError){\r\n      return registrarError.response?.status != 422 ? <Alert variant=\"danger\">\r\n        {registrarError ? registrarError.response?.data?.message || registrarError.message : \"\"}\r\n      </Alert> : null\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <FormProvider {...formMethods}>\r\n    <Form onSubmit={handleSubmit((values)=>{\r\n      registrar.mutate(values)\r\n    })}>\r\n      <h1 style={{fontSize: \"1.75rem\"}}>Solicitud de atención externa</h1>\r\n      {renderAlert()}\r\n      <Accordion className=\"mt-3\"  defaultActiveKey=\"0\">\r\n        <AseguradoCard value={asegurado} onChange={(asegurado)=>{\r\n          setAsegurado(asegurado)\r\n        }} />\r\n        <Card style={{overflow: \"visible\"}} >\r\n          <Accordion.Toggle as={Card.Header} className={\"text-light \" + (formErrors.regional ? \"bg-danger\" : \"bg-primary\")} eventKey=\"1\">\r\n            Regional\r\n          </Accordion.Toggle>\r\n          <Accordion.Collapse eventKey=\"1\">\r\n            <Card.Body>\r\n              <Form.Row>\r\n                <Form.Group as={Col}>\r\n                  <Form.Label>Nombre</Form.Label>\r\n                  <Controller \r\n                    control={control}\r\n                    name=\"regional\"\r\n                    render={({field, fieldState})=>{\r\n                      return <RegionalesTypeahead\r\n                        id=\"solicitud-atencion-externa-form/regionales\"\r\n                        filterBy={(regional: Regional)=>{\r\n                          return (loggedUser?.can(Permisos.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA) ? true : \r\n                            (regional.id == loggedUser?.regionalId))\r\n                        }}\r\n                        isInvalid={!!fieldState.error}\r\n                        feedback={fieldState.error?.message}\r\n                        selected={field.value}\r\n                        onBlur={field.onBlur}\r\n                        onChange={(regional)=>{\r\n                          setValue(\"medico\", [])\r\n                          setValue(\"proveedor\", [])\r\n                          field.onChange(regional)\r\n                        }}\r\n                      />\r\n                    }}\r\n                  />\r\n                </Form.Group> \r\n              </Form.Row>\r\n            </Card.Body>\r\n          </Accordion.Collapse>\r\n        </Card>\r\n        <Card style={{overflow: \"visible\"}} >\r\n          <Accordion.Toggle as={Card.Header}  className={\"text-light \" + (formErrors.medico ? \"bg-danger\" : \"bg-primary\")} eventKey=\"2\">\r\n            Médico\r\n          </Accordion.Toggle>\r\n          <Accordion.Collapse eventKey=\"2\">\r\n            <Card.Body>\r\n              <Form.Row>\r\n                <Form.Group as={Col}>\r\n                  <Form.Label>Nombre</Form.Label>\r\n                  <Controller \r\n                    control={control}\r\n                    name=\"medico\"\r\n                    render={({field, fieldState})=>{\r\n                      return <><MedicosTypeahead\r\n                        id=\"solicitud-atencion-externa-form/medicos\"\r\n                        filter={{\r\n                          estado: 1\r\n                        }}\r\n                        filterBy={(medico) => medico.regionalId == watch(\"regional.0.id\")}\r\n                        className={fieldState.error ? \"is-invalid\" : \"\"}\r\n                        isInvalid={!!formState.errors.medico}\r\n                        selected={field.value}\r\n                        onBlur={field.onBlur}\r\n                        onChange={field.onChange}\r\n                      />\r\n                      <Form.Control.Feedback type=\"invalid\">{fieldState.error?.message}</Form.Control.Feedback></>\r\n                    }}\r\n                  />\r\n                </Form.Group> \r\n              </Form.Row>\r\n            </Card.Body>\r\n          </Accordion.Collapse>\r\n        </Card>\r\n        <PrestacionesSolicitadasCard />\r\n      </Accordion>\r\n      <Button className=\"mt-3\" type=\"submit\">\r\n        {registrar.isLoading ? <Spinner animation=\"border\" size=\"sm\"/> : null}\r\n        Guardar\r\n      </Button>\r\n    </Form>\r\n    {/* <Dm11Viewer /> */}\r\n  </FormProvider>\r\n}","import axios, { AxiosPromise } from \"axios\"\r\nimport { PaginatedResponse } from \"../../../../commons/services\"\r\nimport apiClient from \"../../../../commons/services/apiClient\"\r\nimport { Page } from \"../../../../commons/services/Page\"\r\n\r\nexport type Especialidad = {\r\n  id: number,\r\n  nombre: string,\r\n}\r\n\r\ninterface EspecialidadesService {\r\n  buscar(filter: string): AxiosPromise<Especialidad[]>\r\n  buscar(filter: string, page: Page): AxiosPromise<PaginatedResponse<Especialidad>>\r\n  ver: (id: number) => AxiosPromise<Especialidad>\r\n  registrar: (nombre: string) => AxiosPromise<Especialidad>\r\n  actualizar: (id: number, nombre: string) => AxiosPromise<Especialidad>\r\n  eliminar: (id: number) => AxiosPromise<Especialidad>\r\n  importar(archivo: File, separador: string, formato: string): AxiosPromise\r\n\r\n}\r\n\r\nexport const EspecialidadesService: EspecialidadesService = {\r\n  buscar: (filter: string, page?: Page) => {\r\n    const CancelToken = axios.CancelToken;\r\n    const source = CancelToken.source()\r\n  \r\n    const promise = apiClient.get(\"/especialidades\", {\r\n      params: {\r\n        filter: {\r\n          nombre: filter || undefined\r\n        },\r\n        page\r\n      }\r\n    })\r\n    //@ts-ignore\r\n    promise.cancel = () => {\r\n      source.cancel('Query was cancelled by React Query')\r\n    }\r\n    return promise\r\n  },\r\n  ver: (id: number) => {\r\n    return apiClient.get<Especialidad>(`especialidades/${id}`)\r\n  },\r\n  registrar: (nombre: string) => {\r\n    return apiClient.post<Especialidad>(\"especialidades\", {\r\n      nombre\r\n    })\r\n  },\r\n  actualizar: (id: number, nombre: string) => {\r\n    return apiClient.put<Especialidad>(`especialidades/${id}`, {\r\n      nombre\r\n    })\r\n  },\r\n  eliminar: (id: number) => {\r\n    return apiClient.delete(`especialidades/${id}`)\r\n  },\r\n  importar: (archivo: File, separador: string, formato: string) =>{\r\n    const formData = new FormData()\r\n    formData.append(\"archivo\", archivo, archivo.name)\r\n    formData.append(\"separador\", separador)\r\n    formData.append(\"formato\", formato)\r\n    return apiClient.post(\"/especialidades/importar\", formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    })\r\n  }\r\n}","import React from \"react\"\r\nimport { Form, Button, Col } from \"react-bootstrap\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { FaSearch } from \"react-icons/fa\"\r\n\r\ntype Props = {\r\n  onSearch: (nombre: string) => void \r\n}\r\nexport const EspecialidadesFilter = (props: Props) =>{\r\n  const { register, handleSubmit } = useForm<{nombre: string}>()\r\n  return <Form onSubmit={handleSubmit(({nombre})=>{\r\n    props.onSearch(nombre)\r\n  })} >\r\n    <Form.Row className=\"flex-nowrap\">\r\n      <Col>\r\n        <Form.Label htmlFor=\"nombre\" srOnly>Nombre</Form.Label>\r\n        <Form.Control type=\"search\" id=\"nombre\" style={{minWidth: \"10rem\"}} {...register(\"nombre\")}></Form.Control>\r\n      </Col>\r\n      <Col xs={\"auto\"}>\r\n        <Button className=\"ml-2\" type=\"submit\"><FaSearch /></Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import { AxiosError } from \"axios\"\r\nimport React, {useState, useRef} from \"react\"\r\nimport { Dropdown, ButtonGroup, Button, Form, Table, Spinner, Row, Col } from \"react-bootstrap\"\r\nimport { FaSync, FaEdit, FaTrash } from \"react-icons/fa\"\r\nimport { useMutation, useQuery } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport Pagination from \"../../../../commons/components/Pagination\"\r\nimport VerticalEllipsisDropdownToggle from \"../../../../commons/components/VerticalEllipsisDropdownToggle\"\r\nimport { Page } from \"../../../../commons/services/Page\"\r\nimport { EspecialidadesService } from \"../services\"\r\nimport { EspecialidadesFilter } from \"./EspecialidadesFilter\"\r\n\r\nexport const EspecialidadesIndex = ()=>{\r\n  const [total, setTotal] = useState(0)\r\n  const [page, setPage] = useState<Page>({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const [filter, setFilter] = useState(\"\")\r\n\r\n  const importModalRef = useRef<{show(visible: boolean): void}>()\r\n\r\n  const buscar = useQuery([\"especialidades.buscar\", page, filter], ()=>{\r\n    return EspecialidadesService.buscar(filter, page)\r\n  }, {\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: ({data: {meta}}) => {\r\n      setTotal(meta.total)\r\n    }\r\n  })\r\n\r\n  const eliminar = useMutation((id: number)=>{\r\n    return EspecialidadesService.eliminar(id)\r\n  })\r\n\r\n  const renderRows = ()=>{\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.isError) {\r\n      const { error } = buscar\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {(error as AxiosError).response?.data?.message || (error as AxiosError).message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    const records = buscar.data!.data.records\r\n    if(records.length == 0){\r\n      return  <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          No se encontraron resultados\r\n        </td>\r\n    </tr>\r\n    }\r\n    return records.map((especialidad, index)=>{\r\n      return <tr key={especialidad.id}>\r\n        <td>{index + 1}</td>\r\n        <td>{especialidad.nombre}</td>\r\n        <td>\r\n          <Dropdown>\r\n            <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n              variant=\"link\" id={`dropdown-especialidad-${especialidad.id}`}\r\n            />\r\n\r\n            <Dropdown.Menu>\r\n              <Dropdown.Item as={Link} replace to={{\r\n                pathname: `/clinica/especialidades/${especialidad.id}/editar`,\r\n                state: {\r\n                  especialidad\r\n                }\r\n              }} ><FaEdit /><span className=\"ml-2 align-middle\">Editar</span></Dropdown.Item>\r\n              <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n                if (window.confirm(\"¿Está seguro?\")) {\r\n                  eliminar.mutate(especialidad.id)\r\n                }\r\n              }}>Eliminar</Dropdown.Item>\r\n            </Dropdown.Menu>\r\n          </Dropdown>\r\n        </td>\r\n      </tr>\r\n    })\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h2 style={{fontSize: \"1.75rem\"}}>Especialidades</h2>\r\n    <Form.Row className=\"mb-2\">\r\n      {/* <Col className=\"ml-auto pr-0\" xs=\"auto\" >\r\n        <Button onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n      </Col> */}\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        {/* <Dropdown as={ButtonGroup}> */}\r\n          <Button as={Link} replace to={\"/clinica/especialidades/registrar\"}>Nuevo</Button>\r\n          {/* <Dropdown.Toggle split id=\"especialidades-dropdown\" />\r\n          <Dropdown.Menu>\r\n            <Dropdown.Item onClick={()=>{\r\n              console.log(importModalRef)\r\n              importModalRef.current && importModalRef.current.show(true)\r\n            }}\r\n            >Importar</Dropdown.Item>\r\n          </Dropdown.Menu>\r\n        </Dropdown> */}\r\n      </Col>\r\n    </Form.Row>\r\n    <Row>\r\n      <Col className=\"mb-2\">\r\n        <EspecialidadesFilter onSearch={(filter)=>{\r\n          setFilter(filter)\r\n        }} />\r\n      </Col>\r\n      <Col className=\"mb-2\" xs={\"auto\"}>\r\n        <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n            <span>Mostrar</span>\r\n            <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n              const value = e.target.value\r\n              setPage((page) => ({\r\n                current: 1,\r\n                size: parseInt(value)\r\n              }))\r\n            }}>\r\n              <option value={10}>10</option>\r\n              <option value={20}>20</option>\r\n              <option value={30}>30</option>\r\n              <option value={50}>50</option>\r\n              <option value={100}>100</option>\r\n            </Form.Control>\r\n            <span>filas</span>\r\n        </div>\r\n      </Col>\r\n    </Row>\r\n    <Table responsive>\r\n      <thead>\r\n        <tr>\r\n          <th style={{width: 1}}>#</th>\r\n          <th>Nombre</th>\r\n          <th style={{width: 1}}></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {renderRows()}\r\n      </tbody>\r\n    </Table>\r\n    {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n  </div>\r\n}","import { useEffect, useRef } from \"react\"\r\nimport { Alert, Button, Form, Modal, Spinner } from \"react-bootstrap\"\r\nimport { useParams, useHistory } from \"react-router-dom\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\"\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { Especialidad, EspecialidadesService } from \"../services\"\r\nimport { AxiosError } from \"axios\"\r\n\r\nexport type Inputs = {\r\n  nombre: string\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  nombre: yup.string().required().min(4).max(100)\r\n})\r\n\r\nexport const EspecialidadForm = ()=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    especialidad: Especialidad\r\n  }>()\r\n\r\n  const continueRef = useRef<boolean>(false)\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    reset,\r\n    setValue,\r\n    formState,\r\n  } = useForm<Inputs>({\r\n    resolver: yupResolver(schema)\r\n  })\r\n\r\n  const queryClient = useQueryClient();\r\n\r\n  const guardar = useMutation(({nombre}: Inputs)=>{\r\n    return id ? EspecialidadesService.actualizar(parseInt(id), nombre) : EspecialidadesService.registrar(nombre)\r\n  }, {\r\n    onSuccess: ()=>{\r\n      reset()\r\n      queryClient.invalidateQueries(\"especialidades.buscar\")\r\n      if(!continueRef.current)\r\n        history.replace(\"/clinica/especialidades\")\r\n    }\r\n  })\r\n\r\n  const cargar = useQuery([\"especialidades.cargar\", id], ()=>{\r\n    return EspecialidadesService.ver(parseInt(id as string))\r\n  }, {\r\n    enabled: !!id && !history.location.state?.especialidad,\r\n    refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const especialidad = cargar.data?.data || history.location.state?.especialidad\r\n\r\n  useEffect(()=>{\r\n    if(especialidad){\r\n      setValue(\"nombre\", especialidad.nombre)\r\n    }\r\n  }, [especialidad])\r\n\r\n  const renderBody = ()=>{\r\n    if(cargar.isFetching){\r\n      return <Spinner animation=\"border\">Cargando</Spinner>\r\n    }\r\n    const error = cargar.error as AxiosError\r\n    if(error){\r\n      return <Alert variant=\"danger\">\r\n        {error.response?.data?.message || error.message}\r\n      </Alert>\r\n    }\r\n    return <Form id=\"especialidad-form\"\r\n      onSubmit={handleSubmit((inputs)=>{\r\n        guardar.mutate(inputs)\r\n      })}\r\n    >\r\n      {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n        {guardar.isError ? (guardar.error as AxiosError).response?.data?.message || (guardar.error as AxiosError).message : \"Guardado\"}\r\n      </Alert> : null}\r\n      <Form.Group>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.nombre}\r\n          {...register(\"nombre\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.nombre?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form>\r\n  }\r\n\r\n  return <Modal\r\n    show\r\n    centered\r\n    onHide={()=>{\r\n      history.replace(\"/clinica/especialidades\")\r\n    }}\r\n  >\r\n    <Modal.Header>\r\n      {id ? \"Editar\" : \"Registrar\" }\r\n    </Modal.Header> \r\n    <Modal.Body>\r\n      {renderBody()}\r\n    </Modal.Body>\r\n    <Modal.Footer>\r\n      {!id ? <Button \r\n        type=\"submit\"\r\n        form=\"especialidad-form\"\r\n        onClick={()=>{\r\n          continueRef.current = true\r\n        }}\r\n      >\r\n        {guardar.isLoading && continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar y continuar\r\n      </Button> : null}\r\n      <Button\r\n        type=\"submit\"\r\n        form=\"especialidad-form\"\r\n        onClick={()=>{\r\n          continueRef.current = false\r\n        }}\r\n      >\r\n        {guardar.isLoading && !continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button>\r\n    </Modal.Footer>\r\n  </Modal>\r\n}","import { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\n\r\nexport type Prestacion = {\r\n  id: number,\r\n  nombre: string,\r\n}\r\n\r\nexport const PrestacionesService = {\r\n  buscar: (page: Page, filter: string) => {\r\n    return apiClient.get<PaginatedResponse<Prestacion>>(\"/prestaciones\", {\r\n      params: {\r\n        filter: {\r\n          nombre: filter || undefined\r\n        },\r\n        page\r\n      }\r\n    })\r\n  },\r\n  ver: (id: number) => {\r\n    return apiClient.get<Prestacion>(`prestaciones/${id}`)\r\n  },\r\n  registrar: (nombre: string) => {\r\n    return apiClient.post<Prestacion>(\"prestaciones\", {\r\n      nombre\r\n    })\r\n  },\r\n  actualizar: (id: number, nombre: string) => {\r\n    return apiClient.put<Prestacion>(`prestaciones/${id}`, {\r\n      nombre\r\n    })\r\n  },\r\n  eliminar: (id: number) => {\r\n    return apiClient.delete(`prestaciones/${id}`)\r\n  },\r\n  importar: (archivo: File, separador: string, formato: string) =>{\r\n    const formData = new FormData()\r\n    formData.append(\"archivo\", archivo, archivo.name)\r\n    formData.append(\"separador\", separador)\r\n    formData.append(\"formato\", formato)\r\n    return apiClient.post(\"/prestaciones/importar\", formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    })\r\n  }\r\n}","import React from \"react\"\r\nimport { Form, Button, Col } from \"react-bootstrap\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { FaSearch } from \"react-icons/fa\"\r\n\r\ntype Props = {\r\n  onSearch: (nombre: string) => void \r\n}\r\nexport const PrestacionesFilterForm = (props: Props) =>{\r\n  const { register, handleSubmit } = useForm<{nombre: string}>()\r\n  return <Form onSubmit={handleSubmit(({nombre})=>{\r\n    props.onSearch(nombre)\r\n  })} >\r\n    <Form.Row className=\"flex-nowrap\">\r\n      <Col>\r\n        <Form.Label htmlFor=\"nombre\" srOnly>Nombre</Form.Label>\r\n        <Form.Control type=\"search\" id=\"nombre\" style={{minWidth: \"10rem\"}} {...register(\"nombre\")}></Form.Control>\r\n      </Col>\r\n      <Col xs={\"auto\"}>\r\n        <Button className=\"ml-2\" type=\"submit\"><FaSearch /></Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import { AxiosError } from \"axios\"\r\nimport {useState, useRef} from \"react\"\r\nimport { Dropdown, ButtonGroup, Button, Form, Table, Spinner, Row, Col } from \"react-bootstrap\"\r\nimport { FaSync, FaEdit, FaTrash } from \"react-icons/fa\"\r\nimport { useQuery, useMutation } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport Pagination from \"../../../../commons/components/Pagination\"\r\nimport VerticalEllipsisDropdownToggle from \"../../../../commons/components/VerticalEllipsisDropdownToggle\"\r\nimport { Page } from \"../../../../commons/services/Page\"\r\nimport { PrestacionesService } from \"../services\"\r\nimport { PrestacionesFilterForm } from \"./PrestacionesFilterForm\"\r\n\r\nexport const PrestacionesIndex = ()=>{\r\n  const [total, setTotal] = useState(0)\r\n  const [page, setPage] = useState<Page>({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const [filter, setFilter] = useState(\"\")\r\n\r\n  const buscar = useQuery([\"prestaciones.buscar\", page, filter], ()=>{\r\n    return PrestacionesService.buscar(page, filter)\r\n  }, {\r\n    // refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: ({data: {meta}}) => {\r\n      setTotal(meta.total)\r\n    }\r\n  })\r\n\r\n  const eliminar = useMutation((id: number)=>{\r\n    return PrestacionesService.eliminar(id)\r\n  })\r\n\r\n  const renderRows = ()=>{\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.isError) {\r\n      const { error } = buscar\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {(error as AxiosError).response?.data?.message || (error as AxiosError).message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    const records = buscar.data!.data.records\r\n    if(records.length == 0){\r\n      return  <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          No se encontraron resultados\r\n        </td>\r\n    </tr>\r\n    }\r\n    return records.map((prestacion, index)=>{\r\n      return <tr key={prestacion.id}>\r\n        <td>{index + 1}</td>\r\n        <td>{prestacion.nombre}</td>\r\n        <td>\r\n          <Dropdown>\r\n            <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n              variant=\"link\" id={`dropdown-prestacion-${prestacion.id}`}\r\n            />\r\n            <Dropdown.Menu>\r\n              <Dropdown.Item as={Link} replace to={{\r\n                pathname: `/clinica/prestaciones/${prestacion.id}/editar`,\r\n                state: {\r\n                  prestacion\r\n                }\r\n              }} ><FaEdit /><span className=\"ml-2 align-middle\">Editar</span></Dropdown.Item>\r\n              <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n                if (window.confirm(\"¿Está seguro?\")) {\r\n                  eliminar.mutate(prestacion.id)\r\n                }\r\n              }}><FaTrash /><span className=\"ml-2 align-middle\">Eliminar</span></Dropdown.Item>\r\n            </Dropdown.Menu>\r\n          </Dropdown>\r\n        </td>\r\n      </tr>\r\n    })\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h2 style={{fontSize: \"1.75rem\"}}>Prestaciones</h2>\r\n    <Form.Row className=\"mb-2\">\r\n      {/* <Col className=\"ml-auto pr-0\" xs=\"auto\" >\r\n        <Button onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n      </Col> */}\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        {/* <Dropdown as={ButtonGroup}> */}\r\n          <Button as={Link} replace to={\"/clinica/prestaciones/registrar\"}>Nuevo</Button>\r\n          {/* <Dropdown.Toggle split id=\"especialidades-dropdown\" />\r\n          <Dropdown.Menu>\r\n            <Dropdown.Item onClick={()=>{\r\n              console.log(importModalRef)\r\n              importModalRef.current && importModalRef.current.show(true)\r\n            }}\r\n            >Importar</Dropdown.Item>\r\n          </Dropdown.Menu>\r\n        </Dropdown> */}\r\n      </Col>\r\n    </Form.Row>\r\n    <Row>\r\n      <Col className=\"mb-2\">\r\n        <PrestacionesFilterForm onSearch={(filter)=>{\r\n          setFilter(filter)\r\n        }} />\r\n      </Col>\r\n      <Col className=\"mb-2\" xs={\"auto\"}>\r\n        <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n            <span>Mostrar</span>\r\n            <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n              const value = e.target.value\r\n              setPage((page) => ({\r\n                ...page,\r\n                size: parseInt(value)\r\n              }))\r\n            }}>\r\n              <option value={10}>10</option>\r\n              <option value={20}>20</option>\r\n              <option value={30}>30</option>\r\n              <option value={50}>50</option>\r\n              <option value={100}>100</option>\r\n            </Form.Control>\r\n            <span>filas</span>\r\n        </div>\r\n      </Col>\r\n    </Row>\r\n    <Table responsive>\r\n      <thead>\r\n        <tr>\r\n          <th style={{width: 1}}>#</th>\r\n          <th>Nombre</th>\r\n          <th style={{width: 1}}></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {renderRows()}\r\n      </tbody>\r\n    </Table>\r\n    <div className=\"d-flex flex-row\">\r\n      <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n      <Pagination\r\n        current={page.current}\r\n        total={Math.ceil((total - page.size) / page.size) + 1}\r\n        onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n      />\r\n    </div>\r\n  </div>\r\n}","import { useEffect, useRef } from \"react\"\r\nimport { Alert, Button, Form, Modal, Spinner } from \"react-bootstrap\"\r\nimport { useParams, useHistory } from \"react-router-dom\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\"\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { Prestacion, PrestacionesService } from \"../services\"\r\nimport { AxiosError } from \"axios\"\r\n\r\nexport type Inputs = {\r\n  nombre: string\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  nombre: yup.string().required().min(3).max(150)\r\n})\r\n\r\nexport const PrestacionForm = ()=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    prestacion: Prestacion\r\n  }>()\r\n  \r\n  const { state} = history.location\r\n  \r\n  const prestacion = state?.prestacion\r\n\r\n  const continueRef = useRef<boolean>(false)\r\n\r\n  const {\r\n    handleSubmit,\r\n    reset,\r\n    register,\r\n    setValue,\r\n    formState,\r\n  } = useForm<Inputs>({\r\n    resolver: yupResolver(schema)\r\n  })\r\n\r\n  const queryClient = useQueryClient();\r\n\r\n  const guardar = useMutation(({nombre}: Inputs)=>{\r\n    return id ? PrestacionesService.actualizar(parseInt(id), nombre) : PrestacionesService.registrar(nombre)\r\n  }, {\r\n    onSuccess: ()=>{\r\n      reset()\r\n      queryClient.invalidateQueries(\"prestaciones.buscar\")\r\n      if(!continueRef.current)\r\n        history.replace(\"/clinica/prestaciones\")\r\n    }\r\n  })\r\n\r\n  const verPrestacion = useQuery([\"verPrestacion\", id], ()=>{\r\n    return PrestacionesService.ver(parseInt(id as string))\r\n  }, {\r\n    enabled: !!id && !prestacion,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(verPrestacion.data?.data || prestacion){\r\n      setValue(\"nombre\", (verPrestacion.data?.data || prestacion).nombre)\r\n    }\r\n  }, [verPrestacion.data])\r\n\r\n  const renderBody = ()=>{\r\n    if(verPrestacion.isFetching){\r\n      return <Spinner animation=\"border\">Cargando</Spinner>\r\n    }\r\n    const error = verPrestacion.error as AxiosError\r\n    if(error){\r\n      return <Alert variant=\"danger\">\r\n        {error.response?.data?.message || error.message}\r\n      </Alert>\r\n    }\r\n    return <Form id=\"prestacion-form\"\r\n      onSubmit={handleSubmit((inputs)=>{\r\n        guardar.mutate(inputs)\r\n      })}\r\n    >\r\n      {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n        {guardar.isError ? guardar.error.response?.data?.message || guardar.error.message : \"Guardado\"}\r\n      </Alert> : null}\r\n      <Form.Group>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.nombre}\r\n          {...register(\"nombre\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.nombre?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form>\r\n  }\r\n\r\n\r\n  return <Modal\r\n    show\r\n    centered\r\n    onHide={()=>{\r\n      history.replace(\"/clinica/prestaciones\")\r\n    }}\r\n  >\r\n    <Modal.Header>\r\n      {id ? \"Editar\" : \"Registrar\" }\r\n    </Modal.Header> \r\n    <Modal.Body>\r\n      {renderBody()}\r\n    </Modal.Body>\r\n    <Modal.Footer>\r\n      {!id ? <Button \r\n        type=\"submit\"\r\n        form=\"prestacion-form\"\r\n        onClick={()=>{\r\n          continueRef.current = true\r\n        }}\r\n      >\r\n        {guardar.isLoading && continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar y continuar\r\n      </Button> : null}\r\n      <Button\r\n        type=\"submit\"\r\n        form=\"prestacion-form\"\r\n        onClick={()=>{\r\n          continueRef.current = false\r\n        }}\r\n      >\r\n        {guardar.isLoading && !continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button>\r\n    </Modal.Footer>\r\n  </Modal>\r\n}","import { Permisos, useLoggedUser } from \"../../../../commons/auth\";\r\n\r\nexport const MedicoPolicy = {\r\n  index: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.VER_MEDICOS,\r\n      Permisos.VER_MEDICOS_REGIONAL,\r\n      Permisos.REGISTRAR_MEDICOS,\r\n      Permisos.REGISTRAR_MEDICOS_REGIONAL\r\n    ])\r\n  },\r\n  register: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.REGISTRAR_MEDICOS,\r\n      Permisos.REGISTRAR_MEDICOS_REGIONAL\r\n    ])\r\n  },\r\n  edit: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.EDITAR_MEDICOS,\r\n      Permisos.EDITAR_MEDICOS_REGIONAL\r\n    ])\r\n  },\r\n  view: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.VER_MEDICOS,\r\n      Permisos.VER_MEDICOS_REGIONAL\r\n    ])\r\n  },\r\n  baja: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.BAJA_MEDICOS,\r\n      Permisos.BAJA_MEDICOS_REGIONAL\r\n    ])\r\n  }\r\n}","\r\nimport { useEffect, useMemo } from \"react\"\r\nimport { Button, Form, InputGroup } from \"react-bootstrap\"\r\nimport { Typeahead, TypeaheadProps } from 'react-bootstrap-typeahead'\r\nimport { FaSync } from 'react-icons/fa'\r\nimport { useQuery, useMutation, useQueryClient } from 'react-query'\r\nimport { AxiosError } from 'axios'\r\nimport { Especialidad, EspecialidadesService } from \"../../especialidades/services\";\r\nimport { isMatch } from \"../../../../commons/utils\";\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\r\n\r\nexport type { Especialidad }\r\n\r\nexport const EspecialidadesTypeahead = ({\r\n  isInvalid,\r\n  feedback,\r\n  filterBy,\r\n  onChange,\r\n  ...props\r\n}: {feedback?: string, onLoad?: (options: Especialidad[])=>void} & Omit<TypeaheadProps<Especialidad>, \"isLoading\" | \"options\" | \"onSearch\">) => {\r\n  const queryKey = \"especialidades.buscar\"\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const buscar = useQuery(queryKey, ()=>{\r\n    return EspecialidadesService.buscar(\"\")\r\n  }, {\r\n    // refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n  })\r\n\r\n  const registrar = useMutation((nombre: string)=>{\r\n    return EspecialidadesService.registrar(nombre)\r\n  }, {\r\n    onSuccess: ({data})=>{\r\n      queryClient.invalidateQueries(\"especialidades.buscar\", {inactive: true})\r\n      queryClient.setQueryData(queryKey, (oldData: any) => {\r\n        return {\r\n          ...oldData,\r\n          data: {\r\n            ...oldData.data,\r\n            records: [oldData.data.records, data]\r\n          }\r\n        }\r\n      })\r\n      onChange && onChange([data])\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(buscar.data){\r\n      props.onLoad && props.onLoad(buscar.data?.data)\r\n    }\r\n  }, [buscar.data])\r\n\r\n  const options = useMemo(()=>{\r\n    if(Array.isArray(buscar.data?.data)){\r\n        return buscar.data?.data!\r\n    }\r\n    else if(buscar.data?.data){\r\n        console.error(buscar.data?.data)\r\n    }\r\n    return []\r\n  }, [buscar.data?.data])\r\n\r\n  const _onChange = (selected: Especialidad[])=>{\r\n    if(selected.length){\r\n      const option = selected[0] as any\r\n      if(option.customOption){\r\n        registrar.mutate(option.nombre)\r\n        return\r\n      }\r\n    }\r\n    onChange && onChange(selected)\r\n  }\r\n\r\n  return <InputGroup hasValidation>\r\n    <Typeahead\r\n      clearButton\r\n      allowNew\r\n      emptyLabel=\"No se encontraron resultados\"\r\n      align=\"left\"\r\n      {...props}\r\n      onChange={_onChange}\r\n      //@ts-ignore\r\n      newSelectionPrefix={<i>Crear nueva: </i>}\r\n      className={(buscar.isError || isInvalid) ? \"is-invalid\" : \"\"}\r\n      isInvalid={buscar.isError || isInvalid}\r\n      filterBy={(especialidad, props)=>{\r\n        return (!props.text || isMatch(especialidad.nombre, props)) \r\n          && (!filterBy || (typeof filterBy === \"function\" && filterBy(especialidad, props)))\r\n      }}\r\n      disabled={!buscar.data || registrar.isLoading}\r\n      isLoading={buscar.isFetching || registrar.isLoading}\r\n      options={options}\r\n      labelKey=\"nombre\"\r\n    />\r\n    <InputGroup.Append>\r\n      <Button variant={buscar.isError ? \"outline-danger\" : \"outline-secondary\"} onClick={()=>buscar.refetch()}><FaSync /></Button>\r\n    </InputGroup.Append>\r\n    <Form.Control.Feedback type=\"invalid\">{\r\n      (buscar.error as AxiosError)?.response?.data?.message || (buscar.error as AxiosError)?.message\r\n      || (registrar.error as AxiosError)?.response?.data?.message || (registrar.error as AxiosError)?.message \r\n      || feedback}</Form.Control.Feedback>\r\n  </InputGroup>\r\n}","import { Button, Col, Form } from \"react-bootstrap\"\r\nimport { useForm, Controller } from \"react-hook-form\"\r\nimport { Especialidad, EspecialidadesTypeahead } from \"./EspecialidadesTypeahead\"\r\nimport { MedicoFilter as Filter } from \"../services\"\r\n\r\ntype Inputs = {\r\n  numCi: string\r\n  compCi: string\r\n  nombre: string\r\n  especialidad: Especialidad[]\r\n  tipo: string\r\n}\r\n\r\ntype Props = {\r\n  onFilter: (filter: Filter) => void\r\n}\r\n\r\nexport const MedicosFilterForm = (props: Props) => {\r\n  const {\r\n    control,\r\n    handleSubmit,\r\n    register,\r\n    reset\r\n  } = useForm<Inputs>({\r\n    defaultValues: {\r\n      tipo: \"\",\r\n      especialidad: []\r\n    }\r\n  })\r\n  return <Form onSubmit={handleSubmit((data) => {\r\n    const filter: Filter = {}\r\n    if(data.numCi) filter.ci = data.numCi\r\n    if(data.compCi) filter.ciComplemento = data.compCi\r\n    if(data.nombre) filter.nombre = data.nombre\r\n    if(data.especialidad) filter.especialidadId = data.especialidad.length && data.especialidad[0].id\r\n    if(data.tipo) filter.tipo = parseInt(data.tipo)\r\n    props.onFilter(filter)\r\n  })}>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Tipo</Form.Label>\r\n        <div>\r\n          <Form.Check inline type=\"radio\" value=\"\" label=\"Todos\" {...register(\"tipo\")} />\r\n          <Form.Check inline type=\"radio\" value=\"1\" label=\"Empleados\" {...register(\"tipo\")} />\r\n          <Form.Check inline type=\"radio\" value=\"2\" label=\"Proveedores\" {...register(\"tipo\")} />\r\n        </div>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4} lg={3}>\r\n        <Form.Label>Nº Carnet</Form.Label>\r\n        <Form.Control {...register(\"numCi\")} />\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={2} lg={1}>\r\n        <Form.Label>Comp. Carnet</Form.Label>\r\n        <Form.Control {...register(\"compCi\")} />\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={6} lg={8}>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control {...register(\"nombre\")} />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Especialidad</Form.Label>\r\n        <Controller\r\n          control={control}\r\n          name=\"especialidad\"\r\n          render={({field: {ref, value, ...field}})=>{\r\n            return <EspecialidadesTypeahead\r\n              id=\"medicos-filter/especialidades\"\r\n              selected={value}\r\n              {...field}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button type=\"submit\">Aplicar</Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Button variant=\"secondary\" onClick={()=>reset()}>Limpiar</Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import { useEffect } from \"react\"\r\nimport { Dropdown } from \"react-bootstrap\"\r\nimport { QueryKey, useMutation, useQueryClient } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { Medico, MedicosService } from \"../services\"\r\nimport { MedicoPolicy } from \"../policies\"\r\n\r\ntype Props = {\r\n  medico: Medico,\r\n  queryKey: QueryKey\r\n}\r\nexport const RowOptions = ({medico, queryKey}: Props) => {\r\n\r\n  const modal = useModal(\"queryLoader\")\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const cambiarEstado = useMutation(()=>{\r\n    return MedicosService.cambiarEstado(medico.id, medico.estado == 1 ? 2 : 1)\r\n  }, {\r\n    onSuccess: ()=>{\r\n      modal.close()\r\n      queryClient.invalidateQueries(\"medicos.buscar\", { inactive: true })\r\n      queryClient.setQueryData(queryKey, (oldData: any) => {\r\n        console.log(oldData)\r\n        return {\r\n          ...oldData,\r\n          data: {\r\n            ...oldData.data,\r\n            records: oldData.data.records.map((i: any)=>{\r\n              return i == medico ? {\r\n                ...i,\r\n                estado: medico.estado == 1 ? 2 : 1,\r\n                estadoText: medico.estado == 1 ? \"Baja\" : \"Alta\"\r\n              } : i\r\n            })\r\n          }\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(cambiarEstado.status == \"loading\"){\r\n      modal.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n    else if(cambiarEstado.status == \"error\"){\r\n      modal.open({\r\n        state: \"error\",\r\n        error: cambiarEstado.error\r\n      })\r\n    }\r\n  }, [cambiarEstado.status])\r\n\r\n  return <Dropdown style={{position: \"initial\"}}>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-medicos-${medico.id}`}\r\n    />\r\n    \r\n    <Dropdown.Menu>\r\n      <ProtectedContent\r\n        authorize={MedicoPolicy.view}\r\n      >\r\n        <Dropdown.Item as={Link} to={{\r\n          pathname: `/clinica/medicos/${medico.id}`,\r\n          state: {\r\n            medico\r\n          }\r\n        }} ><span className=\"align-middle\">Ver</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n      <ProtectedContent\r\n        authorize={MedicoPolicy.edit}\r\n      >\r\n        <Dropdown.Item as={Link} to={{\r\n          pathname: `/clinica/medicos/${medico.id}/editar`,\r\n          state: {\r\n            medico\r\n          }\r\n        }} ><span className=\"align-middle\">Editar</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n      <ProtectedContent\r\n        authorize={MedicoPolicy.baja}\r\n      >\r\n        <Dropdown.Item className=\"text-danger\" href=\"#\" onClick={() => {\r\n          // if (window.confirm(\"¿Está seguro?\")) {\r\n            cambiarEstado.mutate()\r\n          // }\r\n        }}>{medico.estado == 1 ? \"Baja\" : \"Alta\"}</Dropdown.Item>\r\n      </ProtectedContent>\r\n    </Dropdown.Menu>\r\n  </Dropdown>  \r\n}","import { AxiosError, AxiosPromise } from \"axios\"\r\nimport { useEffect, useRef, useState } from \"react\"\r\nimport { Button, Col, Collapse, Form, Row, Spinner, Table } from \"react-bootstrap\"\r\nimport { FaFilter, FaSync, FaPlus } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport { Pagination } from \"../../../../commons/components\"\r\nimport { ProtectedContent, useLoggedUser, Permisos } from \"../../../../commons/auth\"\r\nimport { PaginatedResponse } from \"../../../../commons/services\"\r\nimport { MedicoPolicy } from \"../policies\"\r\nimport { Medico, MedicosService, MedicoFilter as Filter } from \"../services\"\r\nimport { MedicosFilterForm } from \"./MedicosFilterForm\"\r\nimport { RowOptions } from \"./RowOptions\"\r\n\r\nexport const MedicosIndex = () => {\r\n  const {pathname: path} = useLocation()\r\n  const [page, setPage] = useState({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser();\r\n  \r\n  const getDefaultFilter = ()=>{\r\n    const filter: Filter = {  }\r\n    if(!loggedUser?.can(Permisos.VER_MEDICOS)){\r\n      if(loggedUser?.can(Permisos.VER_MEDICOS_REGIONAL)){\r\n        filter.regionalId = loggedUser.regionalId;\r\n      }\r\n    }\r\n    return filter\r\n  }\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n  \r\n  const [filterFormVisible, showFilterForm] = useState(false)\r\n\r\n  const queryKey = [\"medicos.buscar\", filter, page];\r\n  const buscar = useQuery(queryKey, () => {\r\n    return MedicosService.buscar(filter, page) as AxiosPromise<PaginatedResponse<Medico>>\r\n  }, {\r\n    enabled: MedicoPolicy.view(loggedUser),\r\n    // refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const total = buscar.data?.data?.meta?.total || 0\r\n\r\n  const renderRows = () => {\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.isError) {\r\n      const error = buscar.error as AxiosError\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {error.response?.data?.message || error.message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if(buscar.data){\r\n      const records = buscar.data.data.records\r\n      if(records.length == 0){\r\n        return  <tr>\r\n          <td className=\"bg-light text-center\" colSpan={100}>\r\n            No se encontraron resultados\r\n          </td>\r\n      </tr>\r\n      }\r\n      return records.map((medico, index) => {\r\n        return <tr key={medico.id}>\r\n          <th scope=\"row\">\r\n            {index + 1}\r\n          </th>\r\n          <td>\r\n            {medico.ciText}\r\n          </td>\r\n          <td>\r\n            {medico.nombreCompleto}\r\n          </td>\r\n          <td>\r\n            {medico.especialidad}\r\n          </td>\r\n          <td>\r\n            {medico.estadoText}\r\n          </td>\r\n          <td>\r\n            <RowOptions queryKey={queryKey} medico={medico} />\r\n          </td>\r\n        </tr>\r\n      })\r\n    }\r\n  }\r\n\r\n  \r\n  return <div className=\"px-1\">\r\n    <h1 style={{fontSize: \"1.75rem\"}}>Medicos</h1>\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\" >\r\n        <ProtectedContent\r\n          authorize={MedicoPolicy.view}\r\n        >\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={()=>{\r\n              showFilterForm(visible=>!visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={MedicoPolicy.register}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button\r\n              as={Link}\r\n              to={`${path}/registrar`}\r\n              className=\"d-flex align-items-center\">\r\n                <FaPlus className=\"mr-1\" /><span>Nuevo</span>\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={MedicoPolicy.view}\r\n    >\r\n      <Collapse in={filterFormVisible}>\r\n        <div>\r\n          <MedicosFilterForm onFilter={(filter)=>{\r\n            setFilter({...filter, ...getDefaultFilter()})\r\n            setPage(page => ({...page, current: 1}))\r\n          }} />\r\n        </div>\r\n      </Collapse>\r\n      <div className=\"d-flex\">\r\n        <div className=\"ml-auto mb-2\">          \r\n          <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n            <span>Mostrar</span>\r\n            <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n              const value = e.target.value\r\n              setPage((page) => ({\r\n                ...page,\r\n                size: parseInt(value)\r\n              }))\r\n            }}>\r\n              <option value={10}>10</option>\r\n              <option value={20}>20</option>\r\n              <option value={30}>30</option>\r\n              <option value={50}>50</option>\r\n              <option value={100}>100</option>\r\n            </Form.Control>\r\n            <span>filas</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <Table responsive>\r\n        <thead>\r\n          <tr>\r\n            <th style={{width: 1}}>#</th>\r\n            <th>C.I.</th>\r\n            <th>Nombre</th>\r\n            <th>Especialidad</th>\r\n            <th>Estado</th>\r\n            <th style={{width: 1}}></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {renderRows()}\r\n        </tbody>\r\n      </Table>\r\n      {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    </ProtectedContent>\r\n  </div>\r\n}","import { useEffect } from 'react'\r\nimport { Table } from 'react-bootstrap'\r\nimport { Medico, MedicosService } from '../services'\r\nimport { useQuery, useMutation } from 'react-query'\r\nimport { useLocation, useParams } from 'react-router-dom'\r\nimport { useLoggedUser } from \"../../../../commons/auth\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { MedicoPolicy } from \"../policies\"\r\n\r\nexport const MedicoView = ()=>{\r\n  const { pathname, state: locationState } = useLocation<{\r\n    medico?: Medico\r\n  }>()\r\n  const { id } = useParams<{\r\n    id: string\r\n  }>()\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const loader = useModal(\"queryLoader\")\r\n\r\n  const cargar = useQuery([\"cargar\", id], ()=>{\r\n    return MedicosService.load(parseInt(id))\r\n  }, {\r\n    enabled: !locationState?.medico,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n    onSuccess: () => {\r\n      loader.close()\r\n    },\r\n    onError: (error) => {\r\n      loader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const medico = cargar.data?.data || locationState?.medico\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isFetching){\r\n      loader.open({state: \"loading\"})\r\n    }\r\n  }, [cargar.isFetching])\r\n  \r\n  return <>\r\n    <h2 style={{fontSize: \"1.75rem\"}}>Medico</h2>\r\n      <Table>\r\n        <tbody>\r\n          <tr>\r\n            <th style={{width: 1}}>Carnet de identidad</th>\r\n            <td>: {medico?.ciText}</td>\r\n          </tr>\r\n          <tr>\r\n            <th style={{width: 1}}>Nombre</th>\r\n            <td>: {medico?.nombreCompleto}</td>\r\n          </tr>\r\n          <tr>\r\n            <th style={{width: 1}}>Regional</th>\r\n            <td>: {medico?.regional}</td>\r\n          </tr>\r\n          <tr>\r\n            <th style={{width: 1}}>Especialidad</th>\r\n            <td>: {medico?.especialidad}</td>\r\n          </tr>\r\n        </tbody>\r\n      </Table>\r\n  </>\r\n}","import { AxiosError } from 'axios'\r\nimport { useEffect, useState, useRef } from 'react'\r\nimport { Alert, Button, Col, Form, Spinner } from 'react-bootstrap'\r\nimport { Controller, useForm } from 'react-hook-form'\r\nimport { useMutation, useQuery, useQueryClient } from 'react-query'\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { Medico, MedicosService } from '../services'\r\nimport { useHistory, useParams } from 'react-router'\r\nimport { Regional, RegionalesTypeahead } from '../../../../commons/components'\r\nimport { Permisos, useLoggedUser } from '../../../../commons/auth'\r\nimport { useModal } from '../../../../commons/reusable-modal'\r\nimport { Especialidad, EspecialidadesTypeahead } from './EspecialidadesTypeahead'\r\n\r\ntype Inputs = {\r\n  tipo: string\r\n  ci: string\r\n  ciComplemento: string\r\n  apellidoPaterno: string\r\n  apellidoMaterno: string\r\n  nombres: string\r\n  especialidad: Especialidad[]\r\n  regional: Regional[]\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  tipo: yup.number().label(\"tipo\").oneOf([1, 2]),\r\n  ci: yup.number().label(\"número de carnet\").typeError(\"El ${path} no es un numero valido\"),\r\n  ciComplemento: yup.string().label(\"número complemento\").transform(value => value === \"\" ? null : value).trim()\r\n    .uppercase().nullable().notRequired()\r\n    .length(2)\r\n    .matches(/(?=.*[A-Z])(?=.*[0-9])/, \"El complemento del carnet esta conformado por un numero y una letra. (No confundir con el expedido)\"),\r\n  apellidoPaterno: yup.string().label(\"apellido paterno\").trim().when(\"apellidoMaterno\", {\r\n    is: (apellidoMaterno: string) => !apellidoMaterno,\r\n    then: yup.string().required(\"Debe proporcionar al menos un apellido\"),\r\n    otherwise: yup.string().nullable().notRequired()\r\n  }),\r\n  apellidoMaterno: yup.string().label(\"apellido materno\").trim().emptyStringToNull().when(\"apellidoPaterno\", {\r\n    is: (apellidoPaterno: string) => !apellidoPaterno,\r\n    then: yup.string().required(\"Debe proporcionar al menos un apellido\"),\r\n    otherwise: yup.string().emptyStringToNull().notRequired()\r\n  }),\r\n  nombres: yup.string().label(\"nombres\").trim().required(),\r\n  especialidad: yup.array().length(1, \"Debe indicar una especialidad\"),\r\n  regional: yup.array().length(1, \"Debe indicar una regional\")\r\n}, [[\"apellidoMaterno\", \"apellidoPaterno\"]])\r\n\r\nexport const MedicosForm = ()=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    medico?: Medico\r\n    ignoreAuthorization?: boolean\r\n  }>()\r\n\r\n  const modal = useModal(\"queryLoader\")\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const [regionales, setRegionales] = useState<Regional[]>([])\r\n  const [especialidades, setEspecialidades] = useState<Especialidad[]>([])\r\n\r\n  const continueRef = useRef<boolean>(false)\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    clearErrors,\r\n    setError,\r\n    setValue,\r\n    reset,\r\n    watch,\r\n    control,\r\n    formState,\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      especialidad: [],\r\n      regional: []\r\n    }\r\n  })\r\n\r\n  console.log(\"Errors\", watch())\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const guardar = useMutation((inputs: Inputs)=>{ \r\n    return id ? MedicosService.actualizar(parseInt(id), \r\n      parseInt(inputs.tipo),\r\n      {\r\n        raiz: parseInt(inputs.ci),\r\n        complemento: inputs.ciComplemento\r\n      },\r\n      inputs.apellidoPaterno,\r\n      inputs.apellidoMaterno,\r\n      inputs.nombres,\r\n      inputs.especialidad![0].id,\r\n      inputs.regional![0].id\r\n    ) : MedicosService.registrar(\r\n      parseInt(inputs.tipo),\r\n      {\r\n        raiz: parseInt(inputs.ci),\r\n        complemento: inputs.ciComplemento\r\n      },\r\n      inputs.apellidoPaterno,\r\n      inputs.apellidoMaterno,\r\n      inputs.nombres,\r\n      inputs.especialidad![0].id,\r\n      inputs.regional![0].id\r\n    )\r\n  }, {\r\n    onSuccess: ()=>{\r\n      reset()\r\n      queryClient.invalidateQueries(\"medicos.buscar\")\r\n      if(!continueRef.current)\r\n        history.replace(\"/clinica/medicos\", {\r\n          ignoreAuthorization: true\r\n        })\r\n    },\r\n    onError: (error) => {\r\n      if((error as AxiosError)?.response?.status == 422){\r\n        const {errors} = (error as AxiosError).response?.data\r\n        Object.keys(errors).forEach((key: any)=>{\r\n          let localKey = key\r\n          setError(localKey, {type: \"serverError\", message: errors[key]})\r\n        })\r\n      }\r\n    }\r\n  })\r\n\r\n  const cargar = useQuery([\"medicos.cargar\", id], ()=>{\r\n    return MedicosService.load(parseInt(id as string))\r\n  }, {\r\n    enabled: !!id && !history.location.state?.medico,\r\n    refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n    onSuccess: () => {\r\n      modal.close()\r\n    },\r\n    onError: (error) => {\r\n      modal.open({\r\n        state: \"error\",\r\n        error: error\r\n      })\r\n    }\r\n  })\r\n\r\n  const medico = cargar.data?.data || history.location.state?.medico\r\n\r\n  useEffect(()=>{\r\n    if(medico){\r\n      setValue(\"tipo\", String(medico.tipo))\r\n      setValue(\"ci\", String(medico.ci.raiz))\r\n      setValue(\"ciComplemento\", medico.ci.complemento)\r\n      setValue(\"apellidoPaterno\", medico.apellidoPaterno)\r\n      setValue(\"apellidoMaterno\", medico.apellidoMaterno)\r\n      setValue(\"nombres\", medico.nombres)\r\n    }\r\n  }, [medico])\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isFetching){\r\n      modal.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n  }, [cargar.isFetching])\r\n\r\n  useEffect(()=>{\r\n    if(medico && regionales.length){\r\n      setValue(\"regional\", regionales.filter(r=>r.id == medico.regionalId))\r\n    }\r\n  }, [medico, regionales])\r\n\r\n  useEffect(()=>{\r\n    if(medico && especialidades.length){\r\n      setValue(\"especialidad\", especialidades.filter(r=>r.id == medico.especialidadId))\r\n    }\r\n  }, [medico, especialidades])\r\n\r\n  return <Form id=\"medico-form\"\r\n    onSubmit={handleSubmit((inputs)=>{\r\n      guardar.mutate(inputs)\r\n    })}\r\n  >\r\n    <h1 style={{fontSize: \"2rem\"}}>{id ? \"Actualizar\" : \"Registrar Medico\"}</h1>\r\n    {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n      {guardar.isError ? (guardar.error as AxiosError).response?.data?.message || (guardar.error as AxiosError).message : \"Guardado\"}\r\n    </Alert> : null}\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Tipo</Form.Label>\r\n        <div>\r\n          <Form.Check inline type=\"radio\" value=\"1\" label=\"Empleado\" {...register(\"tipo\")} />\r\n          <Form.Check inline type=\"radio\" value=\"2\" label=\"Proveedor\" {...register(\"tipo\")} />\r\n        </div>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} md={4} xs={8}>\r\n        <Form.Label>Carnet de identidad</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.ci}\r\n          {...register(\"ci\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.ci?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} md={2} xs={4}>\r\n        <Form.Label>Complemento</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.ciComplemento}\r\n          {...register(\"ciComplemento\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.ciComplemento?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} md={4}>\r\n        <Form.Label>Apellido Paterno</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.apellidoPaterno}\r\n          {...register(\"apellidoPaterno\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.apellidoPaterno?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} md={4}>\r\n        <Form.Label>Apellido Materno</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.apellidoMaterno}\r\n          {...register(\"apellidoMaterno\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.apellidoMaterno?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} md={4}>\r\n        <Form.Label>Nombres</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formState.errors.nombres}\r\n          {...register(\"nombres\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formState.errors.nombres?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} md={8}>\r\n        <Form.Label>Especialidad</Form.Label>\r\n        <Controller\r\n          name=\"especialidad\"\r\n          control={control}\r\n          render={({field, fieldState})=>{\r\n            return <>\r\n              <EspecialidadesTypeahead\r\n                id=\"medicos-form/especialidades-typeahead\"\r\n                onLoad={(especialidades)=>setEspecialidades(especialidades)}\r\n                feedback={fieldState.error?.message}\r\n                isInvalid={!!fieldState.error}\r\n                selected={field.value}\r\n                onChange={field.onChange}\r\n                onBlur={field.onBlur}\r\n              />\r\n            </>\r\n          }}\r\n        />\r\n      </Form.Group>\r\n      <Form.Group as={Col} md={4}>\r\n        <Form.Label>Regional</Form.Label>\r\n        <Controller\r\n          name=\"regional\"\r\n          control={control}\r\n          render={({field, fieldState})=>{\r\n            return <>\r\n              <RegionalesTypeahead\r\n                id=\"medicos-form/regionales-typeahead\"\r\n                onLoad={(regionales)=>setRegionales(regionales)}\r\n                filterBy={(regional) => loggedUser?.can(Permisos.REGISTRAR_MEDICOS) || loggedUser?.regionalId == regional.id}\r\n                feedback={fieldState.error?.message}\r\n                className={fieldState.error ? \"is-invalid\" : \"\"}\r\n                isInvalid={!!fieldState.error}\r\n                selected={field.value}\r\n                onChange={field.onChange}\r\n                onBlur={field.onBlur}\r\n              />\r\n            </>\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <div className=\"m-n1\">\r\n      {!id ? <Button \r\n        className=\"m-1\"\r\n        type=\"submit\"\r\n        onClick={()=>{\r\n          continueRef.current = true\r\n        }}\r\n      >\r\n        {guardar.isLoading && continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar y continuar\r\n      </Button> : null}\r\n      <Button\r\n        className=\"m-1\"\r\n        type=\"submit\"\r\n        onClick={()=>{\r\n          continueRef.current = false\r\n        }}\r\n      >\r\n        {guardar.isLoading && !continueRef.current ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button>\r\n      <Button \r\n        className=\"m-1\"\r\n        variant=\"secondary\"\r\n        type=\"reset\"\r\n        onClick={()=>{\r\n          setValue(\"regional\", [])\r\n          setValue(\"especialidad\", [])\r\n          clearErrors()\r\n        }}\r\n      >Limpiar</Button>\r\n    </div>\r\n  </Form>\r\n}","import { Permisos, User } from \"../../../../commons/auth\";\r\n\r\nexport const ProveedorPolicy = {\r\n  index: function(user: User){\r\n    return user?.canAny([\r\n      Permisos.VER_PROVEEDORES,\r\n      Permisos.VER_PROVEEDORES_REGIONAL,\r\n      Permisos.REGISTRAR_PROVEEDORES,\r\n      Permisos.REGISTRAR_PROVEEDORES_REGIONAL\r\n    ])\r\n  },\r\n  register: function(user: User){\r\n    return user?.canAny([\r\n      Permisos.REGISTRAR_PROVEEDORES,\r\n      Permisos.REGISTRAR_PROVEEDORES_REGIONAL\r\n    ])\r\n  },\r\n  edit: function(user: User){\r\n    return user?.canAny([\r\n      Permisos.EDITAR_PROVEEDORES,\r\n      Permisos.EDITAR_PROVEEDORES_REGIONAL\r\n    ])\r\n  },\r\n  view: function(user: User){\r\n    return user?.canAny([\r\n      Permisos.VER_PROVEEDORES,\r\n      Permisos.VER_PROVEEDORES_REGIONAL\r\n    ])\r\n  },\r\n  baja: function(user: User){\r\n    return user?.canAny([\r\n      // Permisos.BAJA_PROVEEDORES,\r\n      // Permisos.BAJA_PROVEEDORES_REGIONAL\r\n    ])\r\n  }\r\n}","import { Button, Col, Form } from \"react-bootstrap\"\r\nimport { useForm, Controller } from \"react-hook-form\"\r\nimport { Prestacion, PrestacionesTypeahead } from \"../../solicitud_atencion_externa/components/PrestacionesTypeahead\"\r\nimport { Filter } from \"../services\"\r\n\r\ntype Inputs ={\r\n  tipos: {\r\n    medicos: boolean\r\n    empresas: boolean\r\n  }\r\n  nombre: string\r\n  prestaciones: Prestacion[]\r\n}\r\n\r\ntype Props = {\r\n  onFilter: (filter: Filter) => void\r\n}\r\n\r\nexport const ProveedoresFilterForm = (props: Props)=>{\r\n  const {\r\n    control,\r\n    handleSubmit,\r\n    register,\r\n    reset\r\n  } = useForm<Inputs>({\r\n    defaultValues: {\r\n      prestaciones: []\r\n    }\r\n  })\r\n  return <Form onSubmit={handleSubmit((inputs)=>{\r\n    const filter: Filter = {tipos: []}\r\n    if(inputs.tipos.medicos) filter.tipos!.push(1)\r\n    if(inputs.tipos.empresas) filter.tipos!.push(2)\r\n    if(!filter.tipos!.length) delete filter.tipos\r\n    if(inputs.nombre) filter.nombre = inputs.nombre\r\n    if(inputs.prestaciones.length) filter.prestacionesId = inputs.prestaciones.map(p=>p.id)\r\n    console.log(filter)\r\n    props.onFilter(filter)\r\n  })}>\r\n    <Form.Row>\r\n      <Form.Group as={Col} xs=\"auto\">\r\n        <Form.Label>Tipo</Form.Label>\r\n        <div>\r\n          <Form.Check inline\r\n            type=\"checkbox\"\r\n            label=\"Médicos\"\r\n            {...register(\"tipos.medicos\")} />\r\n          <Form.Check inline\r\n            type=\"checkbox\"\r\n            label=\"Empresas\"\r\n            {...register(\"tipos.empresas\")} />\r\n        </div>\r\n      </Form.Group>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control {...register(\"nombre\")}/>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Prestaciones contratadas</Form.Label>\r\n        <Controller\r\n          control={control}\r\n          name=\"prestaciones\"\r\n          render={({field: {ref, value, ...field}})=>{\r\n            return <PrestacionesTypeahead\r\n              id=\"proveedores-filter/prestaciones\"\r\n              multiple\r\n              selected={value}\r\n              {...field}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button type=\"submit\">Aplicar</Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Button variant=\"secondary\" onClick={()=>reset()}>Limpiar</Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import { useEffect } from \"react\"\r\nimport { Dropdown } from \"react-bootstrap\"\r\n// import { FaEdit } from \"react-icons/fa\"\r\nimport { useMutation, useQueryClient, QueryKey } from \"react-query\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { Proveedor, ProveedoresService } from \"../services\"\r\nimport { ProveedorPolicy } from \"../policies\"\r\n\r\ntype Props = {\r\n  proveedor: Proveedor\r\n  queryKey: QueryKey\r\n}\r\nexport const RowOptions = ({proveedor}: Props) => {\r\n\r\n  return <Dropdown style={{position: \"initial\"}}>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-proveedores-${proveedor.id}`}\r\n    />\r\n\r\n    <Dropdown.Menu>\r\n      <ProtectedContent\r\n        authorize={ProveedorPolicy.view}\r\n      >\r\n        <Dropdown.Item as={Link} to={{\r\n          pathname: `/clinica/proveedores/${proveedor.id}`,\r\n          state: {\r\n            proveedor\r\n          }\r\n        }} ><span className=\"align-middle\">Ver</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n      <ProtectedContent\r\n        authorize={ProveedorPolicy.edit}\r\n      >\r\n        <Dropdown.Item as={Link} to={{\r\n          pathname: `/clinica/proveedores/${proveedor.id}/editar`,\r\n          state: {\r\n            proveedor\r\n          }\r\n        }} ><span className=\"align-middle\">Editar</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n    </Dropdown.Menu>\r\n  </Dropdown>\r\n}","import { AxiosError } from \"axios\"\r\nimport { useState } from \"react\"\r\nimport { Button, Col, Collapse, Form, Spinner, Table } from \"react-bootstrap\"\r\nimport { FaFilter, FaSync, FaPlus } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport { Pagination } from \"../../../../commons/components\"\r\nimport { ProtectedContent, useLoggedUser, Permisos } from \"../../../../commons/auth\"\r\nimport { ProveedorPolicy } from \"../policies\"\r\nimport { ProveedoresService, Filter } from \"../services\"\r\nimport { ProveedoresFilterForm } from \"./ProveedoresFilterForm\"\r\nimport { RowOptions } from \"./RowOptions\"\r\n\r\nexport const ProveedoresIndex = () => {\r\n  const { pathname: path } = useLocation()\r\n  const [page, setPage] = useState({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser(\r\n\r\n  )\r\n\r\n  const getDefaultFilter = () => {\r\n    const filter: Filter = {}\r\n    if (!loggedUser?.can(Permisos.VER_PROVEEDORES)) {\r\n      if (loggedUser?.can(Permisos.VER_PROVEEDORES_REGIONAL)) {\r\n        filter.regionalId = loggedUser.regionalId;\r\n      }\r\n    }\r\n    return filter\r\n  }\r\n\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n  const [filterFormVisible, showFilterForm] = useState(false)\r\n\r\n  const queryKey = [\"proveedores.buscar\", filter, page]\r\n  const buscar = useQuery(queryKey, () => {\r\n    return ProveedoresService.buscar(filter, page)\r\n  }, {\r\n    enabled: ProveedorPolicy.view(loggedUser),\r\n    // refetchOnMount: false,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const total = buscar.data?.data?.meta?.total || 0\r\n\r\n  const renderRows = () => {\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    else if (buscar.isError) {\r\n      const error = buscar.error as AxiosError\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {error.response?.data?.message || error.message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.data) {\r\n      const records = buscar.data.data.records\r\n      if (records.length == 0) {\r\n        return <tr>\r\n          <td className=\"bg-light text-center\" colSpan={100}>\r\n            No se encontraron resultados\r\n          </td>\r\n        </tr>\r\n      }\r\n      return records.map((item, index) => {\r\n        return <tr key={item.id}>\r\n          <th scope=\"row\" style={{ width: 1, lineHeight: \"26px\" }}>\r\n            {index + 1}\r\n          </th>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {item.nombre || item.nombreCompleto}\r\n          </td>\r\n          <td style={{ lineHeight: \"26px\" }}>\r\n            {item.tipo}\r\n          </td>\r\n          <td>\r\n            <RowOptions proveedor={item} queryKey={queryKey} />\r\n          </td>\r\n        </tr>\r\n      })\r\n    }\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <h1 style={{ fontSize: \"1.75rem\" }}>Proveedores</h1>\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\" >\r\n        <ProtectedContent\r\n          authorize={ProveedorPolicy.view}\r\n        >\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={() => {\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={() => {\r\n              showFilterForm(visible => !visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={ProveedorPolicy.register}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button\r\n              as={Link}\r\n              to={`${path}/registrar`}\r\n              className=\"d-flex align-items-center\">\r\n              <FaPlus className=\"mr-1\" /><span>Nuevo</span>\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={ProveedorPolicy.view}\r\n    >\r\n      <div className=\"mb-2\">\r\n        <Collapse in={filterFormVisible}>\r\n          <div>\r\n            <ProveedoresFilterForm onFilter={(filter) => {\r\n              setFilter({...getDefaultFilter(), ...filter})\r\n              setPage(page=>({ ...page, current: 1 }))\r\n            }} />\r\n          </div>\r\n        </Collapse>\r\n      </div>\r\n      <div className=\"d-flex\">\r\n        <div className=\"ml-auto mb-2\">\r\n          <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n            <span>Mostrar</span>\r\n            <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n              const value = e.target.value\r\n              setPage((page) => ({\r\n                ...page,\r\n                size: parseInt(value)\r\n              }))\r\n            }}>\r\n              <option value={10}>10</option>\r\n              <option value={20}>20</option>\r\n              <option value={30}>30</option>\r\n              <option value={50}>50</option>\r\n              <option value={100}>100</option>\r\n            </Form.Control>\r\n            <span>filas</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <Table responsive>\r\n        <thead className=\"text-center\">\r\n          <tr>\r\n            <th style={{ width: 1 }}>#</th>\r\n            <th>Nombre</th>\r\n            <th style={{ width: 1 }}>Tipo</th>\r\n            <th style={{ width: 1 }}></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {renderRows()}\r\n        </tbody>\r\n      </Table>\r\n      {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    </ProtectedContent>\r\n  </div>\r\n}","import { Permisos, useLoggedUser } from \"../../../../commons/auth\";\r\n\r\nexport const ContratoPolicy = {\r\n  index: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.VER_CONTRATOS_PROVEEDOR,\r\n      Permisos.VER_CONTRATOS_PROVEEDOR_REGIONAL,\r\n      Permisos.REGISTRAR_CONTRATOS_PROVEEDOR,\r\n      Permisos.REGISTRAR_CONTRATOS_PROVEEDOR_REGIONAL\r\n    ])\r\n  },\r\n  register: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.REGISTRAR_CONTRATOS_PROVEEDOR,\r\n      Permisos.REGISTRAR_CONTRATOS_PROVEEDOR_REGIONAL\r\n    ])\r\n  },\r\n  consumir: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.CONSUMIR_CONTRATOS_PROVEEDOR,\r\n      Permisos.CONSUMIR_CONTRATOS_PROVEEDOR_REGIONAL\r\n    ])\r\n  },\r\n  extender: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.EXTENDER_CONTRATOS_PROVEEDOR,\r\n      Permisos.EXTENDER_CONTRATOS_PROVEEDOR_REGIONAL\r\n    ])\r\n  },\r\n  view: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.VER_CONTRATOS_PROVEEDOR,\r\n      Permisos.VER_CONTRATOS_PROVEEDOR_REGIONAL\r\n    ])\r\n  },\r\n  anular: function(user: ReturnType<typeof useLoggedUser>){\r\n    return user?.canAny([\r\n      Permisos.ANULAR_CONTRATOS_PROVEEDOR,\r\n      Permisos.ANULAR_CONTRATOS_PROVEEDOR_REGIONAL\r\n    ])\r\n  }\r\n}","import { apiClient, Page, PaginatedResponse } from \"../../../../commons/services\"\r\nimport { AxiosPromise } from 'axios'\r\nimport { keysToUnderscore } from \"../../../../commons/utils\"\r\n\r\nexport type Contrato = {\r\n  id: number\r\n  inicio: string\r\n  fin: string\r\n  extension: string\r\n  estadoText: string\r\n  prestaciones: {\r\n    id: number\r\n    nombre: string\r\n  }[]  \r\n}\r\n\r\nexport type Filter = {\r\n  desde?: string\r\n  hasta?: string\r\n  estado?: number\r\n}\r\n\r\n\r\nclass ContratoService {\r\n  buscar(idProveedor: number, filter: {}, page: Page): AxiosPromise<PaginatedResponse<Contrato>>{\r\n    return apiClient.get(`proveedores/${idProveedor}/contratos`, {\r\n      params: keysToUnderscore({filter, page})\r\n    })\r\n  }\r\n  cargar(idProveedor: number, idContrato: number): AxiosPromise<Contrato>{\r\n    return apiClient.get(`proveedores/${idProveedor}/contratos/${idContrato}`)\r\n  }\r\n  registrar(idProveedor: number, contrato: {\r\n    inicio: string\r\n    fin?: string\r\n    prestacionIds: number[]\r\n  }): AxiosPromise<Contrato>{\r\n    return apiClient.post(`proveedores/${idProveedor}/contratos`, keysToUnderscore(contrato))\r\n  }\r\n  consumir(idProveedor: number, idContrato: number): AxiosPromise<Contrato>{\r\n    return apiClient.put(`proveedores/${idProveedor}/contratos/${idContrato}/consumir`)\r\n  }\r\n  extender(idProveedor: number, idContrato: number): AxiosPromise<Contrato>{\r\n    return apiClient.put(`proveedores/${idProveedor}/contratos/${idContrato}/extender`)\r\n  }\r\n  anular(idProveedor: number, idContrato: number): AxiosPromise<Contrato>{\r\n    return apiClient.put(`proveedores/${idProveedor}/contratos/${idContrato}/anular`)\r\n  }\r\n}\r\n\r\nexport const ContratosService = new ContratoService()","import { Button, Col, Form } from \"react-bootstrap\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { Filter } from \"../services\"\r\n\r\ntype Inputs = {\r\n  desde: string\r\n  hasta: string\r\n}\r\n\r\ntype Props = {\r\n  onApply: (filter: Filter) => void\r\n}\r\n\r\nexport const ContratoFilterForm = (props: Props)=>{\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    reset\r\n  } = useForm<Inputs>()\r\n\r\n  return <Form onSubmit={handleSubmit((inputs)=>{\r\n    const filter: Filter = {}\r\n    if(inputs.desde) filter.desde = inputs.desde\r\n    if(inputs.hasta) filter.hasta = inputs.hasta\r\n    props.onApply(filter)\r\n  })}>\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Desde</Form.Label>\r\n        <Form.Control type=\"date\" {...register(\"desde\")} />\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Hasta</Form.Label>\r\n        <Form.Control type=\"date\" {...register(\"hasta\")} />\r\n      </Form.Group>\r\n      {/* <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control {...register(\"estado\")} />\r\n      </Form.Group> */}\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button type=\"submit\">Aplicar</Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Button variant=\"secondary\" onClick={()=>reset()}>Limpiar</Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </Form>\r\n}","import { useEffect } from \"react\"\r\nimport { Dropdown } from \"react-bootstrap\"\r\nimport { useMutation, useQueryClient, QueryKey } from \"react-query\"\r\nimport { Link, useParams } from \"react-router-dom\"\r\nimport { VerticalEllipsisDropdownToggle } from \"../../../../commons/components\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ProtectedContent } from \"../../../../commons/auth/components\"\r\nimport { Contrato, ContratosService } from \"../services\"\r\nimport { ContratoPolicy } from \"../policies\"\r\n\r\ntype Props = {\r\n  contrato: Contrato\r\n  queryKey: QueryKey\r\n}\r\nexport const RowOptions = ({contrato, queryKey}: Props) => {\r\n\r\n  const { id: idProveedor } = useParams<{\r\n    id: string\r\n  }>()\r\n\r\n  const queryLoader = useModal(\"queryLoader\")\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const extender = useMutation(\"contratos.extender\", ()=>{\r\n    return ContratosService.extender(parseInt(idProveedor), contrato.id)\r\n  }, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(queryKey)\r\n      queryLoader.close()\r\n    },\r\n    onError: (error) => {\r\n      queryLoader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const consumir = useMutation(\"contratos.consumir\", ()=>{\r\n    return ContratosService.consumir(parseInt(idProveedor), contrato.id)\r\n  }, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(queryKey)\r\n      queryLoader.close()\r\n    },\r\n    onError: (error) => {\r\n      queryLoader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const anular = useMutation(\"contratos.anular\", ()=>{\r\n    return ContratosService.anular(parseInt(idProveedor), contrato.id)\r\n  }, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(queryKey)\r\n      queryLoader.close()\r\n    },\r\n    onError: (error) => {\r\n      queryLoader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  return <Dropdown style={{position: \"initial\"}}>\r\n    <Dropdown.Toggle as={VerticalEllipsisDropdownToggle}\r\n      variant=\"link\" id={`dropdown-contratos-proveedor-${contrato.id}`}\r\n    />\r\n    <Dropdown.Menu>\r\n      <ProtectedContent\r\n        authorize={ContratoPolicy.view}\r\n      >\r\n        <Dropdown.Item as={Link} to={{\r\n          pathname: `/clinica/proveedores/${idProveedor}/contratos/${contrato.id}`,\r\n          state: {\r\n            contrato\r\n          }\r\n        }} ><span className=\"align-middle\">Ver</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n      <ProtectedContent\r\n        authorize={ContratoPolicy.extender}\r\n      >\r\n        <Dropdown.Item onClick={()=>{\r\n          queryLoader.open({state:\"loading\"})\r\n          extender.mutate()\r\n        }}><span className=\"align-middle\">Extender</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n      <ProtectedContent\r\n        authorize={ContratoPolicy.consumir}\r\n      >\r\n        <Dropdown.Item onClick={()=>{\r\n          queryLoader.open({state:\"loading\"})\r\n          consumir.mutate()\r\n        }}><span className=\"align-middle\">Consumir</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n      <ProtectedContent\r\n        authorize={ContratoPolicy.anular}\r\n      >\r\n        <Dropdown.Item onClick={()=>{\r\n          queryLoader.open({state:\"loading\"})\r\n          anular.mutate()\r\n        }}><span className=\"align-middle\">Anular</span></Dropdown.Item>\r\n      </ProtectedContent>\r\n    </Dropdown.Menu>\r\n  </Dropdown>\r\n}","import { AxiosError } from \"axios\"\r\nimport { useEffect, useState, useRef } from \"react\"\r\nimport { Button, Col, Collapse, Form, Spinner, Table } from \"react-bootstrap\"\r\nimport { FaFilter, FaSync, FaPlus } from \"react-icons/fa\"\r\nimport { useQuery } from \"react-query\"\r\nimport { Link, useLocation, useParams } from \"react-router-dom\"\r\nimport { Pagination } from \"../../../../commons/components\"\r\nimport { ProtectedContent, useLoggedUser, Permisos } from \"../../../../commons/auth\"\r\nimport { ContratoPolicy } from \"../policies\"\r\nimport { ContratosService, Filter } from \"../services\"\r\nimport { ContratoFilterForm } from \"./ContratoFilterForm\"\r\nimport { RowOptions } from \"./RowOptions\"\r\n\r\nexport const ContratosIndex = () => {\r\n  const { id: idProveedor } = useParams<{\r\n    id: string\r\n  }>()\r\n  const { pathname: path } = useLocation()\r\n  const [page, setPage] = useState({\r\n    current: 1,\r\n    size: 10\r\n  })\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const getDefaultFilter = () => {\r\n    const filter: Filter = {}\r\n    return filter\r\n  }\r\n\r\n  const [filter, setFilter] = useState<Filter>(getDefaultFilter)\r\n  const [filterFormVisible, showFilterForm] = useState(false)\r\n\r\n  const queryKey = [\"contratos.buscar\", idProveedor, filter, page]\r\n  const buscar = useQuery(queryKey, () => {\r\n    return ContratosService.buscar(parseInt(idProveedor), filter, page)\r\n  }, {\r\n    enabled: ContratoPolicy.view(loggedUser),\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false\r\n  })\r\n\r\n  const total = buscar.data?.data?.meta?.total || 0\r\n\r\n  const renderRows = () => {\r\n    if (buscar.isFetching) {\r\n      return <tr>\r\n        <td className=\"bg-light text-center\" colSpan={100}>\r\n          <Spinner className=\"mr-2\" variant=\"primary\" animation=\"border\" size=\"sm\" />\r\n          Cargando\r\n        </td>\r\n      </tr>\r\n    }\r\n    else if (buscar.isError) {\r\n      const error = buscar.error as AxiosError\r\n      return <tr>\r\n        <td className=\"bg-danger text-light text-center\" colSpan={100}>\r\n          {error.response?.data?.message || error.message}\r\n        </td>\r\n      </tr>\r\n    }\r\n    if (buscar.data) {\r\n      const records = buscar.data.data.records\r\n      if (records.length == 0) {\r\n        return <tr>\r\n          <td className=\"bg-light text-center\" colSpan={100}>\r\n            No se encontraron resultados\r\n          </td>\r\n        </tr>\r\n      }\r\n      return records.map((item, index) => {\r\n        return <tr key={item.id}>\r\n          <th scope=\"row\">{index + 1}</th>\r\n          <td>{item.inicio}</td>\r\n          <td>{item.fin || \"Indefinido\"}</td>\r\n          <td>{item.extension}</td>\r\n          <td>{item.estadoText}</td>\r\n          <td><RowOptions contrato={item} queryKey={queryKey} /></td>\r\n        </tr>\r\n      })\r\n    }\r\n  }\r\n\r\n  return <div className=\"px-1\">\r\n    <div className=\"d-flex my-2\">\r\n      <Form.Row className=\"ml-auto flex-nowrap\" >\r\n        <ProtectedContent\r\n          authorize={ContratoPolicy.view}\r\n        >\r\n          <Col className={\"pr-0\"} xs=\"auto\" >\r\n            <Button onClick={() => {\r\n              buscar.refetch()\r\n            }}><FaSync /></Button>\r\n          </Col>\r\n          <Col className={\"pr-0\"} xs=\"auto\" >\r\n            <Button onClick={() => {\r\n              showFilterForm(visible => !visible)\r\n            }}><FaFilter /></Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n        <ProtectedContent\r\n          authorize={ContratoPolicy.register}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button\r\n              as={Link}\r\n              to={`/clinica/proveedores/${idProveedor}/contratos/registrar`}\r\n              className=\"d-flex align-items-center\">\r\n              <FaPlus className=\"mr-2\"/><span>Nuevo</span>\r\n            </Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row>\r\n    </div>\r\n    <ProtectedContent\r\n      authorize={ContratoPolicy.view}\r\n    >\r\n      <Collapse in={filterFormVisible}>\r\n        <div>\r\n          <ContratoFilterForm onApply={(filter) => {\r\n            setFilter(filter)\r\n            setPage(page => ({...page, current: 1}))\r\n          }} />\r\n        </div>\r\n      </Collapse>\r\n      <div className=\"d-flex\">\r\n        <div className=\"ml-auto mb-2\">\r\n          <div className=\"d-flex flex-row flex-nowrap align-items-center\">\r\n            <span>Mostrar</span>\r\n            <Form.Control className=\"mx-2\" as=\"select\" value={page.size} onChange={(e) => {\r\n              const value = e.target.value\r\n              setPage((page) => ({\r\n                ...page,\r\n                size: parseInt(value)\r\n              }))\r\n            }}>\r\n              <option value={10}>10</option>\r\n              <option value={20}>20</option>\r\n              <option value={30}>30</option>\r\n              <option value={50}>50</option>\r\n              <option value={100}>100</option>\r\n            </Form.Control>\r\n            <span>filas</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <Table responsive>\r\n        <thead>\r\n          <tr>\r\n            <th style={{width: 1}}>#</th>\r\n            <th>Inicio</th>\r\n            <th>Fin</th>\r\n            <th>Extensión</th>\r\n            <th>Estado</th>\r\n            <th style={{width: 1}}></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {renderRows()}\r\n        </tbody>\r\n      </Table>\r\n      {buscar.status === \"success\" ? <div className=\"d-flex flex-row\">\r\n        <span className=\"mr-auto\">{`Se encontraron ${total} resultados`}</span>\r\n        <Pagination\r\n          current={page.current}\r\n          total={Math.ceil((total - page.size) / page.size) + 1}\r\n          onChange={(current) => setPage((page) => ({ ...page, current }))}\r\n        />\r\n      </div> : null}\r\n    </ProtectedContent>\r\n  </div>\r\n}","import { useEffect, useRef } from 'react'\r\nimport { AxiosError } from 'axios'\r\nimport { Table } from 'react-bootstrap'\r\nimport { useModal } from '../../../../commons/reusable-modal'\r\nimport { ContratosService, Contrato } from '../services'\r\nimport { useQuery, useMutation } from 'react-query'\r\nimport { Link, useLocation, useParams } from 'react-router-dom'\r\n\r\n\r\nexport const ContratoView = ()=>{\r\n  const { idProveedor, id } = useParams<{\r\n    idProveedor: string\r\n    id: string\r\n  }>()\r\n\r\n  const loader = useModal(\"queryLoader\")\r\n\r\n  const cargar = useQuery([\"contratos.cargar\", idProveedor, id], ()=>{\r\n    return ContratosService.cargar(parseInt(idProveedor), parseInt(id))\r\n  }, {\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n    onSuccess: () => {\r\n      loader.close()\r\n    },\r\n    onError: (error) => {\r\n      loader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const contrato = cargar.data?.data\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isFetching){\r\n      loader.open({state: \"loading\"})\r\n    }\r\n  }, [cargar.isFetching])\r\n  \r\n  return <>\r\n    <h2 style={{fontSize: \"1.75rem\"}}>Contrato</h2>\r\n    \r\n    <Table responsive>\r\n        <tbody>\r\n          <tr>\r\n            <th scope=\"row\" style={{width:1}}>Inicio</th>\r\n            <td>{(contrato?.inicio as any)}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\" style={{width:1}}>Fin</th>\r\n            <td>{contrato && (contrato.fin || \"Indefinido\")}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\" style={{width:1}}>Extensión</th>\r\n            <td>{contrato && (contrato.extension || \"Sin extension\")}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\" style={{width: 1}}>Estado</th>\r\n            <td>{contrato?.estadoText}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\" style={{width:1}}>Prestaciones</th>\r\n            <td>\r\n              <ul>\r\n                {contrato?.prestaciones?.map((prestacion)=>{\r\n                  return <li>{prestacion.nombre}</li>\r\n                })}\r\n              </ul>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </Table>\r\n  </>\r\n}","import { useEffect } from \"react\"\r\nimport { Button, Col, Form, ListGroup, Row } from \"react-bootstrap\"\r\nimport { Controller, useFieldArray, useFormContext } from \"react-hook-form\"\r\nimport { FaTrash } from \"react-icons/fa\"\r\nimport { PrestacionesTypeahead } from \"../../solicitud_atencion_externa/components/PrestacionesTypeahead\"\r\nimport { Prestacion } from \"../../prestaciones/services\"\r\nimport { ArancelesControl } from \"./ArancelesControl\"\r\n\r\nexport type Inputs = {\r\n  prestaciones: {\r\n    id: string\r\n    prestacion: Prestacion\r\n  }[]\r\n}\r\n\r\nexport const PrestacionesContratadasControl = ()=>{\r\n  const {\r\n    register,\r\n    control,\r\n    trigger,\r\n    formState: { errors: formErrors },\r\n    watch\r\n  } = useFormContext<Inputs>()\r\n\r\n  const {\r\n    fields,\r\n    append,\r\n    remove\r\n  } = useFieldArray({\r\n    name: \"prestaciones\",\r\n    control\r\n  })\r\n\r\n  return <div>\r\n    <h2 style={{fontSize: \"1.25rem\"}}>Prestaciones contratadas</h2>\r\n    <Form.Row>\r\n      <Form.Group as={Col} xs={12}>\r\n        <PrestacionesTypeahead\r\n          id={`proveedor-contrato/prestaciones`}\r\n          filterBy={(prestacion) => {\r\n            const prestaciones = watch(\"prestaciones\")\r\n            return !prestaciones.some(p=>p.prestacion?.id == prestacion.id)\r\n          }}\r\n          selected={[]}\r\n          onChange={(prestacion) => {\r\n            if(prestacion.length){\r\n              append({prestacion: prestacion[0]})\r\n            }\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <div  className=\"mb-3\" style={{maxHeight: 240, overflowY: \"auto\"}}>\r\n      <ListGroup className={formErrors.prestaciones ? \"is-invalid\" : \"\"}>\r\n        {fields.map((field, index)=>{\r\n          return <ListGroup.Item key={field.id} className={\"py-1 px-2\"}>\r\n            <Form.Row>\r\n              <Col className=\"d-flex align-items-center\">\r\n                {field.prestacion.nombre}\r\n              </Col>\r\n              <Col className=\"d-flex align-items-center\" xs={\"auto\"}>\r\n                <Button variant=\"danger\" onClick={() => remove(index)}><FaTrash/></Button>\r\n              </Col>\r\n            </Form.Row>\r\n          </ListGroup.Item>\r\n        })}\r\n      </ListGroup>\r\n      <Form.Control.Feedback type=\"invalid\">{\r\n        //@ts-ignore\r\n        formErrors.prestaciones?.message}</Form.Control.Feedback>\r\n    </div>\r\n  </div>\r\n}","import { useEffect, useState } from \"react\"\r\nimport { Alert, Button, Col, Form, Spinner } from \"react-bootstrap\"\r\nimport { Controller, FormProvider, useForm } from \"react-hook-form\"\r\nimport { useParams, useHistory } from \"react-router\"\r\nimport { useMutation, useQueryClient } from \"react-query\"\r\nimport { AxiosError } from \"axios\"\r\nimport { yupResolver } from \"@hookform/resolvers/yup\"\r\nimport * as yup from \"yup\"\r\nimport { PrestacionesContratadasControl, Inputs as PCInputs } from \"./PrestacionesContratadasControl\"\r\n// import { Regional, RegionalesTypeahead } from '../../../../commons/components'\r\nimport { Permisos, useLoggedUser } from \"../../../../commons/auth\"\r\nimport { ContratosService } from \"../services\"\r\n\r\nexport type Inputs = {\r\n  inicio?: string\r\n  fin?: string\r\n  // regional?: Regional[]\r\n} & PCInputs\r\n\r\ntype Props = {\r\n  onSubmit?: (data: Inputs) => void\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  inicio: yup.date().label(\"fecha de inicio\").emptyStringTo().typeError(\"No es una fecha valida\")\r\n    .required(),\r\n  fin: yup.date().label(\"fecha de finalizacion\").emptyStringTo(null).typeError(\"No es una fecha valida\")\r\n    .min(yup.ref(\"inicio\"), \"La fecha de finalizacion debe ser mayor a la fecha de inicio\")\r\n    .nullable().notRequired(),\r\n  // regional: yup.array().length(1, \"Debe seleccionar una regional\"),\r\n  prestaciones: yup.array().of(yup.object().shape({\r\n    prestacion: yup.object().required()//array().length(1, \"Debe seleccionar una prestacion\")\r\n  })).min(1, \"Debe seleccionar al menos una prestación\")\r\n})\r\n\r\nexport const ContratoForm = ({onSubmit}: Props)=>{\r\n  const {idProveedor} = useParams<{\r\n    idProveedor: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    tab: string\r\n  }>()\r\n\r\n  const loggedUser = useLoggedUser()\r\n  \r\n  // const [regionales, setRegionales] = useState<Regional[]>([])\r\n\r\n  const methods = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      prestaciones: [],\r\n    }\r\n  })\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    formState,\r\n    control,\r\n    watch\r\n  } = methods\r\n\r\n  const formErrors = formState.errors\r\n\r\n  console.log(\"Errors\", formErrors)\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const guardar = useMutation((values: Inputs)=>{\r\n    return ContratosService.registrar(parseInt(idProveedor), {\r\n      inicio: (values.inicio! as any).toISOString().split(\"T\")[0],\r\n      fin: (values.fin as any)?.toISOString().split(\"T\")[0],\r\n      prestacionIds: values.prestaciones.map(p=>p.prestacion.id)\r\n    })\r\n  }, {\r\n    onSuccess: ({data}) => {\r\n      queryClient.invalidateQueries(\"contratos.buscar\")\r\n      history.replace(`/clinica/proveedores/${parseInt(idProveedor)}`, {\r\n        tab: \"contratos\"\r\n      })\r\n    }\r\n  })\r\n\r\n  return <FormProvider {...methods}>\r\n    <Form id=\"proveedor-contrato-form\" onSubmit={handleSubmit(onSubmit || ((values)=>{\r\n      console.log(\"Values\", values)\r\n      guardar.mutate(values)\r\n    }))}>\r\n      <h1 style={{fontSize: \"1.75rem\"}}>Contrato</h1>\r\n      {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n      {guardar.isError ? (guardar.error as AxiosError).response?.data?.message || (guardar.error as AxiosError).message : \"Guardado\"}\r\n      </Alert> : null}\r\n      <Form.Row>\r\n        <Form.Group as={Col} sm={6}>\r\n          <Form.Label>Inicio</Form.Label>\r\n          <Form.Control type=\"date\"\r\n            isInvalid={!!formState.errors.inicio}\r\n            {...register(\"inicio\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formState.errors.inicio?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} sm={6}>\r\n          <Form.Label>Fin</Form.Label>\r\n          <Form.Control type=\"date\"\r\n            isInvalid={!!formState.errors.fin}\r\n            {...register(\"fin\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formState.errors.fin?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n      </Form.Row>\r\n      {/* <Form.Row>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Regional</Form.Label>\r\n          <Controller\r\n            name=\"regional\"\r\n            control={control}\r\n            render={({field, fieldState})=>{\r\n              return <>\r\n                <RegionalesTypeahead\r\n                  id=\"proveedor-contrato-form/regionales-typeahead\"\r\n                  onLoad={(regionales)=>setRegionales(regionales)}\r\n                  filterBy={(regional) => {\r\n                    if(idProveedor){\r\n                      if(loggedUser.can(Permisos.REGISTRAR_CONTRATO_PROVEEDOR) \r\n                        || (loggedUser.can(Permisos.REGISTRAR_CONTRATO_PROVEEDOR_REGIONAL) && loggedUser.regionalId == regional.id)) return true\r\n                    }\r\n                    else{\r\n                      if(loggedUser.can(Permisos.REGISTRAR_PROVEEDORES) \r\n                        || (loggedUser.can(Permisos.REGISTRAR_PROVEEDORES_REGIONAL) && loggedUser.regionalId == regional.id)) return true\r\n                    }\r\n                    return false\r\n                  }}\r\n                  feedback={fieldState.error?.message}\r\n                  isInvalid={!!fieldState.error}\r\n                  selected={field.value}\r\n                  onChange={field.onChange}\r\n                  onBlur={field.onBlur}\r\n                />\r\n              </>\r\n            }}\r\n          />\r\n        </Form.Group>\r\n      </Form.Row> */}\r\n      <Form.Row>\r\n        <Col>\r\n          <PrestacionesContratadasControl />\r\n        </Col>\r\n      </Form.Row>\r\n      {!onSubmit ? <Button type=\"submit\">\r\n        {guardar.isLoading ? <Spinner className=\"mr-1\" animation=\"border\" size=\"sm\"/> : null}\r\n        <span className=\"align-middle\">Guardar</span>\r\n      </Button> : null}\r\n    </Form>\r\n  </FormProvider>\r\n}","import { useEffect, useRef } from 'react'\r\nimport { Button, Col, Form, Row, Tab, Tabs, Table } from 'react-bootstrap'\r\nimport { MapContainer, Marker, Popup, TileLayer } from \"react-leaflet\"\r\nimport L, { LatLngExpression } from \"leaflet\"\r\nimport { Proveedor, ProveedoresService } from '../services'\r\nimport { useQuery } from 'react-query'\r\nimport { Link, useLocation, useParams } from 'react-router-dom'\r\nimport { useLoggedUser, ProtectedContent } from \"../../../../commons/auth\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { ContratosIndex } from \"../../contratos/components\"\r\nimport { ProveedorPolicy } from \"../policies\"\r\n\r\nimport icon from 'leaflet/dist/images/marker-icon.png';\r\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png';\r\n\r\nlet DefaultIcon = L.icon({\r\n    iconUrl: icon,\r\n    shadowUrl: iconShadow,\r\n    iconSize: [25,41],\r\n    iconAnchor: [12,41]\r\n});\r\n\r\nL.Marker.prototype.options.icon = DefaultIcon;\r\n\r\nexport const ProveedorView = ()=>{\r\n  const { pathname, state: locationState } = useLocation<{\r\n    proveedor?: Proveedor,\r\n    tab?: string\r\n  }>()\r\n  const { id } = useParams<{\r\n    id: string\r\n  }>()\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const loader = useModal(\"queryLoader\")\r\n\r\n  const cargar = useQuery([\"cargar\", id], ()=>{\r\n    return ProveedoresService.cargar(parseInt(id))\r\n  }, {\r\n    enabled: !locationState?.proveedor,\r\n    refetchOnWindowFocus: false,\r\n    refetchOnReconnect: false,\r\n    onSuccess: () => {\r\n      loader.close()\r\n    },\r\n    onError: (error) => {\r\n      loader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const proveedor = cargar.data?.data || locationState?.proveedor\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isFetching){\r\n      loader.open({state: \"loading\"})\r\n    }\r\n  }, [cargar.isFetching])\r\n\r\n\r\n  const renderGeneralInfo = ()=>{\r\n    return <dl className=\"form-row\">\r\n        <dt className=\"col-sm-3 col-md-2\">Tipo</dt>\r\n        <dd className=\"col-sm-9 col-md-10\">{proveedor?.tipoId == 1 ? \"Médico\" : proveedor?.tipoId == 2 ? \"Empresa\" : null}</dd>\r\n        <dt className=\"col-sm-3 col-md-2\" style={{width: '1px'}}>NIT</dt>\r\n        <dd className=\"col-sm-9 col-md-10\">{proveedor?.nit}</dd>\r\n      {proveedor?.tipoId == 1 ? \r\n        <>\r\n            <dt className=\"col-sm-3 col-md-2\" style={{width: 1}}>Carnet de identidad</dt>\r\n            <dd className=\"col-sm-9 col-md-10\">{proveedor?.ciText}</dd>\r\n            <dt className=\"col-sm-3 col-md-2\" style={{width: 1}}>Nombre</dt>\r\n            <dd className=\"col-sm-9\">{proveedor?.nombreCompleto}</dd>\r\n            <dt className=\"col-sm-3 col-md-2\">Especialidad</dt>\r\n            <dd className=\"col-sm-9 col-md-10\">{proveedor?.especialidad?.nombre}</dd>\r\n        </> : (proveedor?.tipoId == 2 ? <>\r\n          <dt className=\"col-sm-3 col-md-2\" style={{width: 1}}>Nombre</dt>\r\n          <dd className=\"col-sm-9 col-md-10\">{proveedor?.nombre}</dd>\r\n        </> : null)}\r\n        <dt className=\"col-sm-3 col-md-2\">Regional</dt>\r\n        <dd className=\"col-sm-9 col-md-10\">{proveedor?.regional?.nombre}</dd>\r\n    </dl>\r\n  }\r\n\r\n  const renderContactInfo = ()=>{\r\n    if(!proveedor) return null\r\n    const position: LatLngExpression = proveedor.ubicacion && [proveedor.ubicacion.latitud, proveedor.ubicacion.longitud]\r\n    return <Row className=\"px-2 py-3\">\r\n      <Col sm={6}>\r\n        <dl className=\"form-row\">\r\n          <dt className=\"col-lg-5 col-xl-4\">Departamento</dt>\r\n          <dd className=\"col-lg-7 col-xl-8\">{proveedor.municipio?.provincia?.departamento?.nombre || 'No proporcionado'}</dd>\r\n          <dt className=\"col-lg-5 col-xl-4\">Provincia</dt>\r\n          <dd className=\"col-lg-7 col-xl-8\">{proveedor.municipio?.provincia?.nombre || 'No proporcionado'}</dd>\r\n          <dt className=\"col-lg-5 col-xl-4\">Municipio</dt>\r\n          <dd className=\"col-lg-7 col-xl-8\">{proveedor.municipio?.nombre || 'No proporcionado'}</dd>\r\n          <dt className=\"col-lg-5 col-xl-4\">Dirección</dt>\r\n          <dd className=\"col-lg-7 col-xl-8\">{proveedor.direccion || 'No proporcionado'}</dd>\r\n          <dt className=\"col-lg-5 col-xl-4\">Teléfono 1</dt>\r\n          <dd className=\"col-lg-7 col-xl-8\">{proveedor.telefono1 || 'No proporcionado'}</dd>\r\n          <dt className=\"col-lg-5 col-xl-4\">Teléfono 2</dt>\r\n          <dd className=\"col-lg-7 col-xl-8\">{proveedor.telefono2 || 'No proporcionado'}</dd>\r\n        </dl>\r\n      </Col>\r\n      <Col sm={6}>\r\n        <MapContainer center={position} zoom={14} dragging={false} scrollWheelZoom={false} doubleClickZoom={false} style={{minHeight: 200, height: \"100%\"}}>\r\n          <TileLayer\r\n            attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n          />\r\n          {position ? <Marker position={position}>\r\n            <Popup>\r\n              <a href={`geo:${position.join(\",\")}`}>Abrir con</a>\r\n            </Popup>\r\n          </Marker> : null}\r\n        </MapContainer>\r\n      </Col>\r\n    </Row>\r\n  }\r\n  \r\n  return <>\r\n    <h2 style={{fontSize: \"1.75rem\"}}>Proveedor</h2>\r\n    <div id=\"general-info\">\r\n      {renderGeneralInfo()}      \r\n      {proveedor ? <Form.Row>\r\n        <ProtectedContent\r\n          authorize={ProveedorPolicy.edit}\r\n        >\r\n          <Col xs=\"auto\">\r\n            <Button as={Link} to={{\r\n              pathname: `/clinica/proveedores/${proveedor.id}/editar`,\r\n              state: {\r\n                proveedor\r\n              }\r\n            }} >Editar</Button>\r\n          </Col>\r\n        </ProtectedContent>\r\n      </Form.Row> : null}\r\n    </div>\r\n    \r\n    <Tabs className={\"my-2\"} defaultActiveKey={locationState?.tab}>\r\n      <Tab eventKey=\"informacion-contacto\" title=\"Informacion de Contacto\">\r\n        {renderContactInfo()}\r\n        {proveedor ? <Form.Row>\r\n          <ProtectedContent\r\n            authorize={ProveedorPolicy.edit}\r\n          >\r\n            <Col xs=\"auto\">\r\n              <Button as={Link} to={{\r\n                pathname: `/clinica/proveedores/${proveedor.id}/editar-contacto`,\r\n                state: {\r\n                  proveedor\r\n                }\r\n              }} >Editar</Button>\r\n            </Col>\r\n          </ProtectedContent>\r\n        </Form.Row> : null}\r\n      </Tab>\r\n      <Tab eventKey=\"contratos\" title=\"Contratos\">\r\n        <ContratosIndex />\r\n      </Tab>\r\n    </Tabs>\r\n  </>\r\n}","import { useEffect, useState } from \"react\"\r\nimport { Button, Form, Col, Spinner } from \"react-bootstrap\"\r\nimport { Controller, useForm } from \"react-hook-form\"\r\nimport { useParams, useHistory } from \"react-router\"\r\nimport { yupResolver } from \"@hookform/resolvers/yup\"\r\nimport * as yup from \"yup\"\r\nimport { useMutation, useQueryClient } from \"react-query\"\r\nimport { Regional, RegionalesTypeahead } from '../../../../commons/components'\r\nimport { Permisos, useLoggedUser } from '../../../../commons/auth'\r\nimport { Proveedor, ProveedoresService } from '../services'\r\n\r\nexport type Inputs = {\r\n  tipo?: 2\r\n  nit?: number,\r\n  nombre?: string,\r\n  regional?: Regional[]\r\n}\r\n\r\ntype Props = {\r\n  proveedor?: Proveedor,\r\n  onSubmit?: (data: Inputs) => void\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  nit: yup.number().label(\"NIT\")\r\n  .emptyStringTo()\r\n  .typeError(\"El ${path} no es un numero valido\")\r\n  .required(),\r\n  // .nullable()\r\n  // .notRequired(),\r\n  nombre: yup.string().required().max(150),  \r\n  regional: yup.array().length(1, \"Debe indicar una regional\")\r\n})\r\n\r\nexport const ProveedorEmpresaForm = ({proveedor, onSubmit}: Props)=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory()\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const {\r\n    control,\r\n    formState,\r\n    handleSubmit,\r\n    setValue,\r\n    register\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      tipo: 2,\r\n      nit: proveedor?.nit as number,\r\n      nombre: proveedor?.nombre as string,\r\n      regional: []\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n\r\n  const [ regionales, setRegionales ] = useState<Regional[]>([])\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const guardar = useMutation((values: Inputs)=>{\r\n    return ProveedoresService.actualizar(parseInt(id!), {\r\n      tipoId: values.tipo!,\r\n      nit: values.nit!,\r\n      nombre: values.nombre!,\r\n      regionalId: values.regional![0].id\r\n    })\r\n  }, {\r\n    onSuccess: ({data}) => {\r\n      queryClient.invalidateQueries(\"proveedor.buscar\")\r\n      history.replace(`/clinica/proveedores/${data.id}`)\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(proveedor && regionales.length){\r\n      setValue(\"regional\", regionales.filter(r=>r.id == proveedor.regionalId))\r\n    }\r\n  }, [proveedor, regionales])\r\n\r\n  return <Form id=\"proveedor-form\" onSubmit={handleSubmit(onSubmit || ((values)=>{\r\n    guardar.mutate(values)\r\n  }))}>\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>NIT</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formErrors.nit}\r\n          {...register(\"nit\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.nit?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={8}>\r\n        <Form.Label>Nombre</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formErrors.nombre}\r\n          {...register(\"nombre\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.nombre?.message}</Form.Control.Feedback>\r\n      </Form.Group>      \r\n      <Form.Group as={Col} md={4}>\r\n          <Form.Label>Regional</Form.Label>\r\n          <Controller\r\n            name=\"regional\"\r\n            control={control}\r\n            render={({field, fieldState})=>{\r\n              return <>\r\n                <RegionalesTypeahead\r\n                  id=\"proveedor-form/regionales-typeahead\"\r\n                  onLoad={(regionales)=>setRegionales(regionales)}\r\n                  filterBy={(regional) => {\r\n                    if(loggedUser?.can(Permisos.REGISTRAR_PROVEEDORES)) return true \r\n                    if(loggedUser?.can(Permisos.REGISTRAR_PROVEEDORES_REGIONAL) && loggedUser?.regionalId == regional.id) return true\r\n                    if(id && loggedUser?.can(Permisos.EDITAR_PROVEEDORES)) return true\r\n                    if(id && loggedUser?.can(Permisos.EDITAR_PROVEEDORES_REGIONAL) && loggedUser?.regionalId == regional.id) return true\r\n                    return false\r\n                  }}\r\n                  feedback={fieldState.error?.message}\r\n                  isInvalid={!!fieldState.error}\r\n                  selected={field.value}\r\n                  onChange={field.onChange}\r\n                  onBlur={field.onBlur}\r\n                />\r\n              </>\r\n            }}\r\n          />\r\n        </Form.Group>\r\n      \r\n    </Form.Row>\r\n    {!onSubmit ? <Button\r\n        type=\"submit\"\r\n      >\r\n        {guardar.isLoading ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button> : null}\r\n  </Form>\r\n}","import { AxiosError, AxiosResponse } from 'axios'\r\nimport { useEffect, useState, useRef } from 'react'\r\nimport { Alert, Button, Col, Form, InputGroup, Modal, Spinner } from 'react-bootstrap'\r\nimport { Controller, useForm } from 'react-hook-form'\r\nimport { useMutation, useQueryClient } from 'react-query'\r\nimport { useHistory, useParams } from 'react-router'\r\nimport { yupResolver } from \"@hookform/resolvers/yup\"\r\nimport * as yup from 'yup'\r\nimport { Especialidad, EspecialidadesTypeahead } from '../../medicos/components/EspecialidadesTypeahead'\r\nimport { Regional, RegionalesTypeahead } from '../../../../commons/components'\r\nimport { Permisos, useLoggedUser } from '../../../../commons/auth'\r\nimport { Proveedor, ProveedoresService } from '../services'\r\n\r\nexport type Inputs = {\r\n  tipo?: 1\r\n  nit?: number\r\n  ci?: number\r\n  ciComplemento?: string\r\n  apellidoPaterno?: string\r\n  apellidoMaterno?: string\r\n  nombres?: string\r\n  especialidad?: Especialidad[]\r\n  regional?: Regional[]\r\n}\r\n\r\ntype Props = {\r\n  proveedor?: Proveedor,\r\n  onSubmit?: (data: Inputs) => void\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  nit: yup.number().label(\"NIT\")\r\n    .emptyStringToNull()\r\n    .typeError(\"El ${path} no es un numero valido\")\r\n    .nullable()\r\n    .notRequired(),\r\n  ci: yup.number().label(\"número de carnet\")\r\n    .emptyStringToNull()\r\n    .typeError(\"El ${path} no es un numero valido\")\r\n    .nullable()\r\n    .required(),\r\n  ciComplemento: yup.string().transform(value => value === \"\" ? null : value).trim().uppercase().nullable().notRequired()\r\n    .length(2).matches(/[0-1A-Z]/),\r\n  apellidoPaterno: yup.string().label(\"apellido paterno\").trim().when(\"apellidoMaterno\", {\r\n    is: (apellidoMaterno: string) => !apellidoMaterno,\r\n    then: yup.string().required(\"Debe proporcionar al menos un apellido\").max(50)\r\n  }),\r\n  apellidoMaterno: yup.string().label(\"apellido materno\").trim().when(\"apellidoPaterno\", {\r\n    is: (apellidoPaterno: string) => !apellidoPaterno,\r\n    then: yup.string().required(\"Debe proporcionar al menos un apellido\").max(50)\r\n  }),\r\n  nombres: yup.string().label(\"nombres\").trim().required().label(\"'Nombres'\").max(50),\r\n  especialidad: yup.array().length(1, \"Debe indicar una especialidad\"),\r\n  regional: yup.array().length(1, \"Debe indicar una regional\")\r\n}, [[\"apellidoMaterno\", \"apellidoPaterno\"]])\r\n\r\n\r\nexport const ProveedorMedicoForm = ({proveedor, onSubmit}: Props)=>{\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory()\r\n\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const [especialidades, setEspecialidades] = useState<Especialidad[]>([])\r\n  const [regionales, setRegionales] = useState<Regional[]>([])\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    setValue,\r\n    control,\r\n    formState,\r\n    watch\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      tipo: 1,\r\n      nit: proveedor?.nit as number,\r\n      ci: proveedor?.ci,\r\n      ciComplemento: proveedor?.ciComplemento,\r\n      apellidoPaterno: proveedor?.apellidoPaterno||\"\",\r\n      apellidoMaterno: proveedor?.apellidoMaterno||\"\",\r\n      nombres: proveedor?.nombres||\"\",\r\n      especialidad: [],\r\n      regional: [],\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  const guardar = useMutation((inputs: Inputs)=>{\r\n    return ProveedoresService.actualizar(parseInt(id!), {\r\n      tipoId: 1,\r\n      nit: inputs.nit,\r\n      ci: inputs.ci!,\r\n      ciComplemento: inputs.ciComplemento,\r\n      apellidoPaterno: inputs.apellidoPaterno,\r\n      apellidoMaterno: inputs.apellidoMaterno,\r\n      nombres: inputs.nombres!,\r\n      especialidadId: inputs.especialidad![0].id,\r\n      regionalId: inputs.regional![0].id\r\n    })\r\n  }, {\r\n    onSuccess: ({data})=>{\r\n      queryClient.invalidateQueries(\"proveedor.buscar\")\r\n      history.replace(`/clinica/proveedores/${data.id}`)\r\n    }\r\n  })\r\n\r\n  useEffect(()=>{\r\n    if(proveedor && especialidades.length){\r\n      setValue(\"especialidad\", especialidades.filter(r=>r.id == proveedor.especialidadId))\r\n    }\r\n  }, [proveedor, especialidades])\r\n\r\n  useEffect(()=>{\r\n    if(proveedor && regionales.length){\r\n      setValue(\"regional\", regionales.filter(r=>r.id == proveedor.regionalId))\r\n    }\r\n  }, [proveedor, regionales])\r\n\r\n  console.log(\"Errors\", formErrors, watch())\r\n\r\n  return <>\r\n    <Form id=\"proveedor-form\"\r\n      onSubmit={handleSubmit(onSubmit || ((inputs)=>{\r\n        guardar.mutate(inputs)\r\n      }))}\r\n    >\r\n      {guardar.status == \"error\" || guardar.status == \"success\"  ? <Alert variant={guardar.isError ? \"danger\" : \"success\"}>\r\n        {guardar.isError ? (guardar.error as AxiosError).response?.data?.message || (guardar.error as AxiosError).message : \"Guardado\"}\r\n      </Alert> : null}\r\n      <Form.Row>\r\n        <Form.Group as={Col} md={4} xs={8}>\r\n          <Form.Label>NIT</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.nit}\r\n            {...register(\"nit\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.nit?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={4} xs={8}>\r\n          <Form.Label>Carnet de identidad</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.ci}\r\n            {...register(\"ci\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.ci?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={2} xs={4}>\r\n          <Form.Label>Complemento</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.ciComplemento}\r\n            {...register(\"ciComplemento\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.ciComplemento?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n      </Form.Row>\r\n      <Form.Row>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Apellido Paterno</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.apellidoPaterno}\r\n            {...register(\"apellidoPaterno\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.apellidoPaterno?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Apellido Materno</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.apellidoMaterno}\r\n            {...register(\"apellidoMaterno\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.apellidoMaterno?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Nombres</Form.Label>\r\n          <Form.Control\r\n            isInvalid={!!formErrors.nombres}\r\n            {...register(\"nombres\")}\r\n          />\r\n          <Form.Control.Feedback type=\"invalid\">{formErrors.nombres?.message}</Form.Control.Feedback>\r\n        </Form.Group>\r\n      </Form.Row>\r\n      <Form.Row>\r\n        <Form.Group as={Col} md={8}>\r\n          <Form.Label>Especialidad</Form.Label>\r\n          <Controller\r\n            name=\"especialidad\"\r\n            control={control}\r\n            render={({field, fieldState})=>{\r\n              return <>\r\n                <EspecialidadesTypeahead\r\n                  id=\"medicos-form/especialidades-typeahead\"\r\n                  align=\"left\"\r\n                  onLoad={(especialidades)=>setEspecialidades(especialidades)}\r\n                  feedback={fieldState.error?.message}\r\n                  className={formState.errors.especialidad ? \"is-invalid\" : \"\"}\r\n                  isInvalid={!!fieldState.error}\r\n                  selected={field.value}\r\n                  onChange={field.onChange}\r\n                  onBlur={field.onBlur}\r\n                />\r\n              </>\r\n            }}\r\n          />\r\n        </Form.Group>\r\n        <Form.Group as={Col} md={4}>\r\n          <Form.Label>Regional</Form.Label>\r\n          <Controller\r\n            name=\"regional\"\r\n            control={control}\r\n            render={({field, fieldState})=>{\r\n              return <>\r\n                <RegionalesTypeahead\r\n                  id=\"proveedor-form/regionales-typeahead\"\r\n                  onLoad={(regionales)=>setRegionales(regionales)}\r\n                  filterBy={(regional) => {\r\n                    if(loggedUser?.can(Permisos.REGISTRAR_PROVEEDORES)) return true \r\n                    if(loggedUser?.can(Permisos.REGISTRAR_PROVEEDORES_REGIONAL) && loggedUser?.regionalId == regional.id) return true\r\n                    if(id && loggedUser?.can(Permisos.EDITAR_PROVEEDORES)) return true\r\n                    if(id && loggedUser?.can(Permisos.EDITAR_PROVEEDORES_REGIONAL) && loggedUser?.regionalId == regional.id) return true\r\n                    return false\r\n                  }}\r\n                  feedback={fieldState.error?.message}\r\n                  isInvalid={!!fieldState.error}\r\n                  selected={field.value}\r\n                  onChange={field.onChange}\r\n                  onBlur={field.onBlur}\r\n                />\r\n              </>\r\n            }}\r\n          />\r\n        </Form.Group>\r\n      </Form.Row>\r\n      {!onSubmit ? <Button\r\n        type=\"submit\"\r\n      >\r\n        {guardar.isLoading ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n        Guardar\r\n      </Button> : null}\r\n    </Form>\r\n  </>\r\n}","\r\nimport { useState, useEffect } from \"react\"\r\nimport { Form, Col} from \"react-bootstrap\"\r\nimport { useHistory, useParams } from \"react-router\"\r\nimport { useQuery } from \"react-query\"\r\nimport { useModal } from \"../../../../commons/reusable-modal\"\r\nimport { Inputs as PEInputs, ProveedorEmpresaForm } from \"./ProveedorEmpresaForm\"\r\nimport { Inputs as ProveedorMedicoInput, ProveedorMedicoForm } from \"./ProveedorMedicoForm\"\r\nimport { Proveedor, ProveedoresService } from \"../services\"\r\n\r\nexport type { ProveedorMedicoInput }\r\n\r\nexport type Inputs = PEInputs | ProveedorMedicoInput\r\n\r\nexport const ProveedorForm = (props: { onSubmit?: (data: PEInputs | ProveedorMedicoInput) => void})=>{\r\n  const [tipo, setTipo] = useState(0)\r\n  const {id} = useParams<{\r\n    id?: string\r\n  }>()\r\n\r\n  const history = useHistory<{\r\n    proveedor: Proveedor\r\n  }>()\r\n\r\n  const loader = useModal(\"queryLoader\")\r\n\r\n  const cargar = useQuery([\"proveedor.cargar\", id], ()=>{\r\n    return ProveedoresService.cargar(parseInt(id!))\r\n  }, {\r\n    enabled: !!id && !history.location.state?.proveedor,\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: ()=>{\r\n      loader.close()\r\n    },\r\n    onError: (error) => {\r\n      loader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const proveedor = cargar.data?.data || history.location.state?.proveedor\r\n\r\n  useEffect(()=>{\r\n    if(proveedor){\r\n      setTipo(proveedor.tipoId)\r\n    }\r\n  }, [proveedor])\r\n\r\n  useEffect(()=>{\r\n    if(cargar.isLoading){\r\n      loader.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n  }, [cargar.isLoading])\r\n\r\n  const renderForm = () => {\r\n    if(tipo == 1) {\r\n      return <ProveedorMedicoForm proveedor={proveedor} \r\n        onSubmit={props.onSubmit}\r\n      />\r\n    } \r\n    if(tipo == 2){\r\n      return <ProveedorEmpresaForm proveedor={proveedor}\r\n        onSubmit={props.onSubmit}\r\n      />\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <>\r\n    <h1 style={{fontSize: \"1.75rem\"}}>{id ? \"Actualizacion de Proveedor\" : \"Registro de Proveedor\"}</h1>\r\n    <Form.Group as={Form.Row}>\r\n      <Form.Label column sm={\"auto\"}>Tipo de proveedor</Form.Label>\r\n      <Col className=\"d-flex\" xs={\"auto\"}>\r\n        <Form.Check disabled={!!id} inline type=\"radio\" label=\"Médico\" value={1} checked={tipo == 1} onChange={(e)=>{\r\n          if(e.target.checked && !id)\r\n            setTipo(1) \r\n        }} ></Form.Check>\r\n        <Form.Check disabled={!!id}  inline type=\"radio\" label=\"Empresa\" value={2} checked={tipo == 2} onChange={(e)=>{\r\n          if(e.target.checked && !id)\r\n            setTipo(2) \r\n        }} ></Form.Check>\r\n      </Col>\r\n    </Form.Group>\r\n    {renderForm()}\r\n  </>\r\n}","import { useState, useEffect } from \"react\"\r\nimport { AxiosError } from \"axios\"\r\nimport { Alert, Button, Col, Form, Spinner } from \"react-bootstrap\"\r\nimport { LatLngExpression } from \"leaflet\"\r\nimport { Controller, useForm } from \"react-hook-form\"\r\nimport { useHistory, useParams } from \"react-router-dom\"\r\nimport { useQuery, useMutation } from \"react-query\"\r\nimport { yupResolver } from '@hookform/resolvers/yup'\r\nimport * as yup from \"yup\"\r\nimport { Departamento, DepartamentosTypeahead, Provincia, ProvinciasTypeahead, Municipio, MunicipiosTypeahead, LocationInput } from \"../../../../commons/components\"\r\nimport { Permisos, useLoggedUser } from '../../../../commons/auth'\r\nimport { useModal } from '../../../../commons/reusable-modal'\r\nimport { Proveedor, ProveedoresService } from \"../services\"\r\n\r\nexport type Inputs = {\r\n  departamento?: Departamento[]\r\n  provincia?: Provincia[]\r\n  municipio?: Municipio[]\r\n  direccion?: string,\r\n  ubicacion?: LatLngExpression\r\n  telefono1?: number\r\n  telefono2?: number | null\r\n}\r\n\r\ntype Props = {\r\n  onSubmit?: (data: Inputs) => void\r\n  onOmit?: () => void\r\n}\r\n\r\nconst schema = yup.object().shape({\r\n  municipio: yup.array().label(\"municipio\").length(1, \"Debe indicar un municipio\"),\r\n  direccion: yup.string().label(\"dirección\").trim().required(),\r\n  ubicacion: yup.mixed().label(\"ubicación\").required(),\r\n  telefono1: yup.number().label(\"telefono 1\").typeError(\"No es un numero válido\")\r\n    .emptyStringTo().required(),\r\n  telefono2: yup.number().label(\"telefono 2\")\r\n    .emptyStringToNull()\r\n    .typeError(\"No es un numero válido\").nullable().notRequired()\r\n})\r\n\r\nexport const ContactoForm = (props: Props) => {\r\n  const params = useParams<{ idProveedor: string }>()\r\n  const { idProveedor: id } = params\r\n  console.log(\"Proveedores\", id)\r\n  const history = useHistory<{\r\n    proveedor?: Proveedor\r\n  }>()\r\n\r\n  const loader = useModal(\"queryLoader\")\r\n\r\n  const [departamentos, setDepartamentos] = useState<Departamento[]>([])\r\n  const [provincias, setProvincias] = useState<Provincia[]>([])\r\n  const [municipios, setMunicipios] = useState<Municipio[]>([])\r\n\r\n  const {\r\n    handleSubmit,\r\n    register,\r\n    control,\r\n    watch,\r\n    setError,\r\n    setValue,\r\n    formState\r\n  } = useForm<Inputs>({\r\n    mode: \"onBlur\",\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      departamento: [],\r\n      provincia: [],\r\n      municipio: [],\r\n      ubicacion: [-17.78629, -63.18117]\r\n    }\r\n  })\r\n\r\n  const formErrors = formState.errors\r\n\r\n  const cargar = useQuery([\"proveedor.cargar\", id], () => {\r\n    return ProveedoresService.cargar(parseInt(id))\r\n  }, {\r\n    enabled: !!id && !history.location.state?.proveedor,\r\n    refetchOnMount: false,\r\n    refetchOnReconnect: false,\r\n    refetchOnWindowFocus: false,\r\n    onSuccess: () => {\r\n      loader.close()\r\n    },\r\n    onError: (error) => {\r\n      loader.open({\r\n        state: \"error\",\r\n        error\r\n      })\r\n    }\r\n  })\r\n\r\n  const guardar = useMutation((values: Inputs) => {\r\n    let lat, lng\r\n    if (Array.isArray(values.ubicacion)) {\r\n      [lat, lng] = values.ubicacion!\r\n    }\r\n    else {\r\n      ({ lat, lng } = values.ubicacion!)\r\n    }\r\n\r\n    return ProveedoresService.actualizarInformacionDeContacto(parseInt(id), {\r\n      municipioId: values.municipio![0].id,\r\n      direccion: values.direccion!,\r\n      ubicacion: {\r\n        latitud: lat,\r\n        longitud: lng\r\n      },\r\n      telefono1: values.telefono1!,\r\n      telefono2: values.telefono2!\r\n    })\r\n  }, {\r\n    onSuccess: ({ data }) => {\r\n      history.replace(`/clinica/proveedores/${data.id}`)\r\n    },\r\n    onError: (error) => {\r\n      if (error?.response?.status == 422) {\r\n        const { errors } = error.response?.data\r\n        Object.keys(errors).forEach((key: any) => {\r\n          let localKey = key\r\n          // if(key == \"asegurado.id\") localKey = \"asegurado.matricula\"\r\n          setError(localKey, { type: \"serverError\", message: errors[key] })\r\n        })\r\n      }\r\n    }\r\n  })\r\n\r\n  const proveedor = history.location.state?.proveedor || cargar.data?.data\r\n\r\n  useEffect(() => {\r\n    setValue(\"direccion\", proveedor?.direccion || \"\")\r\n    const { latitud, longitud } = proveedor?.ubicacion || {\r\n      latitud: -17.78629,\r\n      longitud: -63.18117\r\n    }\r\n    setValue(\"ubicacion\", [latitud, longitud])\r\n    setValue(\"telefono1\", proveedor?.telefono1)\r\n    setValue(\"telefono2\", proveedor?.telefono2)\r\n  }, [proveedor])\r\n\r\n  useEffect(() => {\r\n    if (proveedor && municipios.length && provincias.length && departamentos.length) {\r\n      const municipio = municipios.find(m => m.id == proveedor?.municipioId)\r\n      const provincia = provincias.find(p => p.id == municipio?.provinciaId)\r\n      const departamento = departamentos.find(d => d.id == provincia?.departamentoId )\r\n      setValue(\"municipio\", municipio ? [municipio] : [])\r\n      setValue(\"provincia\", provincia ? [provincia] : [])\r\n      setValue(\"departamento\", departamento ? [departamento] : [])\r\n    }\r\n  }, [proveedor, departamentos, provincias, municipios])\r\n\r\n  useEffect(() => {\r\n    if (cargar.isLoading) {\r\n      loader.open({\r\n        state: \"loading\"\r\n      })\r\n    }\r\n  }, [cargar.isLoading])\r\n\r\n  const renderAlert = () => {\r\n    if (guardar.isSuccess) {\r\n      return <Alert variant=\"success\">\r\n        La operacion se realizó exitosamente\r\n      </Alert>\r\n    }\r\n    if (guardar.isError) {\r\n      const guardarError = guardar.error as AxiosError\r\n      return <Alert variant=\"danger\">\r\n        {guardarError ? guardarError.response?.data?.message || guardarError.message : \"\"}\r\n      </Alert>\r\n    }\r\n    return null\r\n  }\r\n\r\n  return <Form id=\"proveedor-contacto-form\" onSubmit={handleSubmit(props.onSubmit || ((data) => {\r\n    guardar.mutate(data)\r\n  }))}>\r\n    <h1 style={{ fontSize: \"1.75rem\" }}>Información de contacto</h1>\r\n    {renderAlert()}\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Departamento</Form.Label>\r\n        <Controller\r\n          name=\"departamento\"\r\n          control={control}\r\n          render={({ field, fieldState }) => {\r\n            return <DepartamentosTypeahead\r\n              id=\"contacto-form/departamentos\"\r\n              onLoad={(departamentos) => {\r\n                setDepartamentos(departamentos)\r\n              }}\r\n              feedback={fieldState.error?.message}\r\n              isInvalid={!!fieldState.error}\r\n              selected={field.value}\r\n              onChange={(value) => {\r\n                field.onChange(value)\r\n                setValue(\"provincia\", [])\r\n                setValue(\"municipio\", [])\r\n              }}\r\n              onBlur={field.onBlur}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Provincia</Form.Label>\r\n        <Controller\r\n          name=\"provincia\"\r\n          control={control}\r\n          render={({ field, fieldState }) => {\r\n            return <ProvinciasTypeahead\r\n              id=\"contacto-form/provincias\"\r\n              onLoad={(provincias) => {\r\n                setProvincias(provincias)\r\n              }}\r\n              filterBy={(provincia) => {\r\n                const departamento = watch(\"departamento\")\r\n                return !!departamento!.length && provincia.departamentoId == departamento![0].id\r\n              }}\r\n              feedback={fieldState.error?.message}\r\n              isInvalid={!!fieldState.error}\r\n              selected={field.value}\r\n              onChange={(value) => {\r\n                field.onChange(value)\r\n                setValue(\"municipio\", [])\r\n              }}\r\n              onBlur={field.onBlur}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Municipio</Form.Label>\r\n        <Controller\r\n          name=\"municipio\"\r\n          control={control}\r\n          render={({ field, fieldState }) => {\r\n            return <MunicipiosTypeahead\r\n              id=\"contacto-form/municipios\"\r\n              onLoad={(municipios) => {\r\n                setMunicipios(municipios)\r\n              }}\r\n              filterBy={(municipio) => {\r\n                const provincia = watch(\"provincia\")!\r\n                return !!provincia.length && municipio.provinciaId == provincia[0].id\r\n              }}\r\n              feedback={fieldState.error?.message}\r\n              isInvalid={!!fieldState.error}\r\n              selected={field.value}\r\n              onChange={field.onChange}\r\n              onBlur={field.onBlur}\r\n            />\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Direccion</Form.Label>\r\n        <Form.Control as=\"textarea\"\r\n          isInvalid={!!formErrors.direccion}\r\n          {...register(\"direccion\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.direccion?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col}>\r\n        <Form.Label>Ubicación</Form.Label>\r\n        <Controller\r\n          name=\"ubicacion\"\r\n          control={control}\r\n          render={({ field, fieldState }) => {\r\n            return <>\r\n              <LocationInput\r\n                isInvalid={!!fieldState.error}\r\n                center={field.value || [-17.78629, -63.18117]}\r\n                value={field.value!}\r\n                onChange={field.onChange}\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">{fieldState.error?.message}</Form.Control.Feedback>\r\n            </>\r\n          }}\r\n        />\r\n      </Form.Group>\r\n    </Form.Row>\r\n    <Form.Row>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Teléfono 1</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formErrors.telefono1}\r\n          {...register(\"telefono1\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.telefono1?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n      <Form.Group as={Col} sm={4}>\r\n        <Form.Label>Teléfono 2</Form.Label>\r\n        <Form.Control\r\n          isInvalid={!!formErrors.telefono2}\r\n          {...register(\"telefono2\")}\r\n        />\r\n        <Form.Control.Feedback type=\"invalid\">{formErrors.telefono2?.message}</Form.Control.Feedback>\r\n      </Form.Group>\r\n    </Form.Row>\r\n    {!props.onSubmit ? <Button type=\"submit\">\r\n      {guardar.isLoading ? <Spinner className=\"mr-2\" animation=\"border\" size=\"sm\" /> : null}\r\n      <span className=\"align-middle\">Guardar</span>\r\n    </Button> : null}\r\n  </Form>\r\n}","import { useState } from \"react\"\r\nimport { Button, Col, Form, Spinner, Table } from \"react-bootstrap\"\r\nimport StepWizard, { StepWizardChildProps } from \"react-step-wizard\"\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { useMutation, useQueryClient } from \"react-query\"\r\nimport { Inputs as ContratoInputs, ContratoForm } from \"../../contratos/components/ContratoForm\"\r\nimport { Inputs as ProveedorInputs, ProveedorMedicoInput, ProveedorForm } from \"./ProveedorForm\"\r\nimport { Inputs as ContactoInputs, ContactoForm } from \"./ContactoForm\"\r\nimport { ProveedoresService } from \"../services\"\r\n\r\n\r\nconst GeneralInfoStep = (props: Partial<StepWizardChildProps> & {\r\n  onSubmit: (data: ProveedorInputs) => void\r\n}) => {\r\n  return <>\r\n    <ProveedorForm onSubmit={(data) => {\r\n      props.onSubmit(data)\r\n      props.nextStep!()\r\n    }} />\r\n    <Form.Row>\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        <Button\r\n          type=\"submit\"\r\n          form=\"proveedor-form\"\r\n        >\r\n          Siguiente\r\n        </Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </>\r\n}\r\n\r\nconst ContactInfoStep = (props: Partial<StepWizardChildProps> & {\r\n  onSubmit: (data: ContactoInputs) => void\r\n}) => {\r\n  return <>\r\n    <ContactoForm onSubmit={(data) => {\r\n        props.onSubmit(data)\r\n        props.nextStep!()\r\n      }}\r\n    />\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button onClick={props.previousStep}>\r\n          Anterior\r\n        </Button>\r\n      </Col>\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        <Button variant=\"link\" \r\n          onClick={props.nextStep}>\r\n          Omitir\r\n        </Button>\r\n      </Col>\r\n      <Col xs=\"auto\">\r\n        <Button\r\n          type=\"submit\"\r\n          form=\"proveedor-contacto-form\"\r\n        >\r\n          Siguiente\r\n        </Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </>\r\n}\r\n\r\nconst ContractInfoStep = (props: Partial<StepWizardChildProps> & {\r\n  onSubmit: (data: ContratoInputs) => void\r\n}) => {\r\n  return <>\r\n    <ContratoForm onSubmit={(data) => {\r\n      props.onSubmit(data)\r\n      props.nextStep!()\r\n    }} />\r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button onClick={props.previousStep}>\r\n          Anterior\r\n        </Button>\r\n      </Col>\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        <Button\r\n          type=\"submit\"\r\n          form=\"proveedor-contrato-form\"\r\n        >\r\n          Siguiente\r\n        </Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </>\r\n}\r\n\r\nconst FinishStep = ({\r\n  generalInfo,\r\n  contactInfo,\r\n  contractInfo,\r\n  ...props\r\n}: Partial<StepWizardChildProps> & {\r\n  generalInfo: ProveedorInputs\r\n  contactInfo?: ContactoInputs\r\n  contractInfo: ContratoInputs\r\n}) => {\r\n\r\n  // console.log(generalInfo, contactInfo, contractInfo)\r\n\r\n  const history = useHistory()\r\n\r\n  const queryClient = useQueryClient()\r\n\r\n  function isMedico(data: ProveedorInputs): data is ProveedorMedicoInput{\r\n    return data.tipo == 1\r\n  }\r\n\r\n  const guardar = useMutation(()=>{\r\n\r\n    const general = isMedico(generalInfo) ? {\r\n      tipoId: generalInfo.tipo!,\r\n      nit: generalInfo.nit,\r\n      ci: generalInfo.ci!,\r\n      ciComplemento: generalInfo.ciComplemento,\r\n      apellidoPaterno: generalInfo.apellidoPaterno,\r\n      apellidoMaterno: generalInfo.apellidoMaterno,\r\n      nombres: generalInfo.nombres!,\r\n      especialidadId: generalInfo.especialidad![0].id,\r\n      regionalId: generalInfo.regional![0].id\r\n    } : {\r\n      tipoId: generalInfo.tipo!,\r\n      nit: generalInfo.nit,\r\n      nombre: generalInfo.nombre!,\r\n      regionalId: generalInfo.regional![0].id\r\n    }\r\n\r\n    let contacto\r\n    if(contactInfo){\r\n      let lat, lng\r\n      if(Array.isArray(contactInfo.ubicacion)){\r\n        [lat, lng] = contactInfo.ubicacion!\r\n      }\r\n      else{\r\n        ({lat, lng} = contactInfo.ubicacion!)\r\n      }\r\n      contacto = {\r\n        municipioId: contactInfo.municipio![0].id,\r\n        direccion: contactInfo.direccion!,\r\n        ubicacion: {\r\n          latitud: lat,\r\n          longitud: lng\r\n        },\r\n        telefono1: contactInfo.telefono1!,\r\n        telefono2: contactInfo.telefono2!\r\n      }\r\n    }\r\n\r\n    const contrato = {\r\n      inicio: (contractInfo.inicio! as any).toISOString().split(\"T\")[0],\r\n      fin: (contractInfo.fin as any)?.toISOString()?.split(\"T\")[0],\r\n      // regionalId: contractInfo.regional![0].id,\r\n      prestacionIds: contractInfo.prestaciones!.map(pc => pc.prestacion.id)\r\n    }\r\n\r\n\r\n\r\n    return ProveedoresService.registrar({\r\n      general, contacto, contrato\r\n    })\r\n  }, {\r\n    onSuccess: ({data})=>{\r\n      queryClient.invalidateQueries(\"proveedores.buscar\");\r\n      history.push(`/clinica/proveedores/${data.id}`)\r\n    }\r\n  })\r\n\r\n  if(!generalInfo || !contractInfo) return null\r\n\r\n  return <div>\r\n    <div>\r\n      <h2>Informacion general</h2>\r\n      <Table>\r\n        <tbody>\r\n          <tr>\r\n            <th scope=\"row\">Tipo de proveedor</th>\r\n            <td >{generalInfo.tipo == 1 ? \"Médico\" : generalInfo.tipo == 2 ? \"Empresa\" : null}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\" style={{width: '1px'}}>NIT</th>\r\n            <td>{generalInfo.nit}</td>\r\n          </tr>\r\n          {generalInfo.tipo == 1 ? \r\n            <>\r\n              <tr>\r\n                <th scope=\"row\" style={{width: 1}}>Carnet de identidad</th>\r\n                <td>{generalInfo.ci + (generalInfo.ciComplemento ? `-${generalInfo.ciComplemento}` : '')}</td>\r\n              </tr>\r\n              <tr>\r\n                <th scope=\"row\" style={{width: 1}}>Nombre</th>\r\n                <td>{(generalInfo.apellidoPaterno ? generalInfo.apellidoPaterno + ' ' : '') + (generalInfo.apellidoMaterno ? generalInfo.apellidoMaterno + ' ' : '') + generalInfo.nombres}</td>\r\n              </tr>\r\n              <tr>\r\n                <th scope=\"row\">Especialidad</th>\r\n                <td>{generalInfo?.especialidad![0].nombre}</td>\r\n              </tr>\r\n            </> :\r\n            (generalInfo?.tipo == 2 ?\r\n            <tr>\r\n              <th scope=\"row\" style={{width: 1}}>Nombre</th>\r\n              <td>{generalInfo?.nombre}</td>\r\n            </tr> : null)}\r\n          <tr>\r\n            <th scope=\"row\">Regional</th>\r\n            <td>{generalInfo.regional![0].nombre}</td>\r\n          </tr>\r\n        </tbody>\r\n      </Table>\r\n      <h2>Informacion de contacto</h2>\r\n      {contactInfo ? <Table>\r\n        <tbody>\r\n          <tr>\r\n            <th scope=\"row\">Municipio</th>\r\n            <td>{contactInfo.municipio![0].nombre}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\">Direccion</th>\r\n            <td>{contactInfo.direccion}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\">Ubicación</th>\r\n            <td>{Array.isArray(contactInfo.ubicacion) ?\r\n              `${contactInfo.ubicacion[0]}, ${contactInfo.ubicacion[1]}` :\r\n              `${contactInfo.ubicacion!.lat}, ${contactInfo.ubicacion!.lng}` }</td>\r\n          </tr>\r\n          <tr>\r\n            <th>Teléfono 1</th>\r\n            <td>{contactInfo.telefono1}</td>\r\n          </tr>\r\n          <tr>\r\n            <th>Telefono 2</th>\r\n            <td>{contactInfo.telefono2}</td>\r\n          </tr>\r\n        </tbody>\r\n      </Table> : \"Omitida\"}\r\n      <h2>Contrato</h2>\r\n      <Table>\r\n        <tbody>\r\n          <tr>\r\n            <th scope=\"row\">Inicio</th>\r\n            <td>{(contractInfo.inicio as any).toISOString().split(\"T\")[0]}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\">Fin</th>\r\n            <td>{(contractInfo.fin as any)?.toISOString().split(\"T\")[0]}</td>\r\n          </tr>\r\n          <tr>\r\n            <th scope=\"row\">Prestaciones</th>\r\n            <td>\r\n              <ul>\r\n                {contractInfo.prestaciones.map((element)=>{\r\n                  return <li>{element.prestacion.nombre}</li>\r\n                })}\r\n              </ul>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </Table>\r\n    </div>\r\n    \r\n    <Form.Row>\r\n      <Col xs=\"auto\">\r\n        <Button onClick={props.previousStep}>\r\n          Anterior\r\n        </Button>\r\n      </Col>\r\n      <Col className=\"ml-auto\" xs=\"auto\">\r\n        <Button\r\n          onClick={()=>{\r\n            guardar.mutate()\r\n          }}\r\n        >\r\n          {guardar.isLoading ? <Spinner animation=\"border\" size=\"sm\" />: null}\r\n          Guardar\r\n        </Button>\r\n      </Col>\r\n    </Form.Row>\r\n  </div>\r\n}\r\n\r\nexport const ProveedorWizard = () => {\r\n\r\n  const [generalInfo, setGeneralInfo] = useState<ProveedorInputs>()\r\n  const [contactInfo, setContactInfo] = useState<ContactoInputs>()\r\n  const [contractInfo, setContractInfo] = useState<ContratoInputs>()\r\n\r\n  return <StepWizard>\r\n    <GeneralInfoStep onSubmit={(data)=>{\r\n      setGeneralInfo(data)\r\n    }} />\r\n    <ContactInfoStep onSubmit={(data)=>{\r\n      setContactInfo(data)\r\n    }} />\r\n    <ContractInfoStep onSubmit={(data)=>{\r\n      setContractInfo(data)\r\n    }} />\r\n    <FinishStep \r\n      generalInfo={generalInfo!}\r\n      contactInfo={contactInfo}\r\n      contractInfo={contractInfo!}\r\n    />\r\n  </StepWizard>\r\n}","import { useMemo } from \"react\"\r\nimport { Route, Switch, useRouteMatch } from 'react-router-dom';\r\nimport SidebarLayout from '../../commons/components/layouts/SidebarLayout';\r\nimport { FaProcedures, /*FaCoins,*/ FaHandshake, FaUserMd } from 'react-icons/fa';  \r\nimport { GiRodOfAsclepius } from 'react-icons/gi';  \r\nimport { BiTransfer } from 'react-icons/bi';\r\nimport ListaMoraIndex from './mora/components/ListaMoraIndex';\r\nimport ListaMoraItemForm from './mora/components/ListaMoraItemForm';\r\nimport { FcDebt } from '../../commons/components/icons/FcDebt';\r\nimport { SolicitudAtencionExternaIndex } from './solicitud_atencion_externa/components/SolicitudAtencionExternaIndex';\r\nimport { SolicitudAtencionExternaForm } from './solicitud_atencion_externa/components/SolicitudAtencionExternaForm';\r\nimport { SolicitudATPolicy } from './solicitud_atencion_externa/policies';\r\nimport { EspecialidadesIndex, EspecialidadForm } from './especialidades/components';\r\nimport { PrestacionesIndex, PrestacionForm } from './prestaciones/componentes';\r\nimport { MedicosIndex, MedicoView, MedicosForm, MedicoPolicy } from './medicos';\r\nimport { \r\n  ProveedoresIndex,\r\n  ProveedorView,\r\n  ProveedorWizard,\r\n  ProveedorForm,\r\n  ContactoForm,\r\n  ProveedorPolicy\r\n} from './proveedores';\r\nimport {\r\n  ContratoForm,\r\n  ContratoView,\r\n  ContratoPolicy\r\n} from './contratos'\r\nimport { Permisos, ProtectedRoute, useLoggedUser } from '../../commons/auth';\r\nimport { ListaMoraPolicy } from \"./mora/policies\";\r\nimport { Image } from \"react-bootstrap\";\r\n\r\nexport const ClinicaApp = ()=>{\r\n  const { url } = useRouteMatch()\r\n  const loggedUser = useLoggedUser()\r\n\r\n  const sidebarItems = useMemo(()=>{\r\n    const items = [] as any[]\r\n\r\n    if(ListaMoraPolicy.index(loggedUser)){\r\n      items.push(\r\n        {\r\n          id: \"lista-mora\",\r\n          path: `${url}/lista-mora`,\r\n          title: \"Lista de mora\",\r\n          icon: <FcDebt  />\r\n        }\r\n      )\r\n    }\r\n\r\n    if(SolicitudATPolicy.index(loggedUser)) {\r\n      items.push({\r\n        id: \"atencion-externa\",\r\n        path: `${url}/atencion-externa`,\r\n        title: \"Atención externa\",\r\n        icon: <BiTransfer />\r\n      })\r\n    }\r\n    if(MedicoPolicy.index(loggedUser)){\r\n      items.push({\r\n        id: \"medicos\",\r\n        path: `${url}/medicos`,\r\n        title: \"Medicos\",\r\n        icon: <FaUserMd />,\r\n      })\r\n    }\r\n    if(ProveedorPolicy.index(loggedUser)){\r\n      items.push({\r\n        id: \"proveedores\",\r\n        path: `${url}/proveedores`,\r\n        title: \"Proveedores\",\r\n        icon: <FaHandshake />\r\n      })\r\n    }\r\n\r\n    items.push(\r\n          {\r\n            id: \"especialidades\",\r\n            path: `${url}/especialidades`,\r\n            title: \"Especialidades\",\r\n            icon: <GiRodOfAsclepius />,\r\n          },\r\n          {\r\n            id: \"prestaciones\",\r\n            path: `${url}/prestaciones`,\r\n            title: \"Prestaciones\",\r\n            icon: <FaProcedures />,\r\n          }\r\n    )\r\n    return items\r\n  }, [loggedUser])\r\n\r\n  return <SidebarLayout sidebar={{\r\n    header: <div className=\"d-flex justify-content-center\"><Image src=\"/logo-lg.png\" /></div>,\r\n    items: sidebarItems\r\n  }}>\r\n    <Switch>\r\n      <ProtectedRoute exact path={`${url}/lista-mora/agregar`}\r\n        authorize={ListaMoraPolicy.index}>\r\n        <ListaMoraItemForm />\r\n      </ProtectedRoute>\r\n      <Route path={`${url}/lista-mora`}>\r\n        <ListaMoraIndex />\r\n      </Route>\r\n      <ProtectedRoute exact path={`${url}/atencion-externa`}\r\n        authorize={SolicitudATPolicy.index}>\r\n        <SolicitudAtencionExternaIndex />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/atencion-externa/registrar`}\r\n        authorize={SolicitudATPolicy.register}\r\n      >\r\n        <SolicitudAtencionExternaForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/medicos`}\r\n        authorize={MedicoPolicy.index}\r\n      >\r\n        <MedicosIndex />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={[`${url}/medicos/registrar`, `${url}/medicos/:id/editar`]}\r\n        authorize={(user, path) => path == `${url}/medicos/registrar` ? MedicoPolicy.register(user) : MedicoPolicy.edit(user) }\r\n      >\r\n        <MedicosForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/medicos/:id`}\r\n        authorize={MedicoPolicy.view}\r\n      >\r\n        <MedicoView />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores`}\r\n        authorize={ProveedorPolicy.index}\r\n      >\r\n        <ProveedoresIndex />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/registrar`}\r\n        authorize={ProveedorPolicy.register}\r\n      >\r\n        <ProveedorWizard />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:id`}\r\n        authorize={ProveedorPolicy.view}\r\n      >\r\n        <ProveedorView />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:id/editar`}\r\n        authorize={ProveedorPolicy.edit}>\r\n        <ProveedorForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:idProveedor/editar-contacto`}\r\n        authorize={(user)=>ProveedorPolicy.register(user) || ProveedorPolicy.edit(user)}\r\n      >\r\n        <ContactoForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:idProveedor/contratos/registrar`}\r\n        authorize={ContratoPolicy.register}\r\n      >\r\n        <ContratoForm />\r\n      </ProtectedRoute>\r\n      <ProtectedRoute exact path={`${url}/proveedores/:idProveedor/contratos/:id`}\r\n        authorize={ProveedorPolicy.view}\r\n      >\r\n        <ContratoView />\r\n      </ProtectedRoute>\r\n      <Route path={`${url}/especialidades`}>\r\n        <EspecialidadesIndex />\r\n      </Route>\r\n      <Route path={`${url}/prestaciones`}>\r\n        <PrestacionesIndex />\r\n      </Route>\r\n    </Switch>\r\n    \r\n    <Route exact path={[`${url}/prestaciones/registrar`, `${url}/prestaciones/:id/editar`]}>\r\n      <PrestacionForm />\r\n    </Route>\r\n    <Route exact path={[`${url}/especialidades/registrar`, `${url}/especialidades/:id/editar`]}>\r\n      <EspecialidadForm />\r\n    </Route>\r\n  </SidebarLayout>\r\n}\r\n\r\nexport default ClinicaApp"],"sourceRoot":""}