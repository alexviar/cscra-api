(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[4],{626:function(e,a,t){"use strict";t.d(a,"a",(function(){return r}));var r={};t.r(r),t.d(r,"VER_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return n})),t.d(r,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return i})),t.d(r,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return o})),t.d(r,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return c})),t.d(r,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return s})),t.d(r,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return l})),t.d(r,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return d})),t.d(r,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return u})),t.d(r,"VER_USUARIOS",(function(){return j})),t.d(r,"VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return O})),t.d(r,"REGISTRAR_USUARIOS",(function(){return b})),t.d(r,"REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return h})),t.d(r,"EDITAR_USUARIOS",(function(){return m})),t.d(r,"EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return x})),t.d(r,"BLOQUEAR_USUARIOS",(function(){return E})),t.d(r,"BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return v})),t.d(r,"DESBLOQUEAR_USUARIOS",(function(){return p})),t.d(r,"DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return g})),t.d(r,"CAMBIAR_CONTRASE\xd1A",(function(){return R})),t.d(r,"CAMBIAR_CONTRASE\xd1A_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return f})),t.d(r,"VER_ROLES",(function(){return _})),t.d(r,"REGISTRAR_ROLES",(function(){return A})),t.d(r,"EDITAR_ROLES",(function(){return I})),t.d(r,"ELIMINAR_ROLES",(function(){return S})),t.d(r,"VER_LISTA_DE_MORA",(function(){return N})),t.d(r,"VER_LISTA_DE_MORA_REGIONAL",(function(){return C})),t.d(r,"AGREGAR_EMPLEADOR_EN_MORA",(function(){return T})),t.d(r,"AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return L})),t.d(r,"QUITAR_EMPLEADOR_EN_MORA",(function(){return D})),t.d(r,"QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return y})),t.d(r,"VER_MEDICOS",(function(){return M})),t.d(r,"VER_MEDICOS_REGIONAL",(function(){return G})),t.d(r,"REGISTRAR_MEDICOS",(function(){return P})),t.d(r,"REGISTRAR_MEDICOS_REGIONAL",(function(){return V})),t.d(r,"EDITAR_MEDICOS",(function(){return U})),t.d(r,"EDITAR_MEDICOS_REGIONAL",(function(){return w})),t.d(r,"BAJA_MEDICOS",(function(){return z})),t.d(r,"BAJA_MEDICOS_REGIONAL",(function(){return B})),t.d(r,"VER_PROVEEDORES",(function(){return k})),t.d(r,"VER_PROVEEDORES_REGIONAL",(function(){return F})),t.d(r,"REGISTRAR_PROVEEDORES",(function(){return X})),t.d(r,"REGISTRAR_PROVEEDORES_REGIONAL",(function(){return q})),t.d(r,"EDITAR_PROVEEDORES",(function(){return Q})),t.d(r,"EDITAR_PROVEEDORES_REGIONAL",(function(){return H})),t.d(r,"BAJA_PROVEEDOR",(function(){return K})),t.d(r,"BAJA_PROVEEDOR_REGIONAL",(function(){return J})),t.d(r,"VER_CONTRATOS_PROVEEDOR",(function(){return W})),t.d(r,"VER_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return $})),t.d(r,"REGISTRAR_CONTRATOS_PROVEEDOR",(function(){return Z})),t.d(r,"REGISTRAR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return Y})),t.d(r,"CONSUMIR_CONTRATOS_PROVEEDOR",(function(){return ee})),t.d(r,"CONSUMIR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return ae})),t.d(r,"EXTENDER_CONTRATOS_PROVEEDOR",(function(){return te})),t.d(r,"EXTENDER_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return re})),t.d(r,"ANULAR_CONTRATOS_PROVEEDOR",(function(){return ne})),t.d(r,"ANULAR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return ie})),t.d(r,"VER_ESPECIALIDADES",(function(){return oe})),t.d(r,"REGISTRAR_ESPECIALIDADES",(function(){return ce})),t.d(r,"EDITAR_ESPECIALIDADES",(function(){return se})),t.d(r,"ELIMINAR_ESPECIALIDADES",(function(){return le})),t.d(r,"IMPORTAR_ESPECIALIDADES",(function(){return de})),t.d(r,"VER_PRESTACIONES",(function(){return ue})),t.d(r,"REGISTRAR_PRESTACIONES",(function(){return je})),t.d(r,"EDITAR_PRESTACIONES",(function(){return Oe})),t.d(r,"ELIMINAR_PRESTACIONES",(function(){return be})),t.d(r,"IMPORTAR_PRESTACIONES",(function(){return he}));var n="Ver solicitudes de atencion externa",i="Ver solicitudes de atencion externa (misma regional)",o="Ver solicitudes de atencion externa (registrado por)",c="Registrar solicitudes de atencion externa",s="Registrar solicitudes de atencion externa (misma regional)",l="Emitir solicitudes de atencion externa",d="Emitir solicitudes de atencion externa (misma regional)",u="Emitir solicitudes de atencion externa (registrado por)",j="Ver usuarios",O="Ver usuarios (misma regional)",b="Registrar usuarios",h="Registrar usuarios (misma regional)",m="Editar usuarios",x="Editar usuarios (misma regional)",E="Bloquear usuarios",v="Bloquear usuarios (misma regional)",p="Desbloquear usuarios",g="Desbloquear usuarios (misma regional)",R="Cambiar contrase\xf1a",f="Cambiar contrase\xf1a (misma regional)",_="Ver roles",A="Registrar roles",I="Editar roles",S="Eliminar roles",N="Ver lista de mora",C="Ver lista de mora (regional)",T="Agregar empleador en mora",L="Agregar empleador en mora (misma regional)",D="Quitar empleador en mora",y="Quitar empleador en mora (misma regional)",M="Ver m\xe9dicos",G="Ver m\xe9dicos (regional)",P="Registrar m\xe9dicos",V="Registrar m\xe9dicos (regional)",U="Editar m\xe9dicos",w="Editar m\xe9dicos (regional)",z="Baja m\xe9dicos",B="Baja m\xe9dicos (regional)",k="Ver proveedores",F="Ver proveedores (regional)",X="Registrar proveedores",q="Registrar proveedores (regional)",Q="Editar proveedores",H="Editar proveedores (regional)",K="Baja proveedores",J="Baja proveedores (regional)",W="Ver contratos de proveedores",$="Ver contratos de proveedores (regional)",Z="Registrar contratos de proveedores",Y="Registrar contratos de proveedores (regional)",ee="Consumir contratos de proveedores",ae="Consumir contratos de proveedores (regional)",te="Extender contratos de proveedores",re="Extender contratos de proveedores (regional)",ne="Anular contratos de proveedores",ie="Anular contratos de proveedores (regional)",oe="Ver especialidades",ce="Registrar especialidades",se="Editar especialidades",le="Eliminar especialidades",de="Importar especialidades",ue="Ver prestaciones",je="Registrar prestaciones",Oe="Editar prestaciones",be="Eliminar prestaciones",he="Importar prestaciones"},627:function(e,a,t){"use strict";var r=t(137);t.d(a,"b",(function(){return r.b})),t.d(a,"c",(function(){return r.c}));var n=t(138);t.d(a,"d",(function(){return n.a}));var i=t(626);t.d(a,"a",(function(){return i.a}))},628:function(e,a,t){},629:function(e,a,t){"use strict";var r=t(27),n=t(1),i=t.n(n),o=t(630),c=t(40);function s(e,a){Object(n.useEffect)((function(){var t=function(t){var r=null===e||void 0===e?void 0:e.current;r&&!r.contains(t.target)&&document.querySelector("html")!=t.target&&a(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}}),[e,a])}var l=t(84),d=t(4),u=function(e){var a=e.children,t=e.onClickOutside,i=Object(l.a)(e,["children","onClickOutside"]),o=Object(n.useRef)(null);return s(o,t),Object(d.jsx)("div",Object(r.a)(Object(r.a)({ref:o},i),{},{children:a}))},j=t(634),O=t(23),b=t(54),h=function(e){var a=Object(O.j)(e.path||"");return Object(d.jsxs)(d.Fragment,{children:[e.path?Object(d.jsxs)(j.a.Item,{as:b.b,to:e.path,action:!0,active:!!a,className:"border-0 text-nowrap",style:{padding:".5rem 1rem"},children:[e.icon,Object(d.jsx)("span",{style:{verticalAlign:"middle",marginLeft:"0.5rem"},children:e.title})]},e.id):Object(d.jsxs)("div",{className:"list-group-item border-0 text-nowrap",style:{padding:".5rem 1rem"},children:[e.icon,Object(d.jsx)("span",{style:{verticalAlign:"middle",marginLeft:"0.5rem"},children:e.title})]},e.id),e.items&&e.items.map((function(e){return Object(d.jsxs)(b.b,{to:e.path,style:{padding:".5rem 1rem",paddingLeft:"2rem"},className:"list-group-item list-group-item-action border-0 text-nowrap",children:[e.icon||null,Object(d.jsx)("span",{style:{verticalAlign:"middle",marginLeft:"0.5rem"},children:e.title})]},e.id)}))]})},m=function(e){var a=e.className,t=void 0===a?"":a,n=e.side,i=void 0===n?"right":n,o=e.header,c=void 0===o?"":o,s=e.items,l=void 0===s?[]:s;e.renderItem;return Object(d.jsxs)("div",{className:"".concat(t,"  ").concat({left:"border-left",right:"border-right"}[i]),id:"sidebar-wrapper",children:[Object(d.jsx)("div",{className:"sidebar-heading mt-2",children:c}),Object(d.jsx)("hr",{className:"mx-2"}),Object(d.jsx)(j.a,{variant:"flush",children:l.map((function(e){return Object(d.jsx)(h,Object(r.a)({},e),e.id)}))})]})};t(628),a.a=function(e){var a=e.sidebar,t=e.children,n=Object(c.c)((function(e){return e.sidebarVisibility})),s=Object(c.b)(),l=i.a.useCallback((function(e){var a=document.querySelector('[aria-label="Toggle navigation"]');(null===a||void 0===a?void 0:a.contains(e.target))||s({type:"CLOSE_SIDEBAR"})}),[n]);return Object(d.jsxs)("div",{className:"position-relative d-flex flex-grow-1 bg-light"+(n?" toggled":""),id:"wrapper",children:[Object(d.jsx)(u,{onClickOutside:l,children:Object(d.jsx)(m,Object(r.a)({className:"bg-white shadow-sm"},a))}),Object(d.jsx)(o.a,{className:"d-flex flex-column flex-grow-1",children:Object(d.jsx)("div",{className:"d-flex flex-column bg-white rounded-lg shadow-sm m-2 p-3 flex-grow-1",children:t})})]})}},637:function(e,a,t){"use strict";t.r(a),t.d(a,"ClinicaApp",(function(){return xe}));var r=t(1),n=t(23),i=t(629),o=t(632),c=t(27),s=t(37),l=t(613),d=t(620),u=t(336),j=t(332),O=t(237),b=t(631),h=t(50),m=t(75),x=t(54),E=t(186),v=t(627),p=t(85),g=function(e){return p.b.get("empleadores/buscar-por-patronal",{params:{numero_patronal:e}})},R=t(104),f=t(110),_=function(e,a){return R.apiClient.get("/lista-mora",{params:Object(f.c)({page:a,filter:e})})},A=function(e){return R.apiClient.post("lista-mora/agregar",{empleador_id:e})},I=function(e){return console.log(e),R.apiClient.post("lista-mora/quitar",{empleador_id:e})},S=t(93),N=t(4),C=function(e){var a=Object(S.g)(),t=a.handleSubmit,r=a.register,n=a.reset;return Object(N.jsxs)(d.a,{onSubmit:t((function(a){var t={};a.nombre&&(t.nombre=a.nombre),a.numeroPatronal&&(t.numeroPatronal=a.numeroPatronal),e.onApply(t)})),children:[Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"N\xba Patronal"}),Object(N.jsx)(d.a.Control,Object(c.a)({},r("numeroPatronal")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,sm:8,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({},r("nombre")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{type:"submit",children:"Aplicar"})}),Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{variant:"secondary",onClick:function(){return n()},children:"Limpiar"})})]})]})},T=t(92),L=t(65),D=t(137),y=t(626),M={index:function(e){return null===e||void 0===e?void 0:e.canAny([y.a.VER_LISTA_DE_MORA,y.a.VER_LISTA_DE_MORA_REGIONAL,y.a.AGREGAR_EMPLEADOR_EN_MORA,y.a.AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL])},view:function(e){return null===e||void 0===e?void 0:e.canAny([y.a.VER_LISTA_DE_MORA,y.a.VER_LISTA_DE_MORA_REGIONAL])},agregar:function(e){return null===e||void 0===e?void 0:e.canAny([y.a.AGREGAR_EMPLEADOR_EN_MORA,y.a.AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL])},quitar:function(e){return null===e||void 0===e?void 0:e.canAny([y.a.QUITAR_EMPLEADOR_EN_MORA,y.a.QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL])}},G=function(e){var a=e.item,t=e.queryKey,n=Object(L.b)("queryLoader"),i=Object(m.useQueryClient)(),o=Object(m.useMutation)((function(){return I(a.empleadorId)}),{onSuccess:function(){n.close(),i.setQueryData(t,(function(e){return console.log(e),Object(c.a)(Object(c.a)({},e),{},{data:Object(c.a)(Object(c.a)({},e.data),{},{records:e.data.records.filter((function(e){return e!==a}))})})}))}});return Object(r.useEffect)((function(){"loading"==o.status?n.open({state:"loading"}):"error"==o.status&&(console.log(o.error),n.open({state:"error",error:o.error}))}),[o.status]),Object(N.jsxs)(T.a,{children:[Object(N.jsx)(T.a.Toggle,{as:E.e,variant:"link",id:"dropdown-".concat(a.id)}),Object(N.jsx)(T.a.Menu,{children:Object(N.jsx)(D.b,{authorize:M.quitar,children:Object(N.jsx)(T.a.Item,{className:"text-danger",href:"#",onClick:function(){window.confirm("\xbfEst\xe1 seguro?")&&o.mutate()},children:"Quitar"})})})]})},P=function(){var e,a,t,n=Object(r.useState)({current:1,size:10}),i=Object(s.a)(n,2),o=i[0],p=i[1],g=Object(v.d)(),R=Object(r.useState)((function(){var e={};return(null===g||void 0===g?void 0:g.can(v.a.VER_LISTA_DE_MORA))||(null===g||void 0===g?void 0:g.can(v.a.VER_LISTA_DE_MORA_REGIONAL))&&(e.regionalId=g.regionalId),e})),f=Object(s.a)(R,2),A=f[0],I=f[1],S=Object(r.useState)(!1),T=Object(s.a)(S,2),L=T[0],D=T[1],y=["listaMora.buscar",A,o],P=Object(m.useQuery)(y,(function(){return _(A,o)}),{enabled:M.view(g),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),V=(null===(e=P.data)||void 0===e||null===(a=e.data)||void 0===a||null===(t=a.meta)||void 0===t?void 0:t.total)||0;return Object(N.jsxs)("div",{className:"px-1",children:[Object(N.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Empleadores en mora"}),Object(N.jsx)("div",{className:"d-flex my-2",children:Object(N.jsxs)(d.a.Row,{className:"ml-auto flex-nowrap",children:[Object(N.jsxs)(v.b,{authorize:M.view,children:[Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{className:"my-2",onClick:function(){P.refetch()},children:Object(N.jsx)(h.g,{})})}),Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{className:"my-2",onClick:function(){D((function(e){return!e}))},children:Object(N.jsx)(h.d,{})})})]}),Object(N.jsx)(v.b,{authorize:M.agregar,children:Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsxs)(j.a,{as:x.b,to:"/clinica/lista-mora/agregar",className:"my-2",children:[Object(N.jsx)(h.e,{className:"mr-1"}),"Agregar"]})})})]})}),Object(N.jsxs)(v.b,{authorize:M.view,children:[Object(N.jsx)(O.a,{in:L,children:Object(N.jsx)("div",{children:Object(N.jsx)(C,{onApply:function(e){I(e),p((function(e){return Object(c.a)(Object(c.a)({},e),{},{current:1})}))}})})}),Object(N.jsx)("div",{className:"d-flex",children:Object(N.jsx)("div",{className:"ml-auto mb-2",children:Object(N.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(N.jsx)("span",{children:"Mostrar"}),Object(N.jsxs)(d.a.Control,{className:"mx-2",as:"select",value:o.size,onChange:function(e){var a=e.target.value;p((function(e){return Object(c.a)(Object(c.a)({},e),{},{size:parseInt(a)})}))},children:[Object(N.jsx)("option",{value:10,children:"10"}),Object(N.jsx)("option",{value:20,children:"20"}),Object(N.jsx)("option",{value:30,children:"30"}),Object(N.jsx)("option",{value:50,children:"50"}),Object(N.jsx)("option",{value:100,children:"100"})]}),Object(N.jsx)("span",{children:"filas"})]})})}),Object(N.jsxs)(b.a,{responsive:!0,className:"text-nowrap",children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{style:{width:1},children:"#"}),Object(N.jsx)("th",{style:{width:1},children:"N\xba Patronal"}),Object(N.jsx)("th",{children:"Nombre"}),Object(N.jsx)("th",{style:{width:1}})]})}),Object(N.jsx)("tbody",{children:function(){if(P.isFetching)return Object(N.jsx)("tr",{children:Object(N.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(N.jsx)(l.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(P.isError){var e,a,t=P.error;return Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||t.message})})}if(P.data){var r=P.data.data.records;return 0==r.length?Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):r.map((function(e,a){return Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{style:{lineHeight:"26px"},children:a+1}),Object(N.jsx)("td",{style:{lineHeight:"26px"},children:e.numeroPatronal}),Object(N.jsx)("td",{style:{lineHeight:"26px"},children:e.nombre}),Object(N.jsx)("td",{children:Object(N.jsx)(G,{item:e,queryKey:y})})]},e.id)}))}}()})]}),"success"===P.status?Object(N.jsxs)("div",{className:"d-flex flex-row",children:[Object(N.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(V," resultados")}),Object(N.jsx)(E.a,{current:o.current,total:Math.ceil((V-o.size)/o.size)+1,onChange:function(e){return p((function(a){return Object(c.a)(Object(c.a)({},a),{},{current:e})}))}})]}):null]})]})},V=t(614),U=t(615),w=t(235),z=t(69),B=z.g().shape({numeroPatronal:z.j().label("n\xfamero patronal").trim().uppercase().required(),nombre:z.j().required()}),k=function(){var e,a,t=Object(S.g)({mode:"onBlur",resolver:Object(w.a)(B),defaultValues:{nombre:"",numeroPatronal:""}}),i=t.handleSubmit,o=t.register,s=t.watch,O=t.setError,b=t.clearErrors,x=t.setValue,E=(t.reset,t.trigger),v=t.formState,p=v.errors;console.log("Vlues",s(),p);var R=Object(n.g)(),f=Object(m.useQueryClient)(),_=s("numeroPatronal"),I=Object(m.useQuery)(["buscarEmpleadorPorPatronal",_],(function(){return g(_)}),{enabled:!1,onSuccess:function(e){var a=e.data;console.log("Nombre",a.nombre),x("nombre",a.nombre)}}),C=Object(m.useMutation)((function(e){return A(e)}),{onSuccess:function(){f.invalidateQueries("listaMora.buscar"),R.replace("/clinica/lista-mora")}});Object(r.useEffect)((function(){if(I.isError){var e,a=I.error;O("numeroPatronal",{type:"searchError",message:404==(null===(e=a.response)||void 0===e?void 0:e.status)?"Empleador no encontrado":"Ocurrio un error"})}}),[I.isError]);return Object(N.jsxs)(d.a,{id:"form-empleador-mora",onSubmit:i((function(){C.mutate(I.data.data.id)})),children:[Object(N.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Agregar empleador en mora"}),function(){if(C.isSuccess)return Object(N.jsx)(V.a,{variant:"success",children:"La operacion se realiz\xf3 exitosamente"});if(C.isError){var e,a,t=C.error;return Object(N.jsx)(V.a,{variant:"danger",children:(null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||t.message})}return null}(),Object(N.jsx)(d.a.Row,{children:Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"N\xba Patronal"}),Object(N.jsxs)(U.a,{hasValidation:!0,className:"mb-2",children:[Object(N.jsx)(d.a.Control,Object(c.a)({isInvalid:!!p.numeroPatronal,className:"text-uppercase"},o("numeroPatronal"))),Object(N.jsx)(U.a.Append,{children:Object(N.jsx)(j.a,{variant:p.numeroPatronal?"danger":"outline-secondary",onClick:function(){E("numeroPatronal").then((function(e){p.numeroPatronal||(b(),I.data||I.refetch())}))},children:I.isFetching?Object(N.jsx)(l.a,{animation:"border",size:"sm"}):Object(N.jsx)(h.f,{})})}),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(e=p.numeroPatronal)||void 0===e?void 0:e.message})]})]})}),Object(N.jsx)(d.a.Row,{children:Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!v.errors.nombre},o("nombre"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(a=v.errors.nombre)||void 0===a?void 0:a.message})]})}),Object(N.jsxs)(j.a,{type:"subimt",children:[C.isLoading?Object(N.jsx)(l.a,{className:"mr-2",animation:"border",size:"sm"}):null,Object(N.jsx)("span",{className:""}),"Agregar"]})]})},F=t(0),X=function(e){return Object(F.a)({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{d:"M10,12c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5S12.8,12,10,12z"}},{tag:"path",attr:{d:"M2,22v8l3,2l1,14h8l1-14l3-2v-8c0-4.4-3.6-8-8-8h0C5.6,14,2,17.6,2,22z"}},{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M22.4,40.4c-0.6,2.5-1,3.6-2.4,3.6c-0.6,0-1.2-0.5-1.9-1.1c-1-0.8-2.2-1.9-4.1-1.9v2c1.1,0,1.9,0.7,2.8,1.4 c0.9,0.7,1.9,1.6,3.2,1.6c3.1,0,3.8-2.9,4.4-5.2C25,38.2,25.4,37,27,37v-2C23.7,35,22.9,38.1,22.4,40.4z"}},{tag:"polygon",attr:{points:"14.4,40 10,40 10,44 14.1,44"}}]},{tag:"circle",attr:{cx:"36",cy:"36",r:"10"}},{tag:"path",attr:{fill:"#fff",d:"M35,34c0.1,0.2,0.1,0.3,0.3,0.4c0.1,0.1,0.3,0.2,0.5,0.4c0.2,0.1,0.5,0.2,0.8,0.3c0.5,0.2,0.9,0.4,1.3,0.6 c0.4,0.2,0.7,0.4,1,0.7c0.3,0.3,0.5,0.6,0.7,0.9c0.2,0.4,0.2,0.8,0.2,1.3c0,0.4-0.1,0.8-0.2,1.2c-0.1,0.4-0.3,0.7-0.6,0.9 c-0.3,0.3-0.6,0.5-0.9,0.6c-0.4,0.2-0.8,0.3-1.2,0.3v1.5h-1.2v-1.5c-0.4,0-0.8-0.1-1.2-0.3c-0.4-0.2-0.7-0.4-1-0.6 c-0.3-0.3-0.5-0.6-0.7-1.1c-0.2-0.4-0.3-0.9-0.3-1.5h2.2c0,0.4,0,0.7,0.1,0.9c0.1,0.2,0.2,0.4,0.4,0.6c0.2,0.1,0.3,0.2,0.5,0.3 c0.2,0.1,0.4,0.1,0.6,0.1c0.2,0,0.4,0,0.6-0.1c0.2-0.1,0.3-0.2,0.4-0.3c0.1-0.1,0.2-0.3,0.3-0.4c0.1-0.2,0.1-0.3,0.1-0.5 c0-0.2,0-0.4-0.1-0.6c-0.1-0.2-0.1-0.3-0.3-0.4c-0.1-0.1-0.3-0.3-0.5-0.4c-0.2-0.1-0.4-0.2-0.7-0.3c-0.5-0.2-0.9-0.4-1.3-0.6 c-0.4-0.2-0.7-0.4-1-0.7c-0.3-0.3-0.5-0.6-0.7-0.9c-0.2-0.4-0.2-0.8-0.2-1.3c0-0.4,0.1-0.8,0.2-1.2c0.1-0.3,0.3-0.7,0.6-0.9 c0.3-0.3,0.6-0.5,0.9-0.6c0.4-0.2,0.8-0.3,1.2-0.3v-1.6h1.2v1.6c0.4,0.1,0.8,0.2,1.2,0.4c0.4,0.2,0.6,0.4,0.9,0.7 c0.2,0.3,0.4,0.6,0.6,1c0.1,0.4,0.2,0.9,0.2,1.4h-2.2c0-0.6-0.1-1-0.4-1.3c-0.2-0.3-0.6-0.4-1-0.4c-0.2,0-0.4,0-0.6,0.1 c-0.2,0.1-0.3,0.2-0.4,0.3C35.1,32.7,35,32.8,35,33s-0.1,0.3-0.1,0.5C34.9,33.7,34.9,33.9,35,34z"}}]})(e)},q=function(e,a){return R.apiClient.get("solicitudes-atencion-externa",{params:Object(f.c)({filter:e,page:a})})},Q=function(e,a,t,r,n,i){return R.apiClient.post("solicitudes-atencion-externa",{regional_id:e,asegurado_id:a,medico:t,especialidad:r,proveedor:n,prestaciones_solicitadas:i})},H=function(e){var a=Object(S.g)({defaultValues:{medico:"",proveedor:""}}),t=(a.control,a.formState),r=a.handleSubmit,n=a.register,i=a.reset;return console.log(t),Object(N.jsxs)(d.a,{className:"mb-2",onSubmit:r((function(a){console.log(a),e.onFilter({numero:parseInt(a.numero),numeroPatronal:a.numeroPatronal,matriculaAsegurado:a.matricula,desde:a.desde,hasta:a.hasta,medico:a.medico,proveedor:a.proveedor})})),children:[Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"N\xfamero de solicitud"}),Object(N.jsx)(d.a.Control,Object(c.a)({},n("numero")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"N\xba Patronal"}),Object(N.jsx)(d.a.Control,Object(c.a)({},n("numeroPatronal")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Matricula"}),Object(N.jsx)(d.a.Control,Object(c.a)({},n("matricula")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"M\xe9dico"}),Object(N.jsx)(d.a.Control,Object(c.a)({},n("medico")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Proveedor"}),Object(N.jsx)(d.a.Control,Object(c.a)({},n("proveedor")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Desde"}),Object(N.jsx)(d.a.Control,Object(c.a)({type:"date"},n("desde")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Hasta"}),Object(N.jsx)(d.a.Control,Object(c.a)({type:"date"},n("hasta")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{type:"submit",children:"Aplicar"})}),Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{variant:"secondary",onClick:function(){return i()},children:"Limpiar"})})]})]})},K=t(138),J=t(236),W=function(e){var a=e.solicitud,t=Object(L.b)("pdfModal");return Object(N.jsxs)(T.a,{style:{position:"initial"},children:[Object(N.jsx)(T.a.Toggle,{as:E.e,variant:"link",id:"dropdown-solicitud-".concat(a.id)}),Object(N.jsx)(T.a.Menu,{children:Object(N.jsx)(T.a.Item,{href:"#",onClick:function(){t.open({title:"Formulario D.M. - 11",url:a.urlDm11})},children:"Ver D.M. - 11"})})]})},$={index:function(e){return null===e||void 0===e?void 0:e.canAny([v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR,v.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL])},register:function(e){return null===e||void 0===e?void 0:e.canAny([v.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL])},view:function(e){return null===e||void 0===e?void 0:e.canAny([v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR])},emit:function(e){return null===e||void 0===e?void 0:e.canAny([v.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,v.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR])}},Z=function(){var e=Object(n.h)().pathname,a=Object(r.useState)(0),t=Object(s.a)(a,2),i=t[0],o=t[1],v=Object(r.useState)({current:1,size:10}),p=Object(s.a)(v,2),g=p[0],R=p[1],f=Object(K.a)(),_=Object(r.useState)(!1),A=Object(s.a)(_,2),I=A[0],S=A[1],C=function(){var e={};return(null===f||void 0===f?void 0:f.can(y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA))||((null===f||void 0===f?void 0:f.can(y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL))&&(e.regionalId=f.regionalId),(null===f||void 0===f?void 0:f.can(y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR))&&(e.registradoPor=f.id)),e},T=Object(r.useState)(C),L=Object(s.a)(T,2),D=L[0],M=L[1],G=Object(m.useQuery)(["solicitudesAtencionExterna.buscar",g,D],(function(){return console.log(Object(c.a)(Object(c.a)({},D),C())),q(Object(c.a)(Object(c.a)({},D),C()),g)}),{enabled:null===f||void 0===f?void 0:f.canAny([y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA,y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR]),refetchOnReconnect:!1,refetchOnWindowFocus:!1,onSuccess:function(e){var a=e.data.meta;o(a.total)}});return Object(N.jsxs)("div",{className:"px-1",children:[Object(N.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Solicitudes de atenci\xf3n externa"}),Object(N.jsx)("div",{className:"d-flex my-2",children:Object(N.jsxs)(d.a.Row,{className:"ml-auto flex-nowrap",children:[Object(N.jsxs)(J.a,{authorize:$.view,children:[Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{onClick:function(){G.refetch()},children:Object(N.jsx)(h.g,{})})}),Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{onClick:function(){S((function(e){return!e}))},children:Object(N.jsx)(h.d,{})})})]}),Object(N.jsx)(J.a,{authorize:$.register,children:Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsxs)(j.a,{as:x.b,to:"".concat(e,"/registrar"),className:"d-flex align-items-center",children:[Object(N.jsx)(h.e,{className:"mr-1"}),Object(N.jsx)("span",{children:"Nuevo"})]})})})]})}),Object(N.jsxs)(J.a,{authorize:$.view,children:[Object(N.jsxs)(d.a.Row,{className:"mb-2",children:[Object(N.jsx)(u.a,{xs:12,children:Object(N.jsx)(O.a,{in:I,children:Object(N.jsx)("div",{children:Object(N.jsx)(H,{onFilter:function(e){M(e),R((function(e){return Object(c.a)(Object(c.a)({},e),{},{current:1})}))}})})})}),Object(N.jsx)(u.a,{className:"ml-auto",xs:"auto",children:Object(N.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(N.jsx)("span",{children:"Mostrar"}),Object(N.jsxs)(d.a.Control,{className:"mx-2",as:"select",value:g.size,onChange:function(e){var a=e.target.value;R((function(e){return Object(c.a)(Object(c.a)({},e),{},{size:parseInt(a)})}))},children:[Object(N.jsx)("option",{value:10,children:"10"}),Object(N.jsx)("option",{value:20,children:"20"}),Object(N.jsx)("option",{value:30,children:"30"}),Object(N.jsx)("option",{value:50,children:"50"}),Object(N.jsx)("option",{value:100,children:"100"})]}),Object(N.jsx)("span",{children:"filas"})]})})]}),Object(N.jsxs)(b.a,{responsive:!0,children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{style:{width:1},children:"#"}),Object(N.jsx)("th",{children:"N\xba"}),Object(N.jsx)("th",{children:"Fecha y hora"}),Object(N.jsx)("th",{children:"Matr\xedcula asegurado"}),Object(N.jsx)("th",{children:"Doctor"}),Object(N.jsx)("th",{children:"Proveedor"}),Object(N.jsx)("th",{style:{width:1}})]})}),Object(N.jsx)("tbody",{children:function(){if(G.isFetching)return Object(N.jsx)("tr",{children:Object(N.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(N.jsx)(l.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(G.isError){var e,a,t=G.error;return Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||t.message})})}if(G.data){var r=G.data.data.records;return 0===r.length?Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):r.map((function(e,a){return Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{children:a+1}),Object(N.jsx)("td",{children:e.numero}),Object(N.jsx)("td",{children:e.fecha}),Object(N.jsx)("td",{children:e.asegurado.matricula}),Object(N.jsx)("td",{children:e.medico}),Object(N.jsx)("td",{children:e.proveedor}),Object(N.jsx)("td",{children:Object(N.jsx)(W,{solicitud:e})})]},e.id)}))}}()})]}),"success"===G.status?Object(N.jsxs)("div",{className:"d-flex flex-row",children:[Object(N.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(i," resultados")}),Object(N.jsx)(E.a,{current:g.current,total:Math.ceil((i-g.size)/g.size)+1,onChange:function(e){return R((function(a){return Object(c.a)(Object(c.a)({},a),{},{current:e})}))}})]}):null]})]})},Y=t(633),ee=t(635),ae=t(187),te=t.n(ae),re=t(335),ne=t(619),ie=function(e){return console.log(e.asegurados.length),Object(N.jsxs)(ne.a,Object(c.a)(Object(c.a)({},e),{},{children:[Object(N.jsx)(ne.a.Header,{children:e.title}),Object(N.jsx)(ne.a.Body,{children:Object(N.jsxs)(b.a,{responsive:!0,className:"small",children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{style:{width:1},children:"#"}),Object(N.jsx)("th",{children:"Matricula"}),Object(N.jsx)("th",{children:"Nombre completo"}),Object(N.jsx)("th",{children:"Estado"}),Object(N.jsx)("th",{})]})}),Object(N.jsx)("tbody",{children:e.asegurados.length?e.asegurados.map((function(a,t){return Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{scope:"row",children:t+1}),Object(N.jsxs)("td",{children:[a.matricula,"-",a.matriculaComplemento]}),Object(N.jsx)("td",{children:a.nombreCompleto}),Object(N.jsx)("td",{className:a.estadoText?"":"bg-ligth",children:a.estadoText||"Desconocido"}),Object(N.jsx)("td",{children:Object(N.jsx)(j.a,{onClick:function(){console.log(a),e.onSelect(a)},children:"Seleccionar"})})]},a.id)})):Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})})})]})})]}))},oe=function(e){return R.apiClient.get("asegurados",{params:{filter:{matricula:e},page:{size:10},include:"empleador,titular"}})},ce=function(e){var a,t,n,i,o,O,b,x,E,v,p,g,R,f,_,A,I,C,T,L,D,y,M,G,P,V,w,z,B,k,F,X,q,Q,H,K,J,W=Object(S.h)(),$=W.register,Z=W.formState,ae=W.trigger,ne=W.setValue,ce=W.clearErrors,se=(W.control,W.watch),le=Object(r.useState)(!1),de=Object(s.a)(le,2),ue=de[0],je=de[1],Oe=e.value,be=se("asegurado.matricula"),he=Object(m.useQuery)(["asegurados.buscar",be],(function(){return oe(be)}),{enabled:!1,onSuccess:function(a){var t=a.data.records;if(1==t.length){var r=t[0];console.log("Choosed",r),e.onChange(r)}else je(!0)}});Object(r.useEffect)((function(){var e,a,t=null===Oe||void 0===Oe?void 0:Oe.empleador;console.log("empleador",t),ne("asegurado.apellidoPaterno",(null===Oe||void 0===Oe?void 0:Oe.apellidoPaterno)||""),ne("asegurado.apellidoMaterno",(null===Oe||void 0===Oe?void 0:Oe.apellidoMaterno)||""),ne("asegurado.nombres",(null===Oe||void 0===Oe?void 0:Oe.nombres)||""),ne("asegurado.estado",(null===Oe||void 0===Oe?void 0:Oe.estadoText)||"");var r=null===Oe||void 0===Oe||null===(e=Oe.afiliacion)||void 0===e||null===(a=e.baja)||void 0===a?void 0:a.fechaValidezSeguro;if(ne("asegurado.fechaValidezSeguro",r?te()(r).format("L"):""),ne("empleador.numeroPatronal",(null===t||void 0===t?void 0:t.numeroPatronal)||""),ne("empleador.nombre",(null===t||void 0===t?void 0:t.nombre)||""),ne("empleador.estado",(null===t||void 0===t?void 0:t.estadoText)||""),ne("empleador.fechaBaja",(null===t||void 0===t?void 0:t.fechaBaja)||""),ne("empleador.enMora",(null===t||void 0===t?void 0:t.enMora)?"S\xed":!1===(null===t||void 0===t?void 0:t.enMora)?"No":""),2==(null===Oe||void 0===Oe?void 0:Oe.tipo)){var n,i,o,c,s=null===Oe||void 0===Oe?void 0:Oe.titular,l=null===Oe||void 0===Oe||null===(n=Oe.afiliacion)||void 0===n?void 0:n.fechaExtincion,d=function(e){switch(e){case 1:return"Hijo(a)";case 2:return"Esposa";case 3:return"Conviviente";case 4:return"Madre";case 5:return"Padre";case 6:return"Hermano(a)";case 7:return"Esposo";case 8:return"Derechohabiente";default:return""}}(null===Oe||void 0===Oe||null===(i=Oe.afiliacion)||void 0===i?void 0:i.parentesco);ne("asegurado.parentesco",d),ne("asegurado.fechaExtincion",l?te()(l).format("L"):""),ne("titular.matricula",(null===s||void 0===s?void 0:s.matricula)||""),ne("titular.apellidoPaterno",(null===s||void 0===s?void 0:s.apellidoPaterno)||""),ne("titular.apellidoMaterno",(null===s||void 0===s?void 0:s.apellidoMaterno)||""),ne("titular.nombres",(null===s||void 0===s?void 0:s.nombres)||""),ne("titular.estado",null===s||void 0===s?void 0:s.estadoText);var u=null===s||void 0===s||null===(o=s.afiliacion)||void 0===o||null===(c=o.baja)||void 0===c?void 0:c.fechaValidezSeguro;ne("titular.fechaValidezSeguro",u?te()(u).format("L"):"")}}),[Oe]),Object(r.useEffect)((function(){var a;Oe&&(null===(a=Z.dirtyFields.asegurado)||void 0===a?void 0:a.matricula)&&e.onChange(null)}),[be]);var me=Z.errors,xe=me.asegurado||me.titular||me.empleador;return Object(N.jsxs)(ee.a,{children:[Object(N.jsx)(Y.a.Toggle,{as:ee.a.Header,className:"text-light "+(xe?"bg-danger":"bg-primary"),eventKey:"0",children:"Asegurado"}),Object(N.jsx)(Y.a.Collapse,{eventKey:"0",children:Object(N.jsxs)(ee.a.Body,{children:[Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(u.a,{lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{htmlFor:"asegurado-matricula",children:"Matr\xedcula"}),Object(N.jsxs)(U.a,{hasValidation:!0,className:"mb-2",children:[Object(N.jsx)(re.a,Object(c.a)({id:"asegurado-matricula",isInvalid:!!(null===(a=me.asegurado)||void 0===a?void 0:a.matricula),className:"text-uppercase"},$("asegurado.matricula"))),Object(N.jsx)(U.a.Append,{children:Object(N.jsx)(j.a,{variant:"outline-secondary",onClick:function(){ae("asegurado.matricula").then((function(a){var t,r;if(console.log("Matricula validation",a),!(null===(t=me.asegurado)||void 0===t?void 0:t.matricula))if((null===(r=Z.dirtyFields.asegurado)||void 0===r?void 0:r.matricula)&&delete Z.dirtyFields.asegurado.matricula,ce(["asegurado","titular","empleador"]),he.data){var n=he.data.data.records;if(1==n.length){var i=n[0];e.onChange(i)}else je(!0)}else he.refetch()}))},children:he.isFetching?Object(N.jsx)(l.a,{animation:"border",size:"sm"}):Object(N.jsx)(h.f,{})})}),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(t=me.asegurado)||void 0===t||null===(n=t.matricula)||void 0===n?void 0:n.message})]})]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Apellido Paterno"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},$("asegurado.apellidoPaterno")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Apellido Materno"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},$("asegurado.apellidoMaterno")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},$("asegurado.nombres")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Estado"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(i=me.asegurado)||void 0===i?void 0:i.estado)},$("asegurado.estado"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(o=me.asegurado)||void 0===o||null===(O=o.estado)||void 0===O?void 0:O.message})]}),2==(null===Oe||void 0===Oe?void 0:Oe.tipo)&&Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Parentesco"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(b=me.asegurado)||void 0===b?void 0:b.fechaValidezSeguro)},$("asegurado.parentesco"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(x=me.asegurado)||void 0===x||null===(E=x.fechaValidezSeguro)||void 0===E?void 0:E.message})]}),(null===Oe||void 0===Oe||null===(v=Oe.afiliacion)||void 0===v?void 0:v.baja)&&Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Validez del seguro"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(p=me.asegurado)||void 0===p?void 0:p.fechaValidezSeguro)},$("asegurado.fechaValidezSeguro"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(g=me.asegurado)||void 0===g||null===(R=g.fechaValidezSeguro)||void 0===R?void 0:R.message})]}),2==(null===Oe||void 0===Oe?void 0:Oe.tipo)?Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Fecha de extinci\xf3n"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(f=me.asegurado)||void 0===f?void 0:f.fechaExtincion)},$("asegurado.fechaExtincion"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(_=me.asegurado)||void 0===_||null===(A=_.fechaExtincion)||void 0===A?void 0:A.message})]}):null]}),2==(null===Oe||void 0===Oe?void 0:Oe.tipo)&&Object(N.jsxs)("div",{children:[Object(N.jsx)("hr",{}),Object(N.jsx)("h2",{style:{fontSize:"1.25rem"},children:"Titular"}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Matricula"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},$("titular.matricula")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Apellido Paterno"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},$("titular.apellidoPaterno")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Apellido Materno"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},$("titular.apellidoMaterno")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},$("titular.nombres")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Estado"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(I=me.titular)||void 0===I?void 0:I.estado)},$("titular.estado"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(C=me.titular)||void 0===C||null===(T=C.estado)||void 0===T?void 0:T.message})]}),(null===Oe||void 0===Oe||null===(L=Oe.titular)||void 0===L||null===(D=L.afiliacion)||void 0===D?void 0:D.baja)&&Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Validez del seguro"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(y=me.titular)||void 0===y?void 0:y.fechaValidezSeguro)},$("titular.fechaValidezSeguro"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(M=me.titular)||void 0===M||null===(G=M.fechaValidezSeguro)||void 0===G?void 0:G.message})]})]})]}),Object(N.jsx)("hr",{}),Object(N.jsx)("h2",{style:{fontSize:"1.25rem"},children:"Empleador"}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,md:4,children:[Object(N.jsx)(d.a.Label,{children:"N\xba Patronal"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(P=me.empleador)||void 0===P?void 0:P.numeroPatronal)},$("empleador.numeroPatronal"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(V=me.empleador)||void 0===V||null===(w=V.numeroPatronal)||void 0===w?void 0:w.message})]}),Object(N.jsxs)(d.a.Group,{as:u.a,md:8,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},$("empleador.nombre")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Estado"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(z=me.empleador)||void 0===z?void 0:z.estado)},$("empleador.estado"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(B=me.empleador)||void 0===B||null===(k=B.estado)||void 0===k?void 0:k.message})]}),Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Fecha de baja"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(F=me.empleador)||void 0===F?void 0:F.fechaBaja)},$("empleador.fechaBaja"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(X=me.empleador)||void 0===X||null===(q=X.fechaBaja)||void 0===q?void 0:q.message})]}),Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"En mora"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(Q=me.empleador)||void 0===Q?void 0:Q.enMora)},$("empleador.enMora"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(H=me.empleador)||void 0===H||null===(K=H.enMora)||void 0===K?void 0:K.message})]})]}),Object(N.jsx)(ie,{title:"Resultados",show:ue,asegurados:(null===(J=he.data)||void 0===J?void 0:J.data.records)||[],onSelect:function(a){e.onChange(a),je(!1)},onHide:function(){return je(!1)}})]})})]})},se=function(){var e,a=Object(r.useState)(1),t=Object(s.a)(a,2),n=(t[0],t[1],Object(S.h)()),i=n.register,o=n.control,l=n.formState,u=(n.watch,Object(S.f)({control:o,name:"prestacionesSolicitadas"})),j=u.fields,O=(u.append,u.remove,l.errors),h=!!O.prestacionesSolicitadas||!!O.proveedor;return Object(N.jsxs)(ee.a,{style:{overflow:"visible"},children:[Object(N.jsx)(Y.a.Toggle,{as:ee.a.Header,className:"text-light "+(h?"bg-danger":"bg-primary"),eventKey:"3",children:"Prestaciones"}),Object(N.jsx)(Y.a.Collapse,{eventKey:"3",children:Object(N.jsxs)("div",{children:[Object(N.jsxs)(b.a,{className:O.prestacionesSolicitadas?"is-invalid":"",children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{style:{width:1},children:"#"}),Object(N.jsx)("th",{children:"Prestacion"}),Object(N.jsx)("th",{children:"Proveedor"}),Object(N.jsx)("th",{style:{width:1}})]})}),Object(N.jsx)("tbody",{children:j.map((function(e,a){var t,r,n,o;return Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{children:a+1}),Object(N.jsxs)("td",{children:[Object(N.jsx)(d.a.Control,Object(c.a)({style:{textTransform:"uppercase"},isInvalid:!(!l.errors.prestacionesSolicitadas||!(null===(t=l.errors.prestacionesSolicitadas[a])||void 0===t?void 0:t.prestacion))},i("prestacionesSolicitadas.".concat(a,".prestacion")))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:l.errors.prestacionesSolicitadas&&(null===(r=l.errors.prestacionesSolicitadas[a])||void 0===r||null===(n=r.prestacion)||void 0===n?void 0:n.message)})]}),Object(N.jsxs)("td",{children:[Object(N.jsx)(d.a.Control,Object(c.a)({style:{textTransform:"uppercase"},isInvalid:!!l.errors.proveedor},i("proveedor"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(o=l.errors.proveedor)||void 0===o?void 0:o.message})]}),Object(N.jsx)("td",{})]},e.id)}))})]}),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(e=O.prestacionesSolicitadas)||void 0===e?void 0:e.message})]})})]})},le={1:"Activo",2:"Baja"},de={1:"Activo",2:"Baja",3:"Baja temporal"},ue=te()(),je=z.j().label("estado").oneOf(Object.values(le),"Estado desconocido").test("estado-incoherente","",(function(e,a){return e==le[1]&&a.parent.tieneBaja?a.createError({message:"El asegurado figura como activo, pero hay un registro de su baja con fecha ${date}",params:{date:a.parent.fechaRegBaja}}):!(e==le[2]&&!a.parent.tieneBaja)||a.createError({message:"El asegurado figura como dado de baja, aunque no se encontraron registros de la baja."})})),Oe=z.e().label("fecha de extinsion").test("min","",(function(e,a){var t=a.parent,r=t.estado,n=t.tieneBaja;return r==le[2]&&n&&!e?a.createError({message:"Fecha sin especificar, se asume que el seguro ya no tiene validez"}):!te()(e).isSameOrBefore(ue)||a.createError({message:"El seguro ya no tiene validez"})})),be=z.g().shape({asegurado:z.g().shape({matricula:z.j().label("matricula").trim().uppercase().required().matches(/^\d{2}-\d{4}-[a-zA-Z\xf1\xd1]{2,3}$/,"Formato incorrecto."),estado:je,fechaExtincion:z.d((function(e){return e?z.c().label("fecha de extinsion").nullable().notRequired().min(ue.toDate(),"Fecha de extinsion alcanzada"):z.e()})),fechaValidezSeguro:Oe}),titular:z.e().test("titular","",(function(e,a){var t,r,n=null===(t=a.options.context)||void 0===t?void 0:t.asegurado;if(2==(null===n||void 0===n?void 0:n.tipo)&&8!=(null===n||void 0===n||null===(r=n.afiliacion)||void 0===r?void 0:r.parentesco)){if(!n.titular)return a.createError({message:"No se encontraron datos del titular"});try{z.g().shape({estado:je,fechaValidezSeguro:Oe}).validateSync(e,{context:{asegurado:n.titular}})}catch(i){return i}}return!0})),empleador:z.g().shape({numeroPatronal:z.j().label("numero patronal").required(),estado:z.j().label("estado").oneOf(Object.values(de),"Estado desconocido").test("estado-incoherente","El empleador figura como activo, pero tiene fecha de baja",(function(e,a){var t,r,n=null===(t=a.options.context)||void 0===t||null===(r=t.asegurado)||void 0===r?void 0:r.empleador;return 1!=n.estado||!n.fechaBaja})),fechaBaja:z.e().when("estado",{is:function(e){return e==de[2]||e==de[3]},then:z.c().required("Fecha sin especificar, se asume que el seguro ya no tiene validez").min(ue.subtract(2,"months").toDate())}),aportes:z.d((function(e){return e?z.j().oneOf(["No"],"El empleador esta en mora"):z.j()}))}),regional:z.b().length(1,"Debe seleccionar una regional"),medico:z.j().trim().uppercase().required(),especialidad:z.j().trim().uppercase().required(),proveedor:z.j().trim().uppercase().required(),prestacionesSolicitadas:z.b().of(z.g().shape({prestacion:z.j().trim().uppercase().required("Debe indicar una prestacion")})).min(1,"Debe solicitar un servicio").max(1,"Solo puede solicitar un servicio por solicitud")}),he=function(){var e,a,t,n,i=Object(r.useState)(null),o=Object(s.a)(i,2),O=o[0],b=o[1];console.log("Asegurado",O);var h=Object(S.g)({mode:"onBlur",context:{asegurado:O},resolver:Object(w.a)(be),defaultValues:{regional:[],medico:"",proveedor:"",prestacionesSolicitadas:[{id:0,prestacion:""}],asegurado:{},titular:{},empleador:{}}}),x=h.register,v=h.handleSubmit,p=h.formState,g=h.control,R=h.reset,f=h.setValue,_=h.setError,A=(h.watch,Object(L.b)("pdfModal")),I=Object(K.a)(),C=Object(m.useMutation)((function(e){return Q(e.regional[0].id,O.id,e.medico,e.especialidad,e.proveedor,e.prestacionesSolicitadas.map((function(e){return{prestacion:e.prestacion}})))}),{onSuccess:function(e){var a=e.data,t=a.urlDm11,r=a.regionalId;((null===I||void 0===I?void 0:I.canAny([y.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA,y.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR]))||(null===I||void 0===I?void 0:I.can(y.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL))&&r==(null===I||void 0===I?void 0:I.regionalId))&&(A.open({url:t,title:"Formulario D.M. - 11"}),R())}}),T=p.errors,D=C.error;Object(r.useEffect)((function(){var e;if(422==(null===D||void 0===D||null===(e=D.response)||void 0===e?void 0:e.status)){var a,t=(null===(a=D.response)||void 0===a?void 0:a.data).errors;Object.keys(t).forEach((function(e){var a=e;"asegurado.id"==e&&(a="asegurado.matricula"),_(a,{type:"serverError",message:t[e]})}))}}),[D]);return Object(N.jsx)(S.b,Object(c.a)(Object(c.a)({},h),{},{children:Object(N.jsxs)(d.a,{onSubmit:v((function(e){C.mutate(e)})),children:[Object(N.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Solicitud de atenci\xf3n externa"}),function(){return C.isSuccess?Object(N.jsx)(V.a,{variant:"success",children:"La operacion se realiz\xf3 exitosamente"}):C.isError&&422!=(null===(e=D.response)||void 0===e?void 0:e.status)?Object(N.jsx)(V.a,{variant:"danger",children:D?(null===(a=D.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||D.message:""}):null;var e,a,t}(),Object(N.jsxs)(Y.a,{className:"mt-3",defaultActiveKey:"0",children:[Object(N.jsx)(ce,{value:O,onChange:function(e){b(e)}}),Object(N.jsxs)(ee.a,{style:{overflow:"visible"},children:[Object(N.jsx)(Y.a.Toggle,{as:ee.a.Header,className:"text-light "+(T.regional?"bg-danger":"bg-primary"),eventKey:"1",children:"Regional"}),Object(N.jsx)(Y.a.Collapse,{eventKey:"1",children:Object(N.jsx)(ee.a.Body,{children:Object(N.jsx)(d.a.Row,{children:Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(S.a,{control:g,name:"regional",render:function(e){var a,t=e.field,r=e.fieldState;return Object(N.jsx)(E.d,{style:{textTransform:"uppercase"},inputProps:{style:{textTransform:"uppercase"}},id:"solicitud-atencion-externa-form/regionales",filterBy:function(e){return!!(null===I||void 0===I?void 0:I.can(y.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA))||e.id==(null===I||void 0===I?void 0:I.regionalId)},isInvalid:!!r.error,feedback:null===(a=r.error)||void 0===a?void 0:a.message,selected:t.value,onBlur:t.onBlur,onChange:function(e){f("medico",""),f("proveedor",""),t.onChange(e)}})}})]})})})})]}),Object(N.jsxs)(ee.a,{style:{overflow:"visible"},children:[Object(N.jsx)(Y.a.Toggle,{as:ee.a.Header,className:"text-light "+(T.medico?"bg-danger":"bg-primary"),eventKey:"2",children:"M\xe9dico"}),Object(N.jsx)(Y.a.Collapse,{eventKey:"2",children:Object(N.jsx)(ee.a.Body,{children:Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({style:{textTransform:"uppercase"},isInvalid:!!p.errors.medico},x("medico"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(e=p.errors)||void 0===e||null===(a=e.medico)||void 0===a?void 0:a.message})]}),Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Especialidad"}),Object(N.jsx)(d.a.Control,Object(c.a)({style:{textTransform:"uppercase"},isInvalid:!!p.errors.especialidad},x("especialidad"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(t=p.errors)||void 0===t||null===(n=t.especialidad)||void 0===n?void 0:n.message})]})]})})})]}),Object(N.jsx)(se,{})]}),Object(N.jsxs)(j.a,{className:"mt-3",type:"submit",children:[C.isLoading?Object(N.jsx)(l.a,{className:"mr-2",animation:"border",size:"sm"}):null,Object(N.jsx)("span",{children:"Guardar"})]})]})}))},me=t(616),xe=function(){var e=Object(n.j)().url,a=Object(v.d)(),t=Object(r.useMemo)((function(){var t=[];return M.index(a)&&t.push({id:"lista-mora",path:"".concat(e,"/lista-mora"),title:"Lista de mora",icon:Object(N.jsx)(X,{})}),$.index(a)&&t.push({id:"atencion-externa",path:"".concat(e,"/atencion-externa"),title:"Atenci\xf3n externa",icon:Object(N.jsx)(o.a,{})}),t}),[a]);return Object(N.jsx)(i.a,{sidebar:{header:Object(N.jsx)("div",{className:"d-flex justify-content-center",children:Object(N.jsx)(me.a,{src:"/logo-lg.png"})}),items:t},children:Object(N.jsxs)(n.d,{children:[Object(N.jsx)(v.c,{exact:!0,path:"".concat(e,"/lista-mora/agregar"),authorize:M.index,children:Object(N.jsx)(k,{})}),Object(N.jsx)(n.b,{path:"".concat(e,"/lista-mora"),children:Object(N.jsx)(P,{})}),Object(N.jsx)(v.c,{exact:!0,path:"".concat(e,"/atencion-externa"),authorize:$.index,children:Object(N.jsx)(Z,{})}),Object(N.jsx)(v.c,{exact:!0,path:"".concat(e,"/atencion-externa/registrar"),authorize:$.register,children:Object(N.jsx)(he,{})})]})})};a.default=xe}}]);
//# sourceMappingURL=4.d74faa13.chunk.js.map