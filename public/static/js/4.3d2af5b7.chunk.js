(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[4],{600:function(e,a,r){"use strict";r.d(a,"a",(function(){return t}));var t={};r.r(t),r.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return n})),r.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return i})),r.d(t,"VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return o})),r.d(t,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return c})),r.d(t,"REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return s})),r.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA",(function(){return l})),r.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL",(function(){return d})),r.d(t,"EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR",(function(){return u})),r.d(t,"VER_USUARIOS",(function(){return j})),r.d(t,"VER_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return O})),r.d(t,"REGISTRAR_USUARIOS",(function(){return b})),r.d(t,"REGISTRAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return m})),r.d(t,"EDITAR_USUARIOS",(function(){return h})),r.d(t,"EDITAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return x})),r.d(t,"BLOQUEAR_USUARIOS",(function(){return E})),r.d(t,"BLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return v})),r.d(t,"DESBLOQUEAR_USUARIOS",(function(){return p})),r.d(t,"DESBLOQUEAR_USUARIOS_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return f})),r.d(t,"CAMBIAR_CONTRASE\xd1A",(function(){return g})),r.d(t,"CAMBIAR_CONTRASE\xd1A_DE_LA_MISMA_REGIONAL_QUE_EL_USUARIO",(function(){return R})),r.d(t,"VER_ROLES",(function(){return _})),r.d(t,"REGISTRAR_ROLES",(function(){return A})),r.d(t,"EDITAR_ROLES",(function(){return I})),r.d(t,"ELIMINAR_ROLES",(function(){return S})),r.d(t,"VER_LISTA_DE_MORA",(function(){return N})),r.d(t,"VER_LISTA_DE_MORA_REGIONAL",(function(){return C})),r.d(t,"AGREGAR_EMPLEADOR_EN_MORA",(function(){return T})),r.d(t,"AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return L})),r.d(t,"QUITAR_EMPLEADOR_EN_MORA",(function(){return D})),r.d(t,"QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL",(function(){return y})),r.d(t,"VER_MEDICOS",(function(){return M})),r.d(t,"VER_MEDICOS_REGIONAL",(function(){return G})),r.d(t,"REGISTRAR_MEDICOS",(function(){return P})),r.d(t,"REGISTRAR_MEDICOS_REGIONAL",(function(){return V})),r.d(t,"EDITAR_MEDICOS",(function(){return w})),r.d(t,"EDITAR_MEDICOS_REGIONAL",(function(){return U})),r.d(t,"BAJA_MEDICOS",(function(){return z})),r.d(t,"BAJA_MEDICOS_REGIONAL",(function(){return k})),r.d(t,"VER_PROVEEDORES",(function(){return B})),r.d(t,"VER_PROVEEDORES_REGIONAL",(function(){return F})),r.d(t,"REGISTRAR_PROVEEDORES",(function(){return X})),r.d(t,"REGISTRAR_PROVEEDORES_REGIONAL",(function(){return q})),r.d(t,"EDITAR_PROVEEDORES",(function(){return Q})),r.d(t,"EDITAR_PROVEEDORES_REGIONAL",(function(){return H})),r.d(t,"BAJA_PROVEEDOR",(function(){return K})),r.d(t,"BAJA_PROVEEDOR_REGIONAL",(function(){return J})),r.d(t,"VER_CONTRATOS_PROVEEDOR",(function(){return $})),r.d(t,"VER_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return W})),r.d(t,"REGISTRAR_CONTRATOS_PROVEEDOR",(function(){return Y})),r.d(t,"REGISTRAR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return Z})),r.d(t,"CONSUMIR_CONTRATOS_PROVEEDOR",(function(){return ee})),r.d(t,"CONSUMIR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return ae})),r.d(t,"EXTENDER_CONTRATOS_PROVEEDOR",(function(){return re})),r.d(t,"EXTENDER_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return te})),r.d(t,"ANULAR_CONTRATOS_PROVEEDOR",(function(){return ne})),r.d(t,"ANULAR_CONTRATOS_PROVEEDOR_REGIONAL",(function(){return ie})),r.d(t,"VER_ESPECIALIDADES",(function(){return oe})),r.d(t,"REGISTRAR_ESPECIALIDADES",(function(){return ce})),r.d(t,"EDITAR_ESPECIALIDADES",(function(){return se})),r.d(t,"ELIMINAR_ESPECIALIDADES",(function(){return le})),r.d(t,"IMPORTAR_ESPECIALIDADES",(function(){return de})),r.d(t,"VER_PRESTACIONES",(function(){return ue})),r.d(t,"REGISTRAR_PRESTACIONES",(function(){return je})),r.d(t,"EDITAR_PRESTACIONES",(function(){return Oe})),r.d(t,"ELIMINAR_PRESTACIONES",(function(){return be})),r.d(t,"IMPORTAR_PRESTACIONES",(function(){return me}));var n="Ver solicitudes de atencion externa",i="Ver solicitudes de atencion externa (misma regional)",o="Ver solicitudes de atencion externa (registrado por)",c="Registrar solicitudes de atencion externa",s="Registrar solicitudes de atencion externa (misma regional)",l="Emitir solicitudes de atencion externa",d="Emitir solicitudes de atencion externa (misma regional)",u="Emitir solicitudes de atencion externa (registrado por)",j="Ver usuarios",O="Ver usuarios (misma regional)",b="Registrar usuarios",m="Registrar usuarios (misma regional)",h="Editar usuarios",x="Editar usuarios (misma regional)",E="Bloquear usuarios",v="Bloquear usuarios (misma regional)",p="Desbloquear usuarios",f="Desbloquear usuarios (misma regional)",g="Cambiar contrase\xf1a",R="Cambiar contrase\xf1a (misma regional)",_="Ver roles",A="Registrar roles",I="Editar roles",S="Eliminar roles",N="Ver lista de mora",C="Ver lista de mora (regional)",T="Agregar empleador en mora",L="Agregar empleador en mora (misma regional)",D="Quitar empleador en mora",y="Quitar empleador en mora (misma regional)",M="Ver m\xe9dicos",G="Ver m\xe9dicos (regional)",P="Registrar m\xe9dicos",V="Registrar m\xe9dicos (regional)",w="Editar m\xe9dicos",U="Editar m\xe9dicos (regional)",z="Baja m\xe9dicos",k="Baja m\xe9dicos (regional)",B="Ver proveedores",F="Ver proveedores (regional)",X="Registrar proveedores",q="Registrar proveedores (regional)",Q="Editar proveedores",H="Editar proveedores (regional)",K="Baja proveedores",J="Baja proveedores (regional)",$="Ver contratos de proveedores",W="Ver contratos de proveedores (regional)",Y="Registrar contratos de proveedores",Z="Registrar contratos de proveedores (regional)",ee="Consumir contratos de proveedores",ae="Consumir contratos de proveedores (regional)",re="Extender contratos de proveedores",te="Extender contratos de proveedores (regional)",ne="Anular contratos de proveedores",ie="Anular contratos de proveedores (regional)",oe="Ver especialidades",ce="Registrar especialidades",se="Editar especialidades",le="Eliminar especialidades",de="Importar especialidades",ue="Ver prestaciones",je="Registrar prestaciones",Oe="Editar prestaciones",be="Eliminar prestaciones",me="Importar prestaciones"},601:function(e,a,r){"use strict";var t=r(134);r.d(a,"b",(function(){return t.b})),r.d(a,"c",(function(){return t.c}));var n=r(135);r.d(a,"d",(function(){return n.a}));var i=r(600);r.d(a,"a",(function(){return i.a}))},602:function(e,a,r){},603:function(e,a,r){"use strict";var t=r(24),n=r(1),i=r.n(n),o=r(604),c=r(37);function s(e,a){Object(n.useEffect)((function(){var r=function(r){var t=null===e||void 0===e?void 0:e.current;t&&!t.contains(r.target)&&document.querySelector("html")!=r.target&&a(r)};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),function(){document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}}),[e,a])}var l=r(81),d=r(4),u=function(e){var a=e.children,r=e.onClickOutside,i=Object(l.a)(e,["children","onClickOutside"]),o=Object(n.useRef)(null);return s(o,r),Object(d.jsx)("div",Object(t.a)(Object(t.a)({ref:o},i),{},{children:a}))},j=r(608),O=r(20),b=r(51),m=function(e){var a=Object(O.j)(e.path||"");return Object(d.jsxs)(d.Fragment,{children:[e.path?Object(d.jsxs)(j.a.Item,{as:b.b,to:e.path,action:!0,active:!!a,className:"border-0 text-nowrap",style:{padding:".5rem 1rem"},children:[e.icon,Object(d.jsx)("span",{style:{verticalAlign:"middle",marginLeft:"0.5rem"},children:e.title})]},e.id):Object(d.jsxs)("div",{className:"list-group-item border-0 text-nowrap",style:{padding:".5rem 1rem"},children:[e.icon,Object(d.jsx)("span",{style:{verticalAlign:"middle",marginLeft:"0.5rem"},children:e.title})]},e.id),e.items&&e.items.map((function(e){return Object(d.jsxs)(b.b,{to:e.path,style:{padding:".5rem 1rem",paddingLeft:"2rem"},className:"list-group-item list-group-item-action border-0 text-nowrap",children:[e.icon||null,Object(d.jsx)("span",{style:{verticalAlign:"middle",marginLeft:"0.5rem"},children:e.title})]},e.id)}))]})},h=function(e){var a=e.className,r=void 0===a?"":a,n=e.side,i=void 0===n?"right":n,o=e.header,c=void 0===o?"":o,s=e.items,l=void 0===s?[]:s;e.renderItem;return Object(d.jsxs)("div",{className:"".concat(r,"  ").concat({left:"border-left",right:"border-right"}[i]),id:"sidebar-wrapper",children:[Object(d.jsx)("div",{className:"sidebar-heading mt-2",children:c}),Object(d.jsx)("hr",{className:"mx-2"}),Object(d.jsx)(j.a,{variant:"flush",children:l.map((function(e){return Object(d.jsx)(m,Object(t.a)({},e),e.id)}))})]})};r(602),a.a=function(e){var a=e.sidebar,r=e.children,n=Object(c.c)((function(e){return e.sidebarVisibility})),s=Object(c.b)(),l=i.a.useCallback((function(e){var a=document.querySelector('[aria-label="Toggle navigation"]');(null===a||void 0===a?void 0:a.contains(e.target))||s({type:"CLOSE_SIDEBAR"})}),[n]);return Object(d.jsxs)("div",{className:"position-relative d-flex flex-grow-1 bg-light"+(n?" toggled":""),id:"wrapper",children:[Object(d.jsx)(u,{onClickOutside:l,children:Object(d.jsx)(h,Object(t.a)({className:"bg-white shadow-sm"},a))}),Object(d.jsx)(o.a,{className:"d-flex flex-column flex-grow-1",children:Object(d.jsx)("div",{className:"d-flex flex-column bg-white rounded-lg shadow-sm m-2 p-3 flex-grow-1",children:r})})]})}},611:function(e,a,r){"use strict";r.r(a),r.d(a,"ClinicaApp",(function(){return Ee}));var t=r(1),n=r(20),i=r(603),o=r(606),c=r(24),s=r(35),l=r(587),d=r(594),u=r(326),j=r(321),O=r(230),b=r(605),m=r(48),h=r(71),x=r(51),E=r(183),v=r(601),p=r(82),f=function(e){return p.b.get("empleadores/buscar-por-patronal",{params:{numero_patronal:e}})},g=r(100),R=r(105),_=function(e,a){return g.apiClient.get("/lista-mora",{params:Object(R.c)({page:a,filter:e})})},A=function(e){return g.apiClient.post("lista-mora/agregar",{empleador_id:e})},I=function(e){return g.apiClient.post("lista-mora/quitar",{empleador_id:e})},S=r(89),N=r(4),C=function(e){var a=Object(S.g)(),r=a.handleSubmit,t=a.register,n=a.reset;return Object(N.jsxs)(d.a,{onSubmit:r((function(a){var r={};a.nombre&&(r.nombre=a.nombre),a.numeroPatronal&&(r.numeroPatronal=a.numeroPatronal),e.onApply(r)})),children:[Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"N\xba Patronal"}),Object(N.jsx)(d.a.Control,Object(c.a)({},t("numeroPatronal")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,sm:8,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({},t("nombre")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{type:"submit",children:"Aplicar"})}),Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{variant:"secondary",onClick:function(){return n()},children:"Limpiar"})})]})]})},T=r(88),L=r(62),D=r(134),y=r(600),M={index:function(e){return null===e||void 0===e?void 0:e.canAny([y.a.VER_LISTA_DE_MORA,y.a.VER_LISTA_DE_MORA_REGIONAL,y.a.AGREGAR_EMPLEADOR_EN_MORA,y.a.AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL])},view:function(e){return null===e||void 0===e?void 0:e.canAny([y.a.VER_LISTA_DE_MORA,y.a.VER_LISTA_DE_MORA_REGIONAL])},agregar:function(e){return null===e||void 0===e?void 0:e.canAny([y.a.AGREGAR_EMPLEADOR_EN_MORA,y.a.AGREGAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL])},quitar:function(e){return null===e||void 0===e?void 0:e.canAny([y.a.QUITAR_EMPLEADOR_EN_MORA,y.a.QUITAR_EMPLEADOR_EN_MORA_DE_LA_MISMA_REGIONAL])}},G=function(e){var a=e.item,r=e.queryKey,n=Object(L.b)("queryLoader"),i=Object(h.useQueryClient)(),o=Object(h.useMutation)((function(){return I(a.empleadorId)}),{onSuccess:function(){n.close(),i.setQueryData(r,(function(e){return console.log(e),Object(c.a)(Object(c.a)({},e),{},{data:Object(c.a)(Object(c.a)({},e.data),{},{records:e.data.records.filter((function(e){return e!==a}))})})}))}});return Object(t.useEffect)((function(){"loading"==o.status?n.open({state:"loading"}):"error"==o.status&&(console.error(o.error),n.open({state:"error",error:o.error}))}),[o.status]),Object(N.jsxs)(T.a,{children:[Object(N.jsx)(T.a.Toggle,{as:E.e,variant:"link",id:"dropdown-".concat(a.id)}),Object(N.jsx)(T.a.Menu,{children:Object(N.jsx)(D.b,{authorize:M.quitar,children:Object(N.jsx)(T.a.Item,{className:"text-danger",href:"#",onClick:function(){window.confirm("\xbfEst\xe1 seguro?")&&o.mutate()},children:"Quitar"})})})]})},P=function(){var e,a,r,n=Object(t.useState)({current:1,size:10}),i=Object(s.a)(n,2),o=i[0],p=i[1],f=Object(v.d)(),g=Object(t.useState)((function(){var e={};return(null===f||void 0===f?void 0:f.can(v.a.VER_LISTA_DE_MORA))||(null===f||void 0===f?void 0:f.can(v.a.VER_LISTA_DE_MORA_REGIONAL))&&(e.regionalId=f.regionalId),e})),R=Object(s.a)(g,2),A=R[0],I=R[1],S=Object(t.useState)(!1),T=Object(s.a)(S,2),L=T[0],D=T[1],y=["listaMora.buscar",A,o],P=Object(h.useQuery)(y,(function(){return _(A,o)}),{enabled:M.view(f),refetchOnWindowFocus:!1,refetchOnReconnect:!1}),V=(null===(e=P.data)||void 0===e||null===(a=e.data)||void 0===a||null===(r=a.meta)||void 0===r?void 0:r.total)||0;return Object(N.jsxs)("div",{className:"px-1",children:[Object(N.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Empleadores en mora"}),Object(N.jsx)("div",{className:"d-flex my-2",children:Object(N.jsxs)(d.a.Row,{className:"ml-auto flex-nowrap",children:[Object(N.jsxs)(v.b,{authorize:M.view,children:[Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{className:"my-2",onClick:function(){P.refetch()},children:Object(N.jsx)(m.g,{})})}),Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{className:"my-2",onClick:function(){D((function(e){return!e}))},children:Object(N.jsx)(m.d,{})})})]}),Object(N.jsx)(v.b,{authorize:M.agregar,children:Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsxs)(j.a,{as:x.b,to:"/clinica/lista-mora/agregar",className:"my-2",children:[Object(N.jsx)(m.e,{className:"mr-1"}),"Agregar"]})})})]})}),Object(N.jsxs)(v.b,{authorize:M.view,children:[Object(N.jsx)(O.a,{in:L,children:Object(N.jsx)("div",{children:Object(N.jsx)(C,{onApply:function(e){I(e),p((function(e){return Object(c.a)(Object(c.a)({},e),{},{current:1})}))}})})}),Object(N.jsx)("div",{className:"d-flex",children:Object(N.jsx)("div",{className:"ml-auto mb-2",children:Object(N.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(N.jsx)("span",{children:"Mostrar"}),Object(N.jsxs)(d.a.Control,{className:"mx-2",as:"select",value:o.size,onChange:function(e){var a=e.target.value;p((function(e){return Object(c.a)(Object(c.a)({},e),{},{size:parseInt(a)})}))},children:[Object(N.jsx)("option",{value:10,children:"10"}),Object(N.jsx)("option",{value:20,children:"20"}),Object(N.jsx)("option",{value:30,children:"30"}),Object(N.jsx)("option",{value:50,children:"50"}),Object(N.jsx)("option",{value:100,children:"100"})]}),Object(N.jsx)("span",{children:"filas"})]})})}),Object(N.jsxs)(b.a,{responsive:!0,className:"text-nowrap",children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{style:{width:1},children:"#"}),Object(N.jsx)("th",{style:{width:1},children:"N\xba Patronal"}),Object(N.jsx)("th",{children:"Nombre"}),Object(N.jsx)("th",{style:{width:1}})]})}),Object(N.jsx)("tbody",{children:function(){if(P.isFetching)return Object(N.jsx)("tr",{children:Object(N.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(N.jsx)(l.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(P.isError){var e,a,r=P.error;return Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=r.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||r.message})})}if(P.data){var t=P.data.data.records;return 0==t.length?Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):t.map((function(e,a){return Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{style:{lineHeight:"26px"},children:a+1}),Object(N.jsx)("td",{style:{lineHeight:"26px"},children:e.numeroPatronal}),Object(N.jsx)("td",{style:{lineHeight:"26px"},children:e.nombre}),Object(N.jsx)("td",{children:Object(N.jsx)(G,{item:e,queryKey:y})})]},e.id)}))}}()})]}),"success"===P.status?Object(N.jsxs)("div",{className:"d-flex flex-row",children:[Object(N.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(V," resultados")}),Object(N.jsx)(E.a,{current:o.current,total:Math.ceil((V-o.size)/o.size)+1,onChange:function(e){return p((function(a){return Object(c.a)(Object(c.a)({},a),{},{current:e})}))}})]}):null]})]})},V=r(588),w=r(589),U=r(228),z=r(55),k=z.g().shape({numeroPatronal:z.j().label("n\xfamero patronal").trim().uppercase().required(),nombre:z.j().required()}),B=function(){var e,a,r=Object(S.g)({mode:"onBlur",resolver:Object(U.a)(k),defaultValues:{nombre:"",numeroPatronal:""}}),i=r.handleSubmit,o=r.register,s=r.watch,O=r.setError,b=r.clearErrors,x=r.setValue,E=(r.reset,r.trigger),v=r.formState,p=v.errors,g=Object(n.g)(),R=Object(h.useQueryClient)(),_=s("numeroPatronal"),I=Object(h.useQuery)(["buscarEmpleadorPorPatronal",_],(function(){return f(_)}),{enabled:!1,onSuccess:function(e){var a=e.data;x("nombre",a.nombre)}}),C=Object(h.useMutation)((function(e){return A(e)}),{onSuccess:function(){R.invalidateQueries("listaMora.buscar"),g.replace("/clinica/lista-mora")}});Object(t.useEffect)((function(){var e,a=I.error;404==(null===a||void 0===a||null===(e=a.response)||void 0===e?void 0:e.status)?O("numeroPatronal",{type:"searchError",message:"Empleador no encontrado"}):a&&(console.error(a),O("numeroPatronal",{type:"searchError",message:"Ocurrio un error al realizar la busqueda"}))}),[I.isError]),Object(t.useEffect)((function(){var e,a=C.error;if(422==(null===a||void 0===a||null===(e=a.response)||void 0===e?void 0:e.status)){var r,t=(null===a||void 0===a||null===(r=a.response)||void 0===r?void 0:r.data).errors;Object.keys(t).forEach((function(e){var a=e;"empleadorId"==e&&(a="numeroPatronal"),O(a,{type:"serverError",message:t[e]})}))}else a&&console.error(a)}),[C.isError]);return Object(N.jsxs)(d.a,{id:"form-empleador-mora",onSubmit:i((function(){C.mutate(I.data.data.id)})),children:[Object(N.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Agregar empleador en mora"}),C.isSuccess?Object(N.jsx)(V.a,{variant:"success",children:"La operacion se realiz\xf3 exitosamente"}):C.isError?Object(N.jsx)(V.a,{variant:"danger",children:"Ocurrio un error al procesar la solicitud"}):null,Object(N.jsx)(d.a.Row,{children:Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"N\xba Patronal"}),Object(N.jsxs)(w.a,{hasValidation:!0,className:"mb-2",children:[Object(N.jsx)(d.a.Control,Object(c.a)({isInvalid:!!p.numeroPatronal,className:"text-uppercase"},o("numeroPatronal"))),Object(N.jsx)(w.a.Append,{children:Object(N.jsx)(j.a,{variant:p.numeroPatronal?"danger":"outline-secondary",onClick:function(){E("numeroPatronal").then((function(e){p.numeroPatronal||(b(),I.refetch())}))},children:I.isFetching?Object(N.jsx)(l.a,{animation:"border",size:"sm"}):Object(N.jsx)(m.f,{})})}),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(e=p.numeroPatronal)||void 0===e?void 0:e.message})]})]})}),Object(N.jsx)(d.a.Row,{children:Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!v.errors.nombre},o("nombre"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(a=v.errors.nombre)||void 0===a?void 0:a.message})]})}),Object(N.jsxs)(j.a,{type:"subimt",children:[C.isLoading?Object(N.jsx)(l.a,{className:"mr-2",animation:"border",size:"sm"}):null,Object(N.jsx)("span",{className:""}),"Agregar"]})]})},F=r(0),X=function(e){return Object(F.a)({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{d:"M10,12c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5S12.8,12,10,12z"}},{tag:"path",attr:{d:"M2,22v8l3,2l1,14h8l1-14l3-2v-8c0-4.4-3.6-8-8-8h0C5.6,14,2,17.6,2,22z"}},{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M22.4,40.4c-0.6,2.5-1,3.6-2.4,3.6c-0.6,0-1.2-0.5-1.9-1.1c-1-0.8-2.2-1.9-4.1-1.9v2c1.1,0,1.9,0.7,2.8,1.4 c0.9,0.7,1.9,1.6,3.2,1.6c3.1,0,3.8-2.9,4.4-5.2C25,38.2,25.4,37,27,37v-2C23.7,35,22.9,38.1,22.4,40.4z"}},{tag:"polygon",attr:{points:"14.4,40 10,40 10,44 14.1,44"}}]},{tag:"circle",attr:{cx:"36",cy:"36",r:"10"}},{tag:"path",attr:{fill:"#fff",d:"M35,34c0.1,0.2,0.1,0.3,0.3,0.4c0.1,0.1,0.3,0.2,0.5,0.4c0.2,0.1,0.5,0.2,0.8,0.3c0.5,0.2,0.9,0.4,1.3,0.6 c0.4,0.2,0.7,0.4,1,0.7c0.3,0.3,0.5,0.6,0.7,0.9c0.2,0.4,0.2,0.8,0.2,1.3c0,0.4-0.1,0.8-0.2,1.2c-0.1,0.4-0.3,0.7-0.6,0.9 c-0.3,0.3-0.6,0.5-0.9,0.6c-0.4,0.2-0.8,0.3-1.2,0.3v1.5h-1.2v-1.5c-0.4,0-0.8-0.1-1.2-0.3c-0.4-0.2-0.7-0.4-1-0.6 c-0.3-0.3-0.5-0.6-0.7-1.1c-0.2-0.4-0.3-0.9-0.3-1.5h2.2c0,0.4,0,0.7,0.1,0.9c0.1,0.2,0.2,0.4,0.4,0.6c0.2,0.1,0.3,0.2,0.5,0.3 c0.2,0.1,0.4,0.1,0.6,0.1c0.2,0,0.4,0,0.6-0.1c0.2-0.1,0.3-0.2,0.4-0.3c0.1-0.1,0.2-0.3,0.3-0.4c0.1-0.2,0.1-0.3,0.1-0.5 c0-0.2,0-0.4-0.1-0.6c-0.1-0.2-0.1-0.3-0.3-0.4c-0.1-0.1-0.3-0.3-0.5-0.4c-0.2-0.1-0.4-0.2-0.7-0.3c-0.5-0.2-0.9-0.4-1.3-0.6 c-0.4-0.2-0.7-0.4-1-0.7c-0.3-0.3-0.5-0.6-0.7-0.9c-0.2-0.4-0.2-0.8-0.2-1.3c0-0.4,0.1-0.8,0.2-1.2c0.1-0.3,0.3-0.7,0.6-0.9 c0.3-0.3,0.6-0.5,0.9-0.6c0.4-0.2,0.8-0.3,1.2-0.3v-1.6h1.2v1.6c0.4,0.1,0.8,0.2,1.2,0.4c0.4,0.2,0.6,0.4,0.9,0.7 c0.2,0.3,0.4,0.6,0.6,1c0.1,0.4,0.2,0.9,0.2,1.4h-2.2c0-0.6-0.1-1-0.4-1.3c-0.2-0.3-0.6-0.4-1-0.4c-0.2,0-0.4,0-0.6,0.1 c-0.2,0.1-0.3,0.2-0.4,0.3C35.1,32.7,35,32.8,35,33s-0.1,0.3-0.1,0.5C34.9,33.7,34.9,33.9,35,34z"}}]})(e)},q=function(e,a){return g.apiClient.get("solicitudes-atencion-externa",{params:Object(R.c)({filter:e,page:a})})},Q=function(e,a,r,t,n,i){return g.apiClient.post("solicitudes-atencion-externa",{regional_id:e,asegurado_id:a,medico:r,especialidad:t,proveedor:n,prestaciones_solicitadas:i})},H=function(e){var a=Object(S.g)({defaultValues:{medico:"",proveedor:""}}),r=(a.control,a.formState,a.handleSubmit),t=a.register,n=a.reset;return Object(N.jsxs)(d.a,{className:"mb-2",onSubmit:r((function(a){e.onFilter({numero:parseInt(a.numero),numeroPatronal:a.numeroPatronal,matriculaAsegurado:a.matricula,desde:a.desde,hasta:a.hasta,medico:a.medico,proveedor:a.proveedor})})),children:[Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"N\xfamero de solicitud"}),Object(N.jsx)(d.a.Control,Object(c.a)({},t("numero")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"N\xba Patronal"}),Object(N.jsx)(d.a.Control,Object(c.a)({},t("numeroPatronal")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Matricula"}),Object(N.jsx)(d.a.Control,Object(c.a)({},t("matricula")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"M\xe9dico"}),Object(N.jsx)(d.a.Control,Object(c.a)({},t("medico")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Proveedor"}),Object(N.jsx)(d.a.Control,Object(c.a)({},t("proveedor")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Desde"}),Object(N.jsx)(d.a.Control,Object(c.a)({type:"date"},t("desde")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Hasta"}),Object(N.jsx)(d.a.Control,Object(c.a)({type:"date"},t("hasta")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{type:"submit",children:"Aplicar"})}),Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{variant:"secondary",onClick:function(){return n()},children:"Limpiar"})})]})]})},K=r(135),J=r(229),$=function(e){var a=e.solicitud,r=Object(L.b)("pdfModal");return Object(N.jsxs)(T.a,{style:{position:"initial"},children:[Object(N.jsx)(T.a.Toggle,{as:E.e,variant:"link",id:"dropdown-solicitud-".concat(a.id)}),Object(N.jsx)(T.a.Menu,{children:Object(N.jsx)(T.a.Item,{href:"#",onClick:function(){r.open({title:"Formulario D.M. - 11",url:a.urlDm11})},children:"Ver D.M. - 11"})})]})},W={index:function(e){return null===e||void 0===e?void 0:e.canAny([v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR,v.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL])},register:function(e){return null===e||void 0===e?void 0:e.canAny([v.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL])},view:function(e){return null===e||void 0===e?void 0:e.canAny([v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,v.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR])},emit:function(e){return null===e||void 0===e?void 0:e.canAny([v.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA,v.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,v.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR])}},Y=function(){var e=Object(n.h)().pathname,a=Object(t.useState)(0),r=Object(s.a)(a,2),i=r[0],o=r[1],v=Object(t.useState)({current:1,size:10}),p=Object(s.a)(v,2),f=p[0],g=p[1],R=Object(K.a)(),_=Object(t.useState)(!1),A=Object(s.a)(_,2),I=A[0],S=A[1],C=function(){var e={};return(null===R||void 0===R?void 0:R.can(y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA))||((null===R||void 0===R?void 0:R.can(y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL))&&(e.regionalId=R.regionalId),(null===R||void 0===R?void 0:R.can(y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR))&&(e.registradoPor=R.id)),e},T=Object(t.useState)(C),L=Object(s.a)(T,2),D=L[0],M=L[1],G=Object(h.useQuery)(["solicitudesAtencionExterna.buscar",f,D],(function(){return q(Object(c.a)(Object(c.a)({},D),C()),f)}),{enabled:null===R||void 0===R?void 0:R.canAny([y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA,y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL,y.a.VER_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR]),refetchOnReconnect:!1,refetchOnWindowFocus:!1,onSuccess:function(e){var a=e.data.meta;o(a.total)}});return Object(N.jsxs)("div",{className:"px-1",children:[Object(N.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Solicitudes de atenci\xf3n externa"}),Object(N.jsx)("div",{className:"d-flex my-2",children:Object(N.jsxs)(d.a.Row,{className:"ml-auto flex-nowrap",children:[Object(N.jsxs)(J.a,{authorize:W.view,children:[Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{onClick:function(){G.refetch()},children:Object(N.jsx)(m.g,{})})}),Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsx)(j.a,{onClick:function(){S((function(e){return!e}))},children:Object(N.jsx)(m.d,{})})})]}),Object(N.jsx)(J.a,{authorize:W.register,children:Object(N.jsx)(u.a,{xs:"auto",children:Object(N.jsxs)(j.a,{as:x.b,to:"".concat(e,"/registrar"),className:"d-flex align-items-center",children:[Object(N.jsx)(m.e,{className:"mr-1"}),Object(N.jsx)("span",{children:"Nuevo"})]})})})]})}),Object(N.jsxs)(J.a,{authorize:W.view,children:[Object(N.jsxs)(d.a.Row,{className:"mb-2",children:[Object(N.jsx)(u.a,{xs:12,children:Object(N.jsx)(O.a,{in:I,children:Object(N.jsx)("div",{children:Object(N.jsx)(H,{onFilter:function(e){M(e),g((function(e){return Object(c.a)(Object(c.a)({},e),{},{current:1})}))}})})})}),Object(N.jsx)(u.a,{className:"ml-auto",xs:"auto",children:Object(N.jsxs)("div",{className:"d-flex flex-row flex-nowrap align-items-center",children:[Object(N.jsx)("span",{children:"Mostrar"}),Object(N.jsxs)(d.a.Control,{className:"mx-2",as:"select",value:f.size,onChange:function(e){var a=e.target.value;g((function(e){return Object(c.a)(Object(c.a)({},e),{},{size:parseInt(a)})}))},children:[Object(N.jsx)("option",{value:10,children:"10"}),Object(N.jsx)("option",{value:20,children:"20"}),Object(N.jsx)("option",{value:30,children:"30"}),Object(N.jsx)("option",{value:50,children:"50"}),Object(N.jsx)("option",{value:100,children:"100"})]}),Object(N.jsx)("span",{children:"filas"})]})})]}),Object(N.jsxs)(b.a,{responsive:!0,children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{style:{width:1},children:"#"}),Object(N.jsx)("th",{children:"N\xba"}),Object(N.jsx)("th",{children:"Fecha y hora"}),Object(N.jsx)("th",{children:"Matr\xedcula asegurado"}),Object(N.jsx)("th",{children:"Doctor"}),Object(N.jsx)("th",{children:"Proveedor"}),Object(N.jsx)("th",{style:{width:1}})]})}),Object(N.jsx)("tbody",{children:function(){if(G.isFetching)return Object(N.jsx)("tr",{children:Object(N.jsxs)("td",{className:"bg-light text-center",colSpan:100,children:[Object(N.jsx)(l.a,{className:"mr-2",variant:"primary",animation:"border",size:"sm"}),"Cargando"]})});if(G.isError){var e,a,r=G.error;return Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-danger text-light text-center",colSpan:100,children:(null===(e=r.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||r.message})})}if(G.data){var t=G.data.data.records;return 0===t.length?Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})}):t.map((function(e,a){return Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{children:a+1}),Object(N.jsx)("td",{children:e.numero}),Object(N.jsx)("td",{children:e.fecha}),Object(N.jsx)("td",{children:e.asegurado.matricula}),Object(N.jsx)("td",{children:e.medico}),Object(N.jsx)("td",{children:e.proveedor}),Object(N.jsx)("td",{children:Object(N.jsx)($,{solicitud:e})})]},e.id)}))}}()})]}),"success"===G.status?Object(N.jsxs)("div",{className:"d-flex flex-row",children:[Object(N.jsx)("span",{className:"mr-auto",children:"Se encontraron ".concat(i," resultados")}),Object(N.jsx)(E.a,{current:f.current,total:Math.ceil((i-f.size)/f.size)+1,onChange:function(e){return g((function(a){return Object(c.a)(Object(c.a)({},a),{},{current:e})}))}})]}):null]})]})},Z=r(607),ee=r(609),ae=r(127),re=r.n(ae),te=r(325),ne=r(593),ie=function(e){return Object(N.jsxs)(ne.a,Object(c.a)(Object(c.a)({},e),{},{children:[Object(N.jsx)(ne.a.Header,{children:e.title}),Object(N.jsx)(ne.a.Body,{children:Object(N.jsxs)(b.a,{responsive:!0,className:"small",children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{style:{width:1},children:"#"}),Object(N.jsx)("th",{children:"Matricula"}),Object(N.jsx)("th",{children:"Nombre completo"}),Object(N.jsx)("th",{children:"Estado"}),Object(N.jsx)("th",{})]})}),Object(N.jsx)("tbody",{children:e.asegurados.length?e.asegurados.map((function(a,r){return Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{scope:"row",children:r+1}),Object(N.jsxs)("td",{children:[a.matricula,"-",a.matriculaComplemento]}),Object(N.jsx)("td",{children:a.nombreCompleto}),Object(N.jsx)("td",{className:a.estadoText?"":"bg-ligth",children:a.estadoText||"Desconocido"}),Object(N.jsx)("td",{children:Object(N.jsx)(j.a,{onClick:function(){e.onSelect(a)},children:"Seleccionar"})})]},a.id)})):Object(N.jsx)("tr",{children:Object(N.jsx)("td",{className:"bg-light text-center",colSpan:100,children:"No se encontraron resultados"})})})]})})]}))},oe=function(e){return g.apiClient.get("asegurados",{params:{filter:{matricula:e},page:{size:10},include:"empleador,titular"}})},ce=function(e){var a,r,n,i,o,O,b,x,E,v,p,f,g,R,_,A,I,C,T,L,D,y,M,G,P,U,z,k,B,F,X,q,Q,H,K,J,$,W,Y,ae,ne,ce,se,le,de,ue,je,Oe,be,me=Object(S.h)(),he=me.register,xe=me.formState,Ee=me.trigger,ve=me.setValue,pe=me.clearErrors,fe=(me.control,me.watch),ge=Object(t.useState)(!1),Re=Object(s.a)(ge,2),_e=Re[0],Ae=Re[1],Ie=e.value,Se=fe("asegurado.matricula"),Ne=Object(h.useQuery)(["asegurados.buscar",Se],(function(){return oe(Se)}),{enabled:!1,onSuccess:function(a){var r=a.data.records;if(1==r.length){var t=r[0];console.log("Choosed",t),e.onChange(t)}else Ae(!0)}});Object(t.useEffect)((function(){var e,a,r,t,n=null===Ie||void 0===Ie?void 0:Ie.empleador;if(ve("asegurado.apellidoPaterno",(null===Ie||void 0===Ie?void 0:Ie.apellidoPaterno)||""),ve("asegurado.apellidoMaterno",(null===Ie||void 0===Ie?void 0:Ie.apellidoMaterno)||""),ve("asegurado.nombres",(null===Ie||void 0===Ie?void 0:Ie.nombres)||""),ve("asegurado.estado",(null===Ie||void 0===Ie?void 0:Ie.estadoText)||""),(null===Ie||void 0===Ie||null===(e=Ie.afiliacion)||void 0===e||null===(a=e.baja)||void 0===a?void 0:a.fechaValidezSeguro)&&ve("asegurado.baja.fechaValidezSeguro",re()(null===Ie||void 0===Ie||null===(r=Ie.afiliacion)||void 0===r||null===(t=r.baja)||void 0===t?void 0:t.fechaValidezSeguro).format("L")),ve("empleador.numeroPatronal",(null===n||void 0===n?void 0:n.numeroPatronal)||""),ve("empleador.nombre",(null===n||void 0===n?void 0:n.nombre)||""),ve("empleador.estado",(null===n||void 0===n?void 0:n.estadoText)||""),ve("empleador.fechaBaja",(null===n||void 0===n?void 0:n.fechaBaja)?re()(null===n||void 0===n?void 0:n.fechaBaja).format("L"):""),ve("empleador.enMora",(null===n||void 0===n?void 0:n.enMora)?"S\xed":!1===(null===n||void 0===n?void 0:n.enMora)?"No":""),2==(null===Ie||void 0===Ie?void 0:Ie.tipo)){var i,o,c,s,l,d,u=null===Ie||void 0===Ie?void 0:Ie.titular,j=null===Ie||void 0===Ie||null===(i=Ie.afiliacion)||void 0===i?void 0:i.fechaExtincion,O=function(e){switch(e){case 1:return"Hijo(a)";case 2:return"Esposa";case 3:return"Conviviente";case 4:return"Madre";case 5:return"Padre";case 6:return"Hermano(a)";case 7:return"Esposo";case 8:return"Derechohabiente";default:return""}}(null===Ie||void 0===Ie||null===(o=Ie.afiliacion)||void 0===o?void 0:o.parentesco);ve("asegurado.parentesco",O),ve("asegurado.fechaExtincion",j?re()(j).format("L"):""),ve("titular.matricula",(null===u||void 0===u?void 0:u.matricula)||""),ve("titular.apellidoPaterno",(null===u||void 0===u?void 0:u.apellidoPaterno)||""),ve("titular.apellidoMaterno",(null===u||void 0===u?void 0:u.apellidoMaterno)||""),ve("titular.nombres",(null===u||void 0===u?void 0:u.nombres)||""),ve("titular.estado",null===u||void 0===u?void 0:u.estadoText),(null===u||void 0===u||null===(c=u.afiliacion)||void 0===c||null===(s=c.baja)||void 0===s?void 0:s.fechaValidezSeguro)&&ve("titular.baja.fechaValidezSeguro",re()(null===u||void 0===u||null===(l=u.afiliacion)||void 0===l||null===(d=l.baja)||void 0===d?void 0:d.fechaValidezSeguro).format("L"))}}),[Ie]),Object(t.useEffect)((function(){var a;Ie&&(null===(a=xe.dirtyFields.asegurado)||void 0===a?void 0:a.matricula)&&e.onChange(null)}),[Se]);var Ce=xe.errors,Te=Ce.asegurado||Ce.titular||Ce.empleador;return Object(N.jsxs)(ee.a,{children:[Object(N.jsx)(Z.a.Toggle,{as:ee.a.Header,className:"text-light "+(Te?"bg-danger":"bg-primary"),eventKey:"0",children:"Asegurado"}),Object(N.jsx)(Z.a.Collapse,{eventKey:"0",children:Object(N.jsxs)(ee.a.Body,{children:[Object(N.jsxs)("div",{children:[(null===(a=Ce.asegurado)||void 0===a?void 0:a.message)?Object(N.jsx)(V.a,{variant:"danger",children:null===(r=Ce.asegurado)||void 0===r?void 0:r.message}):null,Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{htmlFor:"asegurado-matricula",children:"Matr\xedcula"}),Object(N.jsxs)(w.a,{hasValidation:!0,children:[Object(N.jsx)(te.a,Object(c.a)(Object(c.a)({id:"asegurado-matricula",isInvalid:!!(null===(n=Ce.asegurado)||void 0===n?void 0:n.matricula)||Ne.isError,className:"text-uppercase"},he("asegurado.matricula")),{},{"aria-describedby":"matriculaHelpBlock"})),Object(N.jsx)(w.a.Append,{children:Object(N.jsx)(j.a,{variant:(null===(i=Ce.asegurado)||void 0===i?void 0:i.matricula)||Ne.isError?"outline-danger":"outline-secondary",onClick:function(){Ee("asegurado.matricula").then((function(a){var r,t;if(!(null===(r=Ce.asegurado)||void 0===r?void 0:r.matricula))if((null===(t=xe.dirtyFields.asegurado)||void 0===t?void 0:t.matricula)&&delete xe.dirtyFields.asegurado.matricula,pe(["asegurado","titular","empleador"]),Ne.data){var n=Ne.data.data.records;if(1==n.length){var i=n[0];e.onChange(i)}else Ae(!0)}else Ne.refetch()}))},children:Ne.isFetching?Object(N.jsx)(l.a,{animation:"border",size:"sm"}):Object(N.jsx)(m.f,{})})}),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:(null===(o=Ne.error)||void 0===o||null===(O=o.response)||void 0===O?void 0:O.message)||(null===(b=Ne.error)||void 0===b?void 0:b.message)||(null===(x=Ce.asegurado)||void 0===x||null===(E=x.matricula)||void 0===E?void 0:E.message)})]}),(null===(v=Ce.asegurado)||void 0===v?void 0:v.matricula)||Ne.isError?null:Object(N.jsx)(d.a.Text,{id:"matriculaHelpBlock",muted:!0,children:"Ej: 98-0824-ABC"})]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Apellido Paterno"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},he("asegurado.apellidoPaterno")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Apellido Materno"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},he("asegurado.apellidoMaterno")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},he("asegurado.nombres")))]})]}),Object(N.jsxs)(d.a.Row,{children:[!!Ie&&Object(N.jsxs)(d.a.Group,{as:u.a,sm:3,children:[Object(N.jsx)(d.a.Label,{children:"Estado"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,className:"text-uppercase",isInvalid:!!(null===(p=Ce.asegurado)||void 0===p?void 0:p.estado)},he("asegurado.estado"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(f=Ce.asegurado)||void 0===f||null===(g=f.estado)||void 0===g?void 0:g.message})]}),2==(null===Ie||void 0===Ie?void 0:Ie.tipo)&&Object(N.jsxs)(d.a.Group,{as:u.a,sm:3,children:[Object(N.jsx)(d.a.Label,{children:"Parentesco"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,className:"text-uppercase"},he("asegurado.parentesco")))]}),(null===Ie||void 0===Ie||null===(R=Ie.afiliacion)||void 0===R?void 0:R.baja)&&Object(N.jsxs)(d.a.Group,{as:u.a,sm:3,children:[Object(N.jsx)(d.a.Label,{children:"Validez del seguro"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(_=Ce.asegurado)||void 0===_||null===(A=_.baja)||void 0===A?void 0:A.fechaValidezSeguro)},he("asegurado.baja.fechaValidezSeguro"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(I=Ce.asegurado)||void 0===I||null===(C=I.baja)||void 0===C||null===(T=C.fechaValidezSeguro)||void 0===T?void 0:T.message})]}),2==(null===Ie||void 0===Ie?void 0:Ie.tipo)?Object(N.jsxs)(d.a.Group,{as:u.a,sm:3,children:[Object(N.jsx)(d.a.Label,{children:"Fecha de extinci\xf3n"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(L=Ce.asegurado)||void 0===L?void 0:L.fechaExtincion)},he("asegurado.fechaExtincion"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(D=Ce.asegurado)||void 0===D||null===(y=D.fechaExtincion)||void 0===y?void 0:y.message})]}):null]})]}),2==(null===Ie||void 0===Ie?void 0:Ie.tipo)&&Object(N.jsxs)("div",{children:[Object(N.jsx)("hr",{}),Object(N.jsx)("h2",{style:{fontSize:"1.25rem"},children:"Titular"}),(null===(M=Ce.titular)||void 0===M?void 0:M.message)?Object(N.jsx)(V.a,{variant:"danger",children:null===(G=Ce.titular)||void 0===G?void 0:G.message}):null,Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Matricula"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},he("titular.matricula")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Apellido Paterno"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},he("titular.apellidoPaterno")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Apellido Materno"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},he("titular.apellidoMaterno")))]}),Object(N.jsxs)(d.a.Group,{as:u.a,lg:3,md:6,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},he("titular.nombres")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Estado"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,className:"text-uppercase",isInvalid:!!(null===(P=Ce.titular)||void 0===P?void 0:P.estado)},he("titular.estado"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(U=Ce.titular)||void 0===U||null===(z=U.estado)||void 0===z?void 0:z.message})]}),(null===Ie||void 0===Ie||null===(k=Ie.titular)||void 0===k||null===(B=k.afiliacion)||void 0===B?void 0:B.baja)&&Object(N.jsxs)(d.a.Group,{as:u.a,sm:4,children:[Object(N.jsx)(d.a.Label,{children:"Validez del seguro"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(F=Ce.titular)||void 0===F||null===(X=F.baja)||void 0===X?void 0:X.fechaValidezSeguro)},he("titular.baja.fechaValidezSeguro"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(q=Ce.titular)||void 0===q||null===(Q=q.baja)||void 0===Q||null===(H=Q.fechaValidezSeguro)||void 0===H?void 0:H.message})]})]})]}),!!Ie&&Object(N.jsxs)("div",{children:[Object(N.jsx)("hr",{}),Object(N.jsx)("h2",{style:{fontSize:"1.25rem"},children:"Empleador"}),(null===(K=Ce.empleador)||void 0===K?void 0:K.message)?Object(N.jsx)(V.a,{variant:"danger",children:null===(J=Ce.empleador)||void 0===J?void 0:J.message}):null,Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,md:3,children:[Object(N.jsx)(d.a.Label,{children:"N\xba Patronal"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===($=Ce.empleador)||void 0===$?void 0:$.numeroPatronal)},he("empleador.numeroPatronal"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(W=Ce.empleador)||void 0===W||null===(Y=W.numeroPatronal)||void 0===Y?void 0:Y.message})]}),Object(N.jsxs)(d.a.Group,{as:u.a,md:9,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0},he("empleador.nombre")))]})]}),Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,sm:3,children:[Object(N.jsx)(d.a.Label,{children:"Estado"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,className:"text-uppercase",isInvalid:!!(null===(ae=Ce.empleador)||void 0===ae?void 0:ae.estado)},he("empleador.estado"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(ne=Ce.empleador)||void 0===ne||null===(ce=ne.estado)||void 0===ce?void 0:ce.message})]}),Object(N.jsxs)(d.a.Group,{as:u.a,sm:3,children:[Object(N.jsx)(d.a.Label,{children:"Fecha de baja"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,isInvalid:!!(null===(se=Ce.empleador)||void 0===se?void 0:se.fechaBaja)},he("empleador.fechaBaja"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(le=Ce.empleador)||void 0===le||null===(de=le.fechaBaja)||void 0===de?void 0:de.message})]}),Object(N.jsxs)(d.a.Group,{as:u.a,sm:3,children:[Object(N.jsx)(d.a.Label,{children:"En mora"}),Object(N.jsx)(d.a.Control,Object(c.a)({readOnly:!0,className:"text-uppercase",isInvalid:!!(null===(ue=Ce.empleador)||void 0===ue?void 0:ue.enMora)},he("empleador.enMora"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(je=Ce.empleador)||void 0===je||null===(Oe=je.enMora)||void 0===Oe?void 0:Oe.message})]})]})]}),Object(N.jsx)(ie,{title:"Resultados",show:_e,asegurados:(null===(be=Ne.data)||void 0===be?void 0:be.data.records)||[],onSelect:function(a){e.onChange(a),Ae(!1)},onHide:function(){return Ae(!1)}})]})})]})},se=function(){var e,a=Object(t.useState)(1),r=Object(s.a)(a,2),n=(r[0],r[1],Object(S.h)()),i=n.register,o=n.control,l=n.formState,u=(n.watch,Object(S.f)({control:o,name:"prestacionesSolicitadas"})),j=u.fields,O=(u.append,u.remove,l.errors),m=!!O.prestacionesSolicitadas||!!O.proveedor;return Object(N.jsx)(ee.a,{className:"overflow-visible",children:Object(N.jsxs)("div",{className:"overflow-hidden",children:[Object(N.jsx)(Z.a.Toggle,{as:ee.a.Header,className:"text-light "+(m?"bg-danger":"bg-primary"),eventKey:"3",children:"Prestaciones"}),Object(N.jsx)(Z.a.Collapse,{eventKey:"3",children:Object(N.jsxs)("div",{children:[Object(N.jsxs)(b.a,{className:O.prestacionesSolicitadas?"is-invalid":"",children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{children:[Object(N.jsx)("th",{style:{width:1},children:"#"}),Object(N.jsx)("th",{children:"Prestacion"}),Object(N.jsx)("th",{children:"Proveedor"}),Object(N.jsx)("th",{style:{width:1}})]})}),Object(N.jsx)("tbody",{children:j.map((function(e,a){var r,t,n,o;return Object(N.jsxs)("tr",{children:[Object(N.jsx)("td",{children:a+1}),Object(N.jsxs)("td",{children:[Object(N.jsx)(d.a.Control,Object(c.a)({style:{textTransform:"uppercase"},isInvalid:!(!l.errors.prestacionesSolicitadas||!(null===(r=l.errors.prestacionesSolicitadas[a])||void 0===r?void 0:r.prestacion))},i("prestacionesSolicitadas.".concat(a,".prestacion")))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:l.errors.prestacionesSolicitadas&&(null===(t=l.errors.prestacionesSolicitadas[a])||void 0===t||null===(n=t.prestacion)||void 0===n?void 0:n.message)})]}),Object(N.jsxs)("td",{children:[Object(N.jsx)(d.a.Control,Object(c.a)({style:{textTransform:"uppercase"},isInvalid:!!l.errors.proveedor},i("proveedor"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(o=l.errors.proveedor)||void 0===o?void 0:o.message})]}),Object(N.jsx)("td",{})]},e.id)}))})]}),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(e=O.prestacionesSolicitadas)||void 0===e?void 0:e.message})]})})]})})},le={1:"Activo",2:"Baja"},de={1:"Activo",2:"Baja",3:"Baja temporal"},ue=re()(),je=function(e,a){return a.oneOf(Object.values(le),"Estado desconocido"),e.afiliacion.baja?a.notOneOf([le[1]],"El asegurado figura como activo, pero hay un registro de su baja con fecha ".concat(e.afiliacion.baja.fechaRegistro,".")):a.notOneOf([le[2]],"El asegurado figura como dado de baja, aunque no se encontraron registros de la misma.")},Oe=function(e,a){return e.afiliacion.baja?a.shape({fechaValidezSeguro:z.c().format().emptyStringTo(null).nullable().min(ue,"El seguro ya no tiene validez").required("Fecha sin especificar, se asume que el seguro ya no tiene validez")}):a},be=function(e,a){return a.oneOf(Object.values(de),"Estado desconocido"),e.fechaBaja&&a.notOneOf(de[1],"El empleador figura como activo, pero tiene fecha de baja"),a},me=z.g().shape({asegurado:z.g().when("$asegurado",(function(e,a){return e?a.shape({matricula:z.j().label("matricula").trim().uppercase().required(),estado:je(e,z.j().label("estado")),fechaExtincion:z.c().format().emptyStringTo(null).nullable().label("fecha de extinsion").notRequired().min(ue.toDate(),"Fecha de extinsion alcanzada"),baja:Oe(e,z.g())}):a.test("","",(function(e,a){return a.createError({message:"Debe proporcionar los datos del afiliado"})}))})),titular:z.g().when("$asegurado",(function(e,a){if(2==(null===e||void 0===e?void 0:e.tipo)){var r;if(!e.titular)return a.oneOf([NaN],"No se encontraron datos del titular");if(8!=(null===e||void 0===e||null===(r=e.afiliacion)||void 0===r?void 0:r.parentesco))return a.shape({estado:je(e.titular,z.j().label("estado")),baja:Oe(e,z.g())})}})),empleador:z.g().when("$asegurado",(function(e,a){if(e){var r=e.empleador;return r?a.shape({estado:be(r,z.j().label("estado")),fechaBaja:z.c().format().emptyStringTo(null).nullable().when("estado",{is:function(e){return e==de[2]||e==de[3]},then:function(e){return e.required("Fecha sin especificar, se asume que el seguro ya no tiene validez").min(ue.subtract(2,"months").toDate(),"Han pasado mas de 2 meses desde la baja, el seguro ya no tiene validez")}}),enMora:z.j().oneOf(["No"],"El empleador esta en mora")}):a.oneOf([NaN],"No se encontraron datos del empleador")}})),regional:z.b().length(1,"Debe seleccionar una regional"),medico:z.j().trim().uppercase().required(),especialidad:z.j().trim().uppercase().required(),proveedor:z.j().trim().uppercase().required(),prestacionesSolicitadas:z.b().of(z.g().shape({prestacion:z.j().trim().uppercase().required("Debe indicar una prestacion")})).min(1,"Debe solicitar un servicio").max(1,"Solo puede solicitar un servicio")}),he=function(){var e,a,r,n,i=Object(t.useState)(null),o=Object(s.a)(i,2),O=o[0],b=o[1],m=Object(S.g)({mode:"onBlur",context:{asegurado:O},resolver:Object(U.a)(me),defaultValues:{regional:[],medico:"",proveedor:"",prestacionesSolicitadas:[{id:0,prestacion:""}],asegurado:{},titular:{},empleador:{}}}),x=m.register,v=m.handleSubmit,p=m.formState,f=m.control,g=m.reset,R=m.setValue,_=m.setError,A=(m.watch,Object(L.b)("pdfModal")),I=Object(K.a)(),C=Object(h.useMutation)((function(e){return Q(e.regional[0].id,O.id,e.medico,e.especialidad,e.proveedor,e.prestacionesSolicitadas.map((function(e){return{prestacion:e.prestacion}})))}),{onSuccess:function(e){var a=e.data,r=a.urlDm11,t=a.regionalId;((null===I||void 0===I?void 0:I.canAny([y.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA,y.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_REGISTRADO_POR]))||(null===I||void 0===I?void 0:I.can(y.a.EMITIR_SOLICITUDES_DE_ATENCION_EXTERNA_MISMA_REGIONAL))&&t==(null===I||void 0===I?void 0:I.regionalId))&&(A.open({url:r,title:"Formulario D.M. - 11"}),g(),b(null))}}),T=p.errors,D=C.error;Object(t.useEffect)((function(){var e;if(422==(null===D||void 0===D||null===(e=D.response)||void 0===e?void 0:e.status)){var a,r=(null===(a=D.response)||void 0===a?void 0:a.data).errors;Object.keys(r).forEach((function(e){var a=e;"asegurado.id"==e&&(a="asegurado.matricula"),"empleador.aportes"==e&&(a="empleador.enMora"),_(a,{type:"serverError",message:r[e]})}))}}),[D]);return Object(N.jsx)(S.b,Object(c.a)(Object(c.a)({},m),{},{children:Object(N.jsxs)(d.a,{onSubmit:v((function(e){C.mutate(e)})),children:[Object(N.jsx)("h1",{style:{fontSize:"1.75rem"},children:"Solicitud de atenci\xf3n externa"}),C.isSuccess?Object(N.jsx)(V.a,{variant:"success",children:"La operacion se realiz\xf3 exitosamente"}):C.isError?Object(N.jsx)(V.a,{variant:"danger",children:"Ocurrio un error al procesar la solicitud"}):null,Object(N.jsxs)(Z.a,{className:"mt-3",defaultActiveKey:"0",children:[Object(N.jsx)(ce,{value:O,onChange:function(e){b(e)}}),Object(N.jsx)(ee.a,{className:"overflow-visible",children:Object(N.jsxs)("div",{className:"overflow-hidden",children:[Object(N.jsx)(Z.a.Toggle,{as:ee.a.Header,className:"text-light "+(T.regional?"bg-danger":"bg-primary"),eventKey:"1",children:"Regional"}),Object(N.jsx)(Z.a.Collapse,{eventKey:"1",children:Object(N.jsx)(ee.a.Body,{children:Object(N.jsx)(d.a.Row,{children:Object(N.jsxs)(d.a.Group,{as:u.a,className:"position-unset",children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(S.a,{control:f,name:"regional",render:function(e){var a,r=e.field,t=e.fieldState;return Object(N.jsx)(E.d,{style:{textTransform:"uppercase"},inputProps:{style:{textTransform:"uppercase"}},id:"solicitud-atencion-externa-form/regionales",filterBy:function(e){return!!(null===I||void 0===I?void 0:I.can(y.a.REGISTRAR_SOLICITUDES_DE_ATENCION_EXTERNA))||e.id==(null===I||void 0===I?void 0:I.regionalId)},isInvalid:!!t.error,feedback:null===(a=t.error)||void 0===a?void 0:a.message,selected:r.value,onBlur:r.onBlur,onChange:function(e){R("medico",""),R("proveedor",""),r.onChange(e)}})}})]})})})})]})}),Object(N.jsx)(ee.a,{className:"overflow-visible",children:Object(N.jsxs)("div",{className:"overflow-hidden",children:[Object(N.jsx)(Z.a.Toggle,{as:ee.a.Header,className:"text-light "+(T.medico?"bg-danger":"bg-primary"),eventKey:"2",children:"M\xe9dico"}),Object(N.jsx)(Z.a.Collapse,{eventKey:"2",children:Object(N.jsx)(ee.a.Body,{children:Object(N.jsxs)(d.a.Row,{children:[Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Nombre"}),Object(N.jsx)(d.a.Control,Object(c.a)({style:{textTransform:"uppercase"},isInvalid:!!p.errors.medico},x("medico"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(e=p.errors)||void 0===e||null===(a=e.medico)||void 0===a?void 0:a.message})]}),Object(N.jsxs)(d.a.Group,{as:u.a,children:[Object(N.jsx)(d.a.Label,{children:"Especialidad"}),Object(N.jsx)(d.a.Control,Object(c.a)({style:{textTransform:"uppercase"},isInvalid:!!p.errors.especialidad},x("especialidad"))),Object(N.jsx)(d.a.Control.Feedback,{type:"invalid",children:null===(r=p.errors)||void 0===r||null===(n=r.especialidad)||void 0===n?void 0:n.message})]})]})})})]})}),Object(N.jsx)(se,{})]}),Object(N.jsxs)(j.a,{className:"mt-3",type:"submit",children:[C.isLoading?Object(N.jsx)(l.a,{className:"mr-2",animation:"border",size:"sm"}):null,Object(N.jsx)("span",{children:"Guardar"})]})]})}))},xe=r(590),Ee=function(){var e=Object(n.j)().url,a=Object(v.d)(),r=Object(t.useMemo)((function(){var r=[];return M.index(a)&&r.push({id:"lista-mora",path:"".concat(e,"/lista-mora"),title:"Lista de mora",icon:Object(N.jsx)(X,{})}),W.index(a)&&r.push({id:"atencion-externa",path:"".concat(e,"/atencion-externa"),title:"Atenci\xf3n externa",icon:Object(N.jsx)(o.a,{})}),r}),[a]);return Object(N.jsx)(i.a,{sidebar:{header:Object(N.jsx)("div",{className:"d-flex justify-content-center",children:Object(N.jsx)(xe.a,{src:"/logo-lg.png"})}),items:r},children:Object(N.jsxs)(n.d,{children:[Object(N.jsx)(v.c,{exact:!0,path:"".concat(e,"/lista-mora/agregar"),authorize:M.index,children:Object(N.jsx)(B,{})}),Object(N.jsx)(n.b,{path:"".concat(e,"/lista-mora"),children:Object(N.jsx)(P,{})}),Object(N.jsx)(v.c,{exact:!0,path:"".concat(e,"/atencion-externa"),authorize:W.index,children:Object(N.jsx)(Y,{})}),Object(N.jsx)(v.c,{exact:!0,path:"".concat(e,"/atencion-externa/registrar"),authorize:W.register,children:Object(N.jsx)(he,{})})]})})};a.default=Ee}}]);
//# sourceMappingURL=4.3d2af5b7.chunk.js.map